rule gtfobins_binaries_ghci {
   strings:
      $s1 = "exec $executable --interactive \"$@\"" fullword ascii
      $s2 = "executablename=\"/usr/lib/ghc/bin/./ghci-9.6.6\"" fullword ascii
      $s3 = "executable=\"$bindir/ghc-9.6.6\"" fullword ascii
      $s4 = "bindir=\"/usr/bin\"" fullword ascii
      $s5 = "docdir=\"/usr/share/doc/ghc-doc\"" fullword ascii
      $s6 = "exedir=\"/usr/lib/ghc/bin\"" fullword ascii
      $s7 = "#!/bin/bash" fullword ascii
      $s8 = "exeprog=\"./ghci-9.6.6\"" fullword ascii
      $s9 = "libdir=\"/usr/lib/ghc/lib\"" fullword ascii
      $s10 = "includedir=\"/usr/include\"" fullword ascii
      $magic = {23 21 2f 62 69 6e 2f 62 61 73 68 0a 65 78 65 64 69 72 3d 22 2f 75 73 72 2f 6c 69 62 2f 67 68 63 2f 62 69 6e 22 0a 65 78 65 70 72 6f 67 3d 22 2e 2f 67 68 63 69 2d 39 2e 36 2e 36 22 0a 65 78 65 63 75 74 61 62 6c 65 6e 61 6d 65 3d 22 2f 75 73 72 2f 6c 69 62 2f 67 68 63 2f 62 69 6e 2f 2e 2f 67 68 63 69 2d 39 2e 36 2e 36 22 0a 62 69 6e 64 69 72 3d 22 2f 75 73 72 2f 62 69 6e 22 0a 6c 69 62 64 69 72 3d 22 2f 75 73 72 2f 6c 69 62 2f 67 68 63 2f 6c 69 62 22 0a 64 6f 63 64 69 72 3d 22 2f 75 73 72 2f 73 68 61 72 65 2f 64 6f 63 2f 67 68 63 2d 64 6f 63 22 0a 69 6e 63 6c 75 64 65 64 69 72 3d 22 2f 75 73 72 2f 69 6e 63 6c 75 64 65 22 0a 0a 65 78 65 63 75 74 61 62 6c 65 3d 22 24 62 69 6e 64 69 72 2f 67 68 63 2d 39 2e 36 2e 36 22 0a 65 78 65 63 20 24 65 78 65 63 75 74 61 62 6c 65 20 2d 2d 69 6e 74 65 72 61 63 74 69 76 65 20 22 24 40 22 0a}
condition:
      filesize < 1KB and
      all of them
}

rule gtfobins_binaries_bpftrace {
   strings:
      $s1 = "error: creating an executable stack because of -z execstack command line option" fullword ascii
      $s2 = "error: %pB: object has vendor-specific contents that must be processed by the '%s' toolchain" fullword ascii
      $s3 = ". To specify a particular path to kernel headers, set the env variables BPFTRACE_KERNEL_SOURCE and, optionally, BPFTRACE_KERNEL_" ascii
      $s4 = "warning: enabling an executable stack because of -z execstack command line option" fullword ascii
      $s5 = "Trying to dump BTF from multiple kernel modules at once. " fullword ascii
      $s6 = "    -c 'CMD'       run CMD and enable USDT probes on resulting process" fullword ascii
      $s7 = "%F%P: dynamic STT_GNU_IFUNC symbol `%s' with pointer equality in `%pB' can not be used when making an executable; recompile with" ascii
      $s8 = " * For more details see http://msdn.microsoft.com/en-us/library/y0ybw9fy.aspx" fullword ascii
      $s9 = "will create a tar file at /sys/kernel/kheaders.tar.xz" fullword ascii
      $s10 = " * To accommodate targets that are missing types that are exactly 8, 16, 32, or" fullword ascii
      $s11 = "failed to dump argument: " fullword ascii
      $s12 = "_ZNSt8__detail9_ExecutorIN9__gnu_cxx17__normal_iteratorIPKcNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEEESaINS5_9sub_mat" ascii
      $s13 = "Failed to create create event fd/proc/sys/kernel/randomize_va_sp./src/config.cpp./src/probe_matc./src/struct.cpp/proc/self/ns/mn" ascii
      $s14 = "BTF: failed to initialize dump (" fullword ascii
      $s15 = "failed to dump return type for: " fullword ascii
      $s16 = "_ZNSt8__detail9_ExecutorIN9__gnu_cxx17__normal_iteratorIPKcNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEEESaINS5_9sub_mat" ascii
      $s17 = " * To accommodate these targets, a required minimum-width type is only" fullword ascii
      $s18 = "warning: %s: missing .note.GNU-stack section implies executable stack" fullword ascii
      $s19 = "/*===---- stdint.h - Standard header for sized integer types --------------===*\\" fullword ascii
      $s20 = "get_smp_processor_id" fullword ascii
      $s21 = "%pB: compiled for a big endian system and target is little endian" fullword ascii
      $s22 = "symbol binding STB_GNU_UNIQUE is supported only by GNU and FreeBSD targets" fullword ascii
      $s23 = "%pB: compiled for a little endian system and target is big endian" fullword ascii
      $s24 = "GNU_MBIND section is supported only by GNU and FreeBSD targets" fullword ascii
      $s25 = "error: %s: is triggering the generation of an executable stack (because it has an executable .note.GNU-stack section)" fullword ascii
      $s26 = "error: %s: is triggering the generation of an executable stack because it does not have a .note.GNU-stack section" fullword ascii
      $s27 = "isSafeToReferenceAfterResize(Elt, NewSize) && \"Attempting to reference an element of the vector in an operation \" \"that inval" ascii
      $s28 = "isSafeToReferenceAfterResize(Elt, NewSize) && \"Attempting to reference an element of the vector in an operation \" \"that inval" ascii
      $s29 = "_ZN4llvm11PassBuilderC1EPNS_13TargetMachineENS_21PipelineTuningOptionsESt8optionalINS_10PGOOptionsEEPNS_28PassInstrumentationCal" ascii
      $s30 = "_ZN4llvm11PassBuilderC1EPNS_13TargetMachineENS_21PipelineTuningOptionsESt8optionalINS_10PGOOptionsEEPNS_28PassInstrumentationCal" ascii
      $s31 = " * See https://llvm.org/LICENSE.txt for license information." fullword ascii
      $s32 = " * In violation of the standard, some targets do not implement a type that is" fullword ascii
      $s33 = "is this version of the linker - %s - out of date ?" fullword ascii
      $s34 = " * integer width that the target implements, so corresponding macros are" fullword ascii
      $s35 = "attaching to usdt target file '" fullword ascii
      $s36 = "%pB(%pA): error: secondary reloc section processed twice" fullword ascii
      $s37 = "Failed to create create event fd/proc/sys/kernel/randomize_va_sp./src/config.cpp./src/probe_matc./src/struct.cpp/proc/self/ns/mn" ascii
      $s38 = "Failed to find processes running " fullword ascii
      $s39 = "attaching to uprobe target file '" fullword ascii
      $s40 = "Child core dumped" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 14 13 00 00 00 00 00 40 00 00 00 00 00 00 00 68 fc 53 00 00 00 00 00 00 00 00 00 40 00 38 00 0e 00 40 00 21 00 20 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c8 38 08 00 00 00 00 00 c8 38 08 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 08 00 00 00 00 00 00 40 08 00 00 00 00 00 00 40 08 00 00 00 00 00 39 ae 32 00 00 00 00 00 39 ae 32 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 f0 3a 00 00 00 00 00 00 f0 3a 00 00 00 00 00 00 f0 3a 00 00 00 00 00 13 48 0d 00 00 00 00 00 13 48 0d 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 a8 3b 48 00 00 00 00 00 a8 4b 48 00 00 00 00 00 a8 4b 48 00 00 00 00 00 20 bf 0b 00 00 00 00 00 d8 33 0c 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 30 cc 53 00 00 00 00 00 30 dc 53 00 00 00 00 00 30 dc 53 00 00 00 00 00 a0 02 00 00 00 00 00 00 a0 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 a8 3b 48 00 00 00 00 00 a8 4b 48 00 00 00 00 00 a8 4b 48 00 00 00 00 00 00 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 68 a6 3f 00 00 00 00 00 68 a6 3f 00 00 00 00 00 68 a6 3f 00 00 00 00 00 fc c4 00 00 00 00 00 00 fc c4 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 a8 3b 48 00 00 00 00 00 a8 4b 48 00 00 00 00 00 a8 4b 48 00 00 00 00 00 58 94 0b 00 00 00 00 00 58 94 0b 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 e7 5d ac ca 1e 89 91 50 64 0d 7a 43 34 8f 06 d5 6e 7f d0 4c 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 07 01 00 00 8a 02 00 00 20 00 00 00 0b 00 00 00 10 62 5e 08 80 00 08 20 26 01 90 06 4a 2b a1 4a c0 a0 00 40 28 00 40 80}
condition:
      filesize < 16000KB and
      8 of them and $magic
}

rule gtfobins_binaries_latexmk {
   strings:
      $x1 = "# both non-ASCII character, when latexmk.exe invoked from cmd.exe. In some" fullword ascii
      $s2 = "  warn \"-- Use the -f option to force complete processing.\\n\";" fullword ascii
      $s3 = "  \"   -commands  - list commands used by $my_name for processing files\\n\"," fullword ascii
      $s4 = "    #         executed by a CLI, and by which CLI.  (E.g., cmd.exe," fullword ascii
      $s5 = "# process number and the command line of the processes, since the" fullword ascii
      $s6 = "# $postscript_mode, $pdf_mode, $xdv_mode.  These are used if after processing" fullword ascii
      $s7 = "## Process command line args." fullword ascii
      $s8 = "    # Use -u $ENV{USER} to get all processes started by current user (not just" fullword ascii
      $s9 = "    #  NT-native start command of a cmd.exe is used." fullword ascii
      $s10 = "  \"   -e <code> - Execute specified Perl code (as part of latexmk start-up\\n\"," fullword ascii
      $s11 = "  \"   -f     - force continued processing past errors\\n\"," fullword ascii
      $s12 = "# Usage: Run_no_time (\"command string\");" fullword ascii
      $s13 = "# Hashes, whose keys give names of particular kinds of rule, and targets." fullword ascii
      $s14 = "# postprocessors. " fullword ascii
      $s15 = "# 5. .fls, .log, .aux are all UTF-8, so if necessary convert to CS_system." fullword ascii
      $s16 = "#   else if I fail to spawn a process" fullword ascii
      $s17 = "# The $pscmd below holds a **system-dependent** command to list running" fullword ascii
      $s18 = "# each necessary kind of looping and iteration is coded once.  The" fullword ascii
      $s19 = "# the run of the command for the rule we can measure the processing time of" fullword ascii
      $s20 = "# invoked in turn when a line of an aux file is processed (if none" fullword ascii
      $s21 = "#Glob the filenames command line if the script was not invoked under a " fullword ascii
      $s22 = "# relevant process is identified by the name of file to be viewed." fullword ascii
      $s23 = "# Since deps_file is global (common to all processed files), we must" fullword ascii
      $s24 = "##       after initial processing, when the error condition may get " fullword ascii
      $s25 = "  \"   -g     - process at least one run of all rules\\n\"," fullword ascii
      $s26 = "  \"   -p     - print document after generating postscript.\\n\"," fullword ascii
      $s27 = "  \"   -f-    - turn off forced continuing processing past errors\\n\"," fullword ascii
      $s28 = "#    followed by (a) a command string to be executed by the systerm" fullword ascii
      $s29 = "# Commands for printing are highly system dependent, so default to NONE:" fullword ascii
      $s30 = "#             detaching (as of a previewer) is done by the executed command(s)." fullword ascii
      $s31 = "    # So (FUDGE??) bypass the standard interface for the process." fullword ascii
      $s32 = "## Command to run make:" fullword ascii
      $s33 = "    print \"$My_name: Executing initialization code specified by -e:\\n\"," fullword ascii
      $s34 = "# Commands for use in pvc mode for compiling, success, warnings, and failure;" fullword ascii
      $s35 = "                \"$My_name: A user -r option asked me to process an rc file an extra time.\\n\"," fullword ascii
      $s36 = "#   If process is spawned sucessfully, and I know the PID," fullword ascii
      $s37 = "## \"\" means not determined. Obtain from first line of .log file." fullword ascii
      $s38 = "# latexmk has analyzed the .log and .fls files for dependency information." fullword ascii
      $s39 = "#   else if process is spawned sucessfully, but I do not know the PID," fullword ascii
      $s40 = "    #         under MSWin 7, cmd.exe and perl (by default) work in an" fullword ascii
      $magic = {23 21 20 2f 75 73 72 2f 62 69 6e 2f 70 65 72 6c 0a 75 73 65 20 77 61 72 6e 69 6e 67 73 3b 0a 75 73 65 20 73 74 72 69 63 74 3b 0a 0a 23 23 20 43 6f 70 79 72 69 67 68 74 20 4a 6f 68 6e 20 43 6f 6c 6c 69 6e 73 20 31 39 39 38 2d 32 30 32 34 0a 23 23 20 20 20 20 20 20 20 20 20 20 20 28 75 73 65 72 6e 61 6d 65 20 6a 63 63 38 20 61 74 20 6e 6f 64 65 20 70 73 75 2e 65 64 75 29 0a 23 23 20 20 20 20 20 20 28 61 6e 64 20 74 68 61 6e 6b 73 20 74 6f 20 44 61 76 69 64 20 43 6f 70 70 69 74 20 28 75 73 65 72 6e 61 6d 65 20 64 61 76 69 64 20 61 74 20 6e 6f 64 65 20 63 6f 70 70 69 74 2e 6f 72 67 29 20 0a 23 23 20 20 20 20 20 20 20 20 20 20 20 66 6f 72 20 73 75 67 67 65 73 74 69 6f 6e 73 29 20 0a 23 23 20 43 6f 70 79 72 69 67 68 74 20 45 76 61 6e 20 4d 63 4c 65 61 6e 0a 23 23 20 20 20 20 20 20 20 20 20 28 6d 6f 64 69 66 69 63 61 74 69 6f 6e 73 20 75 70 20 74 6f 20 76 65 72 73 69 6f 6e 20 32 29 0a 23 23 20 43 6f 70 79 72 69 67 68 74 20 31 39 39 32 20 62 79 20 44 61 76 69 64 20 4a 2e 20 4d 75 73 6c 69 6e 65 72 20 61 6e 64 20 54 68 65 20 55 6e 69 76 65 72 73 69 74 79 20 6f 66 20 4d 69 63 68 69 67 61 6e 2e 0a 23 23 20 20 20 20 20 20 20 20 20 28 6f 72 69 67 69 6e 61 6c 20 76 65 72 73 69 6f 6e 29 0a 23 23 0a 23 23 20 20 20 20 54 68 69 73 20 70 72 6f 67 72 61 6d 20 69 73 20 66 72 65 65 20 73 6f 66 74 77 61 72 65 3b 20 79 6f 75 20 63 61 6e 20 72 65 64 69 73 74 72 69 62 75 74 65 20 69 74 20 61 6e 64 2f 6f 72 20 6d 6f 64 69 66 79 0a 23 23 20 20 20 20 69 74 20 75 6e 64 65 72 20 74 68 65 20 74 65 72 6d 73 20 6f 66 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 61 73 20 70 75 62 6c 69 73 68 65 64 20 62 79 0a 23 23 20 20 20 20 74 68 65 20 46 72 65 65 20 53 6f 66 74 77 61 72 65 20 46 6f 75 6e 64 61 74 69 6f 6e 3b 20 65 69 74 68 65 72 20 76 65 72 73 69 6f 6e 20 32 20 6f 66 20 74 68 65 20 4c 69 63 65 6e 73 65 2c 20 6f 72 0a 23 23 20 20 20 20 28 61 74 20 79 6f 75 72 20 6f 70 74 69 6f 6e 29 20 61 6e 79 20 6c 61 74 65 72 20 76 65 72 73 69 6f 6e 2e 0a 23 23 0a 23 23 20 20 20 20 54 68 69 73 20 70 72 6f 67 72 61 6d 20 69 73 20 64 69 73 74 72 69 62 75 74 65 64 20 69 6e 20 74 68 65 20 68 6f 70 65 20 74 68 61 74 20 69 74 20 77 69 6c 6c 20 62 65 20 75 73 65 66 75 6c 2c 0a 23 23 20 20 20 20 62 75 74 20 57 49 54 48 4f 55 54 20 41 4e 59 20 57 41 52 52 41 4e 54 59 3b 20 77 69 74 68 6f 75 74 20 65 76 65 6e 20 74 68 65 20 69 6d 70 6c 69 65 64 20 77 61 72 72 61 6e 74 79 20 6f 66 0a 23 23 20 20 20 20 4d 45 52 43 48 41 4e 54 41 42 49 4c 49 54 59 20 6f 72 20 46 49 54 4e 45 53 53 20 46 4f 52 20 41 20 50 41 52 54 49 43 55 4c 41 52 20 50 55 52 50 4f 53 45 2e 20 20 53 65 65 20 74 68 65 0a 23 23 20 20 20 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 66 6f 72 20 6d 6f 72 65 20 64 65 74 61 69 6c 73 2e 0a 23 23 0a 23 23 20 20 20 20 59 6f 75 20 73 68 6f 75 6c 64 20 68 61 76 65 20 72 65 63 65 69 76 65 64 20 61 20 63 6f 70 79 20 6f 66 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 0a 23 23 20 20 20 20 61 6c 6f 6e 67 20 77 69 74 68 20 74 68 69 73 20 70}
condition:
      filesize < 2000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_apache2ctl {
   strings:
      $s1 = "# Apache control script designed to allow an easy command line interface" fullword ascii
      $s2 = "# Set the maximum number of file descriptors allowed per child process." fullword ascii
      $s3 = "# number of file descriptors allowed per child process. This is" fullword ascii
      $s4 = "[ ! -d ${APACHE_RUN_DIR:-/var/run/apache2}/socks ] && mkdir_chown ${APACHE_RUN_USER:-www-data} ${APACHE_RUN_DIR:-/var/run/apache" ascii
      $s5 = "[ ! -d ${APACHE_RUN_DIR:-/var/run/apache2}/socks ] && mkdir_chown ${APACHE_RUN_USER:-www-data} ${APACHE_RUN_DIR:-/var/run/apache" ascii
      $s6 = "[ ! -d ${APACHE_LOCK_DIR:-/var/lock/apache2} ] && mkdir_chown ${APACHE_RUN_USER:-www-data} ${APACHE_LOCK_DIR:-/var/lock/apache2}" ascii
      $s7 = "2 - usage error" fullword ascii
      $s8 = "0 - operation completed successfully" fullword ascii
      $s9 = "# a command that outputs a formatted text version of the HTML at the" fullword ascii
      $s10 = "    get_status | awk ' /process$/ { print; exit } { print } '" fullword ascii
      $s11 = "# one is reported.  Run \"apachectl help\" for usage info" fullword ascii
      $s12 = "LYNX=\"${APACHE_LYNX:-www-browser -dump}\"" fullword ascii
      $s13 = "[ ! -d ${APACHE_RUN_DIR:-/var/run/apache2} ] && mkdir -p ${APACHE_RUN_DIR:-/var/run/apache2}" fullword ascii
      $s14 = "8 - configuration syntax error" fullword ascii
      $s15 = "# url given on the command line.  Designed for lynx, however other" fullword ascii
      $s16 = "# the following APACHE_* variables should be set in /etc/apache2/envvars" fullword ascii
      $s17 = "# Set this variable to a command that increases the maximum" fullword ascii
      $s18 = "# such as mass vhosting, or a multithreaded server." fullword ascii
      $s19 = "6 - httpd could not be restarted during a restart" fullword ascii
      $s20 = "4 - httpd could not be stopped" fullword ascii
      $s21 = "test -z \"$APACHE_ENVVARS\" && APACHE_ENVVARS=\"$APACHE_CONFDIR/envvars\"" fullword ascii
      $s22 = "7 - httpd could not be restarted during a graceful restart" fullword ascii
      $s23 = "5 - httpd could not be started during a restart" fullword ascii
      $s24 = "3 - httpd could not be started" fullword ascii
      $s25 = "# the path to your httpd binary, including options if necessary" fullword ascii
      $s26 = "        local TMPNAME=$(mktemp -d $DIR.XXXXXXXXXX) || exit 1" fullword ascii
      $s27 = "# critical for configurations that use many file descriptors," fullword ascii
      $s28 = "    [ -e ${APACHE_RUN_DIR:-/var/run/apache2}/*ssl_scache* ] && rm -f ${APACHE_RUN_DIR:-/var/run/apache2}/*ssl_scache*" fullword ascii
      $s29 = "echo The Apache error log may have more information." fullword ascii
      $s30 = "if test -z \"$APACHE_CONFDIR\" ; then" fullword ascii
      $s31 = "ULIMIT_MAX_FILES=\"${APACHE_ULIMIT_MAX_FILES:-ulimit -n 8192}\"" fullword ascii
      $s32 = "if test -f $APACHE_ENVVARS; then" fullword ascii
      $s33 = "STATUSURL=\"${APACHE_STATUSURL:-http://localhost:80/server-status}\"" fullword ascii
      $s34 = "# main configuration directory" fullword ascii
      $s35 = "# |||||||||||||||||||| START CONFIGURATION SECTION  ||||||||||||||||||||" fullword ascii
      $s36 = "# When multiple arguments are given, only the error from the _last_" fullword ascii
      $s37 = "if [ \"x$ULIMIT_MAX_FILES\" != \"x\" ] && [ `id -u` -eq 0 ] ; then" fullword ascii
      $s38 = "    if [ -z \"$APACHE_STARTED_BY_SYSTEMD\" ] ; then" fullword ascii
      $s39 = "APACHE_SYSTEMD_SERVICE=\"apache2$SUFFIX\"" fullword ascii
      $s40 = "        $HTTPD ${APACHE_ARGUMENTS} -k \"$ARGV\"" fullword ascii
      $magic = {23 21 2f 62 69 6e 2f 73 68 0a 23 0a 23 20 4c 69 63 65 6e 73 65 64 20 74 6f 20 74 68 65 20 41 70 61 63 68 65 20 53 6f 66 74 77 61 72 65 20 46 6f 75 6e 64 61 74 69 6f 6e 20 28 41 53 46 29 20 75 6e 64 65 72 20 6f 6e 65 20 6f 72 20 6d 6f 72 65 0a 23 20 63 6f 6e 74 72 69 62 75 74 6f 72 20 6c 69 63 65 6e 73 65 20 61 67 72 65 65 6d 65 6e 74 73 2e 20 20 53 65 65 20 74 68 65 20 4e 4f 54 49 43 45 20 66 69 6c 65 20 64 69 73 74 72 69 62 75 74 65 64 20 77 69 74 68 0a 23 20 74 68 69 73 20 77 6f 72 6b 20 66 6f 72 20 61 64 64 69 74 69 6f 6e 61 6c 20 69 6e 66 6f 72 6d 61 74 69 6f 6e 20 72 65 67 61 72 64 69 6e 67 20 63 6f 70 79 72 69 67 68 74 20 6f 77 6e 65 72 73 68 69 70 2e 0a 23 20 54 68 65 20 41 53 46 20 6c 69 63 65 6e 73 65 73 20 74 68 69 73 20 66 69 6c 65 20 74 6f 20 59 6f 75 20 75 6e 64 65 72 20 74 68 65 20 41 70 61 63 68 65 20 4c 69 63 65 6e 73 65 2c 20 56 65 72 73 69 6f 6e 20 32 2e 30 0a 23 20 28 74 68 65 20 22 4c 69 63 65 6e 73 65 22 29 3b 20 79 6f 75 20 6d 61 79 20 6e 6f 74 20 75 73 65 20 74 68 69 73 20 66 69 6c 65 20 65 78 63 65 70 74 20 69 6e 20 63 6f 6d 70 6c 69 61 6e 63 65 20 77 69 74 68 0a 23 20 74 68 65 20 4c 69 63 65 6e 73 65 2e 20 20 59 6f 75 20 6d 61 79 20 6f 62 74 61 69 6e 20 61 20 63 6f 70 79 20 6f 66 20 74 68 65 20 4c 69 63 65 6e 73 65 20 61 74 0a 23 0a 23 20 20 20 20 20 68 74 74 70 3a 2f 2f 77 77 77 2e 61 70 61 63 68 65 2e 6f 72 67 2f 6c 69 63 65 6e 73 65 73 2f 4c 49 43 45 4e 53 45 2d 32 2e 30 0a 23 0a 23 20 55 6e 6c 65 73 73 20 72 65 71 75 69 72 65 64 20 62 79 20 61 70 70 6c 69 63 61 62 6c 65 20 6c 61 77 20 6f 72 20 61 67 72 65 65 64 20 74 6f 20 69 6e 20 77 72 69 74 69 6e 67 2c 20 73 6f 66 74 77 61 72 65 0a 23 20 64 69 73 74 72 69 62 75 74 65 64 20 75 6e 64 65 72 20 74 68 65 20 4c 69 63 65 6e 73 65 20 69 73 20 64 69 73 74 72 69 62 75 74 65 64 20 6f 6e 20 61 6e 20 22 41 53 20 49 53 22 20 42 41 53 49 53 2c 0a 23 20 57 49 54 48 4f 55 54 20 57 41 52 52 41 4e 54 49 45 53 20 4f 52 20 43 4f 4e 44 49 54 49 4f 4e 53 20 4f 46 20 41 4e 59 20 4b 49 4e 44 2c 20 65 69 74 68 65 72 20 65 78 70 72 65 73 73 20 6f 72 20 69 6d 70 6c 69 65 64 2e 0a 23 20 53 65 65 20 74 68 65 20 4c 69 63 65 6e 73 65 20 66 6f 72 20 74 68 65 20 73 70 65 63 69 66 69 63 20 6c 61 6e 67 75 61 67 65 20 67 6f 76 65 72 6e 69 6e 67 20 70 65 72 6d 69 73 73 69 6f 6e 73 20 61 6e 64 0a 23 20 6c 69 6d 69 74 61 74 69 6f 6e 73 20 75 6e 64 65 72 20 74 68 65 20 4c 69 63 65 6e 73 65 2e 0a 23 0a 23 0a 23 20 41 70 61 63 68 65 20 63 6f 6e 74 72 6f 6c 20 73 63 72 69 70 74 20 64 65 73 69 67 6e 65 64 20 74 6f 20 61 6c 6c 6f 77 20 61 6e 20 65 61 73 79 20 63 6f 6d 6d 61 6e 64 20 6c 69 6e 65 20 69 6e 74 65 72 66 61 63 65 0a 23 20 74 6f 20 63 6f 6e 74 72 6f 6c 6c 69 6e 67 20 41 70 61 63 68 65 2e 20 20 57 72 69 74 74 65 6e 20 62 79 20 4d 61 72 63 20 53 6c 65 6d 6b 6f 2c 20 31 39 39 37 2f 30 38 2f 32 33 0a 23 0a 23 20 48 65 61 76 69 6c 79 20 6d 6f 64 69 66 69 65 64 20 66 6f 72 20 44 65 62 69 61 6e 20 62 79 20 53 74 65 66 61 6e 20 46 72 69 74 73 63 68 20 32 30 30 37 2d 32 30 31 30 0a 23 20 0a 23 20 54 68 65 20 65 78 69 74 20 63 6f 64 65 73 20 72 65 74 75 72 6e 65 64 20 61 72 65 3a}
condition:
      filesize < 20KB and
      8 of them and $magic
}

rule gtfobins_binaries_uudecode {
   strings:
      $s1 = "uudecode (GNU sharutils) - decode an encoded file" fullword ascii
      $s2 = "The encoded file(s) may be specified on the command line, or one may be" fullword ascii
      $s3 = "found.  The program determines from the header line of the encoded file" fullword ascii
      $s4 = "interprocess pipe" fullword ascii
      $s5 = "second or subsquent file specifies standard output, the decoded data will" fullword ascii
      $s6 = "'uudecode' transforms uuencoded files into their original form." fullword ascii
      $s7 = "%s: Command line arguments are not allowed." fullword ascii
      $s8 = "output file name has been encoded with base64 encoding.  See 'uuencode(5)'." fullword ascii
      $s9 = "invalid base64 encoded name: %s" fullword ascii
      $s10 = "Version, usage and configuration options:" fullword ascii
      $s11 = " - examining environment variables named %s_*" fullword ascii
      $s12 = " - reading file $HOME/.sharrc" fullword ascii
      $s13 = "'%s' is not a command line option." fullword ascii
      $s14 = "'n' - version and full copyright notice" fullword ascii
      $s15 = " - reading file %s" fullword ascii
      $s16 = "%s: unknown vendor extension option -- %s" fullword ascii
      $s17 = "uudecode usage error:" fullword ascii
      $s18 = "extended usage information passed thru pager" fullword ascii
      $s19 = "genshellopt 1" fullword ascii
      $s20 = "the original file, except that setuid and execute bits are not retained.  If" fullword ascii
      $s21 = "%s error:  %s exceeds %s keyword count" fullword ascii
      $s22 = "%s error:  invalid option descriptor for %s" fullword ascii
      $s23 = "%s error:  '%s' does not match any %s keywords." fullword ascii
      $s24 = "%s error:  the keyword '%s' is ambiguous for %s" fullword ascii
      $s25 = "test -n \"$%1$s_%2$s\" || {" fullword ascii
      $s26 = "read from standard input.  The output file name is specified in the encoded" fullword ascii
      $s27 = "Copyright (C) 1999-2014 by Bruce Korb - all rights reserved" fullword ascii
      $s28 = "OPTION_COUNT=`expr $ARG_COUNT - $#`" fullword ascii
      $s29 = "If it does, then the shell name and optional first argument will be" fullword ascii
      $s30 = "- an alternate for '%s'" fullword ascii
      $s31 = "If no 'file'(s) are provided, then standard input is decoded." fullword ascii
      $s32 = "You cannot specify an output file when processing" fullword ascii
      $s33 = "Usage:  %s [ -<flag> [<val>] | --<name>[{=| }<val>] ]... [<file>...]" fullword ascii
      $s34 = "optionProcess() was called with invalid data" fullword ascii
      $s35 = "%s warning:  cannot save options - %s not regular file" fullword ascii
      $s36 = "- disabled as '--%s'" fullword ascii
      $s37 = "   -!, --more-help            extended usage information passed thru pager" fullword ascii
      $s38 = "Usage:  %s [ -<flag> [<val>] | --<name>[{=| }<val>] ]..." fullword ascii
      $s39 = "display extended usage information and exit" fullword ascii
      $s40 = "version 2 or later <http://www.gnu.org/licenses/old-licenses/lgpl-2.0.html>" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 50 47 00 00 00 00 00 00 40 00 00 00 00 00 00 00 78 e0 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 32 00 00 00 00 00 00 08 32 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 69 0e 01 00 00 00 00 00 69 0e 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 48 76 00 00 00 00 00 00 48 76 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 ca 01 00 00 00 00 00 70 da 01 00 00 00 00 00 70 da 01 00 00 00 00 00 58 14 00 00 00 00 00 00 40 17 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 cd 01 00 00 00 00 00 e0 dd 01 00 00 00 00 00 e0 dd 01 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 60 a3 01 00 00 00 00 00 60 a3 01 00 00 00 00 00 60 a3 01 00 00 00 00 00 3c 04 00 00 00 00 00 00 3c 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 ca 01 00 00 00 00 00 70 da 01 00 00 00 00 00 70 da 01 00 00 00 00 00 90 05 00 00 00 00 00 00 90 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 fd a6 4f f7 8f 60 e0 81 a9 9a a3 63 7f bd 48 99 f6 cb a9 26 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 62 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 62 00 00 00 64 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 52 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 400KB and
      8 of them and $magic
}

rule gtfobins_binaries_torsocks {
   strings:
      $s1 = "echo \"    $ torsocks ssh user@host.com -p 1234\"" fullword ascii
      $s2 = "# (and will only work with bourne shell users):" fullword ascii
      $s3 = "printf \"ERROR: %s gains the following elevated capabilities. torsocks will not work with privileged executables.\\n%s\" \"$app_" ascii
      $s4 = "printf \"ERROR: %s gains the following elevated capabilities. torsocks will not work with privileged executables.\\n%s\" \"$app_" ascii
      $s5 = "# /System/**, /sbin/**, and /bin/** are currently protected" fullword ascii
      $s6 = "# Spawn a torified shell." fullword ascii
      $s7 = "# https://github.com/mkropat/sh-realpath" fullword ascii
      $s8 = "echo \"Tor mode activated. Every command will be torified for this shell.\"" fullword ascii
      $s9 = "local app_path=\"$(command -v \"$1\")\"" fullword ascii
      $s10 = "# enabled on the users' system." fullword ascii
      $s11 = "# There are three forms of usage for this script:" fullword ascii
      $s12 = "local getcap=\"$(PATH=\"$PATH:/usr/sbin:/sbin\" command -v getcap)\"" fullword ascii
      $s13 = "# *   59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.             *" fullword ascii
      $s14 = "# /usr/bin/torsocks ssh www.foo.org" fullword ascii
      $s15 = "echo \"usage: $0 command args\"" fullword ascii
      $s16 = "echo \"      --shell        Spawn a torified shell\"" fullword ascii
      $s17 = "# Report error due to Apple's System Integrity Protection." fullword ascii
      $s18 = "echo \"  -a, --address HOST Specify Tor address\"" fullword ascii
      $s19 = "# This form sets the users LD_PRELOAD environment variable so that torsocks(8)" fullword ascii
      $s20 = "echo \"Missing password to -p\" >&2" fullword ascii
      $s21 = "# source /usr/bin/torsocks off" fullword ascii
      $s22 = "# . /usr/bin/torsocks on" fullword ascii
      $s23 = "export TORSOCKS_PASSWORD=\"$2\"" fullword ascii
      $s24 = "# source /usr/bin/torsocks on" fullword ascii
      $s25 = "echo \"ERROR: $1 is setgid. torsocks will not work on a setgid executable.\" >&2" fullword ascii
      $s26 = "# It seems like /usr/** (with an exception of /usr/local/**)," fullword ascii
      $s27 = "# . /usr/bin/torsocks off" fullword ascii
      $s28 = "echo \"ERROR: $1 is setuid. torsocks will not work on a setuid executable.\" >&2" fullword ascii
      $s29 = "# This script is originally from the debian torsocks package by" fullword ascii
      $s30 = "# Check if Apple's System Integrity Protection is enabled if the user is" fullword ascii
      $s31 = "echo \"Tor mode deactivated. Command will NOT go through Tor anymore.\"" fullword ascii
      $s32 = "# will be loaded to socksify the application then executes the specified " fullword ascii
      $s33 = "# be used to ssh to www.foo.org via a torsocks.conf(5) configured socks server:" fullword ascii
      $s34 = "# Permission is hereby granted, free of charge, to any person obtaining a copy" fullword ascii
      $s35 = "if [ -n \"$getcap\" ]; then" fullword ascii
      $s36 = "# Silence logging." fullword ascii
      $s37 = "exec \"$@\"" fullword ascii
      $s38 = "# *   Copyright (C) 2012 by Jacob Appelbaum <jacob@torproject.org>          *" fullword ascii
      $s39 = "export TORSOCKS_LOG_LEVEL=5" fullword ascii
      $s40 = "export TORSOCKS_LOG_LEVEL=1" fullword ascii
      $magic = {23 21 2f 62 69 6e 2f 73 68 0a 23 20 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 0a 23 20 2a 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 2a 0a 23 20 2a 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 2a 0a 23 20 2a 20 20 20 43 6f 70 79 72 69 67 68 74 20 28 43 29 20 32 30 30 38 20 62 79 20 52 6f 62 65 72 74 20 48 6f 67 61 6e 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 2a 0a 23 20 2a 20 20 20 72 6f 62 65 72 74 40 72 6f 62 65 72 74 68 6f 67 61 6e 2e 6e 65 74 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 2a 0a 23 20 2a 20 20 20 43 6f 70 79 72 69 67 68 74 20 28 43 29 20 32 30 31 32 20 62 79 20 4a 61 63 6f 62 20 41 70 70 65 6c 62 61 75 6d 20 3c 6a 61 63 6f 62 40 74 6f 72 70 72 6f 6a 65 63 74 2e 6f 72 67 3e 20 20 20 20 20 20 20 20 20 20 2a 0a 23 20 2a 20 20 20 43 6f 70 79 72 69 67 68 74 20 28 43 29 20 32 30 31 33 20 62 79 20 44 61 76 69 64 20 47 6f 75 6c 65 74 20 3c 64 67 6f 75 6c 65 74 40 65 76 30 6b 65 2e 6e 65 74 3e 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 2a 0a 23 20 2a 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 2a 0a 23 20 2a 20 20 20 54 68 69 73 20 70 72 6f 67 72 61 6d 20 69 73 20 66 72 65 65 20 73 6f 66 74 77 61 72 65 3b 20 79 6f 75 20 63 61 6e 20 72 65 64 69 73 74 72 69 62 75 74 65 20 69 74 20 61 6e 64 2f 6f 72 20 6d 6f 64 69 66 79 20 20 2a 0a 23 20 2a 20 20 20 69 74 20 75 6e 64 65 72 20 74 68 65 20 74 65 72 6d 73 20 6f 66 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 61 73 20 70 75 62 6c 69 73 68 65 64 20 62 79 20 20 2a 0a 23 20 2a 20 20 20 74 68 65 20 46 72 65 65 20 53 6f 66 74 77 61 72 65 20 46 6f 75 6e 64 61 74 69 6f 6e 3b 20 65 69 74 68 65 72 20 76 65 72 73 69 6f 6e 20 32 20 6f 66 20 74 68 65 20 4c 69 63 65 6e 73 65 2c 20 6f 72 20 20 20 20 20 2a 0a 23 20 2a 20 20 20 28 61 74 20 79 6f 75 72 20 6f 70 74 69 6f 6e 29 20 61 6e 79 20 6c 61 74 65 72 20 76 65 72 73 69 6f 6e 2e 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 2a 0a 23 20 2a 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 2a 0a}
condition:
      filesize < 30KB and
      8 of them and $magic
}

rule gtfobins_binaries_ntpdate {
   strings:
      $s1 = "# Echo generated command, don't execute" fullword ascii
      $s2 = "# generated ntpdig command rather than executing it." fullword ascii
      $s3 = "        ntpdig $ADJUST $TIMEOUT $PASSTHROUGH $* 2>&1 | logger -t ntpdate" fullword ascii
      $s4 = "# * The -e and -p options of ntpdate are not yet implemented." fullword ascii
      $s5 = "# -k file -k file -k file key file" fullword ascii
      $s6 = "#         -l file         Log to file" fullword ascii
      $s7 = "# -s                      log to syslog (always enabled in ntpd)" fullword ascii
      $s8 = "a) PASSTHROUGH=\"$PASSTHROUGH -a $OPTARG\";;" fullword ascii
      $s9 = "k) PASSTHROUGH=\"$PASSTHROUGH -k $OPTARG\";;" fullword ascii
      $s10 = "o) echo \"ntpdate: -o is no longer supported.\" >&2;;" fullword ascii
      $s11 = "p) echo \"ntpdate: -p is no longer supported.\" >&2;;" fullword ascii
      $s12 = "t) PASSTHROUGH=\"$PASSTHROUGH -t $OPTARG\"; TIMEOUT=\"\";;" fullword ascii
      $s13 = "e) echo \"ntpdate: -e is no longer supported.\" >&2;;" fullword ascii
      $s14 = "# -u      default         unpriv port" fullword ascii
      $s15 = "# -o N            -q      NTP Protocol version" fullword ascii
      $s16 = "# -6      -6      -q -6   Resolve DNS lookups to AAAA records" fullword ascii
      $s17 = "# -q      default -q      query/report only, don't set clock" fullword ascii
      $s18 = "# -e N.N          -q      authdelay" fullword ascii
      $s19 = "# -4      -4      -q -4   Resolve DNS lookups to A records" fullword ascii
      $s20 = "# Debug this by giving the -n option, which causes it to echo the" fullword ascii
      $s21 = "# ntpdate - emulate the crufty old ntpdate utility from NTP Classic" fullword ascii
      $s22 = "# * ntpdate took 4 samples and chose the best (shortest trip time)." fullword ascii
      $s23 = "if [ \"$setclock\" = yes -a -z \"$ADJUST\" ]" fullword ascii
      $s24 = "shift $(($OPTIND - 1))" fullword ascii
      $s25 = "# -p N            -q      How many samples to take" fullword ascii
      $s26 = "#           http://support.ntp.org/bin/view/Dev/DeprecatingNtpdate" fullword ascii
      $s27 = "4) PASSTHROUGH=\"$PASSTHROUGH -4\";;" fullword ascii
      $s28 = "#         -c name         Send concurrent requests to resolved IPs for name" fullword ascii
      $s29 = "6) PASSTHROUGH=\"$PASSTHROUGH -6\";;" fullword ascii
      $s30 = "# -v                      verbose (ntpd is always more verbose than ntpdate)" fullword ascii
      $s31 = "# -d      -d      -d      debugging mode (implies -q)" fullword ascii
      $s32 = "d) PASSTHROUGH=\"$PASSTHROUGH -d\";;" fullword ascii
      $s33 = "#                         (implies -u for ntpdate)" fullword ascii
      $s34 = "# Not documented, as this is strictly a backward-compatibility shim. It's" fullword ascii
      $s35 = "# -B      -s      -q      slew time adjustments" fullword ascii
      $s36 = "# -t N.N  -t N.N          request timeout" fullword ascii
      $s37 = "# SPDX-License-Identifier: BSD-2-Clause" fullword ascii
      $s38 = "# -b      -S      -q      step time adjustments" fullword ascii
      $s39 = "echo \"Options:\"" fullword ascii
      $s40 = "# -a N    -a N    -q      Authentication" fullword ascii
      $magic = {23 21 20 2f 62 69 6e 2f 73 68 0a 23 0a 23 20 6e 74 70 64 61 74 65 20 2d 20 65 6d 75 6c 61 74 65 20 74 68 65 20 63 72 75 66 74 79 20 6f 6c 64 20 6e 74 70 64 61 74 65 20 75 74 69 6c 69 74 79 20 66 72 6f 6d 20 4e 54 50 20 43 6c 61 73 73 69 63 0a 23 0a 23 20 4e 6f 74 20 64 6f 63 75 6d 65 6e 74 65 64 2c 20 61 73 20 74 68 69 73 20 69 73 20 73 74 72 69 63 74 6c 79 20 61 20 62 61 63 6b 77 61 72 64 2d 63 6f 6d 70 61 74 69 62 69 6c 69 74 79 20 73 68 69 6d 2e 20 49 74 27 73 0a 23 20 62 61 73 65 64 20 6f 6e 20 74 68 65 20 72 65 63 69 70 65 73 20 61 74 0a 23 20 20 20 20 20 20 20 20 20 20 20 68 74 74 70 3a 2f 2f 73 75 70 70 6f 72 74 2e 6e 74 70 2e 6f 72 67 2f 62 69 6e 2f 76 69 65 77 2f 44 65 76 2f 44 65 70 72 65 63 61 74 69 6e 67 4e 74 70 64 61 74 65 0a 23 20 77 69 74 68 20 63 6f 72 72 65 63 74 69 6f 6e 73 20 66 6f 72 20 6d 6f 64 65 72 6e 20 6e 74 70 64 69 67 20 6f 70 74 69 6f 6e 73 2e 0a 23 0a 23 20 44 65 62 75 67 20 74 68 69 73 20 62 79 20 67 69 76 69 6e 67 20 74 68 65 20 2d 6e 20 6f 70 74 69 6f 6e 2c 20 77 68 69 63 68 20 63 61 75 73 65 73 20 69 74 20 74 6f 20 65 63 68 6f 20 74 68 65 0a 23 20 67 65 6e 65 72 61 74 65 64 20 6e 74 70 64 69 67 20 63 6f 6d 6d 61 6e 64 20 72 61 74 68 65 72 20 74 68 61 6e 20 65 78 65 63 75 74 69 6e 67 20 69 74 2e 0a 23 0a 23 20 4b 6e 6f 77 6e 20 62 75 67 73 3a 0a 23 20 2a 20 54 68 65 20 2d 65 20 61 6e 64 20 2d 70 20 6f 70 74 69 6f 6e 73 20 6f 66 20 6e 74 70 64 61 74 65 20 61 72 65 20 6e 6f 74 20 79 65 74 20 69 6d 70 6c 65 6d 65 6e 74 65 64 2e 0a 23 20 2a 20 6e 74 70 64 61 74 65 20 74 6f 6f 6b 20 34 20 73 61 6d 70 6c 65 73 20 61 6e 64 20 63 68 6f 73 65 20 74 68 65 20 62 65 73 74 20 28 73 68 6f 72 74 65 73 74 20 74 72 69 70 20 74 69 6d 65 29 2e 0a 23 20 20 20 54 68 69 73 20 74 61 6b 65 73 20 74 68 65 20 66 69 72 73 74 2e 0a 23 0a 23 20 6e 74 70 64 61 74 65 20 6e 74 70 64 69 67 20 20 6e 74 70 64 20 20 20 20 57 68 61 74 20 69 74 20 64 6f 65 73 0a 23 20 2d 34 20 20 20 20 20 20 2d 34 20 20 20 20 20 20 2d 71 20 2d 34 20 20 20 52 65 73 6f 6c 76 65 20 44 4e 53 20 6c 6f 6f 6b 75 70 73 20 74 6f 20 41 20 72 65 63 6f 72 64 73 0a 23 20 2d 36 20 20 20 20 20 20 2d 36 20 20 20 20 20 20 2d 71 20 2d 36 20 20 20 52 65 73 6f 6c 76 65 20 44 4e 53 20 6c 6f 6f 6b 75 70 73 20 74 6f 20 41 41 41 41 20 72 65 63 6f 72 64 73 0a 23 20 2d 61 20 4e 20 20 20 20 2d 61 20 4e 20 20 20 20 2d 71 20 20 20 20 20 20 41 75 74 68 65 6e 74 69 63 61 74 69 6f 6e 0a 23 20 2d 62 20 20 20 20 20 20 2d 53 20 20 20 20 20 20 2d 71 20 20 20 20 20 20 73 74 65 70 20 74 69 6d 65 20 61 64 6a 75 73 74 6d 65 6e 74 73 0a 23 20 2d 42 20 20 20 20 20 20 2d 73 20 20 20 20 20 20 2d 71 20 20 20 20 20 20 73 6c 65 77 20 74 69 6d 65 20 61 64 6a 75 73 74 6d 65 6e 74 73 0a 23 20 2d 64 20 20 20 20 20 20 2d 64 20 20 20 20 20 20 2d 64 20 20 20 20 20 20 64 65 62 75 67 67 69 6e 67 20 6d 6f 64 65 20 28 69 6d 70 6c 69 65 73 20 2d 71 29 0a 23 20 2d 65 20 4e 2e 4e 20 20 20 20 20 20 20 20 20 20 2d 71 20 20 20 20 20 20 61 75 74 68 64 65 6c 61 79 0a 23 20 2d 6b 20 66 69 6c 65 20 2d 6b 20 66 69 6c 65 20 2d 6b 20 66 69 6c 65 20 6b 65 79 20 66 69 6c 65 0a 23 20 2d 6f 20 4e 20 20 20 20 20}
condition:
      filesize < 9KB and
      8 of them and $magic
}

rule gtfobins_binaries_uuencode {
   strings:
      $s1 = "interprocess pipe" fullword ascii
      $s2 = "%s: Command line arguments are not allowed." fullword ascii
      $s3 = "standard in and write the encoded form to standard out.  The output will" fullword ascii
      $s4 = "Version, usage and configuration options:" fullword ascii
      $s5 = " - examining environment variables named %s_*" fullword ascii
      $s6 = " - reading file $HOME/.sharrc" fullword ascii
      $s7 = "'%s' is not a command line option." fullword ascii
      $s8 = "'n' - version and full copyright notice" fullword ascii
      $s9 = " - reading file %s" fullword ascii
      $s10 = "%s: unknown vendor extension option -- %s" fullword ascii
      $s11 = "extended usage information passed thru pager" fullword ascii
      $s12 = "genshellopt 1" fullword ascii
      $s13 = "specifically '/dev/stdout', then 'uudecode' will emit the decoded file to" fullword ascii
      $s14 = "%s error:  %s exceeds %s keyword count" fullword ascii
      $s15 = "%s error:  invalid option descriptor for %s" fullword ascii
      $s16 = "%s error:  '%s' does not match any %s keywords." fullword ascii
      $s17 = "%s error:  the keyword '%s' is ambiguous for %s" fullword ascii
      $s18 = "test -n \"$%1$s_%2$s\" || {" fullword ascii
      $s19 = "Copyright (C) 1999-2014 by Bruce Korb - all rights reserved" fullword ascii
      $s20 = "OPTION_COUNT=`expr $ARG_COUNT - $#`" fullword ascii
      $s21 = "If it does, then the shell name and optional first argument will be" fullword ascii
      $s22 = "uuencode (GNU sharutils) - encode a file into email friendly text" fullword ascii
      $s23 = "uuencode usage error:" fullword ascii
      $s24 = "- an alternate for '%s'" fullword ascii
      $s25 = "optionProcess() was called with invalid data" fullword ascii
      $s26 = "%s warning:  cannot save options - %s not regular file" fullword ascii
      $s27 = "- disabled as '--%s'" fullword ascii
      $s28 = "   -!, --more-help            extended usage information passed thru pager" fullword ascii
      $s29 = "Usage:  %s [ -<flag> [<val>] | --<name>[{=| }<val>] ]..." fullword ascii
      $s30 = "display extended usage information and exit" fullword ascii
      $s31 = "begin with a header line for use by 'uudecode' giving it the resulting" fullword ascii
      $s32 = "Usage:  %s [ -<flag> | --<name> ]... [<in-file>] <output-name>" fullword ascii
      $s33 = "version 2 or later <http://www.gnu.org/licenses/old-licenses/lgpl-2.0.html>" fullword ascii
      $s34 = "with this program.  If not, see <http://www.gnu.org/licenses/>." fullword ascii
      $s35 = "%s error:  %s option requires the %s option" fullword ascii
      $s36 = "Please send bug reports to:  <bug-gnu-utils@gnu.org>" fullword ascii
      $s37 = "version 3 or later <http://gnu.org/licenses/gpl.html>" fullword ascii
      $s38 = "        OPT_PROCESS=false" fullword ascii
      $s39 = "%s error:  the '%s' and '%s' options conflict" fullword ascii
      $s40 = "The genshellopt library is free software; you can redistribute it and/or" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 4c 00 00 00 00 00 00 40 00 00 00 00 00 00 00 58 e0 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 31 00 00 00 00 00 00 40 31 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 c9 08 01 00 00 00 00 00 c9 08 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 58 73 00 00 00 00 00 00 58 73 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 ca 01 00 00 00 00 00 70 da 01 00 00 00 00 00 70 da 01 00 00 00 00 00 38 14 00 00 00 00 00 00 20 17 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 cd 01 00 00 00 00 00 e0 dd 01 00 00 00 00 00 e0 dd 01 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 e0 a0 01 00 00 00 00 00 e0 a0 01 00 00 00 00 00 e0 a0 01 00 00 00 00 00 34 04 00 00 00 00 00 00 34 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 ca 01 00 00 00 00 00 70 da 01 00 00 00 00 00 70 da 01 00 00 00 00 00 90 05 00 00 00 00 00 00 90 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 16 ff ed 7c 4f a7 c8 4d 5a f3 40 31 28 ed a7 0f c3 5e fd 4d 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 5f 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 5f 00 00 00 61 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 4c 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 400KB and
      8 of them and $magic
}

rule gtfobins_binaries_check_log {
   strings:
      $s1 = "#   check_log /var/log/messages ./check_log.badlogins.old \"LOGIN FAILURE\"" fullword ascii
      $s2 = "rm -f \"$templog\"" fullword ascii
      $s3 = "diff \"$logfile\" \"$oldlog\" | grep -v \"^>\" > \"$tempdiff\"" fullword ascii
      $s4 = "templog=\"${TMPDIR}/temp_check_log.tmp\"" fullword ascii
      $s5 = "# Paths to commands used in this script.  These" fullword ascii
      $s6 = "# Copy the logfile to a temporary file, to prevent diff from" fullword ascii
      $s7 = "# The temporary file that the script should use while" fullword ascii
      $s8 = "rc=`echo \"$oldlog\" | grep -q -- \"^-\"; echo $?`" fullword ascii
      $s9 = "#        you define to use this plugin script - even if the different services" fullword ascii
      $s10 = "# processing the log file." fullword ascii
      $s11 = "count=$(grep -c \"$query\" \"$tempdiff\" 2>&1)" fullword ascii
      $s12 = "#   check_log /var/log/message ./check_log.portscan.old \"attackalert\"" fullword ascii
      $s13 = "if [ -x /bin/mktemp ]; then" fullword ascii
      $s14 = "rm -f \"$tempdiff\"" fullword ascii
      $s15 = "# Count the number of matching log entries we have and handle errors when grep fails" fullword ascii
      $s16 = "# Usage: ./check_log <log_file> <old_log_file> <pattern>" fullword ascii
      $s17 = "# Check for login failures in the syslog..." fullword ascii
      $s18 = "    echo \"Usage: $PROGNAME -F logfile -O oldlog -q query -w <number>\"" fullword ascii
      $s19 = "if [ ! -e \"$oldlog\" ]; then" fullword ascii
      $s20 = "# of \"[ -r $logfile ]\", as the latter can return false-negatives on" fullword ascii
      $s21 = "    echo \"Usage: $PROGNAME -F logfile -O oldlog -q query\"" fullword ascii
      $s22 = "if [ ! -e \"$logfile\" ]; then" fullword ascii
      $s23 = "# calls to the plugin script will only report *new* pattern matches in the" fullword ascii
      $s24 = "logfile=$templog" fullword ascii
      $s25 = "# The old log file exists, so compare it to the original log now" fullword ascii
      $s26 = "# log file, since an copy of the log file from the previous run is saved" fullword ascii
      $s27 = "# of \"Log check data initialized\".  On successive runs, it will return an OK" fullword ascii
      $s28 = "# Make sure the correct number of command line" fullword ascii
      $s29 = "# If the source log file doesn't exist or isn't readable, exit." fullword ascii
      $s30 = "# we're running this test, so copy the original log file over to" fullword ascii
      $s31 = "# Grab the command line arguments" fullword ascii
      $s32 = "cp \"$logfile\" \"$templog\"" fullword ascii
      $s33 = "# Linux if the check_log plugin is being run via nrpe with additional" fullword ascii
      $s34 = "#    3.  You *must* supply a different <old_file_log> for each service that" fullword ascii
      $s35 = "# Only use /tmp as a fallback if $TMPDIR doesn't exist" fullword ascii
      $s36 = "    templog=$(/bin/date '+%H%M%S')" fullword ascii
      $s37 = "# Need to remove the temp file otherwise it just fills up the temp directory" fullword ascii
      $s38 = "lastentry=$(egrep \"$query\" \"$tempdiff\" | tail -1)" fullword ascii
      $s39 = "# actually attempts to open the file, which is a true test of whether" fullword ascii
      $s40 = "if [ ! -d \"$TMPDIR\" ];then" fullword ascii
      $magic = {23 21 2f 62 69 6e 2f 73 68 0a 23 0a 23 20 4c 6f 67 20 66 69 6c 65 20 70 61 74 74 65 72 6e 20 64 65 74 65 63 74 6f 72 20 70 6c 75 67 69 6e 20 66 6f 72 20 4e 61 67 69 6f 73 0a 23 20 57 72 69 74 74 65 6e 20 62 79 20 45 74 68 61 6e 20 47 61 6c 73 74 61 64 20 28 6e 61 67 69 6f 73 40 6e 61 67 69 6f 73 2e 6f 72 67 29 0a 23 0a 23 20 55 73 61 67 65 3a 20 2e 2f 63 68 65 63 6b 5f 6c 6f 67 20 3c 6c 6f 67 5f 66 69 6c 65 3e 20 3c 6f 6c 64 5f 6c 6f 67 5f 66 69 6c 65 3e 20 3c 70 61 74 74 65 72 6e 3e 0a 23 0a 23 20 44 65 73 63 72 69 70 74 69 6f 6e 3a 0a 23 0a 23 20 54 68 69 73 20 70 6c 75 67 69 6e 20 77 69 6c 6c 20 73 63 61 6e 20 61 20 6c 6f 67 20 66 69 6c 65 20 28 73 70 65 63 69 66 69 65 64 20 62 79 20 74 68 65 20 3c 6c 6f 67 5f 66 69 6c 65 3e 20 6f 70 74 69 6f 6e 29 0a 23 20 66 6f 72 20 61 20 73 70 65 63 69 66 69 63 20 70 61 74 74 65 72 6e 20 28 73 70 65 63 69 66 69 65 64 20 62 79 20 74 68 65 20 3c 70 61 74 74 65 72 6e 3e 20 6f 70 74 69 6f 6e 29 2e 20 20 53 75 63 63 65 73 73 69 76 65 0a 23 20 63 61 6c 6c 73 20 74 6f 20 74 68 65 20 70 6c 75 67 69 6e 20 73 63 72 69 70 74 20 77 69 6c 6c 20 6f 6e 6c 79 20 72 65 70 6f 72 74 20 2a 6e 65 77 2a 20 70 61 74 74 65 72 6e 20 6d 61 74 63 68 65 73 20 69 6e 20 74 68 65 0a 23 20 6c 6f 67 20 66 69 6c 65 2c 20 73 69 6e 63 65 20 61 6e 20 63 6f 70 79 20 6f 66 20 74 68 65 20 6c 6f 67 20 66 69 6c 65 20 66 72 6f 6d 20 74 68 65 20 70 72 65 76 69 6f 75 73 20 72 75 6e 20 69 73 20 73 61 76 65 64 0a 23 20 74 6f 20 3c 6f 6c 64 5f 6c 6f 67 5f 66 69 6c 65 3e 2e 0a 23 0a 23 20 4f 75 74 70 75 74 3a 0a 23 0a 23 20 4f 6e 20 74 68 65 20 66 69 72 73 74 20 72 75 6e 20 6f 66 20 74 68 65 20 70 6c 75 67 69 6e 2c 20 69 74 20 77 69 6c 6c 20 72 65 74 75 72 6e 20 61 6e 20 4f 4b 20 73 74 61 74 65 20 77 69 74 68 20 61 20 6d 65 73 73 61 67 65 0a 23 20 6f 66 20 22 4c 6f 67 20 63 68 65 63 6b 20 64 61 74 61 20 69 6e 69 74 69 61 6c 69 7a 65 64 22 2e 20 20 4f 6e 20 73 75 63 63 65 73 73 69 76 65 20 72 75 6e 73 2c 20 69 74 20 77 69 6c 6c 20 72 65 74 75 72 6e 20 61 6e 20 4f 4b 0a 23 20 73 74 61 74 65 20 69 66 20 2a 6e 6f 2a 20 70 61 74 74 65 72 6e 20 6d 61 74 63 68 65 73 20 68 61 76 65 20 62 65 65 6e 20 66 6f 75 6e 64 20 69 6e 20 74 68 65 20 2a 64 69 66 66 65 72 65 6e 63 65 2a 20 62 65 74 77 65 65 6e 20 74 68 65 0a 23 20 6c 6f 67 20 66 69 6c 65 20 61 6e 64 20 74 68 65 20 6f 6c 64 65 72 20 63 6f 70 79 20 6f 66 20 74 68 65 20 6c 6f 67 20 66 69 6c 65 2e 20 20 49 66 20 74 68 65 20 70 6c 75 67 69 6e 20 64 65 74 65 63 74 73 20 61 6e 79 0a 23 20 70 61 74 74 65 72 6e 20 6d 61 74 63 68 65 73 20 69 6e 20 74 68 65 20 6c 6f 67 20 64 69 66 66 2c 20 69 74 20 77 69 6c 6c 20 72 65 74 75 72 6e 20 61 20 43 52 49 54 49 43 41 4c 20 73 74 61 74 65 20 61 6e 64 20 70 72 69 6e 74 0a 23 20 6f 75 74 20 61 20 6d 65 73 73 61 67 65 20 69 73 20 74 68 65 20 66 6f 6c 6c 6f 77 69 6e 67 20 66 6f 72 6d 61 74 3a 20 22 28 78 29 20 6c 61 73 74 5f 6d 61 74 63 68 22 2c 20 77 68 65 72 65 20 22 78 22 20 69 73 20 74 68 65 0a 23 20 74 6f 74 61 6c 20 6e 75 6d 62 65 72 20 6f 66 20 70 61 74 74 65 72 6e 20 6d 61 74 63 68 65 73 20 66 6f 75 6e 64 20 69 6e 20 74 68 65 20 66 69 6c 65 20}
condition:
      filesize < 20KB and
      8 of them and $magic
}

rule gtfobins_binaries_enscript {
   strings:
      $s1 = "warning: didn't process following options from environment variable %s:" fullword ascii
      $s2 = "enscriptsite.cfg" fullword ascii
      $s3 = "enscript.cfg" fullword ascii
      $s4 = "  --printer-options=OPTIONS  pass extra options to the printer command" fullword ascii
      $s5 = "%%%%BeginResource: procset Enscript-Header-%s %s" fullword ascii
      $s6 = "systempapername" fullword ascii
      $s7 = "process_file(): got illegal token %d" fullword ascii
      $s8 = "couldn't get passwd entry for uid=%d: %s" fullword ascii
      $s9 = "  -Z, --pass-through         pass through PostScript and PCL files" fullword ascii
      $s10 = "enscript.pro" fullword ascii
      $s11 = "%%%%BeginResource: procset Enscript-Prolog %s" fullword ascii
      $s12 = "/user_header_left_str (%s) def" fullword ascii
      $s13 = "/user_header_center_str (%s) def" fullword ascii
      $s14 = "couldn't find header definition file \"%s.hdr\": %s" fullword ascii
      $s15 = "couldn't find header definition file \"%s.hdr\"" fullword ascii
      $s16 = "/user_header_right_str (%s) def" fullword ascii
      $s17 = "GNU Enscript 1.6.5.90" fullword ascii
      $s18 = "PostScriptLevel:" fullword ascii
      $s19 = "%s:%d: %%HeaderHeight: no argument" fullword ascii
      $s20 = "malformed argument `%s' for option -W, --option: no comma found" fullword ascii
      $s21 = "  --ps-level=LEVEL           set the PostScript language level that enscript" fullword ascii
      $s22 = "AFM Error: %s%s%s" fullword ascii
      $s23 = "file_lookup(): %s/%s%s" fullword ascii
      $s24 = "set new marginals for media `%s' (%dx%d): llx=%d, lly=%d, urx=%d, ury=%d" fullword ascii
      $s25 = "skipping key \"%s\"" fullword ascii
      $s26 = "couldn't read config file \"%s/%s\": %s" fullword ascii
      $s27 = "%%%%BeginResource: procset Enscript-Encoding-%s %s" fullword ascii
      $s28 = "processing file \"%s\"..." fullword ascii
      $s29 = "couldn't open font description file \"%s\": %s" fullword ascii
      $s30 = "bug-enscript@gnu.org" fullword ascii
      $s31 = "downloading font \"%s\"" fullword ascii
      $s32 = "%s:%d: %%Format: name \"%s\" is already defined" fullword ascii
      $s33 = "GENSCRIPT" fullword ascii
      $s34 = "% -- code follows this line --" fullword ascii
      $s35 = "/d_header_w %d def" fullword ascii
      $s36 = "/d_header_y %d def" fullword ascii
      $s37 = "/d_header_h %d def" fullword ascii
      $s38 = "couldn't find prolog \"%s\": %s" fullword ascii
      $s39 = "/user_header_p false def" fullword ascii
      $s40 = "/user_header_p true def" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 6d 01 00 00 00 00 00 40 00 00 00 00 00 00 00 18 61 04 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 58 32 01 00 00 00 00 00 58 32 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 01 00 00 00 00 00 00 40 01 00 00 00 00 00 00 40 01 00 00 00 00 00 ed 94 01 00 00 00 00 00 ed 94 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 02 00 00 00 00 00 00 e0 02 00 00 00 00 00 00 e0 02 00 00 00 00 00 e8 7b 00 00 00 00 00 00 e8 7b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 62 03 00 00 00 00 00 b0 62 03 00 00 00 00 00 b0 62 03 00 00 00 00 00 20 fd 00 00 00 00 00 00 d0 32 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 30 7b 03 00 00 00 00 00 30 7b 03 00 00 00 00 00 30 7b 03 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 70 45 03 00 00 00 00 00 70 45 03 00 00 00 00 00 70 45 03 00 00 00 00 00 ac 02 00 00 00 00 00 00 ac 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 62 03 00 00 00 00 00 b0 62 03 00 00 00 00 00 b0 62 03 00 00 00 00 00 50 1d 00 00 00 00 00 00 50 1d 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 e2 ac b3 54 22 f5 61 2d 42 e9 90 12 c0 b8 f6 55 12 e2 49 8f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 53 00 00 00 01 00 00 00 06 00 00 00 00 05 a1 00 80 01 1c 02 53 00 00 00 55 00 00 00 57 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 32 02 00 00 12 00 00 00}
condition:
      filesize < 800KB and
      8 of them and $magic
}

rule gtfobins_binaries_latex {
   strings:
      $s1 = "  Any remaining COMMANDS are processed as pdfTeX input, after TEXNAME is read." fullword ascii
      $s2 = "quotation error in system command" fullword ascii
      $s3 = "Too many errors - giving up on this content stream" fullword ascii
      $s4 = "Can't swap a %d-byte item for (un)dumping" fullword ascii
      $s5 = "Could not undump %d %d-byte item(s) from %s" fullword ascii
      $s6 = " memory locations dumped; current usage is " fullword ascii
      $s7 = "subfont %s: wrong mapping: character %li --> 0x%4.4lX --> .notdef" fullword ascii
      $s8 = "Beginning to dump on file " fullword ascii
      $s9 = "Bad dump length" fullword ascii
      $s10 = "A dump length must be between 0 and 2^{31}-1," fullword ascii
      $s11 = "runpopen quotation error in command line: %s" fullword ascii
      $s12 = "PDF version {0:s} -- xpdf supports version {1:s} (continuing anyway)" fullword ascii
      $s13 = "[processing page %d]" fullword ascii
      $s14 = "undumptounicode" fullword ascii
      $s15 = "pdffiledump" fullword ascii
      $s16 = "Bad 'toUnicodeDir' config file command ({0:t}:{1:d})" fullword ascii
      $s17 = "Too many errors in CCITTFaxStream - aborting decode" fullword ascii
      $s18 = "tracingcommands" fullword ascii
      $s19 = "the command line with -synctex=0" fullword ascii
      $s20 = "-ini                    be pdfinitex, for dumping formats; this is implicitly" fullword ascii
      $s21 = "Subset TrueType must be a reencoded or a subfont" fullword ascii
      $s22 = "%s: Bad value (%ld) in environment or texmf.cnf for %s, keeping %ld." fullword ascii
      $s23 = "  remaining arguments are processed as above." fullword ascii
      $s24 = " made by different executable version, strings are different" fullword ascii
      $s25 = "! Trouble executing `%s'." fullword ascii
      $s26 = "*** (job aborted, file error in nonstop mode)" fullword ascii
      $s27 = "runpopen command not allowed: %s" fullword ascii
      $s28 = "Expected 'ifelse' in PostScript function stream" fullword ascii
      $s29 = "Bad key/modifier in '{0:s}' config file command ({1:t}:{2:d})" fullword ascii
      $s30 = "getc() failed (%s)" fullword ascii
      $s31 = "Unexpected 'ifelse' in PostScript function stream" fullword ascii
      $s32 = "last command in subr `%i' is not a RETURN; I will add it now but please consider fixing the font" fullword ascii
      $s33 = "/usr/share/fonts/default/ghostscript" fullword ascii
      $s34 = "unexpected command (%i)" fullword ascii
      $s35 = "glyph > glyph_tab && glyph - glyph_tab < glyphs_count" fullword ascii
      $s36 = "Unexpected 'if' in PostScript function stream" fullword ascii
      $s37 = "psEmbedCIDPostScriptFonts" fullword ascii
      $s38 = "( fontnum > 0 ) || ( ( fontnum < 0 ) && ( pdffontnum [ - (integer) fontnum ]> 0 ) )" fullword ascii
      $s39 = "Usage: pdftex [OPTION]... [TEXNAME[.tex]] [COMMANDS]" fullword ascii
      $s40 = "psEmbedCIDPostScript" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 36 06 00 00 00 00 00 40 00 00 00 00 00 00 00 08 a6 24 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 78 d4 05 00 00 00 00 00 78 d4 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 e0 05 00 00 00 00 00 00 e0 05 00 00 00 00 00 00 e0 05 00 00 00 00 00 39 42 14 00 00 00 00 00 39 42 14 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 1a 00 00 00 00 00 00 30 1a 00 00 00 00 00 00 30 1a 00 00 00 00 00 2f eb 05 00 00 00 00 00 2f eb 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 23 20 00 00 00 00 00 50 23 20 00 00 00 00 00 50 23 20 00 00 00 00 00 f8 80 04 00 00 00 00 00 a8 7b 0d 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d0 b6 21 00 00 00 00 00 d0 b6 21 00 00 00 00 00 d0 b6 21 00 00 00 00 00 50 02 00 00 00 00 00 00 50 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 34 e8 1c 00 00 00 00 00 34 e8 1c 00 00 00 00 00 34 e8 1c 00 00 00 00 00 0c 77 00 00 00 00 00 00 0c 77 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 23 20 00 00 00 00 00 50 23 20 00 00 00 00 00 50 23 20 00 00 00 00 00 b0 9c 01 00 00 00 00 00 b0 9c 01 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 52 16 4d 04 df 40 27 9f cf 04 b0 52 e8 a6 be 7b 31 cc 52 5f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 db 00 00 00 01 00 00 00 06 00 00 00 c0 05 b3 00 88 81 1c 02 db 00 00 00 de 00 00 00 e1 00 00 00 28 1d 8c 1c d0 65 ce 6d 23 a5 7d 5c d0 5c 4f e0 66 55 61 10 39 f2 8b 1c b2 a2 f7 12 86 92 4c fc 32 c4 f7 12 ef 21 63 0f 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 7000KB and
      8 of them and $magic
}

rule gtfobins_binaries_pdftex {
   strings:
      $s1 = "  Any remaining COMMANDS are processed as pdfTeX input, after TEXNAME is read." fullword ascii
      $s2 = "quotation error in system command" fullword ascii
      $s3 = "Too many errors - giving up on this content stream" fullword ascii
      $s4 = "Can't swap a %d-byte item for (un)dumping" fullword ascii
      $s5 = "Could not undump %d %d-byte item(s) from %s" fullword ascii
      $s6 = " memory locations dumped; current usage is " fullword ascii
      $s7 = "subfont %s: wrong mapping: character %li --> 0x%4.4lX --> .notdef" fullword ascii
      $s8 = "Beginning to dump on file " fullword ascii
      $s9 = "Bad dump length" fullword ascii
      $s10 = "A dump length must be between 0 and 2^{31}-1," fullword ascii
      $s11 = "runpopen quotation error in command line: %s" fullword ascii
      $s12 = "PDF version {0:s} -- xpdf supports version {1:s} (continuing anyway)" fullword ascii
      $s13 = "[processing page %d]" fullword ascii
      $s14 = "undumptounicode" fullword ascii
      $s15 = "pdffiledump" fullword ascii
      $s16 = "Bad 'toUnicodeDir' config file command ({0:t}:{1:d})" fullword ascii
      $s17 = "Too many errors in CCITTFaxStream - aborting decode" fullword ascii
      $s18 = "tracingcommands" fullword ascii
      $s19 = "the command line with -synctex=0" fullword ascii
      $s20 = "-ini                    be pdfinitex, for dumping formats; this is implicitly" fullword ascii
      $s21 = "Subset TrueType must be a reencoded or a subfont" fullword ascii
      $s22 = "%s: Bad value (%ld) in environment or texmf.cnf for %s, keeping %ld." fullword ascii
      $s23 = "  remaining arguments are processed as above." fullword ascii
      $s24 = " made by different executable version, strings are different" fullword ascii
      $s25 = "! Trouble executing `%s'." fullword ascii
      $s26 = "*** (job aborted, file error in nonstop mode)" fullword ascii
      $s27 = "runpopen command not allowed: %s" fullword ascii
      $s28 = "Expected 'ifelse' in PostScript function stream" fullword ascii
      $s29 = "Bad key/modifier in '{0:s}' config file command ({1:t}:{2:d})" fullword ascii
      $s30 = "getc() failed (%s)" fullword ascii
      $s31 = "Unexpected 'ifelse' in PostScript function stream" fullword ascii
      $s32 = "last command in subr `%i' is not a RETURN; I will add it now but please consider fixing the font" fullword ascii
      $s33 = "/usr/share/fonts/default/ghostscript" fullword ascii
      $s34 = "unexpected command (%i)" fullword ascii
      $s35 = "glyph > glyph_tab && glyph - glyph_tab < glyphs_count" fullword ascii
      $s36 = "Unexpected 'if' in PostScript function stream" fullword ascii
      $s37 = "psEmbedCIDPostScriptFonts" fullword ascii
      $s38 = "( fontnum > 0 ) || ( ( fontnum < 0 ) && ( pdffontnum [ - (integer) fontnum ]> 0 ) )" fullword ascii
      $s39 = "Usage: pdftex [OPTION]... [TEXNAME[.tex]] [COMMANDS]" fullword ascii
      $s40 = "psEmbedCIDPostScript" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 36 06 00 00 00 00 00 40 00 00 00 00 00 00 00 90 4c 24 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 20 00 1f 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e0 d3 05 00 00 00 00 00 e0 d3 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 e0 05 00 00 00 00 00 00 e0 05 00 00 00 00 00 00 e0 05 00 00 00 00 00 49 e5 13 00 00 00 00 00 49 e5 13 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 d0 19 00 00 00 00 00 00 d0 19 00 00 00 00 00 00 d0 19 00 00 00 00 00 dc eb 05 00 00 00 00 00 dc eb 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 c9 1f 00 00 00 00 00 d0 c9 1f 00 00 00 00 00 d0 c9 1f 00 00 00 00 00 f8 80 04 00 00 00 00 00 a8 7b 0d 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 50 5d 21 00 00 00 00 00 50 5d 21 00 00 00 00 00 50 5d 21 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 94 88 1c 00 00 00 00 00 94 88 1c 00 00 00 00 00 94 88 1c 00 00 00 00 00 04 77 00 00 00 00 00 00 04 77 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 c9 1f 00 00 00 00 00 d0 c9 1f 00 00 00 00 00 d0 c9 1f 00 00 00 00 00 30 96 01 00 00 00 00 00 30 96 01 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 c9 bb 2b 0a d2 26 ee 36 d6 04 cb 14 16 cd 6b d4 69 d8 37 c4 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 d9 00 00 00 01 00 00 00 06 00 00 00 c0 05 b3 00 88 81 1c 02 d9 00 00 00 dc 00 00 00 df 00 00 00 28 1d 8c 1c d0 65 ce 6d 23 a5 7d 5c d0 5c 4f e0 66 55 61 10 39 f2 8b 1c b2 a2 f7 12 86 92 4c fc 32 c4 f7 12 ef 21 63 0f 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 7000KB and
      8 of them and $magic
}

rule gtfobins_binaries_luatex {
   strings:
      $s1 = "zlib library version does not match - header: %s, library: %s" fullword ascii
      $s2 = "Execute  'luatex --credits'  for credits and version details." fullword ascii
      $s3 = "!!!!! Coord count (%d) for '%c%c%c%c' script does not match base tag count (%d) in 'BASE' table" fullword ascii
      $s4 = "!!!!! Bad Base Coord format (%d) for '%c%c%c%c' in '%c%c%c%c' script in 'BASE' table" fullword ascii
      $s5 = "  Any remaining COMMANDS are processed as luatex input, after TEXNAME is read." fullword ascii
      $s6 = "    -- os.[execute|os.spawn|os.exec] already are shellescape aware)" fullword ascii
      $s7 = "specific command execution disabled" fullword ascii
      $s8 = "all command execution is disabled" fullword ascii
      $s9 = "    self.try(self.tp:command(\"AUTH\", \"LOGIN\"))" fullword ascii
      $s10 = "Command execution disabled via shell_escape='p'" fullword ascii
      $s11 = "userpassword" fullword ascii
      $s12 = "logger encoding error '%s'" fullword ascii
      $s13 = "lua_gettop(L) == top + 1 && (lua_istable(L, -1) || lua_isnil(L, -1))" fullword ascii
      $s14 = "(ft_usr == 0 && lua_gettop(L) == top) || (lua_gettop(L) == top + 1 && ft_usr == top + 1 && (lua_istable(L, -1) || lua_isnil(L, -" ascii
      $s15 = "process_pdf_image_content" fullword ascii
      $s16 = "All command execution disabled." fullword ascii
      $s17 = "Attempt to read script data beyond end of %s table" fullword ascii
      $s18 = "Attempt to read lookup data beyond end of %s table" fullword ascii
      $s19 = "lua_gettop(L) == top + 2 && lua_istable(L, -1)" fullword ascii
      $s20 = "   --ini                         be iniluatex, for dumping formats" fullword ascii
      $s21 = "the pdf file '%s' is encrypted, passwords wrong" fullword ascii
      $s22 = "stack > getstackbase(L, ptop) && (stack - 1)->s != NULL" fullword ascii
      $s23 = "stack > getstackbase(L, ptop) && (stack - 1)->s == NULL" fullword ascii
      $s24 = "function _M.bind(host, port, backlog)" fullword ascii
      $s25 = "mplib.script_error" fullword ascii
      $s26 = "lua_gettop(L) == top + 1 && lua_istable(L, -1)" fullword ascii
      $s27 = "the pdf file '%s' is encrypted, provide proper passwords" fullword ascii
      $s28 = "(ft_usr == 0 && lua_gettop(L) == top) || (lua_gettop(L) == top + 1 && ft_usr == top + 1 && (lua_istable(L, -1) || lua_isnil(L, -" ascii
      $s29 = "Can't swap a %d-byte item for (un)dumping" fullword ascii
      $s30 = "Could not undump %d %d-byte item(s): %s." fullword ascii
      $s31 = " memory locations dumped; current usage is " fullword ascii
      $s32 = "   --shell-restricted            restrict system commands to a list of commands given in texmf.cnf" fullword ascii
      $s33 = "I'll have to ignore this preprocessor command because it" fullword ascii
      $s34 = "temp_token_head" fullword ascii
      $s35 = "I'll ignore this preprocessor command because it" fullword ascii
      $s36 = "withpostscript" fullword ascii
      $s37 = "postscriptpart" fullword ascii
      $s38 = "Usage: luatex --lua=FILE [OPTION]... [TEXNAME[.tex]] [COMMANDS]" fullword ascii
      $s39 = "Ask the user for mf commands each time mf is invoked" fullword ascii
      $s40 = "Beginning to dump on file " fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 8c 0c 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 22 69 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 61 0c 00 00 00 00 00 10 61 0c 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 70 0c 00 00 00 00 00 00 70 0c 00 00 00 00 00 00 70 0c 00 00 00 00 00 65 eb 2c 00 00 00 00 00 65 eb 2c 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 60 39 00 00 00 00 00 00 60 39 00 00 00 00 00 00 60 39 00 00 00 00 00 80 f5 27 00 00 00 00 00 80 f5 27 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 5c 61 00 00 00 00 00 70 6c 61 00 00 00 00 00 70 6c 61 00 00 00 00 00 b8 c4 07 00 00 00 00 00 e0 35 54 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 0e 65 00 00 00 00 00 e0 1e 65 00 00 00 00 00 e0 1e 65 00 00 00 00 00 50 02 00 00 00 00 00 00 50 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c0 36 5c 00 00 00 00 00 c0 36 5c 00 00 00 00 00 c0 36 5c 00 00 00 00 00 84 af 00 00 00 00 00 00 84 af 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 5c 61 00 00 00 00 00 70 6c 61 00 00 00 00 00 70 6c 61 00 00 00 00 00 90 c3 03 00 00 00 00 00 90 c3 03 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 6e db 10 6f 50 66 d6 2c 1f f4 1c fd 8b e6 53 94 f8 3c 0e a9 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 10 00 00 aa 01 00 00 00 02 00 00 0f 00 00 00 38 04 11 40 62 40 00 00 80 00 87 1b 22 48 81 31 10 88 48 00 00 00 8a 4c 00 04 23 80 00 02 68 c1 01 0c 83 80 02 d9 22 c4 58 08 00 00 80 20 25 08 44 40 00 0a 12 0c 81 08 63 01 b6 01 55 24 90 c9 9a c8 80 96 14 30 00 48 02 40 30 70 7e 10 04 46}
condition:
      filesize < 20000KB and
      8 of them and $magic
}

rule gtfobins_binaries_lualatex {
   strings:
      $s1 = "zlib library version does not match - header: %s, library: %s" fullword ascii
      $s2 = "Execute  'luahbtex --credits'  for credits and version details." fullword ascii
      $s3 = "!!!!! Coord count (%d) for '%c%c%c%c' script does not match base tag count (%d) in 'BASE' table" fullword ascii
      $s4 = "!!!!! Bad Base Coord format (%d) for '%c%c%c%c' in '%c%c%c%c' script in 'BASE' table" fullword ascii
      $s5 = "  Any remaining COMMANDS are processed as luatex input, after TEXNAME is read." fullword ascii
      $s6 = "    -- os.[execute|os.spawn|os.exec] already are shellescape aware)" fullword ascii
      $s7 = "specific command execution disabled" fullword ascii
      $s8 = "all command execution is disabled" fullword ascii
      $s9 = "    self.try(self.tp:command(\"AUTH\", \"LOGIN\"))" fullword ascii
      $s10 = "Command execution disabled via shell_escape='p'" fullword ascii
      $s11 = "userpassword" fullword ascii
      $s12 = "logger encoding error '%s'" fullword ascii
      $s13 = "lua_gettop(L) == top + 1 && (lua_istable(L, -1) || lua_isnil(L, -1))" fullword ascii
      $s14 = "(ft_usr == 0 && lua_gettop(L) == top) || (lua_gettop(L) == top + 1 && ft_usr == top + 1 && (lua_istable(L, -1) || lua_isnil(L, -" ascii
      $s15 = "process_pdf_image_content" fullword ascii
      $s16 = "All command execution disabled." fullword ascii
      $s17 = "Attempt to read script data beyond end of %s table" fullword ascii
      $s18 = "Attempt to read lookup data beyond end of %s table" fullword ascii
      $s19 = "lua_gettop(L) == top + 2 && lua_istable(L, -1)" fullword ascii
      $s20 = "the pdf file '%s' is encrypted, passwords wrong" fullword ascii
      $s21 = "stack > getstackbase(L, ptop) && (stack - 1)->s != NULL" fullword ascii
      $s22 = "stack > getstackbase(L, ptop) && (stack - 1)->s == NULL" fullword ascii
      $s23 = "function _M.bind(host, port, backlog)" fullword ascii
      $s24 = "mplib.script_error" fullword ascii
      $s25 = "lua_gettop(L) == top + 1 && lua_istable(L, -1)" fullword ascii
      $s26 = "the pdf file '%s' is encrypted, provide proper passwords" fullword ascii
      $s27 = "(ft_usr == 0 && lua_gettop(L) == top) || (lua_gettop(L) == top + 1 && ft_usr == top + 1 && (lua_istable(L, -1) || lua_isnil(L, -" ascii
      $s28 = "   --ini                         be iniluahbtex, for dumping formats" fullword ascii
      $s29 = "Can't swap a %d-byte item for (un)dumping" fullword ascii
      $s30 = "Could not undump %d %d-byte item(s): %s." fullword ascii
      $s31 = " memory locations dumped; current usage is " fullword ascii
      $s32 = "   --shell-restricted            restrict system commands to a list of commands given in texmf.cnf" fullword ascii
      $s33 = "I'll have to ignore this preprocessor command because it" fullword ascii
      $s34 = "temp_token_head" fullword ascii
      $s35 = "I'll ignore this preprocessor command because it" fullword ascii
      $s36 = "withpostscript" fullword ascii
      $s37 = "postscriptpart" fullword ascii
      $s38 = "Ask the user for mf commands each time mf is invoked" fullword ascii
      $s39 = "Usage: luahbtex --lua=FILE [OPTION]... [TEXNAME[.tex]] [COMMANDS]" fullword ascii
      $s40 = "Beginning to dump on file " fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 c3 0c 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 d2 69 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 98 9c 0c 00 00 00 00 00 98 9c 0c 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 a0 0c 00 00 00 00 00 00 a0 0c 00 00 00 00 00 00 a0 0c 00 00 00 00 00 8d 33 2d 00 00 00 00 00 8d 33 2d 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 39 00 00 00 00 00 00 e0 39 00 00 00 00 00 00 e0 39 00 00 00 00 00 30 19 28 00 00 00 00 00 30 19 28 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 fd 61 00 00 00 00 00 50 0d 62 00 00 00 00 00 50 0d 62 00 00 00 00 00 d8 d3 07 00 00 00 00 00 40 45 54 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 40 bb 65 00 00 00 00 00 40 cb 65 00 00 00 00 00 40 cb 65 00 00 00 00 00 70 02 00 00 00 00 00 00 70 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 00 c1 5c 00 00 00 00 00 00 c1 5c 00 00 00 00 00 00 c1 5c 00 00 00 00 00 54 b3 00 00 00 00 00 00 54 b3 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 fd 61 00 00 00 00 00 50 0d 62 00 00 00 00 00 50 0d 62 00 00 00 00 00 b0 d2 03 00 00 00 00 00 b0 d2 03 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 3a 12 1e a0 08 a9 4f 6e f8 2f 33 1c a5 20 99 1a 4f 3d 64 8c 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 10 00 00 19 02 00 00 00 02 00 00 0f 00 00 00 38 04 11 40 62 40 00 00 80 00 87 1b 22 48 81 31 10 88 48 00 00 00 8a 4c 00 04 23 80 00 02 68 c1 01 0c 83 80 02 d9 22 c4 58 08 00 00 80 20 25 08 44 40 00 0a 12 0c 81 08 63 01 b6 01 55 24 90 c9 9a c8 80 96 14 30 00 48 02 40 30 70 7e 10 04 46}
condition:
      filesize < 20000KB and
      8 of them and $magic
}

rule gtfobins_binaries_elvish {
   strings:
      $x1 = "Storage daemon may not function.slice bounds out of range [::%x]slice bounds out of range [:%x:]slice bounds out of range [%x::]" ascii
      $x2 = "%ssingle-quoted stringdouble-quoted stringflag: help requestedkill-small-word-leftkill-alnum-word-lefttranspose-small-wordtransp" ascii
      $x3 = "rpc.Register: no service name for type lvalue may not be composite expressions277555756156289135105907917022705078125 cannot pro" ascii
      $x4 = "all goroutines stack traceSIGSTOP: stop, unblockableGC background sweeper waitcall from unknown functionnotewakeup - double wake" ascii
      $x5 = "defer must be called from within a closurearguments to del must omit the dollar sign17347234759768070944119244813919067382812586" ascii
      $x6 = "stopTheWorld: not stopped (status != _Pgcstop)runtime: name offset base pointer out of rangeruntime: type offset base pointer ou" ascii
      $x7 = "startTheWorld: inconsistent mp->nextpruntime: unexpected SPWRITE function all goroutines are asleep - deadlock!value too large f" ascii
      $x8 = "[m30517578125gocachehashgocachetesthttp2clienthttp2serverarchive/tartls10servercrypto/x509archive/zipoutRegPtrs:bad argSizemetho" ascii
      $x9 = " (types from different scopes)failed to get system page sizeassignment to entry in nil mapruntime: found in object at *( in prep" ascii
      $x10 = "stopm spinning nmidlelocked= needspinning=randinit twicestore64 failedsemaRoot queuebad allocCountbad span statestack overflow u" ascii
      $x11 = "pmd.data-edata= runtime/internal/thread exhaustionlocked m0 woke upentersyscallblock spinningthreads=gp.waiting != nilunknown ca" ascii
      $x12 = ", locked to threadinput/output errorno child processesfile name too longno locks availableidentifier removedmultihop attemptedRF" ascii
      $x13 = "runtime: mp.lockedInt = runqsteal: runq overflowdouble traceGCSweepStartbad use of trace.seqlockfunction not implementedlevel 2 " ascii
      $x14 = "lock: lock countbad system huge page sizearena already initialized to unused region of spanunaligned sysNoHugePageOS/sched/gomax" ascii
      $x15 = "reflect: embedded interface with unexported method(s) not implementedtoo many hex fields to fit an embedded IPv4 at the end of t" ascii
      $x16 = "sigaction failedinvalid argumentinvalid exchangeobject is remotemessage too longno route to hostremote I/O errorstopped (signal)" ascii
      $x17 = "store offlinemove-dot-leftmove-dot-downbinding-tablecomplete-sudoarg-completer[%v error] %vapply-autofixautofix firstedit:-insta" ascii
      $x18 = "exit hook invoked panicreflect.Value.Interfacereflect.Value.NumMethodLogical_Order_ExceptionNoncharacter_Code_Pointbytes.Buffer:" ascii
      $x19 = "expected string, styled segment or styled text; got %sarguments to del must be variable or variable elementsonly variables in th" ascii
      $x20 = "[Awordifybindingmatcherdisplayhistorypage-uplistinglastcmdto-showminibufrpromptadd-vardel-varadd-cmddel-cmdadd-dirdel-dirmagenta" ascii
      $x21 = "mstartm not found in allmstopm holding lockssemaRoot rotateLeftbad notifyList sizeruntime: preempt g0runtime: pcdata is bad file" ascii
      $x22 = "dot out of command boundary%s should be string, got %swrong type: need %s, got %s363797880709171295166015625abi.NewName: tag too" ascii
      $x23 = "invalid sleep durationunsupported option: %svariable $%s not foundbad range modifier: %sincomplete mouse event[editor arg genera" ascii
      $x24 = "morebuf={pc:: no frame (sp=runtime: frame ts set in timertimer heap len  != atomic len traceback stuckno such processnot a direc" ascii
      $x25 = "unsafe.String: len out of range.lib section in a.out corruptedcannot assign requested addressinvalid return from write: got malf" ascii
      $x26 = "jsonrpc2: invalid empty batchjsonrpc2: code %v message: %snot in the same process group%s: source is not valid UTF-8can only use" ascii
      $x27 = "accessed data from freed user arena runtime: wrong goroutine in newstackruntime: invalid pc-encoded table f=accessing a corrupte" ascii
      $x28 = "runtime: casgstatus: oldval=gcstopm: negative nmspinningfindrunnable: netpoll with psave on system g not allowednewproc1: newg m" ascii
      $x29 = "ExecuteCommandProvider'json:\"executeCommandProvider,omitempty\"" fullword ascii
      $x30 = "erialExpireMinTTLPort: WeightTarget[%d]%sSTRINGswitchtoken(DB<%q>branch%4d %s%3s %serror:exec: /*.elv&quot;Arity(exceptoptionis-" ascii
      $x31 = ", size = bad prune, tail = newosprocrecover:  not in [ctxt != 0, oldval=, newval= threads=: status= blocked= lockedg=atomicor8 r" ascii
      $x32 = "bufio.Scan: too many empty tokens without progressingreflect: non-interface type passed to Type.Implementsreflect.Value.Slice: s" ascii
      $x33 = "[?2004larg-desc&displayup-cycle-instanthistlistlocationadd-varsdel-varsnext-cmdprev-cmdPageDown%d;%d;%dedit:keyfg-colorbg-color4" ascii
      $x34 = "opt cannot have both arg-required and arg-optionalreflect.Value.Slice3: slice of unaddressable arrayinvalid uint data length %d:" ascii
      $x35 = "[?25hnotifyredraw%s[%d]inserthiddenpinnedfilterpromptyellowInsertDeletePageUpitalicShift-$false0.0000390625rdtscppopcntuint16uin" ascii
      $x36 = "sync/atomic: swap of nil value into Valuetime: Reset called on uninitialized Timertime: missing Location in call to Time.InTime." ascii
      $x37 = "^ {0,3}<\\?remove-allis-regularnamed-pipeunknown %dis-windowsequal-foldhas-prefixhas-suffixlast-indextrim-righttrim-spacecur or " ascii
      $x38 = "unlock: lock countprogToPointerMask: overflow/gc/cycles/forced:gc-cycles/memory/classes/other:bytes/memory/classes/total:bytesfa" ascii
      $x39 = "can't marshal *jsonrpc2.Response (must have result or error)styling function must return a single segment; got %d valuesreflect:" ascii
      $x40 = "parse-getoptempty stringspecial modecontains-any[mods/unix] rlimit valueInstAltMatchunexpected )altmatch -> anynotnl -> stop sig" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 02 00 3e 00 01 00 00 00 f0 b3 59 00 00 00 00 00 40 00 00 00 00 00 00 00 70 75 91 00 00 00 00 00 00 00 00 00 40 00 38 00 0e 00 40 00 23 00 22 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 40 00 00 00 00 00 40 00 40 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 50 03 00 00 00 00 00 00 50 03 40 00 00 00 00 00 50 03 40 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 a8 a1 19 00 00 00 00 00 a8 a1 19 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 b0 19 00 00 00 00 00 00 b0 59 00 00 00 00 00 00 b0 59 00 00 00 00 00 5d 3c 36 00 00 00 00 00 5d 3c 36 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 f0 4f 00 00 00 00 00 00 f0 8f 00 00 00 00 00 00 f0 8f 00 00 00 00 00 a8 21 3f 00 00 00 00 00 a8 21 3f 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 00 1c 8f 00 00 00 00 00 00 2c cf 00 00 00 00 00 00 2c cf 00 00 00 00 00 e0 57 02 00 00 00 00 00 20 bb 04 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 10 1c 8f 00 00 00 00 00 10 2c cf 00 00 00 00 00 10 2c cf 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 70 03 00 00 00 00 00 00 70 03 40 00 00 00 00 00 70 03 40 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 90 03 00 00 00 00 00 00 90 03 40 00 00 00 00 00 90 03 40 00 00 00 00 00 a8 00 00 00 00 00 00 00 a8 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 00 1c 8f 00 00 00 00 00 00 2c cf 00 00 00 00 00 00 2c cf 00 00 00 00 00 00 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 70 03 00 00 00 00 00 00 70 03 40 00 00 00 00 00 70 03 40 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 90 07 8f 00 00 00 00 00 90 07 cf 00 00 00 00 00 90 07 cf 00 00 00 00 00 b4 01 00 00 00 00 00 00 b4 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 00 1c 8f 00 00 00 00 00 00 2c cf 00 00 00 00 00 00 2c cf 00 00 00 00 00 00 04 00 00 00 00 00 00 00 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 20 a3 fb 7f 70 1a d5 ee 1f d1 39 92 7a d1 7f 85 fe 62 41 3b 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 53 00 00 00 04 00 00 00 47 6f 00 00 4b 4a 57 67 62 39 31 6e 4a 41 56 75 54 54 6e 31 59 4b 50 44 2f 66 30 58 71 53 30 4e}
condition:
      filesize < 28000KB and
      1 of ($x*) and $magic
}

rule gtfobins_binaries_busybox {
   strings:
      $s1 = "udhcpc -R -n -p /var/run/udhcpc.%iface%.pid -i %iface%[[ -x hostname:%hostname%]][[ -c %client%]][[ -s %script%]][[ %udhcpc_opts" ascii
      $s2 = "udhcpc -R -n -p /var/run/udhcpc.%iface%.pid -i %iface%[[ -x hostname:%hostname%]][[ -c %client%]][[ -s %script%]][[ %udhcpc_opts" ascii
      $s3 = "user %s: process already running: %s" fullword ascii
      $s4 = "test -f /var/run/udhcpc.%iface%.pid && kill `cat /var/run/udhcpc.%iface%.pid` 2>/dev/null" fullword ascii
      $s5 = "login failed" fullword ascii
      $s6 = "ftp login: %s" fullword ascii
      $s7 = "nologin" fullword ascii
      $s8 = "sulogin" fullword ascii
      $s9 = "kernel does not support requested operation" fullword ascii
      $s10 = "mdev.log" fullword ascii
      $s11 = "mprocessor" fullword ascii
      $s12 = "start-stop-daemon --stop -x wvdial -p /var/run/wvdial.%iface% -s 2" fullword ascii
      $s13 = "start-stop-daemon --start -x wvdial -p /var/run/wvdial.%iface% -b -m --[[ %provider%]]" fullword ascii
      $s14 = "no process info in /proc" fullword ascii
      $s15 = "%s: %u%% - replaced with %.*s" fullword ascii
      $s16 = "dumped)" fullword ascii
      $s17 = "hexdump" fullword ascii
      $s18 = "process in pidfile '%s'" fullword ascii
      $s19 = "process(es) owned by '%s'" fullword ascii
      $s20 = "*** Flush not complete bailing out after %d rounds" fullword ascii
      $s21 = "compressed data not read from terminal, use -f to force it" fullword ascii
      $s22 = "--- %s ping statistics ---" fullword ascii
      $s23 = "dumpleases" fullword ascii
      $s24 = "fatal error, package dependencies corrupt: %d != %d - 1" fullword ascii
      $s25 = "Warning - readback failed" fullword ascii
      $s26 = "password for %s is already %slocked" fullword ascii
      $s27 = "process '%s' (pid %u) exited. Scheduling for restart." fullword ascii
      $s28 = "bad -o argument '%s', supported arguments: %s" fullword ascii
      $s29 = "dumpkmap" fullword ascii
      $s30 = "*** Flush is complete after %d round(s) ***" fullword ascii
      $s31 = "mtarget" fullword ascii
      $s32 = "*** Round %d, deleting %d entries ***" fullword ascii
      $s33 = "GET %s://%s/%s HTTP/1.1" fullword ascii
      $s34 = "%s: no process killed" fullword ascii
      $s35 = " is a shell keyword" fullword ascii
      $s36 = "Adapted from https://github.com/gavinhoward/bc" fullword ascii
      $s37 = "no password entry for root" fullword ascii
      $s38 = "Yuser-agent" fullword ascii
      $s39 = "bad read command" fullword ascii
      $s40 = "target '%s' is not a directory" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 e6 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d0 73 0c 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 48 c3 00 00 00 00 00 00 48 c3 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 19 7b 09 00 00 00 00 00 19 7b 09 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 0a 00 00 00 00 00 00 50 0a 00 00 00 00 00 00 50 0a 00 00 00 00 00 88 e8 01 00 00 00 00 00 88 e8 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 38 0c 00 00 00 00 00 d0 48 0c 00 00 00 00 00 d0 48 0c 00 00 00 00 00 b7 39 00 00 00 00 00 00 88 41 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 80 62 0c 00 00 00 00 00 80 72 0c 00 00 00 00 00 80 72 0c 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 dc 37 0c 00 00 00 00 00 dc 37 0c 00 00 00 00 00 dc 37 0c 00 00 00 00 00 24 00 00 00 00 00 00 00 24 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 38 0c 00 00 00 00 00 d0 48 0c 00 00 00 00 00 d0 48 0c 00 00 00 00 00 30 37 00 00 00 00 00 00 30 37 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 e5 d4 7c c9 28 14 1b 64 11 f8 b7 8a 10 83 b5 2c 18 a4 8d a2 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 63 01 00 00 02 00 00 00 07 00 00 00 a0 21 00 00 52 0d cc 0e 32 1a 8d 00 9c 0c c9 20 00 00 00 00 63 01 00 00 64 01 00 00 67 01 00 00 68 01 00 00 69 01 00 00 6b 01 00 00 6d 01 00 00 6f 01 00 00 00 00 00 00 70 01 00 00 72 01 00 00 74 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 2000KB and
      8 of them and $magic
}

rule gtfobins_binaries_links {
   strings:
      $s1 = " -http.fake-user-agent <string>" fullword ascii
      $s2 = "appspaceusercontent.com" fullword ascii
      $s3 = "githubusercontent.com" fullword ascii
      $s4 = "lpusercontent.com" fullword ascii
      $s5 = "static.observableusercontent.com" fullword ascii
      $s6 = "http.fake-user-agent" fullword ascii
      $s7 = "https://drive.google.com/uc?export=download&id=" fullword ascii
      $s8 = "logoip.com" fullword ascii
      $s9 = "appspacehosted.com" fullword ascii
      $s10 = "paas.hosted-by-previder.com" fullword ascii
      $s11 = "blogsyte.com" fullword ascii
      $s12 = "myiphost.com" fullword ascii
      $s13 = "ip.linodeusercontent.com" fullword ascii
      $s14 = "nfshost.com" fullword ascii
      $s15 = "serveftp.com" fullword ascii
      $s16 = "builtwithdark.com" fullword ascii
      $s17 = "hostedpi.com" fullword ascii
      $s18 = "serveirc.com" fullword ascii
      $s19 = "wphostedmail.com" fullword ascii
      $s20 = "  Name of the PEM encoded file with the user private key" fullword ascii
      $s21 = " -ftp-proxy <host:port>" fullword ascii
      $s22 = "cloud.nospamproxy.com" fullword ascii
      $s23 = "myspreadshop.com" fullword ascii
      $s24 = "servehttp.com" fullword ascii
      $s25 = "remotewd.com" fullword ascii
      $s26 = "stufftoread.com" fullword ascii
      $s27 = "authgearapps.com" fullword ascii
      $s28 = "outsystemscloud.com" fullword ascii
      $s29 = "publishproxy.com" fullword ascii
      $s30 = "qbuser.com" fullword ascii
      $s31 = "postman-echo.com" fullword ascii
      $s32 = "rag-cloud-ch.hosteur.com" fullword ascii
      $s33 = "Errore login FTP" fullword ascii
      $s34 = "  Use ftp PASV command to bypass firewalls." fullword ascii
      $s35 = "mozilla@example.com" fullword ascii
      $s36 = "rag-cloud.hosteur.com" fullword ascii
      $s37 = "site.tb-hosting.com" fullword ascii
      $s38 = "blogspot.com.ng" fullword ascii
      $s39 = "temp-dns.com" fullword ascii
      $s40 = "blogspot.com.tr" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 3f 0b 00 00 00 00 00 40 00 00 00 00 00 00 00 50 e7 22 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a8 2f 0b 00 00 00 00 00 a8 2f 0b 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 0b 00 00 00 00 00 00 30 0b 00 00 00 00 00 00 30 0b 00 00 00 00 00 15 92 07 00 00 00 00 00 15 92 07 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 d0 12 00 00 00 00 00 00 d0 12 00 00 00 00 00 00 d0 12 00 00 00 00 00 10 88 0a 00 00 00 00 00 10 88 0a 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 5d 1d 00 00 00 00 00 f0 6d 1d 00 00 00 00 00 f0 6d 1d 00 00 00 00 00 18 88 05 00 00 00 00 00 10 5e 08 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c8 85 22 00 00 00 00 00 c8 95 22 00 00 00 00 00 c8 95 22 00 00 00 00 00 80 02 00 00 00 00 00 00 80 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 b8 17 1c 00 00 00 00 00 b8 17 1c 00 00 00 00 00 b8 17 1c 00 00 00 00 00 1c 27 00 00 00 00 00 00 1c 27 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 5d 1d 00 00 00 00 00 f0 6d 1d 00 00 00 00 00 f0 6d 1d 00 00 00 00 00 10 32 05 00 00 00 00 00 10 32 05 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 85 ea f0 01 f4 f4 cf 5b 60 f6 e5 84 76 23 d3 d1 70 0f f8 ba 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 e7 00 00 00 01 00 00 00 06 00 00 00 80 01 81 00 00 81 10 02 e7 00 00 00 e9 00 00 00 ea 00 00 00 28 1d 8c 1c d1 65 ce 6d 39 f2 8b 1c ef 21 63 0f 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f9 02 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 7000KB and
      8 of them and $magic
}

rule gtfobins_binaries_varnishncsa {
   strings:
      $s1 = "Use -F or -f in combination with -j to write JSON logs." fullword ascii
      $s2 = "%h %l %u %t \"%r\" %s %b \"%{Referer}i\" \"%{User-agent}i\"" fullword ascii
      $s3 = "Process log records at the head of the log and exit." fullword ascii
      $s4 = "Specifies the VSL query to use. When multiple -q or -Q options are specified, all queries are considered as if the 'or' operator" ascii
      $s5 = "Specifies the file containing the VSL query to use. When multiple -Q or -q options are specified, all queries are considered as " ascii
      $s6 = "Read log in binary file format from this file. The file can be created with ``varnishlog -w filename``. If the filename is -, lo" ascii
      $s7 = "Make format-specifier replacements JSON-compatible. When escaping characters, use JSON-style \\\\uXXXX escape sequences instead " ascii
      $s8 = "Read log in binary file format from this file. The file can be created with ``varnishlog -w filename``. If the filename is -, lo" ascii
      $s9 = "Timeout before returning error on initial VSM connection. If set the VSM connection is retried every 0.5 seconds for this many s" ascii
      $s10 = "Log client requests. This is the default. If -b is specified, then -c is needed to also log client requests" fullword ascii
      $s11 = "econds. If zero the connection is attempted only once and will fail immediately if unsuccessful. If set to \"off\", the connecti" ascii
      $s12 = "Specifies the VSL query to use. When multiple -q or -Q options are specified, all queries are considered as if the 'or' operator" ascii
      $s13 = "Log backend requests. If -c is not specified, then only backend requests will trigger log lines." fullword ascii
      $s14 = "Process old log entries and exit" fullword ascii
      $s15 = "process_vsl" fullword ascii
      $s16 = "process_hdr" fullword ascii
      $s17 = "Sets the upper limit of incomplete transactions kept before the oldest transaction is force completed. A warning record is synth" ascii
      $s18 = "Process this number of matching log transactions before exiting." fullword ascii
      $s19 = "Write the process' PID to the specified file." fullword ascii
      $s20 = "(VSB_cat(CTX.vsb, \"http://localhost\")) == 0" fullword ascii
      $s21 = "Specifies the file containing the VSL query to use. When multiple -Q or -q options are specified, all queries are considered as " ascii
      $s22 = "esized when this happens. This setting keeps an upper bound on the memory usage of running queries. Defaults to 1000 transaction" ascii
      $s23 = "The grouping of the log records. The default is to group by vxid." fullword ascii
      $s24 = "When writing output to a file, append to it rather than overwrite it. This option has no effect without the -w option." fullword ascii
      $s25 = "(unsigned)(q - p) < sizeof buf - 1" fullword ascii
      $s26 = "Missing -w option" fullword ascii
      $s27 = "if the 'or' operator was used to combine them." fullword ascii
      $s28 = "Redirect output to file. The file will be overwritten unless the -a option was specified. If the application receives a SIGHUP i" ascii
      $s29 = "Syntax error. Field specifier must be between 1 and 255: %s]" fullword ascii
      $s30 = "PipeSess:" fullword ascii
      $s31 = "(VSB_error(CTX.vsb)) == 0" fullword ascii
      $s32 = "Timeout before returning error on initial VSM connection. If set the VSM connection is retried every 0.5 seconds for this many s" ascii
      $s33 = "Syntax error: VSL:%s]" fullword ascii
      $s34 = "Unknown log tag: %s" fullword ascii
      $s35 = "Print program usage and exit" fullword ascii
      $s36 = "Usage help" fullword ascii
      $s37 = "(head) != 0" fullword ascii
      $s38 = "Set the output log format string." fullword ascii
      $s39 = "addf_vcl_log" fullword ascii
      $s40 = "openout" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 3a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 48 b3 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 58 22 00 00 00 00 00 00 58 22 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 0d 3f 00 00 00 00 00 00 0d 3f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 c8 28 00 00 00 00 00 00 c8 28 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 9c 00 00 00 00 00 00 90 ac 00 00 00 00 00 00 90 ac 00 00 00 00 00 00 10 15 00 00 00 00 00 00 78 17 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 00 ac 00 00 00 00 00 00 00 bc 00 00 00 00 00 00 00 bc 00 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 b8 92 00 00 00 00 00 00 b8 92 00 00 00 00 00 00 b8 92 00 00 00 00 00 00 d4 00 00 00 00 00 00 00 d4 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 9c 00 00 00 00 00 00 90 ac 00 00 00 00 00 00 90 ac 00 00 00 00 00 00 70 13 00 00 00 00 00 00 70 13 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 75 3c 7c f5 cf 2e 95 76 d0 19 bb 0f 62 ab 0a ee 1f 7a 9a 30 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 39 00 00 00 01 00 00 00 06 00 00 00 00 84 81 08 04 01 3c 01 39 00 00 00 3b 00 00 00 3c 00 00 00 28 1d 8c 1c d1 65 ce 6d 29 ee 32 87}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_timedatectl {
   strings:
      $s1 = "  -H --host=[USER@]HOST    Operate on remote host" fullword ascii
      $s2 = "Failed to get ifindex of interfaces %s: %s" fullword ascii
      $s3 = "ask_password_agent_close" fullword ascii
      $s4 = "systemd-timesyncd Commands:" fullword ascii
      $s5 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"systemd\",\"version\":\"256.2-1\",\"architecture\":\"amd64\",\"debugInfoUrl\":\"h" ascii
      $s6 = "Could not get time from timedated and not operating locally, ignoring." fullword ascii
      $s7 = " RootDispersion=%s," fullword ascii
      $s8 = "{ Leap=%u, Version=%u, Mode=%u, Stratum=%u, Precision=%i," fullword ascii
      $s9 = " RootDelay=%s," fullword ascii
      $s10 = "log_assert_failed_unreachable" fullword ascii
      $s11 = "log_assert_failed" fullword ascii
      $s12 = "bus_log_connect_error" fullword ascii
      $s13 = "no-ask-password" fullword ascii
      $s14 = "Failed to get event loop: %m" fullword ascii
      $s15 = "log_get_max_level" fullword ascii
      $s16 = "%s [OPTIONS...] COMMAND ..." fullword ascii
      $s17 = "     --no-ask-password     Do not prompt for password" fullword ascii
      $s18 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/systemd.debug" fullword ascii
      $s19 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"systemd\",\"version\":\"256.2-1\",\"architecture\":\"amd64\",\"debugInfoUrl\":\"h" ascii
      $s20 = "Failed to run event loop: %m" fullword ascii
      $s21 = "Failed to parse NTP setting '%s': %m" fullword ascii
      $s22 = "Failed to revert interface configuration: %s" fullword ascii
      $s23 = " Ignored=%s, PacketCount=%lu," fullword ascii
      $s24 = " OriginateTimestamp=%s," fullword ascii
      $s25 = " TransmitTimestamp=%s," fullword ascii
      $s26 = " Reference=%s," fullword ascii
      $s27 = " ReceiveTimestamp=%s," fullword ascii
      $s28 = " DestinationTimestamp=%s," fullword ascii
      $s29 = "log_oom_internal" fullword ascii
      $s30 = "polkit_agent_close" fullword ascii
      $s31 = "log_internal" fullword ascii
      $s32 = "get_color_mode" fullword ascii
      $s33 = "     --no-pager            Do not pipe output into a pager" fullword ascii
      $s34 = "polkit_agent_open_if_enabled" fullword ascii
      $s35 = "cell = table_get_cell(table, 0, 1)" fullword ascii
      $s36 = "Failed to parse local RTC setting '%s': %m" fullword ascii
      $s37 = "GetLinkByName" fullword ascii
      $s38 = "%sWarning: The system is configured to read the RTC time in the local time zone." fullword ascii
      $s39 = "sd_bus_message_get_bus" fullword ascii
      $s40 = "cell = table_get_cell(table, 0, 0)" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 39 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 b1 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 26 00 00 00 00 00 00 20 26 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 15 41 00 00 00 00 00 00 15 41 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 94 1e 00 00 00 00 00 00 94 1e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 a5 00 00 00 00 00 00 50 a5 00 00 00 00 00 00 50 a5 00 00 00 00 00 00 b9 0a 00 00 00 00 00 00 f0 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c0 aa 00 00 00 00 00 00 c0 aa 00 00 00 00 00 00 c0 aa 00 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 dc 00 00 00 00 00 00 00 dc 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 30 96 00 00 00 00 00 00 30 96 00 00 00 00 00 00 30 96 00 00 00 00 00 00 cc 00 00 00 00 00 00 00 cc 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 a5 00 00 00 00 00 00 50 a5 00 00 00 00 00 00 50 a5 00 00 00 00 00 00 b0 0a 00 00 00 00 00 00 b0 0a 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 52 a7 68 ca 3d bf 8d 49 7e de b9 76 0b 73 91 ce 6c 4f fe 78 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 88 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 73 79 73 74 65 6d 64 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 35 36 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a 22 61 6d 64}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_dvips {
   strings:
      $s1 = "head.tmp" fullword ascii
      $s2 = "target.dct" fullword ascii
      $s3 = "postscriptbox" fullword ascii
      $s4 = "Execution of <%.500s> failed " fullword ascii
      $s5 = "end targetdump-hook def end" fullword ascii
      $s6 = "Adding font '%s' from included postscript file '%s'." fullword ascii
      $s7 = "! postscriptbox{} arguments longer than %d characters" fullword ascii
      $s8 = "Secure mode is %d so execute <%.500s> will not run" fullword ascii
      $s9 = "body.tmp" fullword ascii
      $s10 = "Oh no, link not found in target hashtable" fullword ascii
      $s11 = "Can't use PostScript encoding vector for font %s; character %d has no name." fullword ascii
      $s12 = "-v   Print version number and quit   -V*  Send downloadable PS fonts as PK" fullword ascii
      $s13 = "last command in subr `%i' is not a RETURN; I will add it now but please consider fixing the font" fullword ascii
      $s14 = "! DVI file contains unexpected pTeX command (%d)" fullword ascii
      $s15 = "Preprocessing special: %s" fullword ascii
      $s16 = "(www.radicaleye.com)" fullword ascii
      $s17 = "Convert DVI input files to PostScript." fullword ascii
      $s18 = "@(#)$Header: /usr/local/src/TeX/Dvips-5.0.2/RCS/drawPS.c,v 1.1 90/03/10 20:32:48 grunwald Exp $ (UCLA)" fullword ascii
      $s19 = "! couldn't open PostScript file" fullword ascii
      $s20 = "Unknown em: command (%s) in \\special will be ignored" fullword ascii
      $s21 = "Processing special: %s" fullword ascii
      $s22 = "! DVI file contains unexpected command (%d)" fullword ascii
      $s23 = "unexpected data after eexec" fullword ascii
      $s24 = "unexpected command in preamble" fullword ascii
      $s25 = "/TargetAnchors" fullword ascii
      $s26 = "Attempt to fill a non-closed path" fullword ascii
      $s27 = "-j*  Download fonts partially" fullword ascii
      $s28 = "warning: %s: z0 directive ignored since -R1 given" fullword ascii
      $s29 = " ERROR: In <%s> keyword not found:" fullword ascii
      $s30 = " Error: ending token 'def' not found in <%s> " fullword ascii
      $s31 = "Reading dvips config file `%s':" fullword ascii
      $s32 = "Warning: Failed to fallback pTeX vf:%s char=%d(0x%06x) to %s:%s" fullword ascii
      $s33 = "dup dup %i %i getinterval %i exch putinterval" fullword ascii
      $s34 = "command not valid: %i" fullword ascii
      $s35 = "dup dup %i exch %i get put" fullword ascii
      $s36 = "command value out of range: %i" fullword ascii
      $s37 = "Spline less than two points - ignored" fullword ascii
      $s38 = "! unexpected command" fullword ascii
      $s39 = "em:graph: Unable to Read Valid MSP Header" fullword ascii
      $s40 = "note: -t selected paper may be too large" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 66 00 00 00 00 00 00 40 00 00 00 00 00 00 00 60 b9 03 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 78 3f 00 00 00 00 00 00 78 3f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 69 b5 02 00 00 00 00 00 69 b5 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 03 00 00 00 00 00 00 00 03 00 00 00 00 00 00 00 03 00 00 00 00 00 b0 9e 00 00 00 00 00 00 b0 9e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 a2 03 00 00 00 00 00 50 a2 03 00 00 00 00 00 50 a2 03 00 00 00 00 00 60 15 00 00 00 00 00 00 28 5f 03 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 aa 03 00 00 00 00 00 e0 aa 03 00 00 00 00 00 e0 aa 03 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 a4 64 03 00 00 00 00 00 a4 64 03 00 00 00 00 00 a4 64 03 00 00 00 00 00 0c 07 00 00 00 00 00 00 0c 07 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 a2 03 00 00 00 00 00 50 a2 03 00 00 00 00 00 50 a2 03 00 00 00 00 00 b0 0d 00 00 00 00 00 00 b0 0d 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 5c fe 37 40 83 9c 62 3c b6 cf 7d 97 e6 e2 ad fe 33 22 78 f2 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 5d 00 00 00 01 00 00 00 06 00 00 00 c0 07 b3 01 88 81 18 02 5d 00 00 00 60 00 00 00 63 00 00 00 28 1d 8c 1c 22 a5 7d 5c d1 65 ce 6d d0 5c 4f e0 66 55 61 10 39 f2 8b 1c ee 21 63 0f 58 82 66 93 87 92 4c fc 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 700KB and
      8 of them and $magic
}

rule gtfobins_binaries_alpine {
   strings:
      $x1 = "# shell connection.  The default is \"%s %s -l %s exec /etc/r%sd\"" fullword ascii
      $x2 = "https://api.login.yahoo.com/oauth2/get_token" fullword ascii
      $x3 = " - process_cmd(cmd=%d) -" fullword ascii
      $s4 = "# have to enter a password when they run the keyboard lock command in the" fullword ascii
      $s5 = "--build=x86_64-linux-gnu --prefix=/usr '--includedir=${prefix}/include' '--mandir=${prefix}/share/man' '--infodir=${prefix}/shar" ascii
      $s6 = "Consider creating an alias or shell script to execute this command to make" fullword ascii
      $s7 = "https://login.microsoftonline.com/" fullword ascii
      $s8 = "<LI>First, login to <A HREF=\"https://console.developers.google.com\">https://console.developers.google.com</A> " fullword ascii
      $s9 = "https://api.login.yahoo.com/oauth2/request_auth" fullword ascii
      $s10 = "<CENTER><SAMP>Command = C:&#92;cygwin&#92;bin&#92;bogofilter.exe -u</SAMP></CENTER>" fullword ascii
      $s11 = "Read command: looks like user typed non-ascii command 0x%x %s: returning KEY_UTF8" fullword ascii
      $s12 = "imap_delete_password: user=%s, host=%s, authtype=%s." fullword ascii
      $s13 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                                                                                               ' */
      $s14 = "Read command: looks like user typed unknown, non-ascii command 0x%x %s: returning KEY_UNKNOWN" fullword ascii
      $s15 = "<CENTER><SAMP>smtpserver.example.com/user=katie</SAMP></CENTER>" fullword ascii
      $s16 = "&nbsp;F4&nbsp;&nbsp;Execute&nbsp;current&nbsp;MAIN&nbsp;MENU&nbsp;command&nbsp;&nbsp;&nbsp;F4&nbsp;&nbsp;<A " fullword ascii
      $s17 = " Failed to create private key. Using UNencrypted Password file. " fullword ascii
      $s18 = "Note that the dump command is currently disabled." fullword ascii
      $s19 = "624395471329-0qee3goofj7kbl7hsukou3rqq0igntv1.apps.googleusercontent.com" fullword ascii
      $s20 = "smtp.gmail.com" fullword ascii
      $s21 = "your email. Once you have completed the authorization process you will get" fullword ascii
      $s22 = " Failed to unlock private key. Using UNencrypted Password file. " fullword ascii
      $s23 = "smtp.mail.yahoo.com" fullword ascii
      $s24 = "Login %s failed: unable to set chroot=%.80s host=%.80s" fullword ascii
      $s25 = "smtp.office365.com" fullword ascii
      $s26 = "temporarily interact with the operating system command &quot;shell&quot; " fullword ascii
      $s27 = "smtp.yandex.com" fullword ascii
      $s28 = "- address_is_us regexec error: %s (%s)" fullword ascii
      $s29 = "mm_login_work trial=%ld user=%s service=%s%s%s%s%s" fullword ascii
      $s30 = "When you use the Forward (<!--chtml if pinemode=\"function_key\"-->F12<!--chtml else-->&quot;F&quot;<!--chtml endif-->) command," ascii
      $s31 = "<DD>When the command is executed, this token is replaced in the" fullword ascii
      $s32 = "<DD>When the command is executed, this token is " fullword ascii
      $s33 = "missing client-id name. Example: -xoauth2-client-id 760.someserver.com" fullword ascii
      $s34 = "missing username value. Example: -xoauth2-user user@example.com" fullword ascii
      $s35 = "The command is executed and the message is piped into its standard input. " fullword ascii
      $s36 = "mm_login_oauth2 trial=%ld user=%s service=%s%s%s%s%s" fullword ascii
      $s37 = "When the command is executed, this token is " fullword ascii
      $s38 = "<li><a href=\"h_config_suppress_user_agent\">FEATURE: <!--#echo var=\"FEAT_suppress-user-agent-when-sending\"--></a>" fullword ascii
      $s39 = "VND.OPENXMLFORMATS-OFFICEDOCUMENT.WORDPROCESSINGML.TEMPLATE" fullword ascii
      $s40 = "dump is readable by others, the loginname and password could be read" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 58 12 00 00 00 00 00 40 00 00 00 00 00 00 00 40 66 68 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 12 00 00 00 00 00 10 00 12 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 12 00 00 00 00 00 00 10 12 00 00 00 00 00 00 10 12 00 00 00 00 00 e5 f9 2a 00 00 00 00 00 e5 f9 2a 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 10 3d 00 00 00 00 00 00 10 3d 00 00 00 00 00 00 10 3d 00 00 00 00 00 88 3b 21 00 00 00 00 00 88 3b 21 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 5a 5e 00 00 00 00 00 50 5a 5e 00 00 00 00 00 50 5a 5e 00 00 00 00 00 a8 0a 0a 00 00 00 00 00 f0 59 16 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 08 af 5e 00 00 00 00 00 08 af 5e 00 00 00 00 00 08 af 5e 00 00 00 00 00 70 02 00 00 00 00 00 00 70 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 f4 d5 59 00 00 00 00 00 f4 d5 59 00 00 00 00 00 f4 d5 59 00 00 00 00 00 1c 8d 00 00 00 00 00 00 1c 8d 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 5a 5e 00 00 00 00 00 50 5a 5e 00 00 00 00 00 50 5a 5e 00 00 00 00 00 b0 65 00 00 00 00 00 00 b0 65 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 03 c0 a9 b0 17 57 3e 3b 6c d7 c7 2e 6c f8 d6 c8 25 be 8e 62 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 b9 01 00 00 02 00 00 00 07 00 00 00 08 00 00 64 30 01 04 16 00 08 05 08 80 84 14 10 b9 01 00 00 bd 01 00 00 c0 01 00 00 28 1d 8c 1c d0 65 ce 6d 7c de 56 e1 f5 17 53 1f 66 55 61 10 38 f2 8b 1c bd ee 90 ca 02 cf 56 fc 5a 59 59 12 52 e8 71 d0 24 cd 06 75 39 b9 6d 86 00 00 00 00}
condition:
      filesize < 20000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_python {
   strings:
      $s1 = "Return True if the process returning status was dumped to a core file." fullword ascii
      $s2 = "6666666666666666666666666666666666666666" wide /* reversed goodware string '6666666666666666666666666666666666666666' */ /* hex encoded string 'ffffffffffffffffffff' */
      $s3 = "6666666666666666666666666666666666666666666666666666666666666666" wide /* reversed goodware string '6666666666666666666666666666666666666666666666666666666666666666' */ /* hex encoded string 'ffffffffffffffffffffffffffffffff' */
      $s4 = "666666666666666666666666666666" wide /* reversed goodware string '666666666666666666666666666666' */ /* hex encoded string 'fffffffffffffff' */
      $s5 = "6666666666666666666666" wide /* reversed goodware string '6666666666666666666666' */ /* hex encoded string 'fffffffffff' */
      $s6 = "666666666666666666666666" wide /* reversed goodware string '666666666666666666666666' */ /* hex encoded string 'ffffffffffff' */
      $s7 = "666666666666666666666666666666666666666666666666666666" wide /* reversed goodware string '666666666666666666666666666666666666666666666666666666' */ /* hex encoded string 'fffffffffffffffffffffffffff' */
      $s8 = "666666666666666666" wide /* reversed goodware string '666666666666666666' */ /* hex encoded string 'fffffffff' */
      $s9 = "666666666666666666666666666666666666666666666666" wide /* reversed goodware string '666666666666666666666666666666666666666666666666' */ /* hex encoded string 'ffffffffffffffffffffffff' */
      $s10 = "666666666666666666666666666666666666" wide /* reversed goodware string '666666666666666666666666666666666666' */ /* hex encoded string 'ffffffffffffffffff' */
      $s11 = "6666666666666666666666666666666666" wide /* reversed goodware string '6666666666666666666666666666666666' */ /* hex encoded string 'fffffffffffffffff' */
      $s12 = "66666666666666666666666666666666666666666666" wide /* reversed goodware string '66666666666666666666666666666666666666666666' */ /* hex encoded string 'ffffffffffffffffffffff' */
      $s13 = "66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666" wide /* reversed goodware string '66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666' */ /* hex encoded string 'fffffffffffffffffffffffffffffffffffffffffffffffff' */
      $s14 = "66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666" wide /* reversed goodware string '66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666' */ /* hex encoded string 'ffffffffffffffffffffffffffffffffffffffffffffffffffffffffff' */
      $s15 = "66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666" wide /* reversed goodware string '66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666' */ /* hex encoded string 'ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff' */
      $s16 = "66666666666666666666666666666666666666" wide /* reversed goodware string '66666666666666666666666666666666666666' */ /* hex encoded string 'fffffffffffffffffff' */
      $s17 = "666666666666666666666666666666666666666666" wide /* reversed goodware string '666666666666666666666666666666666666666666' */ /* hex encoded string 'fffffffffffffffffffff' */
      $s18 = "66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666" wide /* reversed goodware string '6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666' */ /* hex encoded string 'fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff' */
      $s19 = "333333333333333333333333333333333333333333" wide /* reversed goodware string '333333333333333333333333333333333333333333' */ /* hex encoded string '333333333333333333333' */
      $s20 = "33333333333333333333333333333333333333333333333333333333333333" wide /* reversed goodware string '33333333333333333333333333333333333333333333333333333333333333' */ /* hex encoded string '3333333333333333333333333333333' */
      $s21 = "getnameinfo(sockaddr, flags) --> (host, port)" fullword ascii
      $s22 = "Execute the program specified by path in a new process." fullword ascii
      $s23 = "Execute the command in a subshell." fullword ascii
      $s24 = "  gr_passwd - group password (encrypted); often empty" fullword ascii
      $s25 = "  - a text string encoded using the specified encoding" fullword ascii
      $s26 = "FileLoader.get_resource_reader" fullword ascii
      $s27 = "NamespaceLoader.get_resource_reader" fullword ascii
      $s28 = "NamespaceLoader.exec_module" fullword ascii
      $s29 = "ExtensionFileLoader.exec_module" fullword ascii
      $s30 = "If an error occurs in the child process before the exec, it is" fullword ascii
      $s31 = "Process time for profiling: sum of the kernel and user-space CPU time." fullword ascii
      $s32 = "Get the scheduling policy for the process identified by pid." fullword ascii
      $s33 = "LazyLoader.exec_module" fullword ascii
      $s34 = "BuiltinImporter.exec_module" fullword ascii
      $s35 = "decoded or encoded with. It defaults to locale.getencoding()." fullword ascii
      $s36 = "FrozenImporter.exec_module" fullword ascii
      $s37 = "dumps() -- marshal value as a bytes object" fullword ascii
      $s38 = "    the target file descriptor of the operation" fullword ascii
      $s39 = "decodedbytes" fullword ascii
      $s40 = "PYTHONFAULTHANDLER: dump the Python traceback on fatal errors (-X faulthandler)" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 02 00 3e 00 01 00 00 00 30 70 64 00 00 00 00 00 40 00 00 00 00 00 00 00 58 e7 7a 00 00 00 00 00 00 00 00 00 40 00 38 00 0e 00 40 00 22 00 21 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 40 00 00 00 00 00 40 00 40 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 50 03 00 00 00 00 00 00 50 03 40 00 00 00 00 00 50 03 40 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 50 f6 01 00 00 00 00 00 50 f6 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 00 02 00 00 00 00 00 00 00 42 00 00 00 00 00 00 00 42 00 00 00 00 00 b9 97 2d 00 00 00 00 00 b9 97 2d 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 2f 00 00 00 00 00 00 a0 6f 00 00 00 00 00 00 a0 6f 00 00 00 00 00 d0 61 33 00 00 00 00 00 d0 61 33 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 c8 0d 63 00 00 00 00 00 c8 1d a3 00 00 00 00 00 c8 1d a3 00 00 00 00 00 80 d6 17 00 00 00 00 00 80 0e 18 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 0d 63 00 00 00 00 00 d8 1d a3 00 00 00 00 00 d8 1d a3 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 70 03 00 00 00 00 00 00 70 03 40 00 00 00 00 00 70 03 40 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 90 03 00 00 00 00 00 00 90 03 40 00 00 00 00 00 90 03 40 00 00 00 00 00 b4 00 00 00 00 00 00 00 b4 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 c8 0d 63 00 00 00 00 00 c8 1d a3 00 00 00 00 00 c8 1d a3 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 70 03 00 00 00 00 00 00 70 03 40 00 00 00 00 00 70 03 40 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 f0 84 5a 00 00 00 00 00 f0 84 9a 00 00 00 00 00 f0 84 9a 00 00 00 00 00 7c 65 01 00 00 00 00 00 7c 65 01 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 c8 0d 63 00 00 00 00 00 c8 1d a3 00 00 00 00 00 c8 1d a3 00 00 00 00 00 38 02 00 00 00 00 00 00 38 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 65 84 14 99 d5 f9 f3 b7 7d 54 25 ef ce d3 2d 07 e4 2b cb 16 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 60 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 64 65 62 69 61 6e 22 2c}
condition:
      filesize < 24000KB and
      8 of them and $magic
}

rule gtfobins_binaries_vim {
   strings:
      $s1 = "/bin/sh -c \"exec %s -dl -f %s" fullword ascii
      $s2 = "command -nargs=* -keepscript CompilerSet setlocal <args>" fullword ascii
      $s3 = "powershell.exe" fullword ascii
      $s4 = "Executing normal command '%s'" fullword ascii
      $s5 = "Executing ex command '%s'" fullword ascii
      $s6 = "executing shell command: %s" fullword ascii
      $s7 = "E145: Shell commands and some functionality not allowed in rvim" fullword ascii
      $s8 = "%*[^\"]\"%f\"%*\\D%l: %m,\"%f\"%*\\D%l: %m,%-Gg%\\?make[%*\\d]: *** [%f:%l:%m,%-Gg%\\?make: *** [%f:%l:%m,%-G%f:%l: (Each undecl" ascii
      $s9 = "E1179: Failed to extract PWD from %s, check your shell's config related to OSC 7" fullword ascii
      $s10 = "E1100: Command not supported in Vim9 script (missing :var?): %s" fullword ascii
      $s11 = "pwsh.exe" fullword ascii
      $s12 = "E619: File \"%s\" is not a supported PostScript resource file" fullword ascii
      $s13 = "--- Autocommands ---" fullword ascii
      $s14 = "%s%4d LOADSCRIPT %s-%d from %s" fullword ascii
      $s15 = "%s%4d STORESCRIPT %s-%d in %s" fullword ascii
      $s16 = "%s%4d PUSHJOB \"no process\"" fullword ascii
      $s17 = "nologin" fullword ascii
      $s18 = "getscriptinfo" fullword ascii
      $s19 = "E618: File \"%s\" is not a PostScript resource file" fullword ascii
      $s20 = "Incomplete message (%d bytes) - wait 100 msec for more" fullword ascii
      $s21 = "gcc -c -I. -Iproto -DHAVE_CONFIG_H -Wdate-time -g -O2 -Werror=implicit-function-declaration -ffile-prefix-map=/build/reproducibl" ascii
      $s22 = "%s%4d EXECUTE %lld" fullword ascii
      $s23 = "gcc -c -I. -Iproto -DHAVE_CONFIG_H -Wdate-time -g -O2 -Werror=implicit-function-declaration -ffile-prefix-map=/build/reproducibl" ascii
      $s24 = "E1039: \"vim9script\" must be the first command in a script" fullword ascii
      $s25 = "Ex command error: '%s'" fullword ascii
      $s26 = "E476: Invalid command: %s, expected %s" fullword ascii
      $s27 = "& { Get-Content %s | & %s }" fullword ascii
      $s28 = "E943: Command table needs to be updated, run 'make cmdidxs'" fullword ascii
      $s29 = "E1198: Decryption failed: Header incomplete!" fullword ascii
      $s30 = "executing job failed" fullword ascii
      $s31 = "E1144: Command \"%s\" is not followed by white space: %s" fullword ascii
      $s32 = "scriptversion" fullword ascii
      $s33 = "E1292: Command-line window is already open" fullword ascii
      $s34 = "E174: Command already exists: add ! to replace it: %s" fullword ascii
      $s35 = "no process" fullword ascii
      $s36 = "closing channel log in the child process" fullword ascii
      $s37 = "Compressed %s: %ld of %ld nodes; %ld (%ld%%) remaining" fullword ascii
      $s38 = "fullcommand" fullword ascii
      $s39 = "gettabinfo" fullword ascii
      $s40 = "getcmdwintype" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 f0 ae 04 00 00 00 00 00 40 00 00 00 00 00 00 00 38 a4 39 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f0 8e 03 00 00 00 00 00 f0 8e 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 75 c4 29 00 00 00 00 00 75 c4 29 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 60 2d 00 00 00 00 00 00 60 2d 00 00 00 00 00 00 60 2d 00 00 00 00 00 ec 04 08 00 00 00 00 00 ec 04 08 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 67 35 00 00 00 00 00 50 77 35 00 00 00 00 00 50 77 35 00 00 00 00 00 a0 3b 04 00 00 00 00 00 08 03 05 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 b0 75 36 00 00 00 00 00 b0 85 36 00 00 00 00 00 b0 85 36 00 00 00 00 00 50 02 00 00 00 00 00 00 50 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 e0 9f 2f 00 00 00 00 00 e0 9f 2f 00 00 00 00 00 e0 9f 2f 00 00 00 00 00 d4 cc 00 00 00 00 00 00 d4 cc 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 67 35 00 00 00 00 00 50 77 35 00 00 00 00 00 50 77 35 00 00 00 00 00 b0 18 01 00 00 00 00 00 b0 18 01 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 ca f0 a3 bf e4 21 99 b8 c5 48 5d cd 6e 5d de d1 34 7f 45 1a 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 f6 00 00 00 02 00 00 00 07 00 00 00 20 04 10 00 50 0d 02 0e 30 08 09 01 85 06 0c 02 f6 00 00 00 fb 00 00 00 00 01 00 00 a6 dd a3 6b d0 65 ce 6d c4 89 05 90 28 1d 8c 1c 63 b0 dd 3c c4 b9 9c 40 66 55 61 10 0a 73 59 00 d8 74 59 00 39 f2 8b 1c 8a 75 59 00 30 15 11 1a f2 7c 4a 00}
condition:
      filesize < 11000KB and
      8 of them and $magic
}

rule gtfobins_binaries_csvtool {
   strings:
      $s1 = "        Use the shell command 'export -f funcname' to export" fullword ascii
      $s2 = "Unix.open_process_shell" fullword ascii
      $s3 = "Csv.save_out_readable: internal error: length r1 = %d, length r2 = %d" fullword ascii
      $s4 = "Unix.open_process_args_full" fullword ascii
      $s5 = "Mutex.try_lock" fullword ascii
      $s6 = "Unix.open_process_args_out" fullword ascii
      $s7 = "Unix.process_out_pid" fullword ascii
      $s8 = "Mutex.unlock" fullword ascii
      $s9 = "Unix.close_process_out" fullword ascii
      $s10 = "Unix.create_process_gen.close_after.(fun)" fullword ascii
      $s11 = "Unix.popen_mutex" fullword ascii
      $s12 = "Unix.close_process_in" fullword ascii
      $s13 = "Unix.open_process_args_in" fullword ascii
      $s14 = "Unix.create_process_gen.file_descr_not_standard" fullword ascii
      $s15 = "Unix.create_process_env" fullword ascii
      $s16 = "Mutex.create" fullword ascii
      $s17 = "Unix.create_process" fullword ascii
      $s18 = "Unix.create_process_gen" fullword ascii
      $s19 = "Unix.process_pid" fullword ascii
      $s20 = "Mutex.lock" fullword ascii
      $s21 = "Unix.close_process_full" fullword ascii
      $s22 = "Unix.process_full_pid" fullword ascii
      $s23 = "Unix.popen_processes" fullword ascii
      $s24 = "Unix.process_in_pid" fullword ascii
      $s25 = "Unix.open_process_args" fullword ascii
      $s26 = "Unix.close_process" fullword ascii
      $s27 = "Unix.create_process_gen.close_after" fullword ascii
      $s28 = "Unix.create_process_gen.(fun)" fullword ascii
      $s29 = "camlUnix.open_process_shell_1738" fullword ascii
      $s30 = "Stdlib__Sys.executable_name" fullword ascii
      $s31 = "caml_unix_getlogin" fullword ascii
      $s32 = "Unix.Unix_error(Unix.%s, %S, %S)" fullword ascii
      $s33 = "camlStdlib__Mutex.data_end" fullword ascii
      $s34 = "Stdlib__Domain.DLS.get_initial_keys.(fun)" fullword ascii
      $s35 = "camlStdlib__Mutex.data_begin" fullword ascii
      $s36 = "Unix.getsockopt_error" fullword ascii
      $s37 = "        a shell function for use as a command.  Within the" fullword ascii
      $s38 = "mutex_init" fullword ascii
      $s39 = "first domain already spawned" fullword ascii
      $s40 = "csvtool is a tool for performing manipulations on CSV files from shell scripts." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 8f 08 00 00 00 00 00 40 00 00 00 00 00 00 00 d0 f7 1c 00 00 00 00 00 00 00 00 00 40 00 38 00 0e 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d8 74 08 00 00 00 00 00 d8 74 08 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 80 08 00 00 00 00 00 00 80 08 00 00 00 00 00 00 80 08 00 00 00 00 00 09 1d 0b 00 00 00 00 00 09 1d 0b 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 13 00 00 00 00 00 00 a0 13 00 00 00 00 00 00 a0 13 00 00 00 00 00 58 2c 03 00 00 00 00 00 58 2c 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 d3 16 00 00 00 00 00 f0 d3 16 00 00 00 00 00 f0 d3 16 00 00 00 00 00 90 22 06 00 00 00 00 00 c0 f2 06 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 20 d6 16 00 00 00 00 00 20 d6 16 00 00 00 00 00 20 d6 16 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 f0 d3 16 00 00 00 00 00 f0 d3 16 00 00 00 00 00 f0 d3 16 00 00 00 00 00 00 00 00 00 00 00 00 00 18 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 24 06 14 00 00 00 00 00 24 06 14 00 00 00 00 00 24 06 14 00 00 00 00 00 3c 80 00 00 00 00 00 00 3c 80 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 d3 16 00 00 00 00 00 f0 d3 16 00 00 00 00 00 f0 d3 16 00 00 00 00 00 10 0c 00 00 00 00 00 00 10 0c 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 92 f9 74 5d 01 c6 aa d4 35 da e2 5a ca 93 21 0a 01 31 36 5f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 10 00 00 f5 00 00 00 00 02 00 00 0f 00 00 00 90 0c 01 20 04 f2 7f 00 90 80 a8 40 11 02 40 00 c0 31 20 30 20 c8 29 40}
condition:
      filesize < 6000KB and
      8 of them and $magic
}

rule gtfobins_binaries_sqlite3 {
   strings:
      $s1 = "Usage: .system COMMAND" fullword ascii
      $s2 = "Usage: .log FILENAME" fullword ascii
      $s3 = "Digest includes %d invalidly encoded text field%s." fullword ascii
      $s4 = "Usage %s sub-command ?switches...?" fullword ascii
      $s5 = "Error: unable to process SQL: %s" fullword ascii
      $s6 = "attach debugger to process %d and press any key to continue." fullword ascii
      $s7 = "Error: cannot mix regular SQL or dot-commands with \"%s\"" fullword ascii
      $s8 = "%s:%d: expected %d columns but found %d - extras ignored" fullword ascii
      $s9 = "%s:%d: expected %d columns but found %d - filling the rest with NULL" fullword ascii
      $s10 = "REPLACE INTO temp.sqlite_parameters(key,value)VALUES(%Q,%s);" fullword ascii
      $s11 = "/* WARNING: Script requires that SQLITE_DBCONFIG_DEFENSIVE be disabled */" fullword ascii
      $s12 = "Unknown option \"%s\" on \".dump\"" fullword ascii
      $s13 = "Where sub-commands are:" fullword ascii
      $s14 = "   -cmd COMMAND         run \"COMMAND\" before reading stdin" fullword ascii
      $s15 = ");CREATE TEMP TABLE [_shell$self](op,cmd,ans);" fullword ascii
      $s16 = "%s/* no extra indexes required for %s -> %s */" fullword ascii
      $s17 = "tempfilename" fullword ascii
      $s18 = "CREATE TABLE temp.t592690916721053953805701627921227776 AS SELECT * FROM %Q" fullword ascii
      $s19 = "-- Query %d --------------------------------" fullword ascii
      $s20 = "System command returns %d" fullword ascii
      $s21 = "ERROR: extra parameter: \"%s\".  Usage:" fullword ascii
      $s22 = "ROLLBACK; -- due to errors" fullword ascii
      $s23 = "ERROR: unknown option: \"%s\".  Usage:" fullword ascii
      $s24 = "  name TEXT PRIMARY KEY,  -- name of the file" fullword ascii
      $s25 = "  data BLOB               -- compressed content" fullword ascii
      $s26 = "ERROR: missing %s argument. Usage:" fullword ascii
      $s27 = "ERROR: extra argument: \"%s\".  Usage:" fullword ascii
      $s28 = "Error on line %d of --hexdb input" fullword ascii
      $s29 = "multiple command options" fullword ascii
      $s30 = "     -v, --verbose              Print each filename as it is processed" fullword ascii
      $s31 = "Usage: .imposter INDEX IMPOSTER" fullword ascii
      $s32 = "CREATE VIRTUAL TABLE temp.%s USING zipfile(%Q)" fullword ascii
      $s33 = "   -init FILENAME       read/process named file" fullword ascii
      $s34 = "RELEASE dump;" fullword ascii
      $s35 = "/****** ERROR: %s ******/" fullword ascii
      $s36 = "SELECT key, quote(value) FROM temp.sqlite_parameters;" fullword ascii
      $s37 = "Usage: .headers on|off" fullword ascii
      $s38 = "SAVEPOINT dump; PRAGMA writable_schema=ON" fullword ascii
      $s39 = "SELECT value FROM temp.sqlite_parameters WHERE key=?1" fullword ascii
      $s40 = "Cannot run experimental commands such as \"%s\" in safe mode" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 ad 00 00 00 00 00 00 40 00 00 00 00 00 00 00 88 29 05 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 38 7d 00 00 00 00 00 00 38 7d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 89 18 03 00 00 00 00 00 89 18 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 03 00 00 00 00 00 00 a0 03 00 00 00 00 00 00 a0 03 00 00 00 00 00 50 5c 01 00 00 00 00 00 50 5c 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 03 05 00 00 00 00 00 70 03 05 00 00 00 00 00 70 03 05 00 00 00 00 00 d0 24 00 00 00 00 00 00 68 27 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 28 16 05 00 00 00 00 00 28 16 05 00 00 00 00 00 28 16 05 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 e4 95 04 00 00 00 00 00 e4 95 04 00 00 00 00 00 e4 95 04 00 00 00 00 00 6c 0d 00 00 00 00 00 00 6c 0d 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 03 05 00 00 00 00 00 70 03 05 00 00 00 00 00 70 03 05 00 00 00 00 00 90 1c 00 00 00 00 00 00 90 1c 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 f6 05 d0 64 5b 21 08 84 ba 75 03 a8 7e 6c 7b c3 78 49 66 22 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 ed 00 00 00 01 00 00 00 06 00 00 00 02 05 a1 40 82 19 10 12 ed 00 00 00 f0 00 00 00 f5 00 00 00 6a 65 5d 14 d0 65 ce 6d 29 1d 8c 1c 66 55 61 10 68 20 4f 47 9e 52 e5 0c 20 cf 09 fd 39 f2 8b 1c 2b cb d7 99 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 1000KB and
      8 of them and $magic
}

rule gtfobins_binaries_joe {
   strings:
      $s1 = "Write failed when writing first command to shell" fullword ascii
      $s2 = "Attempt to turn off ^S/^Q processing" fullword ascii
      $s3 = "Prompt for command to execute" fullword ascii
      $s4 = ":def shell4 scratch_push,\"* Startup Log *\",rtn,scratch_push,\"* Shell 4 *\",rtn,vtbknd!,eof" fullword ascii
      $s5 = ":def shell1 scratch_push,\"* Startup Log *\",rtn,scratch_push,\"* Shell 1 *\",rtn,vtbknd!,eof" fullword ascii
      $s6 = ":def shell3 scratch_push,\"* Startup Log *\",rtn,scratch_push,\"* Shell 3 *\",rtn,vtbknd!,eof" fullword ascii
      $s7 = ":def shell2 scratch_push,\"* Startup Log *\",rtn,scratch_push,\"* Shell 2 *\",rtn,vtbknd!,eof" fullword ascii
      $s8 = "Enter grep command (for example, 'grep -n foo *.c'): " fullword ascii
      $s9 = "You are at the command shell.  Type 'exit' to return" fullword ascii
      $s10 = "Run a shell command" fullword ascii
      $s11 = "Couldn't execute shell '%s'" fullword ascii
      $s12 = "Execute macro" fullword ascii
      $s13 = "      \\b!\\bcommand                 Pipe in/out of a shell command                \\| " fullword ascii
      $s14 = ":def ispellword psh,nextword,markk,prevword,markb,filt,\"cat >ispell.tmp;ispell ispell.tmp </dev/tty >/dev/tty;tr -d <ispell.tmp" ascii
      $s15 = ":def aspellword psh,nextword,markk,prevword,markb,filt,\"SPLTMP=ispell.tmp;cat >$SPLTMP;aspell --lang=\",language,\".\",charset," ascii
      $s16 = ":def aspellfile filt,\"SPLTMP=ispell.tmp;cat >$SPLTMP;aspell --lang=\",language,\".\",charset,\" -x -c $SPLTMP </dev/tty >/dev/t" ascii
      $s17 = ":def ispellword psh,nextword,markk,prevword,markb,filt,\"cat >ispell.tmp;ispell ispell.tmp </dev/tty >/dev/tty;tr -d <ispell.tmp" ascii
      $s18 = ":def aspellfile filt,\"SPLTMP=ispell.tmp;cat >$SPLTMP;aspell --lang=\",language,\".\",charset,\" -x -c $SPLTMP </dev/tty >/dev/t" ascii
      $s19 = "%s %d: command name missing from :def" fullword ascii
      $s20 = "%s %d: Unknown command in macro" fullword ascii
      $s21 = "* Color set [%d]" fullword ascii
      $s22 = "Dump keyboard macros" fullword ascii
      $s23 = "* Startup Log *" fullword ascii
      $s24 = "execmd" fullword ascii
      $s25 = ". /etc/joe/shellsource /etc/joe//joe/shell.csh" fullword ascii
      $s26 = ":def compile mwind!,mfit!,querysave,query,scratch,\"* Build Log *\",rtn,bof,markb,eof,\" \",markk,blkdel,build" fullword ascii
      $s27 = "*.login" fullword ascii
      $s28 = "%s %d: No context selected for macro to key-sequence binding" fullword ascii
      $s29 = "SE|function|FUNCTION|package|PACKAGE|architecture|ARCHITECTURE|block|BLOCK|process|PROCESS|generate|GENERATE=end|END" fullword ascii
      $s30 = "Finished processing %s" fullword ascii
      $s31 = "*.bash_login" fullword ascii
      $s32 = "*** JOE was aborted due to swap file I/O error" fullword ascii
      $s33 = "*** File '%s'" fullword ascii
      $s34 = " -c $SPLTMP </dev/tty >/dev/tty;tr -d <$SPLTMP '\\\\012';/bin/rm $SPLTMP\",rtn,retype,nextword" fullword ascii
      $s35 = "[postscript]" fullword ascii
      $s36 = "\\|\\bEsc X\\b Command prompt\\|\\bEsc C\\b Save modified compile\\|\\b^G\\b  Find word under cursor  \\| " fullword ascii
      $s37 = "*** JOE was aborted by UNIX signal %d." fullword ascii
      $s38 = "** Line %r Col %c Offset %o(0x%O) **" fullword ascii
      $s39 = "** Line %r Col %c Offset %o(0x%O) %e %a(0x%A) Width %w **" fullword ascii
      $s40 = "\\i** Joe's Own Editor v%s ** (%s) ** Copyright %s 2015 **\\i" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 ea 00 00 00 00 00 00 40 00 00 00 00 00 00 00 30 44 0b 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 cd 00 00 00 00 00 00 20 cd 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 8d 23 06 00 00 00 00 00 8d 23 06 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 07 00 00 00 00 00 00 00 07 00 00 00 00 00 00 00 07 00 00 00 00 00 f4 45 02 00 00 00 00 00 f4 45 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 48 09 00 00 00 00 00 90 58 09 00 00 00 00 00 90 58 09 00 00 00 00 00 90 fa 01 00 00 00 00 00 c0 5b 04 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 50 4d 09 00 00 00 00 00 50 5d 09 00 00 00 00 00 50 5d 09 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 94 37 08 00 00 00 00 00 94 37 08 00 00 00 00 00 94 37 08 00 00 00 00 00 a4 23 00 00 00 00 00 00 a4 23 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 48 09 00 00 00 00 00 90 58 09 00 00 00 00 00 90 58 09 00 00 00 00 00 70 07 00 00 00 00 00 00 70 07 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 fa 62 e3 b6 64 c6 c9 85 2b 48 63 6e 35 83 fa c2 d0 98 c5 bd 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 89 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 89 00 00 00 8b 00 00 00 00 00 00 00 d0 65 ce 6d 29 1d 8c 1c 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 4a 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 2000KB and
      8 of them and $magic
}

rule gtfobins_binaries_loginctl {
   strings:
      $x1 = "Failed to dump process list: %s" fullword ascii
      $s2 = "%5$sSend control commands to or query the login manager.%6$s" fullword ascii
      $s3 = "org.freedesktop.login1" fullword ascii
      $s4 = "org.freedesktop.login1.Session" fullword ascii
      $s5 = "Failed to get properties of session %s, ignoring: %s" fullword ascii
      $s6 = "Failed to get properties of user %s, ignoring: %s" fullword ascii
      $s7 = "loginctl" fullword ascii
      $s8 = "  -H --host=[USER@]HOST    Operate on remote host" fullword ascii
      $s9 = "ask_password_agent_close" fullword ascii
      $s10 = "get_user_creds" fullword ascii
      $s11 = "%3$sSession Commands:%4$s" fullword ascii
      $s12 = "target_session" fullword ascii
      $s13 = "%3$sUser Commands:%4$s" fullword ascii
      $s14 = "%s%s - %s (%u)%s" fullword ascii
      $s15 = "Failed to look up user %s: %m" fullword ascii
      $s16 = "/org/freedesktop/login1/user/self" fullword ascii
      $s17 = "/org/freedesktop/login1" fullword ascii
      $s18 = "Failed to get path for %s '%s': %s" fullword ascii
      $s19 = "unit_show_processes" fullword ascii
      $s20 = "/org/freedesktop/login1/session/auto" fullword ascii
      $s21 = "Failed to get user: %s" fullword ascii
      $s22 = "bus_login_mgr" fullword ascii
      $s23 = "Failed to list users: %s" fullword ascii
      $s24 = "%3$sSeat Commands:%4$s" fullword ascii
      $s25 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"systemd\",\"version\":\"256.2-1\",\"architecture\":\"amd64\",\"debugInfoUrl\":\"h" ascii
      $s26 = "sd_device_get_subsystem" fullword ascii
      $s27 = "log_assert_failed_unreachable" fullword ascii
      $s28 = "log_assert_failed" fullword ascii
      $s29 = "list_users" fullword ascii
      $s30 = "list-users" fullword ascii
      $s31 = "bus_log_connect_error" fullword ascii
      $s32 = "ListUsers" fullword ascii
      $s33 = "no-ask-password" fullword ascii
      $s34 = "log_get_max_level" fullword ascii
      $s35 = "     --no-ask-password     Don't prompt for password" fullword ascii
      $s36 = "%1$s [OPTIONS...] COMMAND ..." fullword ascii
      $s37 = "     --json=MODE           Generate JSON output for list-sessions/users/seats" fullword ascii
      $s38 = "%s%s:%s%s%s%s" fullword ascii
      $s39 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/systemd.debug" fullword ascii
      $s40 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"systemd\",\"version\":\"256.2-1\",\"architecture\":\"amd64\",\"debugInfoUrl\":\"h" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 10 4d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 08 02 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 20 00 1f 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d0 33 00 00 00 00 00 00 d0 33 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 65 70 00 00 00 00 00 00 65 70 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 a8 28 00 00 00 00 00 00 a8 28 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 ef 00 00 00 00 00 00 10 ff 00 00 00 00 00 00 10 ff 00 00 00 00 00 00 30 11 00 00 00 00 00 00 68 11 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 20 fa 00 00 00 00 00 00 20 0a 01 00 00 00 00 00 20 0a 01 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 dc 00 00 00 00 00 00 00 dc 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 f4 da 00 00 00 00 00 00 f4 da 00 00 00 00 00 00 f4 da 00 00 00 00 00 00 1c 01 00 00 00 00 00 00 1c 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 ef 00 00 00 00 00 00 10 ff 00 00 00 00 00 00 10 ff 00 00 00 00 00 00 f0 10 00 00 00 00 00 00 f0 10 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 46 5e 65 58 e1 de 96 a9 0d 46 1e c2 62 5b 71 c4 bc 95 04 df 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 88 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 73 79 73 74 65 6d 64 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 35 36 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a 22 61 6d 64}
condition:
      filesize < 200KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_dmsetup {
   strings:
      $s1 = "Couldn't process command line." fullword ascii
      $s2 = "[--target <target_type>] [--exec <command>] [-o <options>] [--tree]" fullword ascii
      $s3 = "WARNING: This operation will destroy all semaphores %s%.0d%swith keys that have a prefix %u (0x%x)." fullword ascii
      $s4 = "The path %s used for creating device nodes that is set via DM_DEV_DIR environment variable differs from the path %s that is used" ascii
      $s5 = "target-version" fullword ascii
      $s6 = "Too many args to --exec." fullword ascii
      $s7 = "semid %d: sem_ctl failed for cookie 0x%x: %s" fullword ascii
      $s8 = "Command failed." fullword ascii
      $s9 = " by udev. All warnings about udev not working correctly while processing particular nodes will be suppressed. These nodes and sy" ascii
      $s10 = "Internal error: finding dmsetup info command struct." fullword ascii
      $s11 = "Userspace subsystem responsible for this device." fullword ascii
      $s12 = "dm_stats_get_group_descriptor" fullword ascii
      $s13 = "Negative read ahead value (%d) is not understood." fullword ascii
      $s14 = "Using --bounds requires driver version 4.32.0 or later." fullword ascii
      $s15 = "WARNING: Use of cookie and --force is not compatible." fullword ascii
      $s16 = "Number of targets: %d" fullword ascii
      $s17 = "Using --precise requires driver version 4.32.0 or later." fullword ascii
      $s18 = "--userdata is not yet supported with --filemap." fullword ascii
      $s19 = "dm_task_add_target" fullword ascii
      $s20 = "dm_get_next_target" fullword ascii
      $s21 = "noheadings" fullword ascii
      $s22 = "%s: %s: name %salready in correct form" fullword ascii
      $s23 = "dm_stats_get_read_sectors_per_sec" fullword ascii
      $s24 = "dm_stats_get_service_time" fullword ascii
      $s25 = "dm_task_get_versions" fullword ascii
      $s26 = "dm_stats_get_reads_per_sec" fullword ascii
      $s27 = "Table_file contents may be supplied on stdin." fullword ascii
      $s28 = "dm_stats_get_read_sectors" fullword ascii
      $s29 = "[<device>...] [--concise] [--target <target_type>] [--showkeys]" fullword ascii
      $s30 = "Unknown stats command." fullword ascii
      $s31 = "dm_task_get_read_ahead" fullword ascii
      $s32 = "Too many command line arguments." fullword ascii
      $s33 = "dm_report_column_headings" fullword ascii
      $s34 = "<device> may be device name or (if only one) -u <uuid> or -j <major> -m <minor>" fullword ascii
      $s35 = "dm_task_set_read_ahead" fullword ascii
      $s36 = "Read ahead value." fullword ascii
      $s37 = "dm_stats_get_reads" fullword ascii
      $s38 = "dm_stats_get_region_nr_histogram_bins" fullword ascii
      $s39 = "dm_get_library_version" fullword ascii
      $s40 = "dm_stats_get_reads_merged" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 8e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 a8 a4 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d0 7a 00 00 00 00 00 00 d0 7a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 39 60 01 00 00 00 00 00 39 60 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 6c 6a 00 00 00 00 00 00 6c 6a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 66 02 00 00 00 00 00 90 66 02 00 00 00 00 00 90 66 02 00 00 00 00 00 d0 3c 00 00 00 00 00 00 d8 5e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 60 86 02 00 00 00 00 00 60 86 02 00 00 00 00 00 60 86 02 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 00 39 02 00 00 00 00 00 00 39 02 00 00 00 00 00 00 39 02 00 00 00 00 00 a4 06 00 00 00 00 00 00 a4 06 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 66 02 00 00 00 00 00 90 66 02 00 00 00 00 00 90 66 02 00 00 00 00 00 70 29 00 00 00 00 00 00 70 29 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 bd ce 5a 27 34 05 0d 51 de b4 92 4d ce a6 8c a2 90 57 65 9d 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 ef 00 00 00 02 00 00 00 07 00 00 00 f0 11 80 00 90 21 1c 2e 08 0c 05 01 8a 04 80 40 ef 00 00 00 f0 00 00 00 f1 00 00 00 f2 00 00 00 f3 00 00 00 f5 00 00 00 00 00 00 00 f6 00 00 00 00 00 00 00 f8 00 00 00 f9 00 00 00 fb 00 00 00 fc 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_batcat {
   strings:
      $x1 = "\\b(?:Base\\.(?:abs|abs2|abspath|accumulate|accumulate!|acos|acosd|acosh|acot|acotd|acoth|acsc|acscd|acsch|addenv|adjoint|all|al" ascii
      $x2 = "\\b(?:abs|abs2|abspath|accumulate|accumulate!|acos|acosd|acosh|acot|acotd|acoth|acsc|acscd|acsch|addenv|adjoint|all|all!|allequa" ascii
      $x3 = "<unknown>.library/std/src/sys_common/process.rs       - ConnectionRefusedConnectionResetHostUnreachableNetworkUnreachableConnect" ascii
      $x4 = "Possible values: *auto*, never, always.Use italics in output (always, *never*)Specify when to use ANSI sequences for italic text" ascii
      $x5 = "\\b(?:AbstractArray|AbstractChannel|AbstractChar|AbstractDict|AbstractDisplay|AbstractFloat|AbstractIrrational|AbstractMatch|Abs" ascii
      $x6 = "StartByteMap{/usr/share/cargo/registry/regex-automata-0.4.7/src/util/wire.rs/usr/share/cargo/registry/regex-automata-0.4.7/src/u" ascii
      $x7 = "ASCIIageASCII_Hex_DigitAlphabeticalphabeticasciihexdigitbcBidi_ClassbidicBidi_ControlbidiclassbidicontrolbidimBidi_Mirroredbidim" ascii
      $x8 = "UNREACHABLE EVENT: internal error: entered unreachable codedid not find expected <stream-start>did not find expected <document s" ascii
      $x9 = "\\b(a|abbr|acronym|address|applet|area|article|aside|audio|b|base|basefont|bdi|bdo|big|blockquote|body|br|button|canvas|caption|" ascii
      $x10 = "}assertion failed: new_left_len <= CAPACITYinvalid value: , expected invalid length IoInvalidUtf8EncodingInvalidBoolEncodingInva" ascii
      $s11 = "--versionsrc/less.rsLine range contained more than one ':' character. Expected format: 'N' or 'N:M'Invalid character after -src/" ascii
      $s12 = "plainUnknown style '.orig.dpkg-dist.dpkg-new.dpkg-old.dpkg-tmp.ucf-dist.rpmnew.in/etc/nginx/**/*.conf/etc/nginx/sites-*/**/*ngin" ascii
      $s13 = "ERROR: License is of unknown type: Redistributions in binary form must reproduce the above copyright notice,Apache License Versi" ascii
      $s14 = " (MW)N/ASerror building NFA) are not supported or enabled/usr/share/cargo/registry/regex-automata-0.4.7/src/dfa/remapper.rs/usr/" ascii
      $s15 = "<unknown>.library/std/src/sys_common/process.rs       - ConnectionRefusedConnectionResetHostUnreachableNetworkUnreachableConnect" ascii
      $s16 = "{all-args}{after-help}Usage:ArgumentsOptionsOnly called with possible value/usr/share/cargo/registry/clap_builder-4.5.15/src/out" ascii
      $s17 = "/usr/share/cargo/registry/plist-1.7.0/src/date.rs/usr/share/cargo/registry/quick-xml-0.36.1/src/escape.rs/usr/share/cargo/regist" ascii
      $s18 = "\\b(active|any-link|blank|checked|current|default|defined|disabled|drop|empty|enabled|first|first-child|first-of-type|fullscreen" ascii
      $s19 = "while|for|catch|return|break|continue|switch|exit|foreach|if|after|append|array|auto_execok|auto_import|auto_load|auto_mkindex|a" ascii
      $s20 = "  '--line-range 30:+10' prints lines 30 to 40list-languagesDisplay a list of supported languages for syntax highlighting.unbuffe" ascii
      $s21 = "\\b(?i:Abs|Array|Add|Asc|Atn|CBool|CByte|CCur|CDate|CDbl|Chr|CInt|CLng|Conversions|Cos|CreateObject|CSng|CStr|Date|DateAdd|DateD" ascii
      $s22 = "  '--highlight-line 30:+10' highlights lines 30 to 40Specify the name to display for a file.Specify the name to display for a fi" ascii
      $s23 = "/usr/src/rustc-1.81.0/library/std/src/thread/local.rs/usr/share/cargo/registry/git2-0.19.0/src/panic.rs/usr/share/cargo/registry" ascii
      $s24 = "to pass '' as a value, use '-- subcommand '' exists; to use it, remove the '' before it/usr/share/cargo/registry/clap_builder-4." ascii
      $s25 = "Validation on the CLOEXEC pipe failed: wait() should either return Ok or panicthe CLOEXEC pipe failed: short read on the CLOEXEC" ascii
      $s26 = "  spawn_monitor|spawn_opt|split_binary|start_timer|statistics|suspend_process|" fullword ascii
      $s27 = "else|enum|export|extern|debug|default|delegate|delete|deprecated|do|body|break|case|cast|catch|class|const|continue|abstract|ali" ascii
      $s28 = "# run `bat --help` to get a list of all possible configuration options." fullword ascii
      $s29 = "ang-formatF#buildSSH Config**/.ssh/configBourne Again Shell (bash)**/bat/config/etc/profileos-releaseJavaScript (Babel)*.pacfish" ascii
      $s30 = "SlimAVX2CLICOLORNO_COLORexpectedancestorsyntaxesWriting BusyBox .ucf-new.ucf-old.rpmorig.rpmsave*.device*.netdev*.nspawn*.socket" ascii
      $s31 = "| ^\\# \\s* -\\*- [^*]* mode: \\s* shell-script [^*]* -\\*-" fullword ascii
      $s32 = "OkErrpermission deniedconnection refusednetwork unreachableconnection abortednot connectedaddress in useaddress not availablenet" ascii
      $s33 = "/usr/share/cargo/registry/syntect-5.1.0/src/parsing/yaml_load.rs\\{\\{([A-Za-z0-9_]+)\\}\\}file_extensionshidden_file_extensions" ascii
      $s34 = "abs|ceil|floor|log|max|min|pow|signum|chomp|format|formatlist|indent|join|lower|regex|regexall|replace|split|strrev|substr|title" ascii
      $s35 = "  'bat --ignored-suffix \".dev\" my_file.json.dev' will use JSON syntax, and ignore '.dev'Set the color theme for syntax highlig" ascii
      $s36 = "((*emitter).write_handler).is_some()mid > len/usr/src/rustc-1.81.0/library/core/src/slice/sort/stable/quicksort.rsIO error for o" ascii
      $s37 = "  # https://mimesniff.spec.whatwg.org/#javascript-mime-type" fullword ascii
      $s38 = "or sizelibrary/std/src/rt.rsfatal runtime error: drop of the panic payload panicked" fullword ascii
      $s39 = "|NamedTuple|Nothing|Number|OrdinalRange|OutOfMemoryError|OverflowError|Pair|PartialQuickSort|PermutedDimsArray|Pipe|ProcessFaile" ascii
      $s40 = " pipelibrary/std/src/sys/pal/unix/process/process_unix.rsnul byte found in provided datapidfd_spawnp succeeded but the child's P" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 50 cf 04 00 00 00 00 00 40 00 00 00 00 00 00 00 40 9e 50 00 00 00 00 00 00 00 00 00 40 00 38 00 0e 00 40 00 21 00 20 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 d0 03 00 00 00 00 00 20 d0 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 e0 03 00 00 00 00 00 00 e0 03 00 00 00 00 00 00 e0 03 00 00 00 00 00 41 8b 29 00 00 00 00 00 41 8b 29 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 2d 00 00 00 00 00 00 70 2d 00 00 00 00 00 00 70 2d 00 00 00 00 00 54 f3 1f 00 00 00 00 00 54 f3 1f 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 28 73 4d 00 00 00 00 00 28 73 4d 00 00 00 00 00 28 73 4d 00 00 00 00 00 98 29 03 00 00 00 00 00 00 2e 03 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 20 49 50 00 00 00 00 00 20 49 50 00 00 00 00 00 20 49 50 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 28 73 4d 00 00 00 00 00 28 73 4d 00 00 00 00 00 28 73 4d 00 00 00 00 00 20 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c0 c1 48 00 00 00 00 00 c0 c1 48 00 00 00 00 00 c0 c1 48 00 00 00 00 00 dc 6f 00 00 00 00 00 00 dc 6f 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 28 73 4d 00 00 00 00 00 28 73 4d 00 00 00 00 00 28 73 4d 00 00 00 00 00 d8 dc 02 00 00 00 00 00 d8 dc 02 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 42 f2 3b ca 10 7d 06 34 3c 45 29 d2 53 7b c3 39 99 58 5e f0 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 0e 00 00 00 7e 00 00 00 01 00 00 00 06 00 00 00 84 00 c1 28 01 40 19 38 7e 00 00 00 7f 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 15000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_less {
   strings:
      $s1 = "d             Execute the shell command, expanded like a prompt." fullword ascii
      $s2 = "Input preprocessor failed (status %d)" fullword ascii
      $s3 = "Show error message if preprocessor fails" fullword ascii
      $s4 = "Don't show error message if preprocessor fails" fullword ascii
      $s5 = "Home page: https://greenwoodsoftware.com/less" fullword ascii
      $s6 = "Input preprocessor exited with status %x" fullword ascii
      $s7 = "        or from within less by using the - or -- command." fullword ascii
      $s8 = "Input preprocessor terminated: %s" fullword ascii
      $s9 = "invalid operator '%s' in #version line" fullword ascii
      $s10 = "      Commands marked with * may be preceded by a number, _" fullword ascii
      $s11 = "  f  ^F  ^V  SPACE  *  Forward  one window (or _" fullword ascii
      $s12 = "                  Display a message if preprocessor exits with an error status." fullword ascii
      $s13 = "        Each \"find close bracket\" command goes forward to the close bracket " fullword ascii
      $s14 = "** Obtain release builds from the web page below." fullword ascii
      $s15 = "Don't exit F command when input closes" fullword ascii
      $s16 = "%s is a terminal (use -f to open it)" fullword ascii
      $s17 = "** This is an EXPERIMENTAL build of the 'less' software," fullword ascii
      $s18 = "Warning: \"%s\" exists; Overwrite, Append, Don't log, or Quit? " fullword ascii
      $s19 = " is not a regular file (use -f to see it)" fullword ascii
      $s20 = "Exit F command when input closes" fullword ascii
      $s21 = "#commandI9" fullword ascii
      $s22 = "** and may not function correctly." fullword ascii
      $s23 = "Use backslash escaping in command line parameters" fullword ascii
      $s24 = "Don't use backslash escaping in command line parameters" fullword ascii
      $s25 = "LESSKEYIN_SYSTEM" fullword ascii
      $s26 = "Read %d lines looking for modelines" fullword ascii
      $s27 = "  -w  ........  --hilite-unread" fullword ascii
      $s28 = "pshell" fullword ascii
      $s29 = "                  Exit F command on a pipe when writer closes pipe." fullword ascii
      $s30 = "                  Process backspaces for bold/underline." fullword ascii
      $s31 = "LESSKEYIN" fullword ascii
      $s32 = "  -t [_" fullword ascii
      $s33 = "Get size of each file" fullword ascii
      $s34 = "                  Screen position of target lines." fullword ascii
      $s35 = "  -h [_" fullword ascii
      $s36 = "Don't get size of each file" fullword ascii
      $s37 = "Search does not include header lines" fullword ascii
      $s38 = "Number header lines" fullword ascii
      $s39 = "no-number-headers" fullword ascii
      $s40 = "Search includes header lines" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 69 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c0 68 03 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b0 51 00 00 00 00 00 00 b0 51 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 81 d6 01 00 00 00 00 00 81 d6 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 94 da 00 00 00 00 00 00 94 da 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 20 1b 03 00 00 00 00 00 20 2b 03 00 00 00 00 00 20 2b 03 00 00 00 00 00 60 4c 00 00 00 00 00 00 10 a3 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 30 1b 03 00 00 00 00 00 30 2b 03 00 00 00 00 00 30 2b 03 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 f8 bb 02 00 00 00 00 00 f8 bb 02 00 00 00 00 00 f8 bb 02 00 00 00 00 00 9c 0e 00 00 00 00 00 00 9c 0e 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 20 1b 03 00 00 00 00 00 20 2b 03 00 00 00 00 00 20 2b 03 00 00 00 00 00 e0 04 00 00 00 00 00 00 e0 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 7d e6 86 90 c2 40 d2 ae 44 9c d2 3b 32 e5 b4 5f 82 52 cb a2 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 57 00 00 00 01 00 00 00 06 00 00 00 a0 00 a9 01 80 81 00 00 57 00 00 00 58 00 00 00 5a 00 00 00 d1 65 ce 6d 66 55 61 10 d9 74 59 00 04 ca 2b 13 ef 21 63 0f 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f4 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 700KB and
      8 of them and $magic
}

rule gtfobins_binaries_perl {
   strings:
      $x1 = "l&cwlocrpcmadlmaghbahexahomarmiavstbatkbhksbuhdcakmcanschamchrscpmncprtcwucyrldsrtgonggrekgujrguruhluwhmngzlkawikitskndalaoolatn" ascii
      $x2 = "DEBPKG:debian/fakeroot - Postpone LD_LIBRARY_PATH evaluation to the binary targets." fullword ascii
      $s3 = "DEBPKG:debian/errno_ver - https://bugs.debian.org/343351 Remove Errno version check due to upgrade problems with long-running pr" ascii
      $s4 = "DEBPKG:fixes/math_complex_doc_great_circle - https://bugs.debian.org/697567 [rt.cpan.org #114104] Math::Trig: clarify definition" ascii
      $s5 = "DEBPKG:fixes/math_complex_doc_great_circle - https://bugs.debian.org/697567 [rt.cpan.org #114104] Math::Trig: clarify definition" ascii
      $s6 = "%-pExecution of %s aborted due to compilation errors." fullword ascii
      $s7 = "DEBPKG:fixes/unbreak-locale-initialization - [GH #21366] https://bugs.debian.org/1060679 Revert \"locale.c: Do uselocale() earli" ascii
      $s8 = "DEBPKG:fixes/io_socket_ip_ipv6 - Disable getaddrinfo(3) AI_ADDRCONFIG for localhost and IPv4 numeric addresses" fullword ascii
      $s9 = "Using /u for '%.*s' instead of /%s in regex; marked by <-- HERE in m/%d%lu%4p <-- HERE %d%lu%4p/" fullword ascii
      $s10 = "DEBPKG:debian/usrmerge-realpath - https://bugs.debian.org/914128 Configure / libpth.U: use realpath --no-symlinks on Debian" fullword ascii
      $s11 = "DEBPKG:debian/configure-regen - https://bugs.debian.org/762638 Regenerate Configure et al. after probe unit changes" fullword ascii
      $s12 = "DEBPKG:debian/usrmerge-lib64 - https://bugs.debian.org/914128 Configure / libpth.U: Do not adjust glibpth when /usr/lib64 is pre" ascii
      $s13 = "DEBPKG:debian/makemaker-manext - https://bugs.debian.org/247370 Make EU::MakeMaker honour MANnEXT settings in generated manpage " ascii
      $s14 = "DEBPKG:debian/usrmerge-lib64 - https://bugs.debian.org/914128 Configure / libpth.U: Do not adjust glibpth when /usr/lib64 is pre" ascii
      $s15 = "Unexpected binary operator '%c' with no preceding operand in regex; marked by <-- HERE in m/%d%lu%4p <-- HERE %d%lu%4p/" fullword ascii
      $s16 = "DEBPKG:debian/squelch-locale-warnings - https://bugs.debian.org/508764 Squelch locale warnings in Debian package maintainer scri" ascii
      $s17 = "DEBPKG:debian/find_html2text - https://bugs.debian.org/640479 Configure CPAN::Distribution with correct name of html2text" fullword ascii
      $s18 = "DEBPKG:debian/deprecate-with-apt - https://bugs.debian.org/747628 Point users to Debian packages of deprecated core modules" fullword ascii
      $s19 = " ???? - dump.c does not know how to handle this MG_LEN" fullword ascii
      $s20 = "DEBPKG:debian/disable-stack-check - https://bugs.debian.org/902779 [GH #16607] Disable debugperl stack extension checks for bina" ascii
      $s21 = "DEBPKG:fixes/math_complex_doc_angle_units - https://bugs.debian.org/731505 [rt.cpan.org #114106] Math::Trig: document angle unit" ascii
      $s22 = "DEBPKG:fixes/document_makemaker_ccflags - https://bugs.debian.org/628522 [rt.cpan.org #68613] Document that CCFLAGS should inclu" ascii
      $s23 = "DEBPKG:debian/errno_ver - https://bugs.debian.org/343351 Remove Errno version check due to upgrade problems with long-running pr" ascii
      $s24 = "  -u                    dump core after parsing program" fullword ascii
      $s25 = "DEBPKG:debian/prune_libs - https://bugs.debian.org/128355 Prune the list of libraries wanted to what we actually need." fullword ascii
      $s26 = "DEBPKG:fixes/x32-io-msg-skip - https://bugs.debian.org/922609 Skip io/msg.t on x32 due to broken System V message queues" fullword ascii
      $s27 = "DEBPKG:fixes/math_complex_doc_angle_units - https://bugs.debian.org/731505 [rt.cpan.org #114106] Math::Trig: document angle unit" ascii
      $s28 = "DEBPKG:debian/disable-stack-check - https://bugs.debian.org/902779 [GH #16607] Disable debugperl stack extension checks for bina" ascii
      $s29 = "DEBPKG:debian/makemaker-pasthru - https://bugs.debian.org/758471 Pass LD settings through to subdirectories" fullword ascii
      $s30 = "Attempt to free nonexistent shared string '%s'%s, Perl interpreter: 0x%p" fullword ascii
      $s31 = "Useless (%sc) - %suse /gc modifier in regex; marked by <-- HERE in m/%d%lu%4p <-- HERE %d%lu%4p/" fullword ascii
      $s32 = "Useless (%s%c) - %suse /%c modifier in regex; marked by <-- HERE in m/%d%lu%4p <-- HERE %d%lu%4p/" fullword ascii
      $s33 = "DEBPKG:debian/installman-utf8 - https://bugs.debian.org/840211 Generate man pages with UTF-8 characters" fullword ascii
      $s34 = "DEBPKG:debian/eu-mm-perl-base - https://bugs.debian.org/962138 Suppress an ExtUtils::MakeMaker warning about our non-default @IN" ascii
      $s35 = "DEBPKG:debian/perl5db-x-terminal-emulator.patch - https://bugs.debian.org/668490 Invoke x-terminal-emulator rather than xterm in" ascii
      $s36 = "zaonhehgoalbethfivehethkaphqophreshyodhqaphtethkhitansmallscriptcarriagereturncomplexcontextmandatorybreakpostfixnumericetterlik" ascii
      $s37 = "DEBPKG:debian/makemaker-manext - https://bugs.debian.org/247370 Make EU::MakeMaker honour MANnEXT settings in generated manpage " ascii
      $s38 = "DEBPKG:fixes/bignum-recursion - https://bugs.debian.org/1012704 [rt.cpan.org #146411] Fix CPAN RT #146411" fullword ascii
      $s39 = "Bad infix plugin result (%zd) - did not consume entire identifier <%s>" fullword ascii
      $s40 = "DEBPKG:debian/enc2xs_inc - https://bugs.debian.org/290336 Tweak enc2xs to follow symlinks and ignore missing @INC directories." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 50 45 04 00 00 00 00 00 40 00 00 00 00 00 00 00 68 44 3b 00 00 00 00 00 00 00 00 00 40 00 38 00 0e 00 40 00 20 00 1f 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 70 24 04 00 00 00 00 00 70 24 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 04 00 00 00 00 00 00 30 04 00 00 00 00 00 00 30 04 00 00 00 00 00 85 40 1a 00 00 00 00 00 85 40 1a 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 1e 00 00 00 00 00 00 80 1e 00 00 00 00 00 00 80 1e 00 00 00 00 00 a0 9f 1b 00 00 00 00 00 a0 9f 1b 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 48 2c 3a 00 00 00 00 00 48 2c 3a 00 00 00 00 00 48 2c 3a 00 00 00 00 00 64 16 01 00 00 00 00 00 28 7a 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 98 1d 3b 00 00 00 00 00 98 1d 3b 00 00 00 00 00 98 1d 3b 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 48 2c 3a 00 00 00 00 00 48 2c 3a 00 00 00 00 00 48 2c 3a 00 00 00 00 00 00 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 48 8e 37 00 00 00 00 00 48 8e 37 00 00 00 00 00 48 8e 37 00 00 00 00 00 6c 48 00 00 00 00 00 00 6c 48 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 48 2c 3a 00 00 00 00 00 48 2c 3a 00 00 00 00 00 48 2c 3a 00 00 00 00 00 b8 f3 00 00 00 00 00 00 b8 f3 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 b9 f2 87 85 a7 23 22 46 e2 ba 05 cf de f1 ea 4f 2c 46 55 02 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 07 04 00 00 05 01 00 00 80 00 00 00 0d 00 00 00 02 00 32 92 05 90 c0 80 d3 03 32 46 22 99 a0 47 c2 00 84 22 34 25 88 22}
condition:
      filesize < 11000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_ksh {
   strings:
      $x1 = " are removed and placed in the variable assignment list for the command. Ordinarily, variable assignments must precede command a" ascii
      $x2 = "][--catalog?libshell][+NAME?eval - create a shell command and process it][+DESCRIPTION?" fullword ascii
      $x3 = " executes commands, the exit status will be that of the last command executed. Otherwise, it will be one of the following:]{[+0?" ascii
      $x4 = "][--catalog?libshell][+NAME?exec - execute command, open/close and duplicate file descriptors][+DESCRIPTION?" fullword ascii
      $x5 = "][--catalog?libshell][+NAME?command - execute a simple command disabling special properties][+DESCRIPTION?Without " fullword ascii
      $x6 = " - process command history list][+DESCRIPTION?" fullword ascii
      $x7 = " - execute commands in the current environment][+DESCRIPTION?" fullword ascii
      $x8 = " lists, edits, or re-executes, commands  previously entered into the current shell environment.][+?The command history list refe" ascii
      $x9 = "][--catalog?libshell][+NAME?times - display CPU usage by the shell and child processes][+DESCRIPTION?" fullword ascii
      $x10 = ", are processed as operands. It is essential to quote expression arguments to suppress empty removal, field splitting, pathname " ascii
      $x11 = "mode is enabled by default for interactive shells.][n?The shell reads commands and checks for syntax errors, but does not execut" ascii
      $x12 = " - Shell, the standard command language interpreter][+DESCRIPTION?" fullword ascii
      $s13 = "][--catalog?libshell][+NAME?redirect - open/close and duplicate file descriptors][+DESCRIPTION?This command only accepts input/o" ascii
      $s14 = "][--catalog?libshell][+NAME?redirect - open/close and duplicate file descriptors][+DESCRIPTION?This command only accepts input/o" ascii
      $s15 = "][--catalog?libshell][+NAME?whence, type - locate a command and describe its type][+DESCRIPTION?Without " fullword ascii
      $s16 = " can be used to add, delete, or display built-in commands in the current shell environment. A built-in command executes in the c" ascii
      $s17 = " is enabled.][r?restricted. Enables restricted shell. This option cannot be unset once enabled.][t?Obsolete. The shell reads one" ascii
      $s18 = "][-author?David Korn <dgk@research.att.com>][-author?Contributors to https://github.com/ksh93/ksh][-copyright?(c) 1982-2014 AT&T" ascii
      $s19 = ", and again when the shell executes the constructed command.][+?It is not an error if " fullword ascii
      $s20 = " is searched on PATH as an external command and the current shell process will be replaced by " fullword ascii
      $s21 = ", being a special built-in, will exit the current shell environment or abort execution of the interactive command line upon erro" ascii
      $s22 = ", except that it accepts no operands and refuses to suspend a login shell.][+EXIT STATUS?]{[+0?The shell was successfully suspen" ascii
      $s23 = " operand to standard output. All other options are ignored.][r?Reverse the order of the commands.][s?Re-execute the command with" ascii
      $s24 = " will be read and executed by the shell as if it were processed by " fullword ascii
      $s25 = "][--catalog?libshell][+NAME?wait - wait for process or job completion][+DESCRIPTION?" fullword ascii
      $s26 = " operand and the index of the next argument to be processed in the shell variable " fullword ascii
      $s27 = "][--catalog?libcmd][+NAME?getconf - get configuration values][+DESCRIPTION?" fullword ascii
      $s28 = "?Verbose. The shell displays its input onto standard error as it reads it.][x?Execution trace. The shell will display each comma" ascii
      $s29 = " signal to the main shell process, suspending the script or child shell session until it receives " fullword ascii
      $s30 = "][--catalog?libshell][+NAME?sleep - suspend execution for an interval][+DESCRIPTION?" fullword ascii
      $s31 = " string consists of alphanumeric characters, the special characters +, -, ?, :, and <space>, or character groups enclosed in [.." ascii
      $s32 = "][--catalog?libshell][+NAME?continue - continue execution at top of the loop][+DESCRIPTION?" fullword ascii
      $s33 = "][--catalog?libshell][+NAME?umask - get or set the file creation mask][+DESCRIPTION?" fullword ascii
      $s34 = "][--catalog?libcmd][+NAME?mktemp - make temporary file or directory][+DESCRIPTION?" fullword ascii
      $s35 = "[+EXIT STATUS?If a command is re-executed, the exit status is that of the command that gets re-executed. Otherwise, it is one of" ascii
      $s36 = "The script or command line to be executed consists entirely of zero or more blank lines or comments.][+1-125?A noninteractive sh" ascii
      $s37 = ".][s?Read and execute a script from standard input instead of a file. The command name (" fullword ascii
      $s38 = " lists, edits, or re-executes, commands  previously entered into the current shell environment.][+?The command history list refe" ascii
      $s39 = " operands is a process ID or process group ID not known by the current shell environment, " fullword ascii
      $s40 = "][--catalog?libcmd][+NAME?dirname - return directory portion of file name][+DESCRIPTION?" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 2d 01 00 00 00 00 00 40 00 00 00 00 00 00 00 00 f7 16 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c8 15 01 00 00 00 00 00 c8 15 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 01 00 00 00 00 00 00 20 01 00 00 00 00 00 00 20 01 00 00 00 00 00 79 f8 0e 00 00 00 00 00 79 f8 0e 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 10 00 00 00 00 00 00 20 10 00 00 00 00 00 00 20 10 00 00 00 00 00 50 90 05 00 00 00 00 00 50 90 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 bb 15 00 00 00 00 00 50 cb 15 00 00 00 00 00 50 cb 15 00 00 00 00 00 08 3a 01 00 00 00 00 00 58 9c 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 40 a6 16 00 00 00 00 00 40 b6 16 00 00 00 00 00 40 b6 16 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 b0 6e 14 00 00 00 00 00 b0 6e 14 00 00 00 00 00 b0 6e 14 00 00 00 00 00 8c 24 00 00 00 00 00 00 8c 24 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 bb 15 00 00 00 00 00 50 cb 15 00 00 00 00 00 50 cb 15 00 00 00 00 00 b0 f4 00 00 00 00 00 00 b0 f4 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 3f c4 5a c0 0d 1b 5b 31 66 74 c4 a8 13 82 95 b9 64 f8 5b d7 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 0d 01 00 00 04 00 00 00 08 00 00 00 02 20 03 00 10 04 04 06 08 00 41 42 90 80 78 20 00 00 02 00 81 40 40 80 30 08 01 64 22 88 8a f4 0d 01 00 00 0e 01 00 00 0f 01 00 00 12 01 00 00 00 00 00 00 00 00 00 00 16 01 00 00 17 01 00 00 00 00 00 00 19 01 00 00 00 00 00 00 1a 01 00 00}
condition:
      filesize < 4000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_w3m {
   strings:
      $s1 = "    -dump_head       dump response of HEAD request into stdout" fullword ascii
      $s2 = "    -dump_both       dump HEAD and source into stdout" fullword ascii
      $s3 = "    -dump_extra      dump HEAD, source, and extra information into stdout" fullword ascii
      $s4 = "PEM encoded private key file of client" fullword ascii
      $s5 = "Download process retains. Do you want to exit w3m? (y/n)" fullword ascii
      $s6 = "Password for anonymous FTP (your mail address)" fullword ascii
      $s7 = "[-download_only] [-target TARGET] [-charset CHARSET] [-enctype ENCTYPE] [-body BODY] [-boundary BOUNDARY] [-length LEN] URL" fullword ascii
      $s8 = "Sending FTP password to remote server." fullword ascii
      $s9 = "<!-- table stack underflow: %s -->" fullword ascii
      $s10 = "-dump_head" fullword ascii
      $s11 = "request.log" fullword ascii
      $s12 = "Proxy Password: " fullword ascii
      $s13 = "Execution failed" fullword ascii
      $s14 = "Display decoded URL" fullword ascii
      $s15 = "Sending FTP username (%s) to remote server." fullword ascii
      $s16 = "(read shell[pipe])!" fullword ascii
      $s17 = "<html><head><title>Option Setting Panel</title></head><body><h1 align=center>Option Setting Panel<br>(w3m version %s)</b></h1><f" ascii
      $s18 = "defkey: invalid command '%s'" fullword ascii
      $s19 = "Enable cookie processing" fullword ascii
      $s20 = "Password for %s: " fullword ascii
      $s21 = "line %d: invalid command '%s'" fullword ascii
      $s22 = "(exec shell)!" fullword ascii
      $s23 = "    -dump            dump formatted page into stdout" fullword ascii
      $s24 = "    -dump_source     dump page source into stdout" fullword ascii
      $s25 = "<!-- %s -->" fullword ascii
      $s26 = "----- Completion list -----" fullword ascii
      $s27 = "URL of FTP proxy host" fullword ascii
      $s28 = " target=\"%s\"" fullword ascii
      $s29 = "Generate domain part of password for FTP" fullword ascii
      $s30 = "ftppass_hostnamegen" fullword ascii
      $s31 = "SSL error: %s, a workaround might be: w3m -insecure" fullword ascii
      $s32 = "lang=en,m17n,image,color,ansi-color,mouse,gpm,menu,cookie,ssl,ssl-verify,external-uri-loader,w3mmailer,nntp,gopher,ipv6,alarm,ma" ascii
      $s33 = "lang=en,m17n,image,color,ansi-color,mouse,gpm,menu,cookie,ssl,ssl-verify,external-uri-loader,w3mmailer,nntp,gopher,ipv6,alarm,ma" ascii
      $s34 = "Proxy Username for %s: " fullword ascii
      $s35 = "nametemplate" fullword ascii
      $s36 = "execl(\"%s\", \"%s\", NULL): %s" fullword ascii
      $s37 = "PIPE_SHELL" fullword ascii
      $s38 = "cmigemo -q -d /usr/share/cmigemo/utf-8/migemo-dict" fullword ascii
      $s39 = "URL of dictionary lookup command" fullword ascii
      $s40 = "<html><head><title>Option Setting Panel</title></head><body><h1 align=center>Option Setting Panel<br>(w3m version %s)</b></h1><f" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 c0 80 03 00 00 00 00 00 40 00 00 00 00 00 00 00 68 fb 18 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e8 45 03 00 00 00 00 00 e8 45 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 a1 b3 07 00 00 00 00 00 a1 b3 07 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 10 0b 00 00 00 00 00 00 10 0b 00 00 00 00 00 00 10 0b 00 00 00 00 00 08 0b 02 00 00 00 00 00 08 0b 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 2a 0d 00 00 00 00 00 50 2a 0d 00 00 00 00 00 50 2a 0d 00 00 00 00 00 d0 cf 0b 00 00 00 00 00 48 2c 0c 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 46 0d 00 00 00 00 00 d8 46 0d 00 00 00 00 00 d8 46 0d 00 00 00 00 00 50 02 00 00 00 00 00 00 50 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 80 05 0c 00 00 00 00 00 80 05 0c 00 00 00 00 00 80 05 0c 00 00 00 00 00 34 26 00 00 00 00 00 00 34 26 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 2a 0d 00 00 00 00 00 50 2a 0d 00 00 00 00 00 50 2a 0d 00 00 00 00 00 b0 25 00 00 00 00 00 00 b0 25 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 34 b4 5c 7d 1a d3 0d e3 fb 63 73 b8 30 36 06 82 cf 96 be 96 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 d3 00 00 00 02 00 00 00 07 00 00 00 c0 40 40 40 b3 11 30 0e 03 0c 01 00 90 0d 02 00 d3 00 00 00 da 00 00 00 00 00 00 00 28 1d 8c 1c d0 65 ce 6d 66 20 f6 24 ba e3 92 7c 6a 65 5d 14 06 9a ac cd e5 b8 fb 2d a4 fa 9d b3 16 27 83 7c 66 55 61 10 20 cf 09 fd 26 16 dd 19 38 f2 8b 1c}
condition:
      filesize < 5000KB and
      8 of them and $magic
}

rule gtfobins_binaries_php {
   strings:
      $x1 = "Error %d: Only a super user may attempt to increase the process priority" fullword ascii
      $x2 = "The script tried to %s on an incomplete object. Please ensure that the class definition \"%s\" of the object you are trying to o" ascii
      $s3 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHkAAABACAMAAAAJUSgeAAADAFBMVEVHcExweqyBiLNHS42mqtBgY5dbXpVjd7tMTotISotMTo+VmrutsN" ascii
      $s4 = "Only a super user may attempt to increase the priority of a process" fullword ascii
      $s5 = "Permission denied: unable to execute shell to run mail delivery binary '%s'" fullword ascii
      $s6 = "Narrowing occurred during type inference of %s. Please file a bug report on https://github.com/php/php-src/issues" fullword ascii
      $s7 = "mail() on [%s:%d]: To: %s -- Headers: %s -- Subject: %s" fullword ascii
      $s8 = "Error %d: A process was located, but neither its effective nor real user ID matched the effective user ID of the caller" fullword ascii
      $s9 = "Unable to copy file descriptor %d (for pipe) into file descriptor %d: %s" fullword ascii
      $s10 = "getExecutingLine" fullword ascii
      $s11 = "getExecutingFile" fullword ascii
      $s12 = "getExecutingGenerator" fullword ascii
      $s13 = "fcntl(%d, F_SETFD, FD_CLOEXEC) failed: %s (%d)" fullword ascii
      $s14 = "Error %d: No process was located using the given parameters" fullword ascii
      $s15 = "zend_get_executed_scope" fullword ascii
      $s16 = "Allocation of JIT memory failed, PCRE JIT will be disabled. This is likely caused by security restrictions. Either grant PHP per" ascii
      $s17 = "Exec failed: %s" fullword ascii
      $s18 = "  -a               Run as interactive shell (requires readline extension)" fullword ascii
      $s19 = "must be less than the number of the arguments passed to the currently executed function" fullword ascii
      $s20 = "hyKsPBTiXNYyULtwIW7Cx1vlwuJyDLR9L0mQiVPb27fhA54yBbGttMpc1OWwF1cmKaH2FSF7vAjGezOZZJZ9j0dIZlMhnuRiToMO0c+N4X7oksasgEt9XS2KZCHzoem2" ascii
      $s21 = "  -B <begin_code>  Run PHP <begin_code> before processing input lines" fullword ascii
      $s22 = "zend_get_executed_filename_ex" fullword ascii
      $s23 = "Failed to bind to '%s:%d', system said: %s" fullword ascii
      $s24 = "php_network_getaddresses: getaddrinfo for %s failed: %s" fullword ascii
      $s25 = "Fatal error: Maximum execution time of %ld+%ld seconds exceeded (terminated) in %s on line %d" fullword ascii
      $s26 = "RecursiveTreeIterator::BYPASS_KEY" fullword ascii
      $s27 = "php_network_getaddresses: getaddrinfo for %s failed (null result pointer)" fullword ascii
      $s28 = "application/vnd.openxmlformats-officedocument.wordprocessingml.template" fullword ascii
      $s29 = "libxml_get_external_entity_loader" fullword ascii
      $s30 = "assert.exception<input type=\"hid=\"hidden\" name=\"Authorization: BConnection: closContent-Length: " fullword ascii
      $s31 = "Unable to get real path of private key file `%s'" fullword ascii
      $s32 = "must be one of PRIO_PGRP, PRIO_USER, or PRIO_PROCESS" fullword ascii
      $s33 = "The decoded property name is invalid" fullword ascii
      $s34 = "Error getting private key" fullword ascii
      $s35 = "php_network_getaddresses: getaddrinfo for %s failed (null result pointer) errno=%d" fullword ascii
      $s36 = "getifaddrs() failed %d: %s" fullword ascii
      $s37 = "This PHP version is maintained by <a href=\"https://www.freexian.com\">Freexian SARL</a> as part of their <a href=\"https://php." ascii
      $s38 = "Failed to generate an acceptable random number in %d attempts" fullword ascii
      $s39 = "Redirection target %d not found" fullword ascii
      $s40 = "This PHP version is maintained by <a href=\"https://www.freexian.com\">Freexian SARL</a> as part of their <a href=\"https://php." ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 02 13 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 6e 57 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 20 00 1f 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a0 a5 0e 00 00 00 00 00 a0 a5 0e 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 b0 0e 00 00 00 00 00 00 b0 0e 00 00 00 00 00 00 b0 0e 00 00 00 00 00 45 05 31 00 00 00 00 00 45 05 31 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 c0 3f 00 00 00 00 00 00 c0 3f 00 00 00 00 00 00 c0 3f 00 00 00 00 00 48 58 0e 00 00 00 00 00 48 58 0e 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 68 1c 4e 00 00 00 00 00 68 2c 4e 00 00 00 00 00 68 2c 4e 00 00 00 00 00 66 4c 09 00 00 00 00 00 28 28 0b 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 80 32 57 00 00 00 00 00 80 42 57 00 00 00 00 00 80 42 57 00 00 00 00 00 70 02 00 00 00 00 00 00 70 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 7c b6 46 00 00 00 00 00 7c b6 46 00 00 00 00 00 7c b6 46 00 00 00 00 00 4c 28 01 00 00 00 00 00 4c 28 01 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 68 1c 4e 00 00 00 00 00 68 2c 4e 00 00 00 00 00 68 2c 4e 00 00 00 00 00 98 33 09 00 00 00 00 00 98 33 09 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 1b 50 d3 1b 1f 9a 01 a1 19 74 b0 40 26 13 00 a4 00 03 e0 20 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 05 08 00 00 41 03 00 00 00 01 00 00 0e 00 00 00 22 8b 06 a0 10 0c 02 80 5f 3a d1 88 01 27 50 41 01 a5 08 16 22 e0 0a a0 42 0a 80 20 00 40 00 00 11 00 08 00 23 00 00 18 41 10 49 00 03 00 05 20 03 33 93 8a 20 50 20 89 02 00 08 80 12 00 41 00 09 a1 98 0a c3 89 a8 41 02 0b c0 48 0d 42 20 01}
condition:
      filesize < 17000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_tex {
   strings:
      $s1 = "  Any remaining COMMANDS are processed as TeX input, after TEXNAME is read." fullword ascii
      $s2 = "quotation error in system command" fullword ascii
      $s3 = "Can't swap a %d-byte item for (un)dumping" fullword ascii
      $s4 = "Could not undump %d %d-byte item(s) from %s" fullword ascii
      $s5 = " memory locations dumped; current usage is " fullword ascii
      $s6 = "Beginning to dump on file " fullword ascii
      $s7 = "tracingcommands" fullword ascii
      $s8 = "-ini                    be initex, for dumping formats; this is implicitly" fullword ascii
      $s9 = "%s: Bad value (%ld) in environment or texmf.cnf for %s, keeping %ld." fullword ascii
      $s10 = "Usage: tex [OPTION]... [TEXNAME[.tex]] [COMMANDS]" fullword ascii
      $s11 = "  remaining arguments are processed as above." fullword ascii
      $s12 = " made by different executable version, strings are different" fullword ascii
      $s13 = "! Trouble executing `%s'." fullword ascii
      $s14 = "*** (job aborted, file error in nonstop mode)" fullword ascii
      $s15 = "You can't dump inside a group" fullword ascii
      $s16 = "scriptspace" fullword ascii
      $s17 = "executed safely (allowed)" fullword ascii
      $s18 = "(\\dump is performed only by INITEX)" fullword ascii
      $s19 = "nonscript" fullword ascii
      $s20 = "scriptscriptfont" fullword ascii
      $s21 = "-halt-on-error          stop processing at the first error" fullword ascii
      $s22 = "end of alignment template" fullword ascii
      $s23 = "postdisplaypenalty" fullword ascii
      $s24 = "outer endtemplate" fullword ascii
      $s25 = "pagetotal" fullword ascii
      $s26 = "xgetcwd" fullword ascii
      $s27 = "shell_escape_commands" fullword ascii
      $s28 = "mubytelog" fullword ascii
      $s29 = "Primary author of %s: %s." fullword ascii
      $s30 = "really didn't forget anything, try typing `2' now; then" fullword ascii
      $s31 = "[unknown command code!]" fullword ascii
      $s32 = "*** (job aborted, no legal \\end found)" fullword ascii
      $s33 = "Unbalanced write command" fullword ascii
      $s34 = "transcript file name" fullword ascii
      $s35 = "Your \\output commands should empty \\box255," fullword ascii
      $s36 = "superscript character " fullword ascii
      $s37 = "I'm ignoring this misplaced \\limits or \\nolimits command." fullword ascii
      $s38 = "subscript character " fullword ascii
      $s39 = "(Please type a command or say `\\end')" fullword ascii
      $s40 = "post && *post" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 40 95 00 00 00 00 00 00 40 00 00 00 00 00 00 00 38 68 06 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b0 8a 00 00 00 00 00 00 b0 8a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 19 95 04 00 00 00 00 00 19 95 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 05 00 00 00 00 00 00 30 05 00 00 00 00 00 00 30 05 00 00 00 00 00 a0 07 01 00 00 00 00 00 a0 07 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 39 06 00 00 00 00 00 10 49 06 00 00 00 00 00 10 49 06 00 00 00 00 00 78 2d 00 00 00 00 00 00 d8 7e 08 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 40 5b 06 00 00 00 00 00 40 6b 06 00 00 00 00 00 40 6b 06 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 64 c7 05 00 00 00 00 00 64 c7 05 00 00 00 00 00 64 c7 05 00 00 00 00 00 34 0c 00 00 00 00 00 00 34 0c 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 39 06 00 00 00 00 00 10 49 06 00 00 00 00 00 10 49 06 00 00 00 00 00 f0 26 00 00 00 00 00 00 f0 26 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 e4 14 0b ad 96 0a 80 4d d6 0a df 8e eb 97 0c 46 8b a7 36 d5 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 51 00 00 00 01 00 00 00 06 00 00 00 c0 05 b3 00 88 81 1c 02 51 00 00 00 54 00 00 00 57 00 00 00 28 1d 8c 1c 22 a5 7d 5c d1 65 ce 6d d0 5c 4f e0 66 55 61 10 39 f2 8b 1c ee 21 63 0f 32 c4 f7 12 b2 a2 f7 12 87 92 4c fc 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 1000KB and
      8 of them and $magic
}

rule gtfobins_binaries_xetex {
   strings:
      $s1 = "  Any remaining COMMANDS are processed as XeTeX input, after TEXNAME is read." fullword ascii
      $s2 = "quotation error in system command" fullword ascii
      $s3 = "logger encoding error '%s'" fullword ascii
      $s4 = "Can't swap a %d-byte item for (un)dumping" fullword ascii
      $s5 = "Could not undump %d %d-byte item(s) from %s" fullword ascii
      $s6 = " memory locations dumped; current usage is " fullword ascii
      $s7 = "Beginning to dump on file " fullword ascii
      $s8 = "Bad dump length" fullword ascii
      $s9 = "A dump length must be between 0 and 2^{31}-1," fullword ascii
      $s10 = "filedump" fullword ascii
      $s11 = "mdclxvi" fullword ascii /* reversed goodware string 'ivxlcdm' */
      $s12 = "runpopen quotation error in command line: %s" fullword ascii
      $s13 = "MDCLXVI" fullword ascii /* reversed goodware string 'IVXLCDM' */
      $s14 = "tracingcommands" fullword ascii
      $s15 = "-ini                    be xeinitex, for dumping formats; this is implicitly" fullword ascii
      $s16 = "the command line with -synctex=0" fullword ascii
      $s17 = "%s: Bad value (%ld) in environment or texmf.cnf for %s, keeping %ld." fullword ascii
      $s18 = "WARNING: %s: Creating Libpng read/info struct failed." fullword ascii
      $s19 = "Compiled with HarfBuzz version %s; using %s" fullword ascii
      $s20 = "Compiled with zlib version %s; using %s" fullword ascii
      $s21 = "Compiled with Graphite2 version %d.%d.%d; using %d.%d.%d" fullword ascii
      $s22 = "Compiled with FreeType2 version %d.%d.%d; using %d.%d.%d" fullword ascii
      $s23 = "Compiled with ICU version %s; using %s" fullword ascii
      $s24 = "Compiled with fontconfig version %d.%d.%d; using %d.%d.%d" fullword ascii
      $s25 = "Compiled with libpng version %s; using %s" fullword ascii
      $s26 = "  remaining arguments are processed as above." fullword ascii
      $s27 = " made by different executable version, strings are different" fullword ascii
      $s28 = "! Trouble executing `%s'." fullword ascii
      $s29 = "*** (job aborted, file error in nonstop mode)" fullword ascii
      $s30 = "Usage: xetex [OPTION]... [TEXNAME[.tex]] [COMMANDS]" fullword ascii
      $s31 = "runpopen command not allowed: %s" fullword ascii
      $s32 = "io:  An OS command failed that should not have." fullword ascii
      $s33 = "%s decoder error (%d, %s)" fullword ascii
      $s34 = "You can't dump inside a group" fullword ascii
      $s35 = "scriptspace" fullword ascii
      $s36 = "executed safely (allowed)" fullword ascii
      $s37 = "(\\dump is performed only by INITEX)" fullword ascii
      $s38 = "nonscript" fullword ascii
      $s39 = "scriptscriptfont" fullword ascii
      $s40 = "-halt-on-error          stop processing at the first error" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 2a 01 00 00 00 00 00 40 00 00 00 00 00 00 00 a8 7a 0d 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 38 0c 01 00 00 00 00 00 38 0c 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 01 00 00 00 00 00 00 10 01 00 00 00 00 00 00 10 01 00 00 00 00 00 99 8b 09 00 00 00 00 00 99 8b 09 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 0a 00 00 00 00 00 00 a0 0a 00 00 00 00 00 00 a0 0a 00 00 00 00 00 a6 75 02 00 00 00 00 00 a6 75 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 40 25 0d 00 00 00 00 00 40 25 0d 00 00 00 00 00 40 25 0d 00 00 00 00 00 a8 53 00 00 00 00 00 00 f8 d8 30 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 58 53 0d 00 00 00 00 00 58 53 0d 00 00 00 00 00 58 53 0d 00 00 00 00 00 b0 02 00 00 00 00 00 00 b0 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 34 c0 0b 00 00 00 00 00 34 c0 0b 00 00 00 00 00 34 c0 0b 00 00 00 00 00 94 2c 00 00 00 00 00 00 94 2c 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 40 25 0d 00 00 00 00 00 40 25 0d 00 00 00 00 00 40 25 0d 00 00 00 00 00 c0 3a 00 00 00 00 00 00 c0 3a 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 ba f8 e2 68 90 d7 42 2e 0a 6a 3e 3d a6 4c 94 e0 51 90 d3 13 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 3e 01 00 00 01 00 00 00 06 00 00 00 c4 05 b3 00 88 81 1c 02 3e 01 00 00 41 01 00 00 45 01 00 00 28 1d 8c 1c d0 65 ce 6d 23 a5 7d 5c d0 5c 4f e0 66 55 61 10 86 f0 96 7c 39 f2 8b 1c b2 a2 f7 12 86 92 4c fc 32 c4 f7 12 ef 21 63 0f 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 3000KB and
      8 of them and $magic
}

rule gtfobins_binaries_julia {
   strings:
      $x1 = "Unknown errnoOperation not permittedNo such file or directoryNo such processInterrupted system callI/O errorNo such device or ad" ascii
      $x2 = "invalid logging spec '' (too many '/'s)invalid regex filter - /rustc/f6e511eec7342f59a25f7c0534f1dbea00d01b14/library/std/src/sy" ascii
      $x3 = "binjuliaInvalid Juliaup channel ``. Please run `juliaup list` to get a list of valid channels and versions.` is not installed. P" ascii
      $x4 = "AlpaquitaAmazonArtixCentOSDebianEndeavourOSFedoraGarudaGentooMarinerNixOSOpenCloudOSPopSolusUbuntulsb_release-alsb_release comma" ascii
      $x5 = "fatal runtime error: failed to initiate panic, error std/src/../../backtrace/src/symbolize/mod.rs -       ConnectionRefusedConne" ascii
      $x6 = "std/src/sys/pal/unix/process/process_unix.rswait() should either return Ok or panicValidation on the CLOEXEC pipe failed: short " ascii
      $x7 = "StartByteMap{/cargo/registry/src/index.crates.io-6f17d22bba15001f/regex-automata-0.4.8/src/util/determinize/state.rs/cargo/regis" ascii
      $x8 = "ASCIIAnyageASCII_Hex_DigitAlphabeticalphabeticasciihexdigitbcBidi_ClassbidicBidi_ControlbidiclassbidicontrolbidimBidi_Mirroredbi" ascii
      $x9 = "src/config_file.rsCould not create lockfile: Could not create juliaup home folder.Could not open self configuration file Problem" ascii
      $x10 = "Failed to parse vendored version db.src/versions_file.rsFailed to load vendored version db.1.0.53Failed to parse our own db vers" ascii
      $s11 = "_ZN3std3sys3pal4unix7process13process_inner71_$LT$impl$u20$std..sys..pal..unix..process..process_common..Command$GT$7do_exec17he" ascii
      $s12 = "/cargo/registry/src/index.crates.io-6f17d22bba15001f/gimli-0.31.1/src/read/abbrev.rs/rust/deps/gimli-0.29.0/src/read/abbrev.rs/r" ascii
      $s13 = "_ZN3std3sys3pal4unix7process13process_inner71_$LT$impl$u20$std..sys..pal..unix..process..process_common..Command$GT$5spawn17h8b1" ascii
      $s14 = "_ZN3std3sys3pal4unix7process13process_inner71_$LT$impl$u20$std..sys..pal..unix..process..process_common..Command$GT$5spawn17h8b1" ascii
      $s15 = "_ZN3std3sys3pal4unix7process13process_inner71_$LT$impl$u20$std..sys..pal..unix..process..process_common..Command$GT$11posix_spaw" ascii
      $s16 = "_ZN76_$LT$std..process..Command$u20$as$u20$std..os..unix..process..CommandExt$GT$4exec17hd80b7239434c4200E" fullword ascii
      $s17 = "dressArgument list too longExec format errorBad file numberNo child processesTry againOut of memoryPermission deniedBad addressB" ascii
      $s18 = "std/src/sys/pal/unix/process/process_unix.rswait() should either return Ok or panicValidation on the CLOEXEC pipe failed: short " ascii
      $s19 = "artedStreams pipe errorToo many usersSocket operation on non-socketDestination address requiredProtocol wrong type for socketPro" ascii
      $s20 = "_ZN3std3sys3pal4unix7process13process_inner71_$LT$impl$u20$std..sys..pal..unix..process..process_common..Command$GT$7do_exec17he" ascii
      $s21 = "ot be called after logger initializedERROR:UserErrormsg1.17.9https://github.com/JuliaLang/juliaup" fullword ascii
      $s22 = "_ZN3std3sys3pal4unix7process13process_inner71_$LT$impl$u20$std..sys..pal..unix..process..process_common..Command$GT$10send_pidfd" ascii
      $s23 = "_ZN3std3sys3pal4unix7process13process_inner71_$LT$impl$u20$std..sys..pal..unix..process..process_common..Command$GT$10send_pidfd" ascii
      $s24 = "_ZN3std3sys3pal4unix7process13process_inner71_$LT$impl$u20$std..sys..pal..unix..process..process_common..Command$GT$11posix_spaw" ascii
      $s25 = "_ZN4core3ptr127drop_in_place$LT$std..sync..poison..PoisonError$LT$std..sync..mutex..MutexGuard$LT$dyn$u20$console..term..TermWri" ascii
      $s26 = "MultipleHandlersJuliaup launcheralloc/src/fmt.rsDOUBLE_UNDERLINEDOTTED_UNDERLINEDASHED_UNDERLINEassertion `left  right` failed: " ascii
      $s27 = "START(ALL): START(pattern: ): D *    ( (MW)N/ASerror building NFA/cargo/registry/src/index.crates.io-6f17d22bba15001f/regex-auto" ascii
      $s28 = "_ZN4core3ptr42drop_in_place$LT$std..process..Command$GT$17h39bd5ee89959c0a9E" fullword ascii
      $s29 = "RUST_MIN_STACKNoSuchSignalSystemSetLoggerErrorCritical system error while waiting for Ctrl-C/cargo/registry/src/index.crates.io-" ascii
      $s30 = "read on the CLOEXEC pipethe CLOEXEC pipe failed: nul byte found in provided datapidfd_spawnp succeeded but the child's PID could" ascii
      $s31 = "_ZN4core3ptr42drop_in_place$LT$std..process..Command$GT$17h6aebed2b75cff227E" fullword ascii
      $s32 = "_ZN3std3sys3pal4unix7process14process_common7Command3new17h12cddea1ebc33c58E" fullword ascii
      $s33 = "_ZN3std3sys3pal4unix7process14process_common7Command8setup_io17h835f67be2b5a8ffcE" fullword ascii
      $s34 = "_ZN3std7process7Command6output17hff22dc4ec5915539E" fullword ascii
      $s35 = "_ZN3std3sys3pal4unix7process14process_common7Command3arg17h9089b910bb3db700E" fullword ascii
      $s36 = "std/src/sync/lazy_lock.rsstd/src/backtrace.rsRUST_LIB_BACKTRACERUST_BACKTRACEunsupported backtracedisabled backtracestd/src/env." ascii
      $s37 = "_ZN4core3ptr107drop_in_place$LT$core..option..Option$LT$std..sys..pal..unix..process..process_common..CStringArray$GT$$GT$17h7b1" ascii
      $s38 = "/os.rsno /proc/self/exe available. Is /proc mounted?TMPDIRstd/src/sys/pal/unix/process/process_common.rs<string-with-nul>/dev/nu" ascii
      $s39 = "_ZN4core3ptr77drop_in_place$LT$std..sys..pal..unix..process..process_common..StdioPipes$GT$17hb1e48adf0235fe1cE" fullword ascii
      $s40 = "_ZN4core3ptr77drop_in_place$LT$std..sys..pal..unix..process..process_common..ChildPipes$GT$17hf0a2660656562baaE" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 8c 87 04 00 00 00 00 00 40 00 00 00 00 00 00 00 68 a1 31 00 00 00 00 00 00 00 00 00 40 00 38 00 07 00 40 00 1c 00 1b 00 01 00 00 00 05 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b8 c7 26 00 00 00 00 00 b8 c7 26 00 00 00 00 00 00 00 20 00 00 00 00 00 01 00 00 00 06 00 00 00 30 d4 26 00 00 00 00 00 30 d4 46 00 00 00 00 00 30 d4 46 00 00 00 00 00 f0 fd 04 00 00 00 00 00 70 17 05 00 00 00 00 00 00 00 20 00 00 00 00 00 02 00 00 00 06 00 00 00 c0 ca 2b 00 00 00 00 00 c0 ca 4b 00 00 00 00 00 c0 ca 4b 00 00 00 00 00 a0 01 00 00 00 00 00 00 a0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 90 03 29 00 00 00 00 00 90 03 49 00 00 00 00 00 90 03 49 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 40 dc 25 00 00 00 00 00 40 dc 25 00 00 00 00 00 40 dc 25 00 00 00 00 00 b4 54 00 00 00 00 00 00 b4 54 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 d4 26 00 00 00 00 00 30 d4 46 00 00 00 00 00 30 d4 46 00 00 00 00 00 d0 fb 04 00 00 00 00 00 d0 fb 04 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d0 03 49 00 00 00 00 00 08 00 00 00 00 00 00 00 90 89 04 00 00 00 00 00 d8 03 49 00 00 00 00 00 08 00 00 00 00 00 00 00 20 89 04 00 00 00 00 00 f0 03 49 00 00 00 00 00 08 00 00 00 00 00 00 00 10 63 1d 00 00 00 00 00 f8 03 49 00 00 00 00 00 08 00 00 00 00 00 00 00 10 63 1d 00 00 00 00 00 00 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 c0 63 1d 00 00 00 00 00 08 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 f0 68 1d 00 00 00 00 00 10 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 30 68 1d 00 00 00 00 00 18 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 20 63 1d 00 00 00 00 00 20 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 60 64 1d 00 00 00 00 00 28 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 a0 64 1d 00 00 00 00 00 30 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 30 22 1e 00 00 00 00 00 38 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 50 63 1d 00 00 00 00 00 40 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 40 63 1d 00 00 00 00 00 48 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 30 63 1d 00 00 00 00 00 50 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 60 65 1d 00 00 00 00 00 58 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 d0 fd 1d 00 00 00 00 00 60 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 00 66 1d 00 00 00 00 00 68 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 78 dc 4b 00 00 00 00 00 80 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 08 cf 25 00 00 00 00 00 88 04 49 00 00 00 00 00 08 00 00 00 00 00 00 00 08 cf 25 00 00 00 00 00 90 04 49 00 00 00 00 00}
condition:
      filesize < 10000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_mysql {
   strings:
      $s1 = "Execute command and quit. (Disables --force and history file.)" fullword ascii
      $s2 = "Usage: \\! shell-command" fullword ascii
      $s3 = "Execute a system shell command." fullword ascii
      $s4 = "Incompatible key or row definition between the MariaDB .frm file and the information in the storage engine. You may have retry o" ascii
      $s5 = "Binary mode allows certain character sequences to be processed as data that would otherwise be treated with a special meaning by" ascii
      $s6 = "my_thread_destroy_common_mutex" fullword ascii
      $s7 = "Unsupported version %d. Supported versions are in the range %d - %d" fullword ascii
      $s8 = "Binary log protocol error (File: %.*s start_pos=%ld): Log format %d not supported." fullword ascii
      $s9 = "Execute an SQL script file. Takes a file name as an argument." fullword ascii
      $s10 = "Received error packet before completion of TLS handshake. The authenticity of the following error cannot be verified: %d - %s" fullword ascii
      $s11 = "Support MariaDB developers by giving a star at https://github.com/MariaDB/server" fullword ascii
      $s12 = "r dump and restore the table to fix this" fullword ascii
      $s13 = "Operation was interrupted by end user (probably kill command?)" fullword ascii
      $s14 = "SQL Command to execute when connecting to MariaDB server. Will automatically be re-executed when reconnecting." fullword ascii
      $s15 = "(i.e., when binary mode is combined with either 1) piped input, 2) the --batch mysql option, or 3) the 'source' command). Also, " ascii
      $s16 = "my_thread_var_mutex_in_use" fullword ascii
      $s17 = "my_errorcheck_mutexattr" fullword ascii
      $s18 = "Binary log error (File: %.*s start_pos=%ld): %s." fullword ascii
      $s19 = "Get progress reports for long running commands (like ALTER TABLE)" fullword ascii
      $s20 = "key_SAFEHASH_mutex" fullword ascii
      $s21 = "Switch to another charset. Might be needed for processing binlog with multi-byte charsets." fullword ascii
      $s22 = "The event could not be processed. No other handler error happened" fullword ascii
      $s23 = "key_my_thread_var_mutex" fullword ascii
      $s24 = "my_thread_destroy_internal_mutex" fullword ascii
      $s25 = "SAFE_HASH::mutex" fullword ascii
      $s26 = "key_TMPDIR_mutex" fullword ascii
      $s27 = "Binary log error (File: %.*s start_pos=%ld): Unknown event type (%d) with flag 'not_ignorable'." fullword ascii
      $s28 = "Binary mode allows certain character sequences to be processed as data that would otherwise be treated with a special meaning by" ascii
      $s29 = "PROCESSLIST" fullword ascii
      $s30 = "ma_tls_get_password" fullword ascii
      $s31 = "my_get_tty_password" fullword ascii
      $s32 = "O_TMPFILE is not supported on %s (disabling future attempts)" fullword ascii
      $s33 = "gethostname(2) failed" fullword ascii
      $s34 = "DUMPFILE" fullword ascii
      $s35 = "Shared memory connection failed during %s. (%lu)" fullword ascii
      $s36 = "named-commands" fullword ascii
      $s37 = "Enable named commands. Named commands mean this program's internal commands; see mysql> help . When enabled, the named commands " ascii
      $s38 = "Lost connection to server at '%s', system error: %d" fullword ascii
      $s39 = "Notify the server that this client is prepared to handle expired password sandbox mode even if --batch was specified." fullword ascii
      $s40 = "key_memory_charset_loader" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 a3 05 00 00 00 00 00 40 00 00 00 00 00 00 00 00 6a 50 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a8 7a 05 00 00 00 00 00 a8 7a 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 80 05 00 00 00 00 00 00 80 05 00 00 00 00 00 00 80 05 00 00 00 00 00 29 7a 08 00 00 00 00 00 29 7a 08 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 0e 00 00 00 00 00 00 00 0e 00 00 00 00 00 00 00 0e 00 00 00 00 00 16 69 36 00 00 00 00 00 16 69 36 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 e0 74 44 00 00 00 00 00 e0 74 44 00 00 00 00 00 e0 74 44 00 00 00 00 00 60 f3 0b 00 00 00 00 00 68 eb 0d 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 18 75 45 00 00 00 00 00 18 75 45 00 00 00 00 00 18 75 45 00 00 00 00 00 60 02 00 00 00 00 00 00 60 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 68 11 43 00 00 00 00 00 68 11 43 00 00 00 00 00 68 11 43 00 00 00 00 00 4c 3d 00 00 00 00 00 00 4c 3d 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 e0 74 44 00 00 00 00 00 e0 74 44 00 00 00 00 00 e0 74 44 00 00 00 00 00 20 0b 01 00 00 00 00 00 20 0b 01 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 05 80 fe 8f 86 c1 44 be 3e 5b c6 24 2e 31 7c b6 0d c4 c7 40 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 07 04 00 00 06 01 00 00 80 00 00 00 0d 00 00 00 43 44 00 a0 9b 10 4d 41 31 2c 00 22 50 e0 c0 98 ef 12 34 31 2c 68 b6 81 08 c7 36 80 00 11 13 54 85 28 00 08 00 80 00 11 04 00 0c 70 01 11 43 c8 40 22 a4 0a 8c a4 11 1e 04 43 08 06 00 20 80 84 0c 00 a8 1d 92 60 4d 2b 0a a1 01 21 28 00 22 0f}
condition:
      filesize < 15000KB and
      8 of them and $magic
}

rule gtfobins_binaries_lftp {
   strings:
      $s1 = " -f <file>           execute commands from the file and exit" fullword ascii
      $s2 = " -e <cmd>            execute the command just after selecting" fullword ascii
      $s3 = " -c <cmd>            execute the commands and exit" fullword ascii
      $s4 = "_Z7cmd_getP7CmdExec" fullword ascii
      $s5 = "_ZN7CmdExec18GetFullCommandNameEPKc" fullword ascii
      $s6 = "_ZN7CmdExec15RegisterCommandEPKcPFP3JobPS_ES1_S1_" fullword ascii
      $s7 = "_Z11cmd_commandP7CmdExec" fullword ascii
      $s8 = "_ZN7CmdExec12builtin_lftpEv" fullword ascii
      $s9 = "_ZN7CmdExec8GetQueueEb" fullword ascii
      $s10 = "_Z8cmd_lftpP7CmdExec" fullword ascii
      $s11 = "_Z8cmd_get1P7CmdExec" fullword ascii
      $s12 = "_ZN7CmdExec19exec_parsed_commandEv" fullword ascii
      $s13 = "_Z12cmd_notemptyP7CmdExec" fullword ascii
      $s14 = "_ZN3Ftp16proxy_LoginCheckEi" fullword ascii
      $s15 = "_ZN7CmdExec20RevertToSavedSessionEv" fullword ascii
      $s16 = "_Z8cmd_userP7CmdExec" fullword ascii
      $s17 = "_ZN7CmdExec12FormatStatusER7xstringiPKc" fullword ascii
      $s18 = "_ZN7CmdExec17ReuseSavedSessionEv" fullword ascii
      $s19 = "_ZN7CmdExec13ChangeSessionEP10FileAccess" fullword ascii
      $s20 = "Usage: %s [OPTS] <files> <target-dir>" fullword ascii
      $s21 = "_ZN7CmdExec13ShowRunStatusERK9SMTaskRefI10StatusLineE" fullword ascii
      $s22 = "_Z9cmd_shellP7CmdExec" fullword ascii
      $s23 = "%s: --continue conflicts with --remove-target." fullword ascii
      $s24 = "_ZN8HttpAuth3NewENS_8target_tEPKcPNS_9ChallengeES2_S2_" fullword ascii
      $s25 = "_ZN4Http7NewAuthEPKcN8HttpAuth8target_tES1_S1_" fullword ascii
      $s26 = "_ZN4Http8SendAuthEN8HttpAuth8target_tEPKcS3_" fullword ascii
      $s27 = " -p  show password" fullword ascii
      $s28 = "_ZN8HttpAuth3GetENS_8target_tEPKcS2_" fullword ascii
      $s29 = "_ZN4HFtp5LoginEPKcS1_" fullword ascii
      $s30 = "_ZN8HttpAuth7MatchesENS_8target_tEPKcS2_" fullword ascii
      $s31 = "_ZN3Ftp10LoginCheckEi" fullword ascii
      $s32 = "EMILEMITEMMAENDSERICEROSEVENEVEREVILEYEDFACEFACTFADEFAILFAINFAIRFAKEFALLFAMEFANGFARMFASTFATEFAWNFEARFEATFEEDFEELFEETFELLFELTFEND" ascii
      $s33 = "%s: ambiguous target directory (`%s' or `%s'?)" fullword ascii
      $s34 = "_Z9cmd_debugP7CmdExec" fullword ascii
      $s35 = "_ZN7CmdExec15load_cmd_moduleEPKc" fullword ascii
      $s36 = "_ZN7CmdExec16static_cmd_tableE" fullword ascii
      $s37 = "_Z9cmd_subshP7CmdExec" fullword ascii
      $s38 = "_Z7cmd_setP7CmdExec" fullword ascii
      $s39 = "_ZN7CmdExec15needs_quotationEPKci" fullword ascii
      $s40 = "_Z9cmd_sleepP7CmdExec" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 70 05 00 00 00 00 00 40 00 00 00 00 00 00 00 80 ba 17 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 98 38 05 00 00 00 00 00 98 38 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 05 00 00 00 00 00 00 40 05 00 00 00 00 00 00 40 05 00 00 00 00 00 a5 b4 0d 00 00 00 00 00 a5 b4 0d 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 13 00 00 00 00 00 00 00 13 00 00 00 00 00 00 00 13 00 00 00 00 00 a4 ce 03 00 00 00 00 00 a4 ce 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 98 d3 16 00 00 00 00 00 98 d3 16 00 00 00 00 00 98 d3 16 00 00 00 00 00 9c e5 00 00 00 00 00 00 90 09 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 58 53 17 00 00 00 00 00 58 53 17 00 00 00 00 00 58 53 17 00 00 00 00 00 50 02 00 00 00 00 00 00 50 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 04 43 14 00 00 00 00 00 04 43 14 00 00 00 00 00 04 43 14 00 00 00 00 00 c4 64 00 00 00 00 00 00 c4 64 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 98 d3 16 00 00 00 00 00 98 d3 16 00 00 00 00 00 98 d3 16 00 00 00 00 00 68 8c 00 00 00 00 00 00 68 8c 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 3d 09 0e d3 2f 65 18 61 6f 98 14 dc b3 53 77 99 e8 01 7a a8 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 05 08 00 00 40 01 00 00 00 02 00 00 0f 00 00 00 10 8d 42 38 20 10 08 30 00 6c 00 00 02 20 52 44 08 50 02 20 01 44 01 10 01 00 01 42 00 00 01 12 a0 02 a8 02 08 90 88 85 20 00 00 00 40 03 00 00 03 03 05 00 10 04 00 11 01 08 00 40 00 0c 1c 41 08 00 08 00 20 80 00 00 01 48 03 61 28 48 c8 00}
condition:
      filesize < 5000KB and
      8 of them and $magic
}

rule gtfobins_binaries_agetty {
   strings:
      $s1 = " -E, --remote               use -r <hostname> for login(1)" fullword ascii
      $s2 = "agetty.autologin" fullword ascii
      $s3 = "%s: invalid character conversion for login name" fullword ascii
      $s4 = " -o, --login-options <opts> options that are passed to login" fullword ascii
      $s5 = " -H, --host <hostname>      specify login host" fullword ascii
      $s6 = "%s%s (automatic login)" fullword ascii
      $s7 = " -l, --login-program <file> specify login program" fullword ascii
      $s8 = "hush login status: restore original IDs failed" fullword ascii
      $s9 = "%s: invalid character 0x%x in login name" fullword ascii
      $s10 = " -p, --login-pause          wait for any key before the login" fullword ascii
      $s11 = " -t, --timeout <number>     login process timeout" fullword ascii
      $s12 = "/dev/%s: cannot set process group: %m" fullword ascii
      $s13 = "/bin/login" fullword ascii
      $s14 = "/etc/hushlogins" fullword ascii
      $s15 = "login-pause" fullword ascii
      $s16 = "[press ENTER to login]" fullword ascii
      $s17 = "login-program" fullword ascii
      $s18 = "skip-login" fullword ascii
      $s19 = "login-options" fullword ascii
      $s20 = "HUSHLOGIN_FILE" fullword ascii
      $s21 = "LOGIN_PLAIN_PROMPT" fullword ascii
      $s22 = "/etc/login.defs" fullword ascii
      $s23 = "%s: failed to get terminal attributes: %m" fullword ascii
      $s24 = "     --chdir <directory>    chdir before the login" fullword ascii
      $s25 = "failed to open credentials directory" fullword ascii
      $s26 = " -n, --skip-login           do not prompt for login" fullword ascii
      $s27 = "     --nice <number>        run login with this priority" fullword ascii
      $s28 = "%s: can't change process priority: %m" fullword ascii
      $s29 = "%s: can't exec %s: %m" fullword ascii
      $s30 = "lightmagenta" fullword ascii
      $s31 = "getttynam" fullword ascii
      $s32 = "nohostname" fullword ascii
      $s33 = "failed to create reload file: %s: %m" fullword ascii
      $s34 = "/dev/%s: vhangup() failed: %m" fullword ascii
      $s35 = "/run/agetty.reload" fullword ascii
      $s36 = "failed to get terminal attributes: %m" fullword ascii
      $s37 = "sd_get_sessions" fullword ascii
      $s38 = "     --reload               reload prompts on running agetty instances" fullword ascii
      $s39 = "versionsort" fullword ascii
      $s40 = "/dev/%s: cannot get controlling tty: %m" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 10 77 00 00 00 00 00 00 40 00 00 00 00 00 00 00 88 96 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b8 3c 00 00 00 00 00 00 b8 3c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 8d e4 00 00 00 00 00 00 8d e4 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 01 00 00 00 00 00 00 30 01 00 00 00 00 00 00 30 01 00 00 00 00 00 90 49 00 00 00 00 00 00 90 49 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 85 01 00 00 00 00 00 b0 85 01 00 00 00 00 00 b0 85 01 00 00 00 00 00 20 0f 00 00 00 00 00 00 c0 2f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 28 88 01 00 00 00 00 00 28 88 01 00 00 00 00 00 28 88 01 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 34 4f 01 00 00 00 00 00 34 4f 01 00 00 00 00 00 34 4f 01 00 00 00 00 00 cc 05 00 00 00 00 00 00 cc 05 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 85 01 00 00 00 00 00 b0 85 01 00 00 00 00 00 b0 85 01 00 00 00 00 00 50 0a 00 00 00 00 00 00 50 0a 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 7f 45 6b c7 e2 94 98 ae 0a 3a 2d 63 36 00 b5 44 c5 8d e4 2c 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 300KB and
      8 of them and $magic
}

rule gtfobins_binaries_dmesg {
   strings:
      $s1 = "read kernel buffer failed" fullword ascii
      $s2 = "userspace" fullword ascii
      $s3 = "klogctl failed" fullword ascii
      $s4 = "clear kernel buffer failed" fullword ascii
      $s5 = "lightmagenta" fullword ascii
      $s6 = "terminal is ready (supports %d colors)" fullword ascii
      $s7 = "klogctl" fullword ascii
      $s8 = " -F, --file <file>           use the file instead of the kernel log buffer" fullword ascii
      $s9 = "--raw can be used together with --level or --facility only when reading messages from /dev/kmsg" fullword ascii
      $s10 = "Supported log facilities:" fullword ascii
      $s11 = "Supported log levels (priorities):" fullword ascii
      $s12 = "setting '%s' from %d -to-> %d" fullword ascii
      $s13 = "messages generated internally by syslogd" fullword ascii
      $s14 = " -u, --userspace             display userspace messages" fullword ascii
      $s15 = "kernel messages" fullword ascii
      $s16 = "reading dir: '%s'" fullword ascii
      $s17 = "reading file '%s'" fullword ascii
      $s18 = "failed to set the %s environment variable" fullword ascii
      $s19 = "stat of %s failed" fullword ascii
      $s20 = "$tI(knNfailed to parse facility '%s'" fullword ascii
      $s21 = "failed to parse level '%s'" fullword ascii
      $s22 = "security/authorization messages (private)" fullword ascii
      $s23 = "item '%s': score=%d [cur: %d, name(%zu): %s, term(%zu): %s]" fullword ascii
      $s24 = "waitpid failed" fullword ascii
      $s25 = "unsupported color mode" fullword ascii
      $s26 = "(out - *seq) <= len" fullword ascii
      $s27 = " %7s - %s" fullword ascii
      $s28 = "system daemons" fullword ascii
      $s29 = "network news subsystem" fullword ascii
      $s30 = "system is unusable" fullword ascii
      $s31 = "/proc/sys/kernel/pid_max" fullword ascii
      $s32 = " -P, --nopager               do not pipe output into a pager" fullword ascii
      $s33 = "error conditions" fullword ascii
      $s34 = "mail system" fullword ascii
      $s35 = "Display or control the kernel ring buffer." fullword ascii
      $s36 = "line printer subsystem" fullword ascii
      $s37 = " -L, --color[=<when>]        colorize messages (%s, %s or %s)" fullword ascii
      $s38 = "bad usage" fullword ascii
      $s39 = "halfbright" fullword ascii
      $s40 = "lightred" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 63 00 00 00 00 00 00 40 00 00 00 00 00 00 00 18 5b 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 78 38 00 00 00 00 00 00 78 38 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 09 a6 00 00 00 00 00 00 09 a6 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 30 3f 00 00 00 00 00 00 30 3f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 3e 01 00 00 00 00 00 90 3e 01 00 00 00 00 00 90 3e 01 00 00 00 00 00 d4 1a 00 00 00 00 00 00 e0 1e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 49 01 00 00 00 00 00 e0 49 01 00 00 00 00 00 e0 49 01 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 38 10 01 00 00 00 00 00 38 10 01 00 00 00 00 00 38 10 01 00 00 00 00 00 5c 04 00 00 00 00 00 00 5c 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 3e 01 00 00 00 00 00 90 3e 01 00 00 00 00 00 90 3e 01 00 00 00 00 00 70 11 00 00 00 00 00 00 70 11 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 80 c1 16 60 5d 7f 2a e5 83 44 b4 a0 d8 84 f3 fb f8 cf 66 48 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 300KB and
      8 of them and $magic
}

rule gtfobins_binaries_date {
   strings:
      $s1 = "error: %s:%d" fullword ascii
      $s2 = "'@timespec' - always UTC" fullword ascii
      $s3 = "only using last of multiple -s options" fullword ascii
      $s4 = "only using last of multiple -d options" fullword ascii
      $s5 = "  -  (hyphen) do not pad the field" fullword ascii
      $s6 = "error: invalid hour %ld%s" fullword ascii
      $s7 = " isdst=%d%s" fullword ascii
      $s8 = "  %::z  +hh:mm:ss numeric time zone (e.g., -04:00:00)" fullword ascii
      $s9 = "  %:z  +hh:mm numeric time zone (e.g., -04:00)" fullword ascii
      $s10 = "%Y-%m-%dT%H:%M:%S%:z" fullword ascii
      $s11 = "%Y-%m-%dT%H:%M:%S,%N%:z" fullword ascii
      $s12 = "error: tzalloc (\"%s\") failed" fullword ascii
      $s13 = "error: unknown word '%s'" fullword ascii
      $s14 = "error: parsing failed, stopped at '%s'" fullword ascii
      $s15 = "error: adding relative date resulted in an invalid date: '%s'" fullword ascii
      $s16 = "error: day '%s' (day ordinal=%ld number=%d) resulted in an invalid date: '%s'" fullword ascii
      $s17 = "system default" fullword ascii
      $s18 = "TZ=\"UTC0\" environment value or -u" fullword ascii
      $s19 = "With -s, or with [MMDDhhmm[[CC]YY][.ss]], set the date and time." fullword ascii
      $s20 = "  %:::z  numeric time zone with : to necessary precision (e.g., -04, +05:30)" fullword ascii
      $s21 = "  -I[FMT], --iso-8601[=FMT]  output date/time in ISO 8601 format." fullword ascii
      $s22 = "  +  pad with zeros, and put '+' before future years with >4 digits" fullword ascii
      $s23 = "  $ date --date='@2147483647'" fullword ascii
      $s24 = "I.e.: --date, --file, --reference, --resolution." fullword ascii
      $s25 = "%Y-%m-%dT%H:%M%:z" fullword ascii
      $s26 = "%Y-%m-%dT%H%:z" fullword ascii
      $s27 = "timezone: system default" fullword ascii
      $s28 = "starting date/time: '%s'" fullword ascii
      $s29 = "error: seen multiple time-zone parts" fullword ascii
      $s30 = "warning: when adding relative days, it is recommended to specify noon" fullword ascii
      $s31 = "error: year, month, or day overflow" fullword ascii
      $s32 = "warning: value %ld has %ld digits. Assuming YYYY/MM/DD" fullword ascii
      $s33 = "using current date as starting value: '%s'" fullword ascii
      $s34 = "%s (day ordinal=%ld number=%d)" fullword ascii
      $s35 = "final: %s (UTC)" fullword ascii
      $s36 = "warning: day (%s) ignored when explicit dates are given" fullword ascii
      $s37 = "timezone: TZ=\"%s\" environment value" fullword ascii
      $s38 = "error: seen multiple date parts" fullword ascii
      $s39 = "TZ=\"%s\" environment value" fullword ascii
      $s40 = "error: seen multiple time parts" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 3e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b0 c4 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 2a 00 00 00 00 00 00 20 2a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 39 15 01 00 00 00 00 00 39 15 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 d8 5c 00 00 00 00 00 00 d8 5c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 b1 01 00 00 00 00 00 f0 b1 01 00 00 00 00 00 f0 b1 01 00 00 00 00 00 10 11 00 00 00 00 00 00 d0 12 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 bd 01 00 00 00 00 00 d8 bd 01 00 00 00 00 00 d8 bd 01 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 10 8f 01 00 00 00 00 00 10 8f 01 00 00 00 00 00 10 8f 01 00 00 00 00 00 8c 04 00 00 00 00 00 00 8c 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 b1 01 00 00 00 00 00 f0 b1 01 00 00 00 00 00 f0 b1 01 00 00 00 00 00 10 0e 00 00 00 00 00 00 10 0e 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 3c bd ac 84 b3 8c 02 0e 27 fa 04 c7 ae 36 c2 6e 0e 84 48 3f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 50 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 50 00 00 00 52 00 00 00 58 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 300KB and
      8 of them and $magic
}

rule gtfobins_binaries_curl {
   strings:
      $s1 = "Using --anyauth or --proxy-anyauth with upload from stdin involves a big risk of it not working. Use a temporary file or a fixed" ascii
      $s2 = "Using --anyauth or --proxy-anyauth with upload from stdin involves a big risk of it not working. Use a temporary file or a fixed" ascii
      $s3 = "-D, --dump-header <filename>" fullword ascii
      $s4 = "-A, --user-agent <name>" fullword ascii
      $s5 = "Configure Encrypted Client Hello (ECH) for use with the TLS session" fullword ascii
      $s6 = "SOCKS5 proxy on given host + port" fullword ascii
      $s7 = "-x, --proxy [protocol://]host[:port]" fullword ascii
      $s8 = "-U, --proxy-user <user:password>" fullword ascii
      $s9 = "SOCKS4a proxy on given host + port" fullword ascii
      $s10 = "SOCKS4 proxy on given host + port" fullword ascii
      $s11 = "Acceptable MD5 hash of host public key" fullword ascii
      $s12 = "Acceptable SHA256 hash of host public key" fullword ascii
      $s13 = "Header file %s read error: %s" fullword ascii
      $s14 = "Setting custom HTTP method to HEAD with -X/--request may not work the way you want. Consider using -I/--head instead." fullword ascii
      $s15 = "HTTP POST data URL encoded" fullword ascii
      $s16 = "Send User-Agent <name> to server" fullword ascii
      $s17 = "FILE/HASHES public key to verify proxy with" fullword ascii
      $s18 = "-Q, --quote <command>" fullword ascii
      $s19 = "-P, --ftp-port <address>" fullword ascii
      $s20 = "Pass phrase for the private key for HTTPS proxy" fullword ascii
      $s21 = "Append to target file when uploading" fullword ascii
      $s22 = "-J, --remote-header-name" fullword ascii
      $s23 = "-u, --user <user:password>" fullword ascii
      $s24 = "login-options" fullword ascii
      $s25 = "Allow RCPT TO command to fail" fullword ascii
      $s26 = "CURLOPT_PROXY_TLSAUTH_PASSWORD" fullword ascii
      $s27 = "CURLOPT_LOGIN_OPTIONS" fullword ascii
      $s28 = "--continue-at and --remote-header-name cannot be combined" fullword ascii
      $s29 = "Must read .netrc for username and password" fullword ascii
      $s30 = "Proxy user and password" fullword ascii
      $s31 = "SOCKS5 proxy, pass hostname to proxy" fullword ascii
      $s32 = "Enter %s password for user '%s' on URL #%zu:" fullword ascii
      $s33 = "Process given URLs as metalink XML file" fullword ascii
      $s34 = "CURLOPT_SSH_HOST_PUBLIC_KEY_SHA256" fullword ascii
      $s35 = "HTTP POST binary data" fullword ascii
      $s36 = "proxy-tlspassword" fullword ascii
      $s37 = "Require TLS for login, clear for transfer" fullword ascii
      $s38 = "Show error even when -s is used" fullword ascii
      $s39 = "urle.password" fullword ascii
      $s40 = "url.password" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 aa 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b0 71 04 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 93 00 00 00 00 00 00 20 93 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 71 9e 01 00 00 00 00 00 71 9e 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 c4 da 01 00 00 00 00 00 c4 da 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 23 04 00 00 00 00 00 70 23 04 00 00 00 00 00 70 23 04 00 00 00 00 00 f8 4c 00 00 00 00 00 00 c0 55 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 50 69 04 00 00 00 00 00 50 69 04 00 00 00 00 00 50 69 04 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 e0 e3 03 00 00 00 00 00 e0 e3 03 00 00 00 00 00 e0 e3 03 00 00 00 00 00 a4 06 00 00 00 00 00 00 a4 06 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 23 04 00 00 00 00 00 70 23 04 00 00 00 00 00 70 23 04 00 00 00 00 00 90 4c 00 00 00 00 00 00 90 4c 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 2d d4 81 c2 5e 9d 07 94 b1 0b c9 13 3a e7 6a 9e a6 da 67 f6 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 8a 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 8a 00 00 00 8c 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0b 05 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 900KB and
      8 of them and $magic
}

rule gtfobins_binaries_script {
   strings:
      $s1 = " -c, --command <command>       run command rather than interactive shell" fullword ascii
      $s2 = "Script done on %s [COMMAND_EXIT_CODE=\"%d\"]" fullword ascii
      $s3 = " stdin --> master %zd bytes queued" fullword ascii
      $s4 = " stdin --> master trying %zu bytes" fullword ascii
      $s5 = "unsupported logging format: '%s'" fullword ascii
      $s6 = "COMMAND=\"%s\"" fullword ascii
      $s7 = "log->format == SCRIPT_FMT_TIMING_MULTI" fullword ascii
      $s8 = " -e, --return                  return exit code of the child process" fullword ascii
      $s9 = "%*s<not executed on terminal>" fullword ascii
      $s10 = "getttynam" fullword ascii
      $s11 = "Make a typescript of a terminal session." fullword ascii
      $s12 = "Script done on %s [<%s>]" fullword ascii
      $s13 = " master --> stdout %zd bytes" fullword ascii
      $s14 = "cannot create child process" fullword ascii
      $s15 = "Script started on %s [" fullword ascii
      $s16 = ", output log file is '%s'" fullword ascii
      $s17 = " child stop by SIGSTOP -- stop parent too" fullword ascii
      $s18 = ", input log file is '%s'" fullword ascii
      $s19 = "  log timing info" fullword ascii
      $s20 = " -I, --log-in <file>           log stdin to file" fullword ascii
      $s21 = "stop logging" fullword ascii
      $s22 = " -B, --log-io <file>           log stdin and stdout to file" fullword ascii
      $s23 = "$tI(knNterm-utils/script.c" fullword ascii
      $s24 = "SCRIPT_DEBUG" fullword ascii
      $s25 = "Script started" fullword ascii
      $s26 = "unssuported echo mode: '%s'" fullword ascii
      $s27 = "Script done." fullword ascii
      $s28 = "script(1)" fullword ascii
      $s29 = "Session terminated, killing shell..." fullword ascii
      $s30 = "Script terminated, max output files size %lu exceeded." fullword ascii
      $s31 = "pty setup done [master=%d, slave=%d, rc=%d]" fullword ascii
      $s32 = "leaving poll() loop [timeout=%d, rc=%d]" fullword ascii
      $s33 = "poll() done [signal=%d, rc=%d]" fullword ascii
      $s34 = "OUTPUT_LOG" fullword ascii
      $s35 = " get signal SIGWINCH" fullword ascii
      $s36 = " get signal SIG{TERM,INT,QUIT}" fullword ascii
      $s37 = " get signal SIGCHLD" fullword ascii
      $s38 = "logging-format" fullword ascii
      $s39 = "ul_pty_get_delivered_signal" fullword ascii
      $s40 = "failed to parse output limit size" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 4d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 21 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e0 2b 00 00 00 00 00 00 e0 2b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 a9 9d 00 00 00 00 00 00 a9 9d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 a0 34 00 00 00 00 00 00 a0 34 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 12 01 00 00 00 00 00 d0 12 01 00 00 00 00 00 d0 12 01 00 00 00 00 00 44 0d 00 00 00 00 00 00 a8 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 40 1a 01 00 00 00 00 00 40 1a 01 00 00 00 00 00 40 1a 01 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 1c e9 00 00 00 00 00 00 1c e9 00 00 00 00 00 00 1c e9 00 00 00 00 00 00 dc 03 00 00 00 00 00 00 dc 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 12 01 00 00 00 00 00 d0 12 01 00 00 00 00 00 d0 12 01 00 00 00 00 00 30 0d 00 00 00 00 00 00 30 0d 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 ac 86 7c de 6e f5 0d 26 da 8e 65 e8 43 57 c6 f4 d6 48 89 1b 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_highlight {
   strings:
      $s1 = "The --plug-in option reads the path of a Lua script which overrides or" fullword ascii
      $s2 = "HeaderInjection" fullword ascii
      $s3 = "highlight.sty (LaTeX, TeX) if neither -c nor -I is given." fullword ascii
      $s4 = "<office:document xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:style=\"urn:oasis:names:tc:opendocument" ascii
      $s5 = "highlight: no LS executable defined. Consider the --ls-exec or --ls-profile options." fullword ascii
      $s6 = "Run highlight --list-scripts=langs to see all supported syntax types." fullword ascii
      $s7 = "Description=\"Plugin generated by highlight using the --two-pass option\"" fullword ascii
      $s8 = "     --plug-in=<script>         execute Lua plug-in script; repeat option to" fullword ascii
      $s9 = "St11_Mutex_baseILN9__gnu_cxx12_Lock_policyE2EE" fullword ascii
      $s10 = "boost::xpressive::regex_constants::compiler_token_type boost::xpressive::compiler_traits<RegexTraits>::get_charset_token(FwdIter" ascii
      $s11 = "boost::xpressive::regex_constants::compiler_token_type boost::xpressive::compiler_traits<RegexTraits>::get_group_type(FwdIter&, " ascii
      $s12 = "boost::xpressive::regex_constants::compiler_token_type boost::xpressive::compiler_traits<RegexTraits>::get_charset_token(FwdIter" ascii
      $s13 = "boost::xpressive::regex_constants::compiler_token_type boost::xpressive::compiler_traits<RegexTraits>::get_group_type(FwdIter&, " ascii
      $s14 = "filetypes.conf (see --print-config for the configuration search paths)." fullword ascii
      $s15 = "keep-injections" fullword ascii
      $s16 = "Print all installed themes with --list-scripts=themes." fullword ascii
      $s17 = "FooterInjection" fullword ascii
      $s18 = "Print all installed themes with --list-scripts=plugins." fullword ascii
      $s19 = "\" target=\"new\">" fullword ascii
      $s20 = "boost::xpressive::basic_regex<BidiIter> boost::xpressive::regex_compiler<BidiIter, RegexTraits, CompilerTraits>::compile_(FwdIte" ascii
      $s21 = "InjectioH" fullword ascii
      $s22 = "Print all installed language definitions with --list-scripts=langs." fullword ascii
      $s23 = "     --ls-exec=<bin>            set server executable name" fullword ascii
      $s24 = "InjectioL" fullword ascii
      $s25 = " Plug-in theme injections: " fullword ascii
      $s26 = "Highlight is configured by a set of Lua scripts and environment variables." fullword ascii
      $s27 = "xmlns:form:1.0\" xmlns:script=\"urn:oasis:names:tc:opendocument:xmlns:script:1.0\" xmlns:config=\"urn:oasis:names:tc:opendocumen" ascii
      $s28 = "highlight: language server initialization failed. Consider --ls-legacy option." fullword ascii
      $s29 = "lns:config:1.0\" xmlns:ooo=\"http://openoffice.org/2004/office\" xmlns:ooow=\"http://openoffice.org/2004/writer\" xmlns:oooc=\"h" ascii
      $s30 = "port\" xmlns:of=\"urn:oasis:names:tc:opendocument:xmlns:of:1.2\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:grddl=\"http" ascii
      $s31 = "\\newcommand{\\hl" fullword ascii
      $s32 = "     --keep-injections          output plug-in injections in spite of -f" fullword ascii
      $s33 = "     --ls-hover                 execute hover requests (HTML output only)" fullword ascii
      $s34 = "HIGHLIGHT_DATADIR: sets the path to highlight's configuration scripts" fullword ascii
      $s35 = "bool boost::xpressive::compiler_traits<RegexTraits>::get_quant_spec(FwdIter&, FwdIter, boost::xpressive::detail::quant_spec&) [w" ascii
      $s36 = "void boost::xpressive::compiler_traits<RegexTraits>::get_name_(FwdIter&, FwdIter, string_type&) [with FwdIter = __gnu_cxx::__nor" ascii
      $s37 = "traitsIcNS0_16cpp_regex_traitsIcEEEEN4mpl_5bool_ILb0EEENS1_16compound_charsetIS9_EEEEEENSB_ILb1EEEEEN9__gnu_cxx17__normal_iterat" ascii
      $s38 = "N5boost9xpressive6detail17lookahead_matcherINS1_16shared_matchableIN9__gnu_cxx17__normal_iteratorIPKcNSt7__cxx1112basic_stringIc" ascii
      $s39 = "traitsIcNS0_16cpp_regex_traitsIcEEEEN4mpl_5bool_ILb1EEENS1_16compound_charsetIS9_EEEEEENSB_ILb0EEEEEN9__gnu_cxx17__normal_iterat" ascii
      $s40 = "N5boost9xpressive6detail17dynamic_xpressionINS1_17lookahead_matcherINS1_16shared_matchableIN9__gnu_cxx17__normal_iteratorIPKcNSt" ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 ba 02 00 00 00 00 00 40 00 00 00 00 00 00 00 a0 31 14 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 60 05 01 00 00 00 00 00 60 05 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 01 00 00 00 00 00 00 10 01 00 00 00 00 00 00 10 01 00 00 00 00 00 bd f7 0e 00 00 00 00 00 bd f7 0e 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 10 10 00 00 00 00 00 00 10 10 00 00 00 00 00 00 10 10 00 00 00 00 00 af b8 03 00 00 00 00 00 af b8 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 38 d6 13 00 00 00 00 00 38 d6 13 00 00 00 00 00 38 d6 13 00 00 00 00 00 08 5a 00 00 00 00 00 00 40 8b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 20 27 14 00 00 00 00 00 20 27 14 00 00 00 00 00 20 27 14 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 0c 3f 11 00 00 00 00 00 0c 3f 11 00 00 00 00 00 0c 3f 11 00 00 00 00 00 24 49 00 00 00 00 00 00 24 49 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 38 d6 13 00 00 00 00 00 38 d6 13 00 00 00 00 00 38 d6 13 00 00 00 00 00 c8 59 00 00 00 00 00 00 c8 59 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 4e d1 ec ef dc 20 21 7a 20 62 41 58 b9 0c 99 ce 05 27 b0 c6 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 d8 00 00 00 04 00 00 00 08 00 00 00 08 a0 30 21 a1 21 00 42 f4 30 78 01 a0 28 1c 18 18 08 82 50 00 28 09 00 00 10 01 08 20 14 00 60 d8 00 00 00 d9 00 00 00 db 00 00 00 00 00 00 00 dd 00 00 00 e0 00 00 00 e3 00 00 00 00 00 00 00 e5 00 00 00 e6 00 00 00 e8 00 00 00 00 00 00 00}
condition:
      filesize < 4000KB and
      8 of them and $magic
}

rule gtfobins_binaries_git {
   strings:
      $s1 = "dropping %s %s -- patch contents already upstream" fullword ascii
      $s2 = "gpg.ssh.defaultKeyCommand failed: %s %s" fullword ascii
      $s3 = "ExecStart=\"%s/git\" --exec-path=\"%s\" for-each-repo --config=maintenance.repo maintenance run --schedule=%%i" fullword ascii
      $s4 = "%%d %%s * * %%s \"%s/git\" --exec-path=\"%s\" for-each-repo --config=maintenance.repo maintenance run --schedule=%%s" fullword ascii
      $s5 = "Could not run 'git rev-list <commits> --not --remotes -n 1' command in submodule %s" fullword ascii
      $s6 = "x, exec <command> = run command (the rest of the line) using shell" fullword ascii
      $s7 = "fast-import: dumping crash report to %s" fullword ascii
      $s8 = "git archive --remote <repo> [--exec <cmd>] --list" fullword ascii
      $s9 = "gpg.ssh.defaultKeyCommand succeeded but returned no keys: %s %s" fullword ascii
      $s10 = "use '%s -f -f' to override, or 'unlock' and 'prune' or 'remove' to clear" fullword ascii
      $s11 = "sendemail.smtpReloginDelay" fullword ascii
      $s12 = "%%(align:%d,left)%s%%(refname:lstrip=2)%%(end)%s%%(if)%%(symref)%%(then) -> %%(symref:short)%%(else) %s %%(contents:subject)%%(e" ascii
      $s13 = "%%(align:%d,left)%s%%(refname:lstrip=2)%%(end)%s%%(if)%%(symref)%%(then) -> %%(symref:short)%%(else) %s %%(contents:subject)%%(e" ascii
      $s14 = "git ls-remote [--heads] [--tags] [--refs] [--upload-pack=<exec>]" fullword ascii
      $s15 = "rebase.rescheduleFailedExec" fullword ascii
      $s16 = "tar.tgz.command" fullword ascii
      $s17 = "<Arguments>--exec-path=\"%s\" for-each-repo --config=maintenance.repo maintenance run --schedule=%s</Arguments>" fullword ascii
      $s18 = "<Command>\"%s\\headless-git.exe\"</Command>" fullword ascii
      $s19 = "unable to move logfile logs/%s to logs/refs/.tmp-renamed-log: %s" fullword ascii
      $s20 = "Could not execute the todo command" fullword ascii
      $s21 = "unable to restore logfile %s from logs/refs/.tmp-renamed-log: %s" fullword ascii
      $s22 = "Execution of '%s %s' failed in submodule path '%s'" fullword ascii
      $s23 = "*** Commands ***" fullword ascii
      $s24 = "unable to copy logfile logs/%s to logs/refs/.tmp-renamed-log: %s" fullword ascii
      $s25 = "graph->mapping[i - 1] > target" fullword ascii
      $s26 = "tar.tar.gz.command" fullword ascii
      $s27 = "empty exec command" fullword ascii
      $s28 = "tortoiseplink.exe" fullword ascii
      $s29 = "gpg.ssh.defaultKeyCommand" fullword ascii
      $s30 = "failed to run command '%s': %s" fullword ascii
      $s31 = "or --ff-only on the command line to override the configured default per" fullword ascii
      $s32 = "NACK unable to spawn subprocess" fullword ascii
      $s33 = "error processing config file(s)" fullword ascii
      $s34 = "git rebase [-i] [options] [--exec <cmd>] [--onto <newbase>] --root [<branch>]" fullword ascii
      $s35 = "process for submodule '%s' failed" fullword ascii
      $s36 = "error reading from textconv command '%s'" fullword ascii
      $s37 = "initialization for subprocess '%s' failed" fullword ascii
      $s38 = "  git config --global user.email \"you@example.com\"" fullword ascii
      $s39 = "running trailer command '%s' failed" fullword ascii
      $s40 = "git rebase [-i] [options] [--exec <cmd>] [--onto <newbase> | --keep-base] [<upstream> [<branch>]]" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 f1 01 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 08 3a 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f0 d4 01 00 00 00 00 00 f0 d4 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 19 0d 2a 00 00 00 00 00 19 0d 2a 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 f0 2b 00 00 00 00 00 00 f0 2b 00 00 00 00 00 00 f0 2b 00 00 00 00 00 f0 97 0c 00 00 00 00 00 f0 97 0c 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 8d 38 00 00 00 00 00 30 9d 38 00 00 00 00 00 30 9d 38 00 00 00 00 00 40 7a 01 00 00 00 00 00 38 df 03 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 60 bd 38 00 00 00 00 00 60 cd 38 00 00 00 00 00 60 cd 38 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 88 d9 32 00 00 00 00 00 88 d9 32 00 00 00 00 00 88 d9 32 00 00 00 00 00 44 bb 00 00 00 00 00 00 44 bb 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 8d 38 00 00 00 00 00 30 9d 38 00 00 00 00 00 30 9d 38 00 00 00 00 00 d0 32 00 00 00 00 00 00 d0 32 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 40 be b4 fd 9f a1 32 5d 7d 20 84 e3 b0 ba a9 83 21 2b ab 93 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 f6 00 00 00 02 00 00 00 07 00 00 00 80 00 00 04 52 05 00 0e 18 18 01 40 80 94 08 80 f6 00 00 00 f9 00 00 00 ff 00 00 00 28 1d 8c 1c a6 dd a3 6b d1 65 ce 6d 86 f0 96 7c cc 3f 0c af 66 55 61 10 a8 bd f0 bb c4 b9 9c 40 39 f2 8b 1c 3a 0d 85 b3 ee 21 63 0f 24 75 82 0d 5f 96 93 1c}
condition:
      filesize < 11000KB and
      8 of them and $magic
}

rule gtfobins_binaries_rsync {
   strings:
      $s1 = "--rsh=COMMAND, -e        specify the remote shell to use" fullword ascii
      $s2 = "attempt to copy device contents without --copy-devices" fullword ascii
      $s3 = "Failed to stat temp-dir %s: %s" fullword ascii
      $s4 = "* *.a *.olb *.o *.obj *.so *.exe *.Z *.elc *.ln core .svn/ .git/ .hg/ .bzr/" fullword ascii
      $s5 = "ERROR: password file must be owned by root when running as root" fullword ascii
      $s6 = "ERROR: failed to read a password from %s" fullword ascii
      $s7 = "get_xattr_names: llistxattr(%s,%s) failed" fullword ascii
      $s8 = "get_xattr_data: lgetxattr(%s,\"%s\",0) failed" fullword ascii
      $s9 = "get_xattr_data: lgetxattr(%s,\"%s\",%ld) failed" fullword ascii
      $s10 = "early exec preparation failed" fullword ascii
      $s11 = "early exec failed" fullword ascii
      $s12 = "rsync: internal error on %s%s: %d != %d" fullword ascii
      $s13 = "RCS SCCS CVS CVS.adm RCSLOG cvslog.* tags TAGS .make.state .nse_depinfo *~ #* .#* ,* _$* *$ *.old *.bak *.BAK *.orig *.rej .del-" ascii
      $s14 = "[%s] created hashtable %lx (%ssize: %d, keys: %d-bit)" fullword ascii
      $s15 = "auth failed on module %s from %s (%s) for %s: %s" fullword ascii
      $s16 = "[%s] destroyed hashtable %lx (size: %d, keys: %d-bit)" fullword ascii
      $s17 = "[%s] growing hashtable %lx (size: %d, keys: %d-bit)" fullword ascii
      $s18 = "[%s] completed parent_dirscan for mergelist #%d%s" fullword ascii
      $s19 = "name-converter exec preparation failed" fullword ascii
      $s20 = "@ERROR: early exec failed" fullword ascii
      $s21 = "ERROR: password file must not be other-accessible" fullword ascii
      $s22 = "@ERROR: early exec preparation failed" fullword ascii
      $s23 = "[%s] Invalid dir index: %d (%d - %d)" fullword ascii
      $s24 = "@ERROR: name-converter exec preparation failed" fullword ascii
      $s25 = "*getnameinfo failure: %s*" fullword ascii
      $s26 = "get_xattr_data: lgetxattr(%s,\"%s\",%ld) returned %ld" fullword ascii
      $s27 = "listen backlog" fullword ascii
      $s28 = "[%s] popping mergelist #%d%s" fullword ascii
      $s29 = "Try using --ipv4 or --ipv6 to avoid this listen() error." fullword ascii
      $s30 = "password mismatch" fullword ascii
      $s31 = "rename %s -> \"%s\" failed" fullword ascii
      $s32 = "forward lookup" fullword ascii
      $s33 = "%s returned failure (%d)%s%s%s" fullword ascii
      $s34 = "early exec" fullword ascii
      $s35 = "FATAL I/O ERROR: dying to avoid a --delete-%s issue with a pre-3.0.7 receiver." fullword ascii
      $s36 = "getgrouplist failed" fullword ascii
      $s37 = "%s%s compress: %s (level %d)" fullword ascii
      $s38 = "Your --%s-choice value (%s) was refused by the server." fullword ascii
      $s39 = "multiplexing overflow %d:%lu [%s%s]" fullword ascii
      $s40 = "invalid multi-message %d:%lu [%s%s]" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 50 c3 00 00 00 00 00 00 40 00 00 00 00 00 00 00 48 d2 07 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e8 8c 00 00 00 00 00 00 e8 8c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 35 54 05 00 00 00 00 00 35 54 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 f0 05 00 00 00 00 00 00 f0 05 00 00 00 00 00 00 f0 05 00 00 00 00 00 68 7f 01 00 00 00 00 00 68 7f 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 48 78 07 00 00 00 00 00 48 78 07 00 00 00 00 00 48 78 07 00 00 00 00 00 b8 58 00 00 00 00 00 00 48 87 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 85 07 00 00 00 00 00 d8 85 07 00 00 00 00 00 d8 85 07 00 00 00 00 00 60 02 00 00 00 00 00 00 60 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 2c cd 06 00 00 00 00 00 2c cd 06 00 00 00 00 00 2c cd 06 00 00 00 00 00 84 13 00 00 00 00 00 00 84 13 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 48 78 07 00 00 00 00 00 48 78 07 00 00 00 00 00 48 78 07 00 00 00 00 00 b8 17 00 00 00 00 00 00 b8 17 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 c0 e7 18 ef 4c 26 10 4d 9c 19 e5 be 37 b3 df e6 39 9b 06 84 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 f1 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 f1 00 00 00 f3 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 05 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 2000KB and
      8 of them and $magic
}

rule gtfobins_binaries_tar {
   strings:
      $s1 = "%s: directory is on a different filesystem; not dumped" fullword ascii
      $s2 = "print total bytes after processing the archive; with an argument - print total bytes when this SIGNAL is delivered; Allowed sign" ascii
      $s3 = "preserve access times on dumped files, either by restoring the times after reading (METHOD='replace'; default) or by not setting" ascii
      $s4 = "Refusing to read archive contents from terminal (missing -f option?)" fullword ascii
      $s5 = "lgetxattrat" fullword ascii
      $s6 = "Refusing to write archive contents to terminal (missing -f option?)" fullword ascii
      $s7 = "%s: archive cannot contain itself; not dumped" fullword ascii
      $s8 = "Try '%s --help' or '%s --usage' for more information." fullword ascii
      $s9 = "Unknown quoting style '%s'. Try '%s --quoting-style=help' to get a list." fullword ascii
      $s10 = "mmands --delete, --diff, --extract or --list and when a list of files is given either on the command line or via the -T option; " ascii
      $s11 = "process only the NUMBERth occurrence of each file in the archive; this option is valid only in conjunction with one of the subco" ascii
      $s12 = "Ignoring unknown extended header keyword '%s'" fullword ascii
      $s13 = "failed to assert availability of the standard file descriptors" fullword ascii
      $s14 = "Malformed dumpdir: 'T' not preceded by 'R'" fullword ascii
      $s15 = "%s: unrecognized option '%s%s'" fullword ascii
      $s16 = "%s: option '%s%s' is ambiguous" fullword ascii
      $s17 = "%s: option '%s%s' requires an argument" fullword ascii
      $s18 = "%s: option '%s%s' is ambiguous; possibilities:" fullword ascii
      $s19 = "%s: option '%s%s' doesn't allow an argument" fullword ascii
      $s20 = "fgetfilecon" fullword ascii
      $s21 = "lgetfilecon" fullword ascii
      $s22 = "lgetfileconat" fullword ascii
      $s23 = "setxattrat" fullword ascii
      $s24 = "llistxattrat" fullword ascii
      $s25 = "%s: Warning: Read error at byte %jd, while reading %zu byte" fullword ascii
      $s26 = "%s: Warning: Read error at byte %jd, while reading %zu bytes" fullword ascii
      $s27 = "%s: Read error at byte %jd, while reading %zu bytes" fullword ascii
      $s28 = "%s: Read error at byte %jd, while reading %zu byte" fullword ascii
      $s29 = "%s: file list requested from %s already read from %s" fullword ascii
      $s30 = "%{%Y-%m-%d %H:%M:%S}t: %ds, %{read,wrote}T%*" fullword ascii
      $s31 = "globbing error" fullword ascii
      $s32 = "slash - dir < 4096" fullword ascii
      $s33 = "errors reading map file" fullword ascii
      $s34 = "Cannot redirect files for remote shell" fullword ascii
      $s35 = "Options '-Aru' are incompatible with '-f -'" fullword ascii
      $s36 = "-T reads null-terminated names; implies --verbatim-files-from" fullword ascii
      $s37 = "Options '-[0-7][lmh]' not supported by *this* tar" fullword ascii
      $s38 = "  tar -cf archive.tar foo bar  # Create archive.tar from files foo and bar." fullword ascii
      $s39 = " y or newline  Continue operation" fullword ascii
      $s40 = "invalid wordsplit usage" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 c2 00 00 00 00 00 00 40 00 00 00 00 00 00 00 a8 d6 06 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 78 90 00 00 00 00 00 00 78 90 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 6d 77 04 00 00 00 00 00 6d 77 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 05 00 00 00 00 00 00 20 05 00 00 00 00 00 00 20 05 00 00 00 00 00 d0 5f 01 00 00 00 00 00 d0 5f 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 87 06 00 00 00 00 00 30 87 06 00 00 00 00 00 30 87 06 00 00 00 00 00 20 4e 00 00 00 00 00 00 c8 5f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 98 9d 06 00 00 00 00 00 98 9d 06 00 00 00 00 00 98 9d 06 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 b4 b7 05 00 00 00 00 00 b4 b7 05 00 00 00 00 00 b4 b7 05 00 00 00 00 00 44 1c 00 00 00 00 00 00 44 1c 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 87 06 00 00 00 00 00 30 87 06 00 00 00 00 00 30 87 06 00 00 00 00 00 d0 18 00 00 00 00 00 00 d0 18 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 84 c8 5f 58 af 66 75 ea a6 da 81 6a 77 77 aa 24 d8 04 5a fa 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 d6 00 00 00 04 00 00 00 08 00 00 00 04 00 00 20 00 01 04 42 40 d2 28 18 80 04 80 c0 80 20 c9 a1 41 00 81 1d 50 49 03 08 26 10 40 4a d6 00 00 00 00 00 00 00 d7 00 00 00 d8 00 00 00 db 00 00 00 de 00 00 00 e0 00 00 00 e3 00 00 00 e4 00 00 00 00 00 00 00 e7 00 00 00 e8 00 00 00}
condition:
      filesize < 1000KB and
      8 of them and $magic
}

rule gtfobins_binaries_lua {
   strings:
      $s1 = "usage: %s [options] [script [args]]" fullword ascii
      $s2 = "  -i        enter interactive mode after executing 'script'" fullword ascii
      $s3 = "  -e stat   execute string 'stat'" fullword ascii
      $s4 = "  -         stop handling options and execute stdin" fullword ascii
      $s5 = "$LuaVersion: Lua 5.4.6  Copyright (C) 1994-2023 Lua.org, PUC-Rio $$LuaAuthors: R. Ierusalimschy, L. H. de Figueiredo, W. Celes $" ascii
      $s6 = "attempt to %s a %s value%s" fullword ascii
      $s7 = "attempt to %s a '%s' with a '%s'" fullword ascii
      $s8 = "attempt to assign to const variable '%s'" fullword ascii
      $s9 = "attempt to divide by zero" fullword ascii
      $s10 = "%s: bad binary format (%s)" fullword ascii
      $s11 = "mkstemp64" fullword ascii
      $s12 = "too many arguments to script" fullword ascii
      $s13 = "lua_getiuservalue" fullword ascii
      $s14 = "  -l g=mod  require library 'mod' into global 'g'" fullword ascii
      $s15 = "=(command line)" fullword ascii
      $s16 = "(temporary)" fullword ascii
      $s17 = "(C temporary)" fullword ascii
      $s18 = "perform bitwise operation on" fullword ascii
      $s19 = "attempt to perform 'n%%0'" fullword ascii
      $s20 = "default %s file is closed" fullword ascii
      $s21 = "invalid conversion '%s' to 'format'" fullword ascii
      $s22 = "  -v        show version information" fullword ascii
      $s23 = "(skipping %d levels)" fullword ascii
      $s24 = "(error object is a %s value)" fullword ascii
      $s25 = "a;/usr/share/lua/5.4/?.lua;/usr/share/lua/5.4/?/init.lua;./?.lua;./?/init.lua" fullword ascii
      $s26 = "/usr/local/share/lua/5.4/?.lua;/usr/local/share/lua/5.4/?/init.lua;/usr/local/lib/lua/5.4/?.lua;/usr/local/lib/lua/5.4/?/init.lu" ascii
      $s27 = "/usr/local/share/lua/5.4/?.lua;/usr/local/share/lua/5.4/?/init.lua;/usr/local/lib/lua/5.4/?.lua;/usr/local/lib/lua/5.4/?/init.lu" ascii
      $s28 = "Lua 5.4.6  Copyright (C) 1994-2023 Lua.org, PUC-Rio" fullword ascii
      $s29 = "error in " fullword ascii
      $s30 = "light userdata" fullword ascii
      $s31 = "pattern too complex" fullword ascii
      $s32 = "version mismatch" fullword ascii
      $s33 = "not a binary chunk" fullword ascii
      $s34 = "error object is not a string" fullword ascii
      $s35 = "core and library have incompatible numeric types" fullword ascii
      $s36 = "aAbBcCdDeFgGhHIjmMnprRStTuUVwWxXyYzZ%||EcECExEXEyEYOdOeOHOIOmOMOSOuOUOVOwOWOy" fullword ascii
      $s37 = "charpattern" fullword ascii
      $s38 = "isyieldable" fullword ascii
      $s39 = "mininteger" fullword ascii
      $s40 = "ftransfer" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 77 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c0 24 04 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 20 00 1f 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b8 6c 00 00 00 00 00 00 b8 6c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 85 bd 02 00 00 00 00 00 85 bd 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 03 00 00 00 00 00 00 30 03 00 00 00 00 00 00 30 03 00 00 00 00 00 0c d5 00 00 00 00 00 00 0c d5 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 0a 04 00 00 00 00 00 30 1a 04 00 00 00 00 00 30 1a 04 00 00 00 00 00 d0 18 00 00 00 00 00 00 10 19 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 70 1d 04 00 00 00 00 00 70 2d 04 00 00 00 00 00 70 2d 04 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 48 69 03 00 00 00 00 00 48 69 03 00 00 00 00 00 48 69 03 00 00 00 00 00 04 17 00 00 00 00 00 00 04 17 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 0a 04 00 00 00 00 00 30 1a 04 00 00 00 00 00 30 1a 04 00 00 00 00 00 d0 15 00 00 00 00 00 00 d0 15 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 63 26 0e 1f 9f df 87 33 ee 1d 0b 84 8d 47 92 43 f9 e2 11 99 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 83 00 00 00 63 00 00 00 10 00 00 00 0a 00 00 00 40 16 00 d0 44 80 20 00 19 82 e0 19 04 18 a2 20 18 83 09 81 08 93 61 c1 80 24 71 4e 41 60 01 54 88 20 30 ae 80 0f 04 20 76 4a 2a 56 c0 22 50 44 08 03 05 24 00 80 a8 24 4a 69 a7 46 00 b0 32 30 24 b8 02 28 31 84 81 12 01 81 51 31 18 08 80 40}
condition:
      filesize < 800KB and
      8 of them and $magic
}

rule gtfobins_binaries_eqn {
   strings:
      $s1 = "usage: %s {-v | --version}" fullword ascii
      $s2 = "usage: %s --help" fullword ascii
      $s3 = "definition* definition_ptable::lookupassoc(const char**)" fullword ascii
      $s4 = "char_info* char_info_ptable::lookupassoc(const char**)" fullword ascii
      $s5 = "virtual int script_box::compute_metrics(int)" fullword ascii
      $s6 = "bad argument '%1' to space command" fullword ascii
      $s7 = "char_info* char_info_ptable::lookup(const char*)" fullword ascii
      $s8 = "definition* definition_ptable::lookup(const char*)" fullword ascii
      $s9 = "0 == \"unsupported argument conversion (not in [%123])\"" fullword ascii
      $s10 = "char& string::operator[](int)" fullword ascii
      $s11 = "0 == \"unhandled getopt_long return value\"" fullword ascii
      $s12 = "standard output stream is in an error state" fullword ascii
      $s13 = "FILE* search_path::open_file(const char*, char**)" fullword ascii
      $s14 = "const char* definition_ptable::define(const char*, definition*)" fullword ascii
      $s15 = "const char* char_info_ptable::define(const char*, char_info*)" fullword ascii
      $s16 = "../../src/preproc/eqn/script.cpp" fullword ascii
      $s17 = "long unsigned int hash_string(const char*)" fullword ascii
      $s18 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/groff-base.debug" fullword ascii
      $s19 = "/usr/lib/groff/site-tmac:/usr/share/groff/site-tmac:/usr/share/groff/1.23.0/tmac:/usr/share/groff/tmac" fullword ascii
      $s20 = "end of file while reading argument to 'delim'" fullword ascii
      $s21 = " right \"%s\"" fullword ascii
      $s22 = "06ef8899361ef620726a4d122ffdcff1a5a478.debug" fullword ascii
      $s23 = "usage: %s [-CNrR] [-d xy] [-f font] [-m n] [-M dir] [-p n] [-s n] [-T name] [file ...]" fullword ascii
      $s24 = ".if !'\\*(.T'%s' .if !'\\*(.T'html' .tm warning: %s should have been given a '-T\\*(.T' option" fullword ascii
      $s25 = ".if '\\*(.T'html' .if !'%s'ps' .tm warning: %s should have been given a '-Tps' option" fullword ascii
      $s26 = "BCCDDEEEFFFFF" ascii
      $s27 = "a delete character" fullword ascii
      $s28 = " context is" fullword ascii
      $s29 = "vcenter" fullword ascii /* Goodware String - occured 1 times */
      $s30 = "i >= 0 && i < len" fullword ascii
      $s31 = "format != 0" fullword ascii /* Goodware String - occured 1 times */
      $s32 = "!arg3.empty()" fullword ascii
      $s33 = "ATUSHcV" fullword ascii
      $s34 = "ATUSHco" fullword ascii
      $s35 = "string::string(const char*, int, const char*, int)" fullword ascii
      $s36 = "!arg2.empty()" fullword ascii
      $s37 = "void errprint(const char*, const errarg&, const errarg&, const errarg&)" fullword ascii
      $s38 = "string::string(const char*, int)" fullword ascii
      $s39 = "n1 >= 0 && n2 >= 0" fullword ascii
      $s40 = "!arg1.empty()" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 77 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c0 24 04 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 20 00 1f 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b8 6c 00 00 00 00 00 00 b8 6c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 85 bd 02 00 00 00 00 00 85 bd 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 03 00 00 00 00 00 00 30 03 00 00 00 00 00 00 30 03 00 00 00 00 00 0c d5 00 00 00 00 00 00 0c d5 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 0a 04 00 00 00 00 00 30 1a 04 00 00 00 00 00 30 1a 04 00 00 00 00 00 d0 18 00 00 00 00 00 00 10 19 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 70 1d 04 00 00 00 00 00 70 2d 04 00 00 00 00 00 70 2d 04 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 48 69 03 00 00 00 00 00 48 69 03 00 00 00 00 00 48 69 03 00 00 00 00 00 04 17 00 00 00 00 00 00 04 17 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 0a 04 00 00 00 00 00 30 1a 04 00 00 00 00 00 30 1a 04 00 00 00 00 00 d0 15 00 00 00 00 00 00 d0 15 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 63 26 0e 1f 9f df 87 33 ee 1d 0b 84 8d 47 92 43 f9 e2 11 99 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 83 00 00 00 63 00 00 00 10 00 00 00 0a 00 00 00 40 16 00 d0 44 80 20 00 19 82 e0 19 04 18 a2 20 18 83 09 81 08 93 61 c1 80 24 71 4e 41 60 01 54 88 20 30 ae 80 0f 04 20 76 4a 2a 56 c0 22 50 44 08 03 05 24 00 80 a8 24 4a 69 a7 46 00 b0 32 30 24 b8 02 28 31 84 81 12 01 81 51 31 18 08 80 40}
condition:
      filesize < 600KB and
      8 of them and $magic
}

rule gtfobins_binaries_bash {
   strings:
      $s1 = "      -x  keyseq:shell-command" fullword ascii
      $s2 = "vi-edit-and-execute-command" fullword ascii
      $s3 = "      -x  Print commands and their arguments as they are executed." fullword ascii
      $s4 = "      -n  Read commands but do not execute them." fullword ascii
      $s5 = "    Execute SHELL-BUILTIN with arguments ARGs without performing command" fullword ascii
      $s6 = "bind [-lpsvPSVX] [-m keymap] [-f filename] [-q name] [-u name] [-r keyseq] [-x keyseq:shell-command] [keyseq:readline-function o" ascii
      $s7 = "    Execute COMMAND, replacing this shell with the specified program." fullword ascii
      $s8 = "bind [-lpsvPSVX] [-m keymap] [-f filename] [-q name] [-u name] [-r keyseq] [-x keyseq:shell-command] [keyseq:readline-function o" ascii
      $s9 = "      -t  Exit after reading and executing one command." fullword ascii
      $s10 = "    Exits a login shell with exit status N.  Returns an error if not executed" fullword ascii
      $s11 = "_rl_command_to_execute" fullword ascii
      $s12 = "    execute a disk command which has the same name as a shell builtin" fullword ascii
      $s13 = "    All file operators except -h and -L are acting on the target of a symbolic" fullword ascii
      $s14 = "execute_array_command" fullword ascii
      $s15 = "echo_command_at_execute" fullword ascii
      $s16 = "    Execute PIPELINE and print a summary of the real time, user CPU time," fullword ascii
      $s17 = "execute_command_internal" fullword ascii
      $s18 = "execute_variable_command" fullword ascii
      $s19 = "    Execute COMMAND asynchronously, with the standard output and standard" fullword ascii
      $s20 = "      -v    print a description of COMMAND similar to the `type' builtin" fullword ascii
      $s21 = "    If the -p option is supplied, the process or job identifier of the job" fullword ascii
      $s22 = "${FCEDIT:-${EDITOR:-$(command -v editor || echo vi)}}" fullword ascii
      $s23 = "    last command executed within the function or script." fullword ascii
      $s24 = "fc -e \"${VISUAL:-${EDITOR:-$(command -v editor || echo vi)}}\"" fullword ascii
      $s25 = "force the suspend, even if the shell is a login shell or job" fullword ascii
      $s26 = "    ARG is a command to be read and executed when the shell receives the" fullword ascii
      $s27 = "    Read and execute commands from FILENAME in the current shell.  The" fullword ascii
      $s28 = "${FCEDIT:-${EDITOR:-$(command -v editor || echo ed)}}" fullword ascii
      $s29 = "    If the command cannot be executed, a non-interactive shell exits, unless" fullword ascii
      $s30 = "fc -e \"${VISUAL:-${EDITOR:-$(command -v editor || echo emacs)}}\"" fullword ascii
      $s31 = "-ilrsD or -c command or -O shopt_option" fullword ascii
      $s32 = "    runs the last command beginning with `cc' and typing `r' re-executes" fullword ascii
      $s33 = "    Returns success or status of executed command; non-zero if an error occurs." fullword ascii
      $s34 = "    Returns the status of the last command executed in FILENAME; fails if" fullword ascii
      $s35 = "executing_command_builtin" fullword ascii
      $s36 = "command_execution_string" fullword ascii
      $s37 = "    executed commands.  If VALUE is supplied, assign VALUE before exporting." fullword ascii
      $s38 = "    shell and by the commands it invokes." fullword ascii
      $s39 = "      -P  If set, do not resolve symbolic links when executing commands" fullword ascii
      $s40 = "r readline-command]" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 17 03 00 00 00 00 00 40 00 00 00 00 00 00 00 b0 c8 13 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 ef 02 00 00 00 00 00 10 ef 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 f0 02 00 00 00 00 00 00 f0 02 00 00 00 00 00 00 f0 02 00 00 00 00 00 21 88 0c 00 00 00 00 00 21 88 0c 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 0f 00 00 00 00 00 00 80 0f 00 00 00 00 00 00 80 0f 00 00 00 00 00 64 7e 03 00 00 00 00 00 64 7e 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 0a 13 00 00 00 00 00 70 0a 13 00 00 00 00 00 70 0a 13 00 00 00 00 00 f4 bc 00 00 00 00 00 00 50 6d 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e8 35 13 00 00 00 00 00 e8 35 13 00 00 00 00 00 e8 35 13 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d0 1e 11 00 00 00 00 00 d0 1e 11 00 00 00 00 00 d0 1e 11 00 00 00 00 00 14 47 00 00 00 00 00 00 14 47 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 0a 13 00 00 00 00 00 70 0a 13 00 00 00 00 00 70 0a 13 00 00 00 00 00 90 35 00 00 00 00 00 00 90 35 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 6d 3e 22 a3 92 19 1f 46 84 45 f0 af 0c bb d8 ab ee d8 f5 b1 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 05 08 00 00 e1 00 00 00 00 01 00 00 0e 00 00 00 09 30 34 06 0c 00 00 00 04 23 21 4a 05 05 00 04 7a 64 12 86 94 41 50 0f e1 00 44 44 00 42 20 12 00 84 03 80 10 44 80 01 00 09 01 80 80 00 40 f0 02 15 00 41 03 12 4a 8c 81 21 10 49 68 04 c4 4d 00 08 15 40 1c 00 69 01 00 06 22 00 72 80 0a 36}
condition:
      filesize < 4000KB and
      8 of them and $magic
}

rule gtfobins_binaries_task {
   strings:
      $s1 = "If you're interested in more release highlights, run 'task news {3}u want to prepend to all pending recurrences of Prepending to" ascii
      $s2 = "Executes external commands and scripts" fullword ascii
      $s3 = "eted.leted - task belongs in pending.ongs in completeleted - task remTDB::revert_backlog - task found in backlog.datacolor.undo." ascii
      $s4 = "allow.empty.filtThis command has no filter, and will modify all (including completed and deleted) tasks.  Are yoFiltered {1} tas" ascii
      $s5 = " abbreviation.minimum active.indicator allow.empty.filter avoidlastcolumn bulk calendar.details calendar.details.report calendar" ascii
      $s6 = "[48;5rgb500 on rgb100rgb550 on rgb220rgb050 on rgb010TDB::revert - task found in pendTDB::revert_completed - task found in compl" ascii
      $s7 = "# Aliases - alternate names for commands" fullword ascii
      $s8 = "report.completed.labels=ID,UUID,Created,Completed,Age,Deps,P,Project,Tags,R,Due,Description" fullword ascii
      $s9 = "report.completed.description=Completed tasks" fullword ascii
      $s10 = "_ZN11CmdCommands7executeERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s11 = "report.completed.columns=id,uuid.short,entry,end,entry.age,depends,priority,project,tags,recur.indicator,due,description" fullword ascii
      $s12 = "_ZN6CmdGet7executeERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s13 = "_ZN7CmdLogo7executeERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s14 = "_ZN21CmdCompletionCommands7executeERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s15 = "_ZN6CmdLog7executeERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s16 = "_ZN14CmdZshCommands7executeERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s17 = "_ZNSt8__detail9_ExecutorIN9__gnu_cxx17__normal_iteratorIPKcNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEEESaINS5_9sub_mat" ascii
      $s18 = "_ZNSt8__detail9_ExecutorIN9__gnu_cxx17__normal_iteratorIPKcNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEEESaINS5_9sub_mat" ascii
      $s19 = "# Use the command 'task show' to see all defaults and overrides" fullword ascii
      $s20 = "_ZN7CmdExec7executeERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s21 = "_ZN10CmdReports7executeERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s22 = "_ZN20CmdCompletionVersion7executeERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s23 = "_ZN10CmdVersion7executeERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s24 = "No command specified - assuming 'information'." fullword ascii
      $s25 = "'{1}'Hook Error: JSON Object '{...}' expected from hohook script: {1} Object missing 'description' attribute from hoo'uuid' attr" ascii
      $s26 = "lendar.weeknumber color.completed color.debug color.deleted color.due color.due.today color.warning color.error color.footnote c" ascii
      $s27 = "_ZN9CmdImport7executeERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s28 = "_ZN9CmdExport7executeERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s29 = "The logo command requires that color support is enabled." fullword ascii
      $s30 = "_ZTV7CmdExec" fullword ascii
      $s31 = "_ZN7CmdExecD1Ev" fullword ascii
      $s32 = "_ZN7CmdExecD2Ev" fullword ascii
      $s33 = "_ZN7CmdExecD0Ev" fullword ascii
      $s34 = "_ZTS7CmdExec" fullword ascii
      $s35 = "7CmdExec" fullword ascii
      $s36 = "report.all.description=All tasks" fullword ascii
      $s37 = "r debug.tls default.command default.due default.project default.scheduled defaultheight defaultwidth default.timesheet.filter de" ascii
      $s38 = "default.command" fullword ascii
      $s39 = "report.unblocked.columns=id,depends,project,priority,due,start.active,entry.age,description" fullword ascii
      $s40 = "report.blocked.columns=id,depends,project,priority,due,start.active,entry.age,description" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 5b 07 00 00 00 00 00 40 00 00 00 00 00 00 00 a0 46 29 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 18 83 04 00 00 00 00 00 18 83 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 90 04 00 00 00 00 00 00 90 04 00 00 00 00 00 00 90 04 00 00 00 00 00 21 4b 1e 00 00 00 00 00 21 4b 1e 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 22 00 00 00 00 00 00 e0 22 00 00 00 00 00 00 e0 22 00 00 00 00 00 30 05 06 00 00 00 00 00 30 05 06 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 68 ee 28 00 00 00 00 00 68 fe 28 00 00 00 00 00 68 fe 28 00 00 00 00 00 d8 56 00 00 00 00 00 00 98 6e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 00 26 29 00 00 00 00 00 00 36 29 00 00 00 00 00 00 36 29 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 00 5d 24 00 00 00 00 00 00 5d 24 00 00 00 00 00 00 5d 24 00 00 00 00 00 ac 62 00 00 00 00 00 00 ac 62 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 68 ee 28 00 00 00 00 00 68 fe 28 00 00 00 00 00 68 fe 28 00 00 00 00 00 98 41 00 00 00 00 00 00 98 41 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 31 b3 91 36 d5 2e fd 82 85 51 02 96 9d f2 9d 4e 85 a1 d8 75 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 05 08 00 00 f7 00 00 00 00 01 00 00 0e 00 00 00 81 9f 02 52 10 78 3d 60 06 01 16 5a 20 13 08 0a 28 18 c2 21 60 30 0b 9a 01 e0 02 08 00 26 44 00 26 20 a2 89 b4 68 0d 01 5a 80 04 00 00 41 80 40 14 90 5a 95 cf 10 83 02 00 29 00 18 70 21 80 28 08 02 01 10 81 c0 01 30 3a a8 88 11 01 91 26 00}
condition:
      filesize < 8000KB and
      8 of them and $magic
}

rule gtfobins_binaries_rtorrent {
   strings:
      $s1 = "d.try_close= ;d.ignore_commands.Invalid bencode  in raw_bencode.queries_receivedreplies_receivedconnection_leechtimestamp.starte" ascii
      $s2 = "method.set_key = event.download.hash_done, !_timestamp, {(branch,((d.complete)),((d.timestamp.finished.set_if_z,(system.time))))" ascii
      $s3 = "method.set_key = event.download.hash_done, !_timestamp, {(branch,((d.complete)),((d.timestamp.finished.set_if_z,(system.time))))" ascii
      $s4 = "log.execute" fullword ascii
      $s5 = "ExecFile::execute(...) Pipe creation failed." fullword ascii
      $s6 = "view.filter.temp.log.set" fullword ascii
      $s7 = "view.filter.temp.log" fullword ascii
      $s8 = "St5_BindIFPFPN7torrent4PeerEPN4core8DownloadERKNS0_10HashStringEESt12_PlaceholderILi1EESB_ILi2EEEE" fullword ascii
      $s9 = "_ZN7torrent25resume_check_target_filesENS_8DownloadERKNS_6ObjectE" fullword ascii
      $s10 = "St24_Weak_result_type_memfunIPFPN7torrent4PeerEPN4core8DownloadERKNS0_10HashStringEELb0EE" fullword ascii
      $s11 = "19object_convert_typeISt5_BindIFPFvPN4core8DownloadERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEESt12_PlaceholderILi1E" ascii
      $s12 = "St5_BindIFPFN7torrent6ObjectEPN4core8DownloadERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEbESt12_PlaceholderILi1EESF_I" ascii
      $s13 = "_ZN7torrent21resume_load_addressesENS_8DownloadERKNS_6ObjectE" fullword ascii
      $s14 = "St5_BindIFPFN7torrent6ObjectEPN4core8DownloadERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEbESt12_PlaceholderILi1EESF_I" ascii
      $s15 = "_ZN7torrent21resume_save_addressesENS_8DownloadERNS_6ObjectE" fullword ascii
      $s16 = "St22_Weak_result_type_implIPFPN7torrent4PeerEPN4core8DownloadERKNS0_10HashStringEEE" fullword ascii
      $s17 = "log.vmmap.dump" fullword ascii
      $s18 = "19object_convert_typeISt5_BindIFPFvPN4core8DownloadERKN7torrent6ObjectEESt12_PlaceholderILi1EESA_ILi2EEEEvE" fullword ascii
      $s19 = "St5_BindIFPFN7torrent6ObjectEPN4core8DownloadERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEPKcSE_ESt12_PlaceholderILi1E" ascii
      $s20 = "19object_convert_typeISt5_BindIFPFvPN4core8DownloadERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEESt12_PlaceholderILi1E" ascii
      $s21 = "St17_Weak_result_typeIPFPN7torrent4PeerEPN4core8DownloadERKNS0_10HashStringEEE" fullword ascii
      $s22 = "St5_BindIFPFN7torrent6ObjectEPN4core8DownloadERKS1_PKcS8_ESt12_PlaceholderILi1EESB_ILi2EES8_S8_EE" fullword ascii
      $s23 = "St5_BindIFPFN7torrent6ObjectEPN4core8DownloadERKSt6vectorIS1_SaIS1_EEESt12_PlaceholderILi1EESC_ILi2EEEE" fullword ascii
      $s24 = "method.insert = event.download.hash_final_failed,multi|rlookup|static" fullword ascii
      $s25 = "St5_BindIFPFN7torrent6ObjectEPN4core8DownloadERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEESt12_PlaceholderILi1EESF_IL" ascii
      $s26 = "St5_BindIFPFN7torrent6ObjectEPN4core8DownloadERKlPKcS8_ESt12_PlaceholderILi1EESB_ILi2EES8_S8_EE" fullword ascii
      $s27 = "method.insert = event.download.hash_failed,multi|rlookup|static" fullword ascii
      $s28 = "St5_BindIFPFN7torrent6ObjectEPN4core8DownloadERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEPKcSE_ESt12_PlaceholderILi1E" ascii
      $s29 = "St5_BindIFPFN7torrent6ObjectEPN4core8DownloadERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEESt12_PlaceholderILi1EESF_IL" ascii
      $s30 = "Could not open fReading torrent rent file failedDownload registered as completed, but hash check returned unfinifinished chunks." ascii
      $s31 = "St5_BindIFPFN7torrent6ObjectEPN4core8DownloadERKSt6vectorIS1_SaIS1_EEiESt12_PlaceholderILi1EESC_ILi2EEiEE" fullword ascii
      $s32 = "Unsupported target type found." fullword ascii
      $s33 = "Processing meta download." fullword ascii
      $s34 = "ExecFile::execute(...) Fork failed." fullword ascii
      $s35 = "execute.raw.bg" fullword ascii
      $s36 = "execute.raw" fullword ascii
      $s37 = "ExecFile::execute(...) waitpid failed." fullword ascii
      $s38 = "St22_Weak_result_type_implIPFN7torrent6ObjectEPN4core8DownloadERKSt6vectorIS1_SaIS1_EEEE" fullword ascii
      $s39 = "St24_Weak_result_type_memfunIPFN7torrent6ObjectEPN4core8DownloadERKSt6vectorIS1_SaIS1_EEiELb0EE" fullword ascii
      $s40 = "St22_Weak_result_type_implIPFN7torrent6ObjectEPN4core8DownloadERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEEE" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 72 04 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 a3 18 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 70 c7 01 00 00 00 00 00 70 c7 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 d0 01 00 00 00 00 00 00 d0 01 00 00 00 00 00 00 d0 01 00 00 00 00 00 11 89 11 00 00 00 00 00 11 89 11 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 60 13 00 00 00 00 00 00 60 13 00 00 00 00 00 00 60 13 00 00 00 00 00 6c d3 04 00 00 00 00 00 6c d3 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 28 3a 18 00 00 00 00 00 28 4a 18 00 00 00 00 00 28 4a 18 00 00 00 00 00 28 68 00 00 00 00 00 00 e8 81 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 10 8b 18 00 00 00 00 00 10 9b 18 00 00 00 00 00 10 9b 18 00 00 00 00 00 70 02 00 00 00 00 00 00 70 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c8 1d 15 00 00 00 00 00 c8 1d 15 00 00 00 00 00 c8 1d 15 00 00 00 00 00 94 55 00 00 00 00 00 00 94 55 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 28 3a 18 00 00 00 00 00 28 4a 18 00 00 00 00 00 28 4a 18 00 00 00 00 00 d8 55 00 00 00 00 00 00 d8 55 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 a1 09 41 a1 80 92 93 c1 ef 9a 71 12 70 cf 13 41 4a e8 9a 1a 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 83 00 00 00 e7 01 00 00 10 00 00 00 0a 00 00 00 40 2f d1 a1 d7 20 ab a0 c4 40 80 05 60 a0 8c 8a 80 00 2c cb a5 02 88 80 38 00 04 80 10 18 40 70 00 29 0b 80 03 2c 39 52 cc 11 10 20 72 08 ac 82 8f 10 d2 54 6a 11 47 4d 78 12 61 6a 0d 20 db 63 10 0e 59 00 00 48 96 46 e4 c5 80 80 86 8c 8e 84}
condition:
      filesize < 5000KB and
      8 of them and $magic
}

rule gtfobins_binaries_check_by_ssh {
   strings:
      $x1 = "%s - check_by_ssh: Remote command execution failed: %s" fullword ascii
      $s2 = "This plugin uses SSH to execute commands on a remote host" fullword ascii
      $s3 = "command to execute on the remote machine" fullword ascii
      $s4 = "execute additional commands as proxy" fullword ascii
      $s5 = "%s - check_by_ssh: Remote command '%s' returned status %d" fullword ascii
      $s6 = " %s -H <host> -C <command> [-fqv] [-1|-2] [-4|-6]" fullword ascii
      $s7 = "%s: In passive mode, you must provide a service name for each command." fullword ascii
      $s8 = "[%d] PROCESS_SERVICE_CHECK_RESULT;%s;%s;%d;%s" fullword ascii
      $s9 = "Invalid hostname/address - %s" fullword ascii
      $s10 = "-C, --command='COMMAND STRING'" fullword ascii
      $s11 = "$ check_by_ssh -H localhost -n lh -s c1:c2:c3 -C uptime -C uptime -C uptime -O /tmp/foo" fullword ascii
      $s12 = "%s: In passive mode, you must provide the host short name from the nagios configs." fullword ascii
      $s13 = " -H, --hostname=ADDRESS" fullword ascii
      $s14 = "-l, --logname=USERNAME" fullword ascii
      $s15 = "sha1_process_bytes" fullword ascii
      $s16 = "[1080933700] PROCESS_SERVICE_CHECK_RESULT;flint;c2;0; up 2 days" fullword ascii
      $s17 = "process_tcp_request2" fullword ascii
      $s18 = "file of the remote host. Usually the key will be restricted to running" fullword ascii
      $s19 = "[1080933700] PROCESS_SERVICE_CHECK_RESULT;flint;c1;0; up 2 days" fullword ascii
      $s20 = "[1080933700] PROCESS_SERVICE_CHECK_RESULT;flint;c3;0; up 2 days" fullword ascii
      $s21 = "SSH user name on remote host [optional]" fullword ascii
      $s22 = "Copyright (c) 1999 Karl DeBisschop <kdebisschop@users.sourceforge.net>" fullword ascii
      $s23 = "ProxyCommand" fullword ascii
      $s24 = "process_request" fullword ascii
      $s25 = "only one command on the remote server. If the remote SSH server tracks" fullword ascii
      $s26 = "Invalid character for keyname - only alphanumerics or '_'" fullword ascii
      $s27 = "process_arguments" fullword ascii
      $s28 = "all of -O, -s, and -n options (servicelist order must match '-C'options)" fullword ascii
      $s29 = "%s: %s - %s" fullword ascii
      $s30 = "%s: %s - %c" fullword ascii
      $s31 = "temp_keyname" fullword ascii
      $s32 = "Error writing temp file" fullword ascii
      $s33 = "tells ssh to fork rather than create a tty [optional]. This will always return OK if ssh is executed" fullword ascii
      $s34 = "remotecmd" fullword ascii
      $s35 = " -%c, --port=INTEGER" fullword ascii
      $s36 = "idpriv-droptemp.c" fullword ascii
      $s37 = "idpriv_temp_drop.cold" fullword ascii
      $s38 = "passphrase and the public key should be listed in the authorized_keys" fullword ascii
      $s39 = "idpriv_temp_drop" fullword ascii
      $s40 = "Error opening %s: %s" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 c0 3a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 20 b0 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 27 00 26 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 90 22 00 00 00 00 00 00 90 22 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 a1 67 00 00 00 00 00 00 a1 67 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 1c 31 00 00 00 00 00 00 1c 31 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 c0 dd 00 00 00 00 00 00 c0 ed 00 00 00 00 00 00 c0 ed 00 00 00 00 00 00 b0 09 00 00 00 00 00 00 80 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d0 dd 00 00 00 00 00 00 d0 ed 00 00 00 00 00 00 d0 ed 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 18 bd 00 00 00 00 00 00 18 bd 00 00 00 00 00 00 18 bd 00 00 00 00 00 00 24 03 00 00 00 00 00 00 24 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 c0 dd 00 00 00 00 00 00 c0 ed 00 00 00 00 00 00 c0 ed 00 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 25 67 aa 06 2f 7a 6c 1b cc d9 cf ec 94 f2 61 49 c6 3a f5 5c 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 68 00 00 00 01 00 00 00 06 00 00 00 10 04 a1 00 c0 01 5c 00 68 00 00 00 6b 00 00 00 6d 00 00 00 28 1d 8c 1c d0 65 ce 6d a7 dd a3 6b c4 b9 9c 40 67 55 61 10 b2 a2 f7 12 33 c4 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 13 03 00 00 12 00 00 00}
condition:
      filesize < 500KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_emacs {
   strings:
      $s1 = "dump file is result of failed dump attempt" fullword ascii
      $s2 = "process-command" fullword ascii
      $s3 = "Attempt to get process for a dead buffer" fullword ascii
      $s4 = "Attempt to accept output from process %s locked to thread %s" fullword ascii
      $s5 = "Attempt to autoload %s while preparing to dump" fullword ascii
      $s6 = "process %s no longer connected to pipe; closed it" fullword ascii
      $s7 = "TF LIBSELINUX LIBSYSTEMD LIBXML2 M17N_FLT MODULES NATIVE_COMP NOTIFY INOTIFY PDUMPER PNG RSVG SECCOMP SOUND SQLITE3 THREADS TIFF" ascii
      $s8 = "command-line-processed" fullword ascii
      $s9 = "command-execute" fullword ascii
      $s10 = "No command line arguments known; unable to re-execute Emacs" fullword ascii
      $s11 = "Module assertions are not supported during dumping" fullword ascii
      $s12 = "Dumping fingerprint" fullword ascii
      $s13 = "could not load dump file \"%s\": %s" fullword ascii
      $s14 = "--build x86_64-linux-gnu --prefix=/usr --sharedstatedir=/var/lib --libexecdir=/usr/libexec --localstatedir=/var/lib --infodir=/u" ascii
      $s15 = "Dumping Emacs currently works only in batch mode.  If you'd like it to work interactively, please consider contributing a patch " ascii
      $s16 = "Incoherent compilation unit for dump was dumped" fullword ascii
      $s17 = "Dumping Emacs currently works only in batch mode.  If you'd like it to work interactively, please consider contributing a patch " ascii
      $s18 = "pthread_mutex_init failed: %s" fullword ascii
      $s19 = "DUMPEDGNL" fullword ascii
      $s20 = "DUMPEDGNUEMACS" fullword ascii
      $s21 = "Error using execdir %s:" fullword ascii
      $s22 = "fixup object not dumped" fullword ascii
      $s23 = "not a dump file" fullword ascii
      $s24 = "get-process" fullword ascii
      $s25 = "make client process failed" fullword ascii
      $s26 = "get-buffer-process" fullword ascii
      $s27 = "make server process failed" fullword ascii
      $s28 = " MODULES NATIVE_COMP NOTIFY INOTIFY PDUMPER PNG RSVG SECCOMP SOUND SQLITE3 THREADS TIFF TOOLKIT_SCROLL_BARS TREE_SITTER WEBP X11" ascii
      $s29 = "bignum not dumped" fullword ascii
      $s30 = "this-single-command-raw-keys" fullword ascii
      $s31 = "clear-this-command-keys" fullword ascii
      $s32 = "this-command-keys-vector" fullword ascii
      $s33 = "read-command" fullword ascii
      $s34 = "$Id: GNU Emacs 29.4 (x86_64-pc-linux-gnu ACL CAIRO DBUS FREETYPE GIF GLIB GMP GNUTLS GPM GSETTINGS HARFBUZZ JPEG JSON LCMS2 LIBO" ascii
      $s35 = "processp" fullword ascii
      $s36 = "unread-command-events" fullword ascii
      $s37 = "this-command-keys-shift-translated" fullword ascii
      $s38 = "substitute-command-keys" fullword ascii
      $s39 = "libgccjit.log" fullword ascii
      $s40 = "set--this-command-keys" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 90 05 00 00 00 00 00 40 00 00 00 00 00 00 00 70 10 7f 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 58 57 04 00 00 00 00 00 58 57 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 60 04 00 00 00 00 00 00 60 04 00 00 00 00 00 00 60 04 00 00 00 00 00 69 0a 2a 00 00 00 00 00 69 0a 2a 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 2e 00 00 00 00 00 00 70 2e 00 00 00 00 00 00 70 2e 00 00 00 00 00 20 90 07 00 00 00 00 00 20 90 07 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 06 36 00 00 00 00 00 d0 16 36 00 00 00 00 00 d0 16 36 00 00 00 00 00 48 08 49 00 00 00 00 00 e0 f1 53 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c0 a9 36 00 00 00 00 00 c0 b9 36 00 00 00 00 00 c0 b9 36 00 00 00 00 00 e0 04 00 00 00 00 00 00 e0 04 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 a0 ee 30 00 00 00 00 00 a0 ee 30 00 00 00 00 00 a0 ee 30 00 00 00 00 00 04 c5 00 00 00 00 00 00 04 c5 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 06 36 00 00 00 00 00 d0 16 36 00 00 00 00 00 d0 16 36 00 00 00 00 00 30 a9 00 00 00 00 00 00 30 a9 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 f0 69 8c b7 7a 4c d2 4a c0 d8 ab 5a c4 a8 43 c9 33 a3 5d 5f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 25 00 00 00 3b 06 00 00 04 00 00 00 08 00 00 00 00 04 40 20 81 05 0c 42 ae 40 20 08 f0 03 50 12 80 86 77 60 58 0c 28 48 36 02 21 13 b2 80 16 13 3b 06 00 00 00 00 00 00 3c 06 00 00 3d 06 00 00 00 00 00 00 3f 06 00 00 00 00 00 00 41 06 00 00 42 06 00 00 00 00 00 00 00 00 00 00 43 06 00 00}
condition:
      filesize < 24000KB and
      8 of them and $magic
}

rule gtfobins_binaries_nm {
   strings:
      $s1 = "  -C, --demangle[=STYLE] Decode mangled/processed symbol names" fullword ascii
      $s2 = "bfd_set_default_target" fullword ascii
      $s3 = "bfd_target_list" fullword ascii
      $s4 = "      --target=BFDNAME   Specify the target object format as BFDNAME" fullword ascii
      $s5 = "                         Specify how to treat UTF-8 encoded unicode characters" fullword ascii
      $s6 = "<https://sourceware.org/bugzilla/>" fullword ascii
      $s7 = "{\"type\":\"deb\",\"os\":\"debian\",\"name\":\"binutils\",\"version\":\"2.42.90.20240720-2\",\"architecture\":\"amd64\"}" fullword ascii
      $s8 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/binutils-x86-64-linux-gnu.debug" fullword ascii
      $s9 = "%s: error: @-file refers to a directory" fullword ascii
      $s10 = "bfd_get_error" fullword ascii
      $s11 = "bfd_get_arch_size" fullword ascii
      $s12 = "bfd_get_next_mapent" fullword ascii
      $s13 = "bfd_get_reloc_upper_bound" fullword ascii
      $s14 = "  -A, --print-file-name  Print name of the input file before every symbol" fullword ascii
      $s15 = "invalid argument to -U/--unicode: %s" fullword ascii
      $s16 = "fatal error: libbfd ABI mismatch" fullword ascii
      $s17 = "libbfd-2.42.90-system.20240720.so" fullword ascii
      $s18 = "Warning: '%s' is a directory" fullword ascii
      $s19 = "bfd_set_error_program_name" fullword ascii
      $s20 = "(GNU Binutils for Debian) 2.42.90.20240720" fullword ascii
      $s21 = "  -e                     (ignored)" fullword ascii
      $s22 = "  -o                     Same as -A" fullword ascii
      $s23 = "<unknown>: %d/%d" fullword ascii
      $s24 = "with-symbol-versions" fullword ascii
      $s25 = "without-symbol-versions" fullword ascii
      $s26 = " List symbols in [file(s)] (a.out by default)." fullword ascii
      $s27 = "%s: plugin needed to handle lto object" fullword ascii
      $s28 = "  -V, --version          Display this program's version number" fullword ascii
      $s29 = "  -P, --portability      Same as --format=posix" fullword ascii
      $s30 = "      --without-symbol-versions  Do not display version strings after symbol names" fullword ascii
      $s31 = "cause of error unknown" fullword ascii
      $s32 = " The options are:" fullword ascii
      $s33 = "bfd_openr_next_archived_file" fullword ascii
      $s34 = "bfd_check_format" fullword ascii
      $s35 = "bfd_plugin_set_program_name" fullword ascii
      $s36 = "bfd_plugin_set_plugin" fullword ascii
      $s37 = "bfd_check_format_matches" fullword ascii
      $s38 = "Copyright (C) 2024 Free Software Foundation, Inc." fullword ascii
      $s39 = "aABCDef:gHhjJlnopPrSst:uUvVvWX:" fullword ascii
      $s40 = "bfd_demangle" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 56 00 00 00 00 00 00 40 00 00 00 00 00 00 00 a8 a8 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d0 1e 00 00 00 00 00 00 d0 1e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 d9 46 00 00 00 00 00 00 d9 46 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 f0 23 00 00 00 00 00 00 f0 23 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 9c 00 00 00 00 00 00 b0 ac 00 00 00 00 00 00 b0 ac 00 00 00 00 00 00 70 0a 00 00 00 00 00 00 40 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 80 9d 00 00 00 00 00 00 80 ad 00 00 00 00 00 00 80 ad 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 bc 00 00 00 00 00 00 00 bc 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c0 88 00 00 00 00 00 00 c0 88 00 00 00 00 00 00 c0 88 00 00 00 00 00 00 f4 01 00 00 00 00 00 00 f4 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 9c 00 00 00 00 00 00 b0 ac 00 00 00 00 00 00 b0 ac 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 f9 a0 aa 25 57 31 7b 21 2d 46 61 dd 07 3e fe 9a 84 b0 ab 3a 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 68 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 64 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 62 69 6e 75 74 69 6c 73 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 32 2e 39 30 2e 32 30 32 34 30 37 32 30 2d 32 22 2c 22 61 72 63 68 69 74}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_nmap {
   strings:
      $x1 = "Even though your Zombie (%s; %s) appears to be vulnerable to IP ID sequence prediction (class: %s), our attempts have failed.  T" ascii
      $s2 = "*WINDOWS:  Nmap only supports ethernet interfaces on Windows for most operations because Microsoft disabled raw sockets as of Wi" ascii
      $s3 = "Your argument to -b is b0rked. Use the normal url style:  user:pass@server:port or just use server and use default anon login" fullword ascii
      $s4 = "Your FTP bounce server refused login combo (%s/%s)" fullword ascii
      $s5 = "*WINDOWS:  Nmap only supports ethernet interfaces on Windows for most operations because Microsoft disabled raw sockets as of Wi" ascii
      $s6 = "_Z22printhostscriptresultsPK6Target" fullword ascii
      $s7 = "Login credentials accepted by FTP server!" fullword ascii
      $s8 = "Attempting connection to ftp://%s:%s@%s:%i" fullword ascii
      $s9 = "Even though your Zombie (%s; %s) appears to be vulnerable to IP ID sequence prediction (class: %s), our attempts have failed.  T" ascii
      $s10 = " *BSD:  If you are getting device not configured, you need to recompile your kernel with Berkeley Packet Filter support.  If you" ascii
      $s11 = "*BSD:  If you are getting device not configured, you need to recompile your kernel with Berkeley Packet Filter support.If you ar" ascii
      $s12 = "Warning: Servicescan failed to fill ostype_template (subjectlen: %lu, ostypelen: %lu). Capture exceeds length? Match string was " ascii
      $s13 = "Warning: Servicescan failed to fill info_template (subjectlen: %lu, infolen: %lu). Capture exceeds length? Match string was line" ascii
      $s14 = "%s: parse error on line %d of nmap-service-probes - must begin with \"match\" or \"softmatch\"" fullword ascii
      $s15 = "Warning: Servicescan failed to fill devicetype_template (subjectlen: %lu, devicetypelen: %lu). Too long? Match string was line %" ascii
      $s16 = "Warning: Servicescan failed to fill hostname_template (subjectlen: %lu, hostnamelen: %lu). Capture exceeds length? Match string " ascii
      $s17 = "Warning: Servicescan failed to fill version_template (subjectlen: %lu, versionlen: %lu). Capture exceeds length? Match string wa" ascii
      $s18 = "Warning: Servicescan failed to fill product_template (subjectlen: %lu, productlen: %lu). Capture exceeds length? Match string wa" ascii
      $s19 = "Failed to convert target address to presentation format in %s!?!  Error: %s" fullword ascii
      $s20 = "  --host-timeout <time>: Give up on target after this long" fullword ascii
      $s21 = "  -iR <num hosts>: Choose random targets" fullword ascii
      $s22 = "Error executing command" fullword ascii
      $s23 = "  -sL: List Scan - simply list targets to scan" fullword ascii
      $s24 = "%s: Failed to determine dst MAC address for target %s" fullword ascii
      $s25 = "Nmap wishes you a merry Christmas! Specify -sX for Xmas Scan (https://nmap.org/book/man-port-scanning-techniques.html)." fullword ascii
      $s26 = "WARNING: Your decoys won't be used in the Idlescan portion of your scanning (although all packets sent to the target are spoofed" ascii
      $s27 = "Skipping Idle Scan against %s -- you can't idle scan your own machine (localhost)." fullword ascii
      $s28 = "Strange SO_ERROR from connection to %s (%d - '%s') -- bailing scan" fullword ascii
      $s29 = "_ZN6FPHost16getTargetAddressEv" fullword ascii
      $s30 = "host is not being processed right now" fullword ascii
      $s31 = "WARNING: idle scan has erroneously detected phantom ports -- is the proxy %s (%s) really idle?" fullword ascii
      $s32 = "ndows XP SP2.  Depending on the reason for this error, it is possible that the --unprivileged command-line argument will help." fullword ascii
      $s33 = "  -A: Enable OS detection, version detection, script scanning, and traceroute" fullword ascii
      $s34 = "Hint: if your bounce scan target hosts aren't reachable from here, remember to use -Pn so we don't try and ping them prior to th" ascii
      $s35 = "could not get hostkey hash" fullword ascii
      $s36 = "ndows XP SP2. Depending on the reason for this error, it is possible that the --unprivileged command-line argument will help." fullword ascii
      $s37 = "WARNING: Your decoys won't be used in the Idlescan portion of your scanning (although all packets sent to the target are spoofed" ascii
      $s38 = "ERROR: adding targets is disabled in the Post-scanning phase." fullword ascii
      $s39 = "Hint: if your bounce scan target hosts aren't reachable from here, remember to use -Pn so we don't try and ping them prior to th" ascii
      $s40 = "Adjusting timing -- idlescan_countopen correctly found %d open ports (out of %d, starting with %hu)" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 8a 03 00 00 00 00 00 40 00 00 00 00 00 00 00 b0 b6 2b 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a0 2f 03 00 00 00 00 00 a0 2f 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 03 00 00 00 00 00 00 30 03 00 00 00 00 00 00 30 03 00 00 00 00 00 49 35 0c 00 00 00 00 00 49 35 0c 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 0f 00 00 00 00 00 00 70 0f 00 00 00 00 00 00 70 0f 00 00 00 00 00 a7 5b 04 00 00 00 00 00 a7 5b 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 cb 13 00 00 00 00 00 f0 db 13 00 00 00 00 00 f0 db 13 00 00 00 00 00 60 e9 17 00 00 00 00 00 00 5f 1a 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 60 fd 13 00 00 00 00 00 60 0d 14 00 00 00 00 00 60 0d 14 00 00 00 00 00 a0 02 00 00 00 00 00 00 a0 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 00 b3 11 00 00 00 00 00 00 b3 11 00 00 00 00 00 00 b3 11 00 00 00 00 00 74 49 00 00 00 00 00 00 74 49 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 cb 13 00 00 00 00 00 f0 db 13 00 00 00 00 00 f0 db 13 00 00 00 00 00 10 44 00 00 00 00 00 00 10 44 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 bc cb 7b 30 2c 8f eb 11 86 c9 d0 0a 4f be bf 3d ed 36 a8 b6 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 07 04 00 00 f7 01 00 00 00 01 00 00 0e 00 00 00 4c 04 80 01 60 00 86 0e 0a 0c 22 13 34 64 12 49 00 68 08 68 00 16 00 02 09 82 47 80 b1 28 61 04 90 85 53 3b 30 50 b0 28 0a 85 20 48 00 00 00 23 45 00 02 04 04 c8 00 40 11 11 c6 00 10 24 14 41 e2 02 14 02 45 03 00 10 20 00 04 30 00 4d 08 11}
condition:
      filesize < 8000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_make {
   strings:
      $s1 = "execute_file_commands" fullword ascii
      $s2 = "target-specific order-only second-expansion else-if shortest-stem undefine oneshell nocomment grouped-target extra-prereqs archi" ascii
      $s3 = "target-specific order-only second-expansion else-if shortest-stem undefine oneshell nocomment grouped-target extra-prereqs archi" ascii
      $s4 = "Target file '%s' needs to be remade under -q." fullword ascii
      $s5 = "exec_command" fullword ascii
      $s6 = "warning: overriding group membership for target '%s'" fullword ascii
      $s7 = "Cleaning up temp batch file %s failed (%d)" fullword ascii
      $s8 = "target '%s' given more than once in the same rule" fullword ascii
      $s9 = "hash_dump" fullword ascii
      $s10 = "internal error: invalid --jobserver-auth string '%s'" fullword ascii
      $s11 = "GNUMAKEFLAGS" fullword ascii /* base64 encoded string '5C (AK d' */
      $s12 = "%s[%s: %s] Error %d%s" fullword ascii
      $s13 = "grouped targets must provide a recipe" fullword ascii
      $s14 = "-*-command-varia$(-*-eval-flags-lseek()" fullword ascii
      $s15 = "sync_mutex" fullword ascii
      $s16 = "*** Warning: .LOW_RESOLUTION_TIME file '%s' has a high resolution time stamp" fullword ascii
      $s17 = "sync-mutex" fullword ascii
      $s18 = " $(LINT.c) -C$* y.tab.c " fullword ascii
      $s19 = "child_execute_job" fullword ascii
      $s20 = "print_target_variables" fullword ascii
      $s21 = "target_environment" fullword ascii
      $s22 = "build_target_list" fullword ascii
      $s23 = "delete_child_targets" fullword ascii
      $s24 = "output_dump" fullword ascii
      $s25 = "max_pattern_targets" fullword ascii
      $s26 = "Failed to read /proc/loadavg: %s" fullword ascii
      $s27 = "  -L, --check-symlink-times   Use the latest mtime between symlinks and target." fullword ascii
      $s28 = "remote_description" fullword ascii
      $s29 = "  -e, --environment-overrides" fullword ascii
      $s30 = "  -t, --touch                 Touch targets instead of remaking them." fullword ascii
      $s31 = "  -B, --always-make           Unconditionally make all targets." fullword ascii
      $s32 = "read: %s: %s" fullword ascii
      $s33 = "Failed to load symbol %s from %s: %s" fullword ascii
      $s34 = "construct_command_argv" fullword ascii
      $s35 = "  -f FILE, --file=FILE, --makefile=FILE" fullword ascii
      $s36 = "jobserver_get_auth" fullword ascii
      $s37 = " mv -f y.tab.c $@" fullword ascii
      $s38 = "  -l [N], --load-average[=N], --max-load[=N]" fullword ascii
      $s39 = "commands_started" fullword ascii
      $s40 = "is_bourne_compatible_shell" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 50 b7 00 00 00 00 00 00 40 00 00 00 00 00 00 00 58 a3 03 00 00 00 00 00 00 00 00 00 40 00 38 00 0b 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 68 02 00 00 00 00 00 00 68 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 a8 02 00 00 00 00 00 00 a8 02 00 00 00 00 00 00 a8 02 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 58 8d 00 00 00 00 00 00 58 8d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 b9 35 02 00 00 00 00 00 b9 35 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 d0 02 00 00 00 00 00 00 d0 02 00 00 00 00 00 00 d0 02 00 00 00 00 00 60 a6 00 00 00 00 00 00 60 a6 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 83 03 00 00 00 00 00 50 93 03 00 00 00 00 00 50 93 03 00 00 00 00 00 c4 1e 00 00 00 00 00 00 a8 57 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d0 8d 03 00 00 00 00 00 d0 9d 03 00 00 00 00 00 d0 9d 03 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 c4 02 00 00 00 00 00 00 c4 02 00 00 00 00 00 00 c4 02 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 70 26 03 00 00 00 00 00 70 26 03 00 00 00 00 00 70 26 03 00 00 00 00 00 fc 0a 00 00 00 00 00 00 fc 0a 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 83 03 00 00 00 00 00 50 93 03 00 00 00 00 00 50 93 03 00 00 00 00 00 b0 0c 00 00 00 00 00 00 b0 0c 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 1b 41 68 0c 21 e3 f0 46 80 cc 10 e8 e6 ed 07 11 6d 6d 6d 93 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 07 01 00 00 84 00 00 00 20 00 00 00 0b 00 00 00 02 02 82 20 4a 40 02 44 6a 04 21 07 04 40 09 08 e1 02 85 55 30 20 80 c0 1b 50 a8 08 a8 42 11 09 16 00 81 10 03 01 08 02 00 24 43 10 ba 94 0c 00 00 8a 34 48 01 c0 49 14 74 70 c4 15 13 88 0b 4c 55 79 00 c3 e0 d2 94 63 70 04 0c 02 01 01 30 63 a9 d0 62 84 d0 01 55 2c 40 aa 00 01 21 a3 34 11 50 01 29 c0 06 e0 d0 00 00 a4 05 95 8b 20 61 12 90 40 45 10 0c 22 91 1e 02 06 00 06 c0 18 40 60 24 30 41 4c 92 4b 3a 51 c3 12 91 05 80 00 60 20 02 00 10 80 ac 82 00 20 92 42 00 92 09 83 11 05 0c 84 40 21 12 8f 40 20 6e 06 8c 00 e0 07 21 82 90 01 80 48 40 40 24 48 02 5d 81 04 00 04 a8 16 e0 10 81 40 14 92 80 80 09 23 0a 61 00 54 00 04 80 98 20 08 01 60 00 a0 8a a0 c3 01 66 06 00 02 53 0b 34 80 80 80 1c 0f}
condition:
      filesize < 700KB and
      8 of them and $magic
}

rule gtfobins_binaries_dig {
   strings:
      $s1 = ";; ->>HEADER<<- opcode: %s, status: %s, id: %u" fullword ascii
      $s2 = "couldn't get address for '%s': %s: skipping lookup" fullword ascii
      $s3 = " ahead of any encryption if an encrypted transport is used)" fullword ascii
      $s4 = "targetp != ((void *)0) && *targetp == ((void *)0)" fullword ascii
      $s5 = "dns_message_gettemprdataset" fullword ascii
      $s6 = "dns_message_gettemprdata" fullword ascii
      $s7 = "dns_message_gettempname" fullword ascii
      $s8 = "irs_resconf_getattempts" fullword ascii
      $s9 = "dns_message_gettemprdatalist" fullword ascii
      $s10 = "Couldn't read key from %s: %s" fullword ascii
      $s11 = ";; WARNING -- TSIG key was not used." fullword ascii
      $s12 = "({ uint_fast32_t __v; __v = __atomic_fetch_sub (((&lookup->references)), ((1)), (memory_order_acq_rel)); ((void)((__v > 0) || ((" ascii
      $s13 = "                 +[no]proxy-plain[=src_addr[#src_port]-dst_addr[#dst_port]]  (The same as '+[no]proxy', but send PROXYv2 headers" ascii
      $s14 = "couldn't get address for '%s': %s" fullword ascii
      $s15 = "Use \"dig -h\" (or \"dig -h | more\") for complete list of options" fullword ascii
      $s16 = ";; WARNING: EDNS query returned status %s - retry with '%s+noedns'" fullword ascii
      $s17 = ";; Couldn't create key %s: %s" fullword ascii
      $s18 = "keysecret" fullword ascii
      $s19 = "Connection to %s(%s) for %s failed: %s." fullword ascii
      $s20 = "RUNTIME_CHECK(%s) failed" fullword ascii
      $s21 = "                 +[no]cmd            (Control display of command line -" fullword ascii
      $s22 = "Skipping mapped address '%s'" fullword ascii
      $s23 = "                 -b address[#port]   (bind to source address/port)" fullword ascii
      $s24 = "udp_ready(%p, %s, %p)" fullword ascii
      $s25 = "isc_assertion_failed)(\"dighost.c\", 1677, isc_assertiontype_insist, \"__v > 0\"), 0))); __v; }) == 1" fullword ascii
      $s26 = "dighost_error" fullword ascii
      $s27 = "(lookup->q).head != (query)" fullword ascii
      $s28 = "(lookup_list).head == (l)" fullword ascii
      $s29 = "((lookup_list).head) == ((void *)0)" fullword ascii
      $s30 = "((b)->length - (b)->used) >= (unsigned int)length" fullword ascii
      $s31 = "((lookup->q).head == ((void *)0))" fullword ascii
      $s32 = "https-get" fullword ascii
      $s33 = "http-plain-get" fullword ascii
      $s34 = "((b)->length - (b)->used) >= sizeof(val)" fullword ascii
      $s35 = "dighost_comments" fullword ascii
      $s36 = "get_address" fullword ascii
      $s37 = "(lookup->my_server_list).head != ((dig_server_t *)ptr)" fullword ascii
      $s38 = "key must have algorithm and secret" fullword ascii
      $s39 = "(lookup->my_server_list).head != (srv)" fullword ascii
      $s40 = "ERROR: short (< header size) message" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 6f 00 00 00 00 00 00 40 00 00 00 00 00 00 00 a8 33 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 78 5c 00 00 00 00 00 00 78 5c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 01 3e 01 00 00 00 00 00 01 3e 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 01 00 00 00 00 00 00 a0 01 00 00 00 00 00 00 a0 01 00 00 00 00 00 e0 76 00 00 00 00 00 00 e0 76 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 25 02 00 00 00 00 00 90 25 02 00 00 00 00 00 90 25 02 00 00 00 00 00 68 0c 00 00 00 00 00 00 78 20 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 20 26 02 00 00 00 00 00 20 26 02 00 00 00 00 00 20 26 02 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d0 fb 01 00 00 00 00 00 d0 fb 01 00 00 00 00 00 d0 fb 01 00 00 00 00 00 3c 03 00 00 00 00 00 00 3c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 25 02 00 00 00 00 00 90 25 02 00 00 00 00 00 90 25 02 00 00 00 00 00 70 0a 00 00 00 00 00 00 70 0a 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 5c 83 8e 44 52 13 e4 3d 16 64 b0 90 c2 29 14 65 41 19 8a f1 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 61 00 00 00 ec 00 00 00 10 00 00 00 0a 00 00 00 11 00 00 00 04 10 04 00 32 28 32 20 61 80 02 81 80 00 20 00 88 20 10 04 03 84 03 50 aa 40 34 91 81 30 02 01 00 93 30 88 0c 04 2f 81 86 04 1a 08 4c 04 00 00 48 04 00 21 22 10 03 17 00 12 01 02 18 50 40 89 84 5a 84 52 40 14 40 04 01 60 40 09}
condition:
      filesize < 400KB and
      8 of them and $magic
}

rule gtfobins_binaries_pic {
   strings:
      $s1 = "usage: %s {-v | --version}" fullword ascii
      $s2 = "error running command '%1': system() returned %2" fullword ascii
      $s3 = "lookahead_token == -1" fullword ascii
      $s4 = "usage: %s --help" fullword ascii
      $s5 = "usage: %s -t [-cCSUz] [file ...]" fullword ascii
      $s6 = "unsafe to run command '%1'; ignoring" fullword ascii
      $s7 = "char* char_ptable::lookupassoc(const char**)" fullword ascii
      $s8 = "place* place_ptable::lookupassoc(const char**)" fullword ascii
      $s9 = "void common_output::dotted_circle(const position&, double, const line_type&)" fullword ascii
      $s10 = "virtual void tpic_output::command(const char*, const char*, int)" fullword ascii
      $s11 = "void common_output::dashed_circle(const position&, double, const line_type&)" fullword ascii
      $s12 = "  \\csname newdimen\\endcsname\\graphtemp" fullword ascii
      $s13 = "char* char_ptable::lookup(const char*)" fullword ascii
      $s14 = "place* place_ptable::lookup(const char*)" fullword ascii
      $s15 = "0 == \"unsupported argument conversion (not in [%123])\"" fullword ascii
      $s16 = "arguments to '^' operator out of domain" fullword ascii
      $s17 = "result of '^' operator out of range" fullword ascii
      $s18 = "virtual void tex_output::circle(const position&, double, const line_type&, double)" fullword ascii
      $s19 = "virtual void simple_output::circle(const position&, double, const line_type&, double)" fullword ascii
      $s20 = "char& string::operator[](int)" fullword ascii
      $s21 = "linear_object* object_spec::make_line(position*, direction*)" fullword ascii
      $s22 = "const char* char_ptable::define(const char*, char*)" fullword ascii
      $s23 = "graphic_object* object_spec::make_move(position*, direction*)" fullword ascii
      $s24 = "object* object_spec::make_object(position*, direction*)" fullword ascii
      $s25 = "const char* place_ptable::define(const char*, place*)" fullword ascii
      $s26 = "void common_output::dashed_arc(const position&, const position&, const position&, const line_type&)" fullword ascii
      $s27 = "usage: %s [-CnSU] [file ...]" fullword ascii
      $s28 = "virtual void common_output::rounded_box(const position&, const distance&, double, const line_type&, double, char*)" fullword ascii
      $s29 = "virtual void closed_object::set_fill(double)" fullword ascii
      $s30 = "void common_output::dotted_arc(const position&, const position&, const position&, const line_type&)" fullword ascii
      $s31 = "void common_output::dashed_ellipse(const position&, const distance&, const line_type&)" fullword ascii
      $s32 = "long unsigned int hash_string(const char*)" fullword ascii
      $s33 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/groff-base.debug" fullword ascii
      $s34 = "void common_output::dotted_ellipse(const position&, const distance&, const line_type&)" fullword ascii
      $s35 = "c43811c512e354e1d7ef77f0d1ae0bcfc63840.debug" fullword ascii
      $s36 = "void common_output::ellipse_arc(const position&, const position&, const position&, const distance&, const line_type&)" fullword ascii
      $s37 = "invalid sprintf conversion specifier '%1'" fullword ascii
      $s38 = "    \\divide\\graphtemp by 2" fullword ascii
      $s39 = "too few arguments to sprintf" fullword ascii
      $s40 = "    \\graphtemp=.5ex" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 81 00 00 00 00 00 00 40 00 00 00 00 00 00 00 50 59 03 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e8 6d 00 00 00 00 00 00 e8 6d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 b1 eb 01 00 00 00 00 00 b1 eb 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 60 02 00 00 00 00 00 00 60 02 00 00 00 00 00 00 60 02 00 00 00 00 00 c3 cc 00 00 00 00 00 00 c3 cc 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 80 2e 03 00 00 00 00 00 80 3e 03 00 00 00 00 00 80 3e 03 00 00 00 00 00 18 29 00 00 00 00 00 00 28 5b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 b0 4b 03 00 00 00 00 00 b0 5b 03 00 00 00 00 00 b0 5b 03 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d4 c5 02 00 00 00 00 00 d4 c5 02 00 00 00 00 00 d4 c5 02 00 00 00 00 00 84 10 00 00 00 00 00 00 84 10 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 80 2e 03 00 00 00 00 00 80 3e 03 00 00 00 00 00 80 3e 03 00 00 00 00 00 80 21 00 00 00 00 00 00 80 21 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 59 c4 38 11 c5 12 e3 54 e1 d7 ef 77 f0 d1 ae 0b cf c6 38 40 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 47 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 47 00 00 00 49 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 61 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 600KB and
      8 of them and $magic
}

rule gtfobins_binaries_perf {
   strings:
      $x1 = "This metric estimates the fraction of cycles when the CPU was stalled due to switches of uop delivery to the Microcode Sequencer" ascii
      $x2 = "This metric estimates the fraction of cycles when the CPU was stalled due to switches of uop delivery to the Microcode Sequencer" ascii
      $x3 = "This category represents fraction of slots where the processor's Frontend undersupplies its Backend. Frontend denotes the first " ascii
      $x4 = "This category represents fraction of slots where the processor's Frontend undersupplies its Backend. Frontend denotes the first " ascii
      $x5 = "# Executed %d pipe operations between two %s" fullword ascii
      $x6 = "This metric estimates the fraction of cycles when the CPU was stalled due to switches of uop delivery to the Microcode Sequencer" ascii
      $x7 = "This metric estimates fraction of slots the CPU retired uops delivered by the Microcode_Sequencer as a result of Assists. Assist" ascii
      $x8 = "This event counts the number of micro-ops (uops) retired. The processor decodes complex macro instructions into a sequence of si" ascii
      $x9 = "Counts the number of cycles when the local HA tracker pool is completely used.  This can be used with edge detect to identify th" ascii
      $x10 = "Counts the number of cycles when the local HA tracker pool is completely used.  This can be used with edge detect to identify th" ascii
      $x11 = "This metric estimates fraction of slots the CPU retired uops delivered by the Microcode_Sequencer as a result of Assists. Assist" ascii
      $x12 = "This event used to measure front-end inefficiencies. I.e. when front-end of the machine is not delivering uops to the back-end a" ascii
      $x13 = "This metric represents fraction of cycles CPU executed total of 2 uops per cycle on all execution ports (Logical Processor cycle" ascii
      $x14 = "This metric represents fraction of cycles CPU executed total of 2 uops per cycle on all execution ports (Logical Processor cycle" ascii
      $x15 = "This metric represents fraction of cycles CPU executed total of 2 uops per cycle on all execution ports (Logical Processor cycle" ascii
      $x16 = "This metric estimates fraction of cycles the CPU performance was potentially limited due to Core computation issues (non divider" ascii
      $x17 = "This metric represents fraction of cycles where the CPU executed total of 1 uop per cycle on all execution ports (Logical Proces" ascii
      $x18 = "This metric represents fraction of cycles where the CPU executed total of 1 uop per cycle on all execution ports (Logical Proces" ascii
      $s19 = "Counts the number of HA requests to a given TAD region.  There are up to 11 TAD (target address decode) regions in each home age" ascii
      $s20 = "Counts the number of HA requests to a given TAD region.  There are up to 11 TAD (target address decode) regions in each home age" ascii
      $s21 = "Counts the number of HA requests to a given TAD region.  There are up to 11 TAD (target address decode) regions in each home age" ascii
      $s22 = "Counts the number of HA requests to a given TAD region.  There are up to 11 TAD (target address decode) regions in each home age" ascii
      $s23 = "Counts the number of HA requests to a given TAD region.  There are up to 11 TAD (target address decode) regions in each home age" ascii
      $s24 = "Counts the number of HA requests to a given TAD region.  There are up to 11 TAD (target address decode) regions in each home age" ascii
      $s25 = "Counts the number of HA requests to a given TAD region.  There are up to 11 TAD (target address decode) regions in each home age" ascii
      $s26 = "Counts the number of HA requests to a given TAD region.  There are up to 11 TAD (target address decode) regions in each home age" ascii
      $s27 = "Counts the number of HA requests to a given TAD region.  There are up to 11 TAD (target address decode) regions in each home age" ascii
      $s28 = "Counts the number of HA requests to a given TAD region.  There are up to 11 TAD (target address decode) regions in each home age" ascii
      $s29 = "Counts the number of HA requests to a given TAD region.  There are up to 11 TAD (target address decode) regions in each home age" ascii
      $s30 = "Counts the number of HA requests to a given TAD region.  There are up to 11 TAD (target address decode) regions in each home age" ascii
      $s31 = "Counts the number of HA requests to a given TAD region.  There are up to 11 TAD (target address decode) regions in each home age" ascii
      $s32 = "Counts the number of HA requests to a given TAD region.  There are up to 11 TAD (target address decode) regions in each home age" ascii
      $s33 = "The number of pipeline restarts caused by invalidating probes that hit on the instruction stream currently being executed. This " ascii
      $s34 = "This metric represents fraction of slots where the CPU was retiring heavy-weight operations -- instructions that require two or " ascii
      $s35 = "This metric represents fraction of slots where the CPU was retiring heavy-weight operations -- instructions that require two or " ascii
      $s36 = "This metric represents fraction of slots where the CPU was retiring heavy-weight operations -- instructions that require two or " ascii
      $s37 = "The NO_ALLOC_CYCLES.NOT_DELIVERED event is used to measure front-end inefficiencies, i.e. when front-end of the machine is not d" ascii
      $s38 = "Total pipeline cost when the execution is compute-bound - an estimation. Covers Core Bound when High ILP as well as when long-la" ascii
      $s39 = "Total pipeline cost when the execution is compute-bound - an estimation. Covers Core Bound when High ILP as well as when long-la" ascii
      $s40 = "This event counts a subset of the Topdown Slots event that are utilized by operations that eventually get retired (committed) by" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 50 d3 04 00 00 00 00 00 40 00 00 00 00 00 00 00 40 9c 97 00 00 00 00 00 00 00 00 00 40 00 38 00 0e 00 40 00 20 00 1f 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 84 04 00 00 00 00 00 10 84 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 90 04 00 00 00 00 00 00 90 04 00 00 00 00 00 00 90 04 00 00 00 00 00 c5 a4 25 00 00 00 00 00 c5 a4 25 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 2a 00 00 00 00 00 00 40 2a 00 00 00 00 00 00 40 2a 00 00 00 00 00 f8 07 69 00 00 00 00 00 f8 07 69 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 e8 4c 93 00 00 00 00 00 e8 5c 93 00 00 00 00 00 e8 5c 93 00 00 00 00 00 f8 4d 04 00 00 00 00 00 a0 a6 04 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 20 ca 95 00 00 00 00 00 20 da 95 00 00 00 00 00 20 da 95 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 e8 4c 93 00 00 00 00 00 e8 5c 93 00 00 00 00 00 e8 5c 93 00 00 00 00 00 00 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 f8 ee 8e 00 00 00 00 00 f8 ee 8e 00 00 00 00 00 f8 ee 8e 00 00 00 00 00 5c b1 00 00 00 00 00 00 5c b1 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 e8 4c 93 00 00 00 00 00 e8 5c 93 00 00 00 00 00 e8 5c 93 00 00 00 00 00 18 83 02 00 00 00 00 00 18 83 02 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 41 df 59 0f f6 c2 16 37 2c b7 c5 bc a3 10 65 53 d7 db a2 a7 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 c5 02 00 00 01 00 00 00 06 00 00 00 00 02 85 20 04 20 40 40 c5 02 00 00 c7 02 00 00 c8 02 00 00 62 6b 1e c2}
condition:
      filesize < 29000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_update_alternatives {
   strings:
      $s1 = "wait for subprocess %s failed" fullword ascii
      $s2 = "two commands specified: --%s and --%s" fullword ascii
      $s3 = "unable to execute %s (%s)" fullword ascii
      $s4 = "%s%s/%s has been changed (manually or by a script); switching to manual updates only" fullword ascii
      $s5 = "/var/log/alternatives.log" fullword ascii
      $s6 = "unable to get file '%s%s' metadata" fullword ascii
      $s7 = "Use '%s --help' for program usage information." fullword ascii
      $s8 = "cannot get local time to log into '%s'" fullword ascii
      $s9 = "Usage: %s [<option> ...] <command>" fullword ascii
      $s10 = "removing manually selected alternative - switching %s to auto mode" fullword ascii
      $s11 = "unable to read link '%s%.255s'" fullword ascii
      $s12 = "need --%s, --%s, --%s, --%s, --%s, --%s, --%s, --%s, --%s, --%s, --%s or --%s" fullword ascii
      $s13 = "  --list <name>            display all targets of the <name> group." fullword ascii
      $s14 = "while reading %s: %s" fullword ascii
      $s15 = "alternative path %s%s doesn't exist" fullword ascii
      $s16 = "--%s only allowed with --%s" fullword ascii
      $s17 = "to return to automatic updates use '%s --auto %s'" fullword ascii
      $s18 = "renaming %s link from %s%s to %s%s" fullword ascii
      $s19 = "renaming %s slave link from %s%s to %s%s" fullword ascii
      $s20 = "%s%s/%s is dangling; it will be updated with best choice" fullword ascii
      $s21 = "This is free software; see the GNU General Public License version 2 or" fullword ascii
      $s22 = "read error in %.250s" fullword ascii
      $s23 = "alternative link %s is already managed by %s (slave of %s)" fullword ascii
      $s24 = "alternative link %s is already managed by %s" fullword ascii
      $s25 = "<path> is the location of one of the alternative target files." fullword ascii
      $s26 = "%s/%s.dpkg-tmp" fullword ascii
      $s27 = "root=%s admdir=%s altdir=%s" fullword ascii
      $s28 = "%s version %s." fullword ascii
      $s29 = "set_selection(%s, %s, %s)" fullword ascii
      $s30 = "  slave %s: %s" fullword ascii
      $s31 = "priority of %s: %s" fullword ascii
      $s32 = "  link best version not available" fullword ascii
      $s33 = "--get-selections" fullword ascii
      $s34 = "setvbuf failed" fullword ascii
      $s35 = "  --quiet                  quiet operation, minimal output." fullword ascii
      $s36 = "  --log <file>             change the log file." fullword ascii
      $s37 = "  (e.g. /usr/bin/pager)" fullword ascii
      $s38 = "  --install <link> <name> <path> <priority>" fullword ascii
      $s39 = "  --get-selections         list master alternative names and their status." fullword ascii
      $s40 = "  --verbose                verbose operation, more output." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 43 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c0 e1 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b8 16 00 00 00 00 00 00 b8 16 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 d5 74 00 00 00 00 00 00 d5 74 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 30 31 00 00 00 00 00 00 30 31 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 da 00 00 00 00 00 00 f0 ea 00 00 00 00 00 00 f0 ea 00 00 00 00 00 00 30 05 00 00 00 00 00 00 a8 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d0 db 00 00 00 00 00 00 d0 eb 00 00 00 00 00 00 d0 eb 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 f8 c0 00 00 00 00 00 00 f8 c0 00 00 00 00 00 00 f8 c0 00 00 00 00 00 00 3c 02 00 00 00 00 00 00 3c 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 da 00 00 00 00 00 00 f0 ea 00 00 00 00 00 00 f0 ea 00 00 00 00 00 00 10 05 00 00 00 00 00 00 10 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 98 57 e1 af 59 0f 4d 61 9b 69 36 57 b4 ae 43 04 46 53 50 d7 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 04 00 00 00 43 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 43 00 00 00 45 00 00 00 00 00 00 00 46 00 00 00 28 1d 8c 1c d1 65 ce 6d 39 f2 8b 1c 67 55 61 10 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 bc 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_nano {
   strings:
      $s1 = " This mode allows you to insert the output of a command run by the shell into the current buffer (or into a new buffer).  If the" ascii
      $s2 = "Execute a function or an external command" fullword ascii
      $s3 = "Command to execute" fullword ascii
      $s4 = "Command to execute in new buffer" fullword ascii
      $s5 = " command is preceded by '|' (the pipe symbol), the current contents of the buffer (or marked region) will be piped to the comman" ascii
      $s6 = " This mode allows you to insert the output of a command run by the shell into the current buffer (or into a new buffer).  If the" ascii
      $s7 = "flipexecute" fullword ascii
      $s8 = "Error reading temp file: %s" fullword ascii
      $s9 = "Missing regex string after '%s' command" fullword ascii
      $s10 = "Mismatching undo type -- please report a bug" fullword ascii
      $s11 = "Misplaced cursor -- please report a bug" fullword ascii
      $s12 = "%s -- %zu line (%s)" fullword ascii
      $s13 = " If you have compiled nano with multiple file buffer support, and enable multiple file buffers with the -F or --multibuffer comm" ascii
      $s14 = "Bad undo type -- please report a bug" fullword ascii
      $s15 = "Missing multidata -- please report a bug" fullword ascii
      $s16 = "A '%s' command requires a preceding 'syntax' command" fullword ascii
      $s17 = "Buffer has been processed" fullword ascii
      $s18 = "Span has underflowed -- please report a bug" fullword ascii
      $s19 = "%s -- %zu lines (%s)" fullword ascii
      $s20 = "Pipe the current buffer (or marked region) to the command" fullword ascii
      $s21 = "flippipe" fullword ascii
      $s22 = " If you have compiled nano with multiple file buffer support, and enable multiple file buffers with the -F or --multibuffer comm" ascii
      $s23 = "Unbound key: %s%c" fullword ascii
      $s24 = "Failed to open pipe: %s" fullword ascii
      $s25 = "Error expanding %s: %s" fullword ascii
      $s26 = "Error writing lock file %s: %s" fullword ascii
      $s27 = "Error deleting lock file %s: %s" fullword ascii
      $s28 = "Error opening lock file %s: %s" fullword ascii
      $s29 = "Sorry! Nano crashed!  Code: %d.  Please report a bug." fullword ascii
      $s30 = "Suspend the editor (return to the shell)" fullword ascii
      $s31 = "If you just need another blank buffer, do not enter any command." fullword ascii
      $s32 = "Got 0 parsable lines from command: %s" fullword ascii
      $s33 = "runmacro" fullword ascii
      $s34 = "Executing..." fullword ascii
      $s35 = "Type '%s -h' for a list of available options." fullword ascii
      $s36 = "uncomment" fullword ascii
      $s37 = "keycolor" fullword ascii
      $s38 = "errorcolor" fullword ascii
      $s39 = "%s%zd %s,  %zu %s,  %zu %s" fullword ascii
      $s40 = " Shortcuts are written as follows: Control-key sequences are notated with a '^' and can be entered either by using the Ctrl key " ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 72 00 00 00 00 00 00 40 00 00 00 00 00 00 00 18 6c 04 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 4a 00 00 00 00 00 00 00 4a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 29 1c 03 00 00 00 00 00 29 1c 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 6c e0 00 00 00 00 00 00 6c e0 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 51 04 00 00 00 00 00 90 61 04 00 00 00 00 00 90 61 04 00 00 00 00 00 40 19 00 00 00 00 00 00 a0 21 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 f0 55 04 00 00 00 00 00 f0 65 04 00 00 00 00 00 f0 65 04 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 ac e3 03 00 00 00 00 00 ac e3 03 00 00 00 00 00 ac e3 03 00 00 00 00 00 1c 0f 00 00 00 00 00 00 1c 0f 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 51 04 00 00 00 00 00 90 61 04 00 00 00 00 00 90 61 04 00 00 00 00 00 70 0e 00 00 00 00 00 00 70 0e 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 e8 d0 d2 f3 88 b0 4c 07 cf 76 55 97 a7 bb 7a 1f e3 96 0f 8d 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 b0 00 00 00 02 00 00 00 07 00 00 00 60 c1 c0 40 13 21 0c 06 00 08 81 01 00 00 80 10 b0 00 00 00 b2 00 00 00 b9 00 00 00 28 1d 8c 1c d1 65 ce 6d 20 cf 09 fd d8 2b 8c 1c 76 3e e9 a9 2c 32 40 fd 16 27 83 7c 20 a3 87 0d 39 f2 8b 1c 32 c4 f7 12 b2 a2 f7 12 97 67 53 f7 00 00 00 00}
condition:
      filesize < 900KB and
      8 of them and $magic
}

rule gtfobins_binaries_diff {
   strings:
      $s1 = "standard file descriptors" fullword ascii
      $s2 = "extra operand '%s'" fullword ascii
      $s3 = "missing operand after '%s'" fullword ascii
      $s4 = "    --to-file=FILE2             compare all operands to FILE2;" fullword ascii
      $s5 = "    --from-file=FILE1           compare FILE1 to all operands;" fullword ascii
      $s6 = "subsidiary program '%s' could not be invoked" fullword ascii
      $s7 = "https://www.gnu.org/software/diffutils/" fullword ascii
      $s8 = "subsidiary program '%s' failed" fullword ascii
      $s9 = "subsidiary program '%s' failed (exit status %d)" fullword ascii
      $s10 = "program error" fullword ascii
      $s11 = "%>#endif /* @ */" fullword ascii
      $s12 = "%<#else /* @ */" fullword ascii
      $s13 = "unparsable value for --palette" fullword ascii
      $s14 = "-I, --ignore-matching-lines=RE  ignore changes where all lines match RE" fullword ascii
      $s15 = "%<#endif /* ! @ */" fullword ascii
      $s16 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/diffutils.debug" fullword ascii
      $s17 = "conflicting %s option value '%s'" fullword ascii
      $s18 = "invalid context length '%s'" fullword ascii
      $s19 = "If a FILE is '-', read standard input." fullword ascii
      $s20 = "_Files %s and %s differ" fullword ascii
      $s21 = "Symbolic links %s and %s differ" fullword ascii
      $s22 = "subsidiary program '%s' not found" fullword ascii
      $s23 = "invalid color '%s'" fullword ascii
      $s24 = "invalid width '%s'" fullword ascii
      $s25 = "invalid horizon length '%s'" fullword ascii
      $s26 = "invalid tabsize '%s'" fullword ascii
      $s27 = "    --horizon-lines=NUM  keep NUM lines of the common prefix and suffix" fullword ascii
      $s28 = "    --left-column             output only the left column of common lines" fullword ascii
      $s29 = "    --suppress-common-lines   do not output common lines" fullword ascii
      $s30 = "-l, --paginate                pass output through 'pr' to paginate it" fullword ascii
      $s31 = "%td%c%td" fullword ascii
      $s32 = "re_set_syntax" fullword ascii /* Goodware String - occured 1 times */
      $s33 = "/usr/bin/pr" fullword ascii /* Goodware String - occured 1 times */
      $s34 = "/proc/self/maps" fullword ascii
      $s35 = "E(H;E0" fullword ascii /* Goodware String - occured 1 times */
      $s36 = "F(I;F0" fullword ascii /* Goodware String - occured 1 times */
      $s37 = "gnulib sigsegv (stackoverflow_deinstall_handler)" fullword ascii
      $s38 = "H;T$hu" fullword ascii /* Goodware String - occured 1 times */
      $s39 = "//TRANSLH" fullword ascii
      $s40 = "    %L  contents of line" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 5a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b0 56 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 34 00 00 00 00 00 00 00 34 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 81 75 01 00 00 00 00 00 81 75 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 c0 01 00 00 00 00 00 00 c0 01 00 00 00 00 00 00 c0 01 00 00 00 00 00 04 73 00 00 00 00 00 00 04 73 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 42 02 00 00 00 00 00 d0 42 02 00 00 00 00 00 d0 42 02 00 00 00 00 00 30 12 00 00 00 00 00 00 f0 1a 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c0 4d 02 00 00 00 00 00 c0 4d 02 00 00 00 00 00 c0 4d 02 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 24 f4 01 00 00 00 00 00 24 f4 01 00 00 00 00 00 24 f4 01 00 00 00 00 00 6c 09 00 00 00 00 00 00 6c 09 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 42 02 00 00 00 00 00 d0 42 02 00 00 00 00 00 d0 42 02 00 00 00 00 00 30 0d 00 00 00 00 00 00 30 0d 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 d5 c5 80 da c5 38 ce f2 d0 3c ba 35 6b 75 71 38 ed 26 00 bb 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 7f 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 7f 00 00 00 81 00 00 00 87 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_troff {
   strings:
      $s1 = "usage: %s {-v | --version}" fullword ascii
      $s2 = "void token::process()" fullword ascii
      $s3 = "unicode_decompose* unicode_decompose_ptable::lookupassoc(const char**)" fullword ascii
      $s4 = "0 == \"unhandled switch case while processing operator\"" fullword ascii
      $s5 = "usage: %s {-h | --help}" fullword ascii
      $s6 = "int font::get_subscript_correction(glyph*, int)" fullword ascii
      $s7 = "output process '%1' got fatal signal %2" fullword ascii
      $s8 = "output process '%1' exited with status %2" fullword ascii
      $s9 = "void process_input_stack()" fullword ascii
      $s10 = "unicode_decompose* unicode_decompose_ptable::lookup(const char*)" fullword ascii
      $s11 = "unicode_to_glyph* unicode_to_glyph_ptable::lookupassoc(const char**)" fullword ascii
      $s12 = "glyph_to_unicode* glyph_to_unicode_ptable::lookupassoc(const char**)" fullword ascii
      $s13 = "can't open pipe to process '%1': %2" fullword ascii
      $s14 = "  target text length: %1u" fullword ascii
      $s15 = "memory allocation failure while processing 'papersize' directive" fullword ascii
      $s16 = "const char* font::get_special_device_encoding(glyph*)" fullword ascii
      $s17 = "tfont* font_info::get_tfont(font_size, int, int, int)" fullword ascii
      $s18 = "virtual breakpoint* dbreak_node::get_breakpoints(hunits, int, breakpoint*, int)" fullword ascii
      $s19 = "virtual breakpoint* space_node::get_breakpoints(hunits, int, breakpoint*, int)" fullword ascii
      $s20 = "const char* get_string(const char*)" fullword ascii
      $s21 = "virtual input_iterator* macro_iterator::get_arg(int)" fullword ascii
      $s22 = "unable to open macro file for -m argument '%1'" fullword ascii
      $s23 = "usage: %s [-abcCEiRUz] [-d ct] [-d string=text] [-f font-family] [-F font-directory] [-I inclusion-directory] [-m macro-package]" ascii
      $s24 = "conditional operator '%1' used in compatibility mode" fullword ascii
      $s25 = "missing closing delimiter in output comparison operator (got %1)" fullword ascii
      $s26 = "no glyphs defined in font description" fullword ascii
      $s27 = "executivH" fullword ascii
      $s28 = "unicode_to_glyph* unicode_to_glyph_ptable::lookup(const char*)" fullword ascii
      $s29 = "node* make_composite_node(charinfo*, environment*)" fullword ascii
      $s30 = "virtual node* composite_node::add_self(node*, hyphen_list**)" fullword ascii
      $s31 = "0 == \"unhandled switch case when processing scaling unit\"" fullword ascii
      $s32 = "PostScript file '%1' is non-conforming because length of line exceeds 255" fullword ascii
      $s33 = "  temporary indentation: %1u" fullword ascii
      $s34 = "request_or_macro* lookup_request(symbol)" fullword ascii
      $s35 = "const char* unicode_decompose_ptable::define(const char*, unicode_decompose*)" fullword ascii
      $s36 = "do_old_compatible_flag == -1" fullword ascii
      $s37 = "glyph_to_unicode* glyph_to_unicode_ptable::lookup(const char*)" fullword ascii
      $s38 = "  have temporary indentation: %1" fullword ascii
      $s39 = "color* lookup_color(symbol)" fullword ascii
      $s40 = "0 == \"unsupported argument conversion (not in [%123])\"" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 97 03 00 00 00 00 00 40 00 00 00 00 00 00 00 90 27 0c 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 90 3e 03 00 00 00 00 00 90 3e 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 03 00 00 00 00 00 00 40 03 00 00 00 00 00 00 40 03 00 00 00 00 00 21 2a 05 00 00 00 00 00 21 2a 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 08 00 00 00 00 00 00 70 08 00 00 00 00 00 00 70 08 00 00 00 00 00 c3 9d 02 00 00 00 00 00 c3 9d 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 e0 0e 0b 00 00 00 00 00 e0 1e 0b 00 00 00 00 00 e0 1e 0b 00 00 00 00 00 f8 16 01 00 00 00 00 00 38 63 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 20 6b 0b 00 00 00 00 00 20 7b 0b 00 00 00 00 00 20 7b 0b 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 44 78 09 00 00 00 00 00 44 78 09 00 00 00 00 00 44 78 09 00 00 00 00 00 b4 3d 00 00 00 00 00 00 b4 3d 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 e0 0e 0b 00 00 00 00 00 e0 1e 0b 00 00 00 00 00 e0 1e 0b 00 00 00 00 00 20 61 00 00 00 00 00 00 20 61 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 6f 0a f1 af 7b 2c 48 6a 11 73 75 f5 ad eb cb 26 24 27 c0 2b 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 58 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 58 00 00 00 5a 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 73 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 2000KB and
      8 of them and $magic
}

rule gtfobins_binaries_ssh_keygen {
   strings:
      $s1 = "%.24s processed %lu of %lu (%lu%%) in %s, ETA %s" fullword ascii
      $s2 = "%s: Failed to set SELinux execution context for %s (in enforcing mode)" fullword ascii
      $s3 = "%s%s%s:%ld: Removed %s key for host %s" fullword ascii
      $s4 = "login failed for always-auth key" fullword ascii
      $s5 = "webauthn-sk-ecdsa-sha2-nistp256@openssh.com" fullword ascii
      $s6 = "session-bind@openssh.com" fullword ascii
      $s7 = "%s: Failed to set SELinux execution context for %s" fullword ascii
      $s8 = "%s: Failed to get default SELinux security context for %s (in enforcing mode)" fullword ascii
      $s9 = "login failed" fullword ascii
      $s10 = "subprocess" fullword ascii
      $s11 = "Failed to read v2 public key from \"%s\"" fullword ascii
      $s12 = "Unsupported operation for -Y: \"%s\"" fullword ascii
      $s13 = "provider %s: manufacturerID <%.*s> cryptokiVersion %d.%d libraryDescription <%.*s> libraryVersion %d.%d" fullword ascii
      $s14 = "PKCS#11 login failed: PIN length out of range" fullword ascii
      $s15 = "PKCS#11 login failed: PIN incorrect" fullword ascii
      $s16 = "sk-ecdsa-sha2-nistp256-cert-v01@openssh.com" fullword ascii
      $s17 = "restrict-destination-v00@openssh.com" fullword ascii
      $s18 = "ssh-ed25519-cert-v01@openssh.com" fullword ascii
      $s19 = "sk-ecdsa-sha2-nistp256@openssh.com" fullword ascii
      $s20 = "PKCS#11 login failed: PIN locked" fullword ascii
      $s21 = "chacha20-poly1305@openssh.com" fullword ascii
      $s22 = "sk-ssh-ed25519@openssh.com" fullword ascii
      $s23 = "sk-provider@openssh.com" fullword ascii
      $s24 = "rsa-sha2-512-cert-v01@openssh.com" fullword ascii
      $s25 = "%s command \"%s\" running as %s (flags 0x%x)" fullword ascii
      $s26 = "sk-ssh-ed25519-cert-v01@openssh.com" fullword ascii
      $s27 = "associated-certs-v00@openssh.com" fullword ascii
      $s28 = "PKCS#11 login failed: error %lu" fullword ascii
      $s29 = "rsa-sha2-256-cert-v01@openssh.com" fullword ascii
      $s30 = "C_GetTokenInfo for provider %s slot %lu failed: %lu" fullword ascii
      $s31 = "process from line %lu from pipe" fullword ascii
      $s32 = "%s: ssh_selinux_getctxbyname: security_getenforce() failed" fullword ascii
      $s33 = "%s:%ld: parse error in hostkeys file" fullword ascii
      $s34 = "%s: Failed to get default SELinux security context for %s" fullword ascii
      $s35 = "sshkey_dump_ec_point" fullword ascii
      $s36 = "incorrect passphrase supplied to decrypt private key" fullword ascii
      $s37 = "agent refused operation" fullword ascii
      $s38 = "setexeccon" fullword ascii
      $s39 = "getseuserbyname" fullword ascii
      $s40 = "No private key found for public key \"%s\"" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 c0 ce 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 a2 08 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c8 7d 00 00 00 00 00 00 c8 7d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 cd b1 04 00 00 00 00 00 cd b1 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 05 00 00 00 00 00 00 40 05 00 00 00 00 00 00 40 05 00 00 00 00 00 14 3f 03 00 00 00 00 00 14 3f 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 82 08 00 00 00 00 00 d0 82 08 00 00 00 00 00 d0 82 08 00 00 00 00 00 c0 1d 00 00 00 00 00 00 c0 36 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 91 08 00 00 00 00 00 e0 91 08 00 00 00 00 00 e0 91 08 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 e0 9a 07 00 00 00 00 00 e0 9a 07 00 00 00 00 00 e0 9a 07 00 00 00 00 00 ac 17 00 00 00 00 00 00 ac 17 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 82 08 00 00 00 00 00 d0 82 08 00 00 00 00 00 d0 82 08 00 00 00 00 00 30 1d 00 00 00 00 00 00 30 1d 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 79 a4 8d 6c ed f6 37 a6 3d 0f fc 73 aa 4d b6 81 a2 8e b2 f2 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 85 01 00 00 02 00 00 00 07 00 00 00 00 00 00 12 12 81 00 16 26 0e 81 04 e2 04 00 00 85 01 00 00 8a 01 00 00 90 01 00 00 28 1d 8c 1c 56 61 36 cb d0 65 ce 6d e6 d0 45 cc 41 4d 9d 7c 50 b5 a8 10 66 55 61 10 bc 50 76 9e 38 f2 8b 1c e4 62 41 f5 2f 32 21 1e 18 ee ff 54 cb 44 77 12}
condition:
      filesize < 2000KB and
      8 of them and $magic
}

rule gtfobins_binaries_xz {
   strings:
      $s1 = "Reduced the number of threads from %s to one. The automatic memory usage limit of %s MiB is still being exceeded. %s MiB of memo" ascii
      $s2 = "Adjusted LZMA%c dictionary size for --filters%u from %s MiB to %s MiB to not exceed the memory usage limit of %s MiB" fullword ascii
      $s3 = "Reduced the number of threads from %s to one. The automatic memory usage limit of %s MiB is still being exceeded. %s MiB of memo" ascii
      $s4 = "Reduced the number of threads from %s to %s to not exceed the memory usage limit of %s MiB" fullword ascii
      $s5 = "Number of processor threads:" fullword ascii
      $s6 = "Switching to single-threaded mode to not exceed the memory usage limit of %s MiB" fullword ascii
      $s7 = "      --files[=FILE]  read filenames to process from FILE; if FILE is" fullword ascii
      $s8 = "Error creating a pipe: %s" fullword ascii
      $s9 = "%s: File already has '%s' suffix, skipping" fullword ascii
      $s10 = "Error getting the file status flags from standard output: %s" fullword ascii
      $s11 = "                      as many threads as there are processor cores" fullword ascii
      $s12 = "Error getting the file status flags from standard input: %s" fullword ascii
      $s13 = "Switching to single-threaded mode due to --flush-timeout" fullword ascii
      $s14 = "Error in --filters%s=FILTERS option:" fullword ascii
      $s15 = "Filter chain %u is incompatible with --flush-timeout" fullword ascii
      $s16 = "With --format=raw, --suffix=.SUF is required unless writing to stdout" fullword ascii
      $s17 = "      --no-adjust     if compression settings exceed the memory usage limit," fullword ascii
      $s18 = "  -e, --extreme       try to improve compression ratio by using more CPU time;" fullword ascii
      $s19 = "%s: Too many arguments to --block-list" fullword ascii
      $s20 = "In --block-list, block size is missing after filter chain number '%c:'" fullword ascii
      $s21 = "%s: Invalid argument to --block-list" fullword ascii
      $s22 = "                      decompressor memory usage into account before using 7-9!" fullword ascii
      $s23 = "https://tukaani.org/xz/" fullword ascii
      $s24 = "Compression of lzip files (.lz) is not supported" fullword ascii
      $s25 = "Multi-threaded decompression:" fullword ascii
      $s26 = "%s: Null character found when reading filenames; maybe you meant to use '--files0' instead of '--files'?" fullword ascii
      $s27 = "Error changing to filter chain %u: %s" fullword ascii
      $s28 = "%s: Options must be 'name=value' pairs separated with commas" fullword ascii
      $s29 = "%s: poll() failed: %s" fullword ascii
      $s30 = "MemUsage" fullword ascii
      $s31 = "  -S, --suffix=.SUF   use the suffix '.SUF' on compressed files" fullword ascii
      $s32 = " Operation mode:" fullword ascii
      $s33 = "      --robot         use machine-parsable messages (useful for scripts)" fullword ascii
      $s34 = "Memory usage limits:" fullword ascii
      $s35 = "lzma_get_progress" fullword ascii
      $s36 = "Sizes in headers:" fullword ascii
      $s37 = "lzma_stream_encoder_mt_memusage" fullword ascii
      $s38 = " Operation modifiers:" fullword ascii
      $s39 = "  -M, --memlimit=LIMIT" fullword ascii
      $s40 = "filter chain %u used by --block-list but not specified with --filters%u=" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 3b 00 00 00 00 00 00 40 00 00 00 00 00 00 00 68 63 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c0 2e 00 00 00 00 00 00 c0 2e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 8d b6 00 00 00 00 00 00 8d b6 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 80 57 00 00 00 00 00 00 80 57 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 4f 01 00 00 00 00 00 10 5f 01 00 00 00 00 00 10 5f 01 00 00 00 00 00 10 13 00 00 00 00 00 00 f8 5e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 50 5a 01 00 00 00 00 00 50 6a 01 00 00 00 00 00 50 6a 01 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 b0 29 01 00 00 00 00 00 b0 29 01 00 00 00 00 00 b0 29 01 00 00 00 00 00 2c 04 00 00 00 00 00 00 2c 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 4f 01 00 00 00 00 00 10 5f 01 00 00 00 00 00 10 5f 01 00 00 00 00 00 f0 10 00 00 00 00 00 00 f0 10 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 ae e2 6e 85 24 69 aa 35 57 e7 da bc 06 48 92 b2 8a a1 59 7f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 71 00 00 00 01 00 00 00 06 00 00 00 04 45 e1 00 80 01 1c 02 71 00 00 00 73 00 00 00 77 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 96 a0 89 97 ce 2c 63 72 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 300KB and
      8 of them and $magic
}

rule gtfobins_binaries_cupsfilter {
   strings:
      $s1 = "%s: Error - expected \"username\" after \"-U\" option." fullword ascii
      $s2 = "vnd.cups-postscript" fullword ascii
      $s3 = "ERROR: Unable to create \"%s\" - %s" fullword ascii
      $s4 = "%s: Error - expected number of copies after \"-n\" option." fullword ascii
      $s5 = "%s: Error - expected title after \"-%c\" option." fullword ascii
      $s6 = "%s: Error - expected PPD file after \"-%c\" option." fullword ascii
      $s7 = "%s: Error - expected job-id after \"-j\" option." fullword ascii
      $s8 = "%s: Error - expected name=value after \"-a\" option." fullword ascii
      $s9 = "%s: Error - expected name=value after \"-o\" option." fullword ascii
      $s10 = "%s: Error - unknown option \"-%c\"." fullword ascii
      $s11 = "%s: Error - expected input file after \"-f\" option." fullword ascii
      $s12 = "%s: Error - expected source MIME type after \"-i\" option." fullword ascii
      $s13 = "%s: Error - expected destination MIME type after \"-m\" option." fullword ascii
      $s14 = "%s: Error - expected printer name after \"-d\" option." fullword ascii
      $s15 = "%s: Error - expected filename after \"-c\" option." fullword ascii
      $s16 = "Usage: cupsfilter [ options ] [ -- ] filename" fullword ascii
      $s17 = "cupsfilter: Unable to get job file - %s" fullword ascii
      $s18 = "application/vnd.cups-postscript 0 -" fullword ascii
      $s19 = "%s: Unable to read MIME database from \"%s\" or \"%s\"." fullword ascii
      $s20 = "FINAL_CONTENT_TYPE=%s/%s" fullword ascii
      $s21 = "httpConnectEncrypt" fullword ascii
      $s22 = "cupsTempFd" fullword ascii
      $s23 = "ERROR: %s (PID %d) crashed on signal %d" fullword ascii
      $s24 = "PPD=%s/model/laserjet.ppd" fullword ascii
      $s25 = "  -p filename.ppd         Set PPD file." fullword ascii
      $s26 = "INFO: %s (PID %d) exited with no errors." fullword ascii
      $s27 = "ERROR: %s (PID %d) stopped with status %d" fullword ascii
      $s28 = "%s: Invalid filter string \"%s\"." fullword ascii
      $s29 = "%s: No filter to convert from %s/%s to %s/%s." fullword ascii
      $s30 = "%s: Unable to open PPD file: %s on line %d." fullword ascii
      $s31 = "%s: Unknown destination MIME type %s/%s." fullword ascii
      $s32 = "%s: Unable to determine MIME type of \"%s\"." fullword ascii
      $s33 = "%s: Unknown source MIME type %s/%s." fullword ascii
      $s34 = "cupsGetNamedDest" fullword ascii
      $s35 = "cupsFileGets" fullword ascii
      $s36 = "cupsEncryption" fullword ascii
      $s37 = "FINAL_CONTENT_TYPE=%s" fullword ascii
      $s38 = "cupsGetOption" fullword ascii
      $s39 = "cupsDirClose" fullword ascii
      $s40 = "cupsFileGetConf" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 46 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 b2 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a0 1e 00 00 00 00 00 00 a0 1e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 41 60 00 00 00 00 00 00 41 60 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 b8 19 00 00 00 00 00 00 b8 19 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 aa 00 00 00 00 00 00 90 ba 00 00 00 00 00 00 90 ba 00 00 00 00 00 00 b0 06 00 00 00 00 00 00 f0 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a0 aa 00 00 00 00 00 00 a0 ba 00 00 00 00 00 00 a0 ba 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 1c 9f 00 00 00 00 00 00 1c 9f 00 00 00 00 00 00 1c 9f 00 00 00 00 00 00 6c 01 00 00 00 00 00 00 6c 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 aa 00 00 00 00 00 00 90 ba 00 00 00 00 00 00 90 ba 00 00 00 00 00 00 70 05 00 00 00 00 00 00 70 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 2a c6 71 47 fa 35 ed be e0 f4 37 27 8c f3 01 4f 06 7d 04 08 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 69 00 00 00 01 00 00 00 06 00 00 00 00 00 81 00 00 00 00 00 69 00 00 00 00 00 00 00 d1 65 ce 6d 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 91 03 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 06 05 00 00 12 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_man {
   strings:
      $s1 = "len <= d->u.inprocess.len - d->u.inprocess.offset" fullword ascii
      $s2 = "pipeline_dump" fullword ascii
      $s3 = "add_output_iconv: source %s, target %s" fullword ascii
      $s4 = "decompress_inprocess_buf" fullword ascii
      $s5 = "d->tag == DECOMPRESS_INPROCESS" fullword ascii
      $s6 = "pipecmd_pre_exec" fullword ascii
      $s7 = "pre-processors `%s' from %s" fullword ascii
      $s8 = "decompress_inprocess_replace" fullword ascii
      $s9 = "decompress_inprocess_len" fullword ascii
      $s10 = "command exited with status %d: %s" fullword ascii
      $s11 = "555555556555" wide /* hex encoded string 'UUUUeU' */
      $s12 = "output source page encoded in ENCODING" fullword ascii
      $s13 = "pipeline_set_command" fullword ascii
      $s14 = "pipeline_command_args" fullword ascii
      $s15 = "pipeline_command" fullword ascii
      $s16 = "pipeline_get_ncommands (decomp_p) <= 1" fullword ascii
      $s17 = "pipecmd_sequence_command" fullword ascii
      $s18 = "ignoring unknown preprocessor `%c'" fullword ascii
      $s19 = "mandb command failed with exit status %d" fullword ascii
      $s20 = "decompress_get_pipeline" fullword ascii
      $s21 = "add_nls_manpaths(): processing %s" fullword ascii
      $s22 = "pipeline_get_ncommands" fullword ascii
      $s23 = "pipeline_install_post_fork" fullword ascii
      $s24 = "pipeline_new_commands" fullword ascii
      $s25 = "pipeline_get_command" fullword ascii
      $s26 = "preprocessor encoding: %s" fullword ascii
      $s27 = "couldn't execute any browser from %s" fullword ascii
      $s28 = "no useful manpath for executable" fullword ascii
      $s29 = "%s:%s reduced to %s%s%s" fullword ascii
      $s30 = "xgetcwd" fullword ascii
      $s31 = "pipeline_run" fullword ascii
      $s32 = "pipeline_readline" fullword ascii
      $s33 = "pipeline_read" fullword ascii
      $s34 = "pipecmd_new_passthrough" fullword ascii
      $s35 = "echo .mso %s.tmac && echo .lf 1" fullword ascii
      $s36 = "From the config file %s:" fullword ascii
      $s37 = "%s:%d: warning: failed .so request" fullword ascii
      $s38 = "/usr/libexec/man-db/zsoelim" fullword ascii
      $s39 = "use this user configuration file" fullword ascii
      $s40 = "pathsearch_executable" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 10 6d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f0 dd 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d0 4f 00 00 00 00 00 00 d0 4f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 a9 05 01 00 00 00 00 00 a9 05 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 60 01 00 00 00 00 00 00 60 01 00 00 00 00 00 00 60 01 00 00 00 00 00 20 5a 00 00 00 00 00 00 20 5a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 c3 01 00 00 00 00 00 d0 c3 01 00 00 00 00 00 d0 c3 01 00 00 00 00 00 7c 18 00 00 00 00 00 00 c0 1d 10 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 08 c7 01 00 00 00 00 00 08 c7 01 00 00 00 00 00 08 c7 01 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 e0 97 01 00 00 00 00 00 e0 97 01 00 00 00 00 00 e0 97 01 00 00 00 00 00 a4 04 00 00 00 00 00 00 a4 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 c3 01 00 00 00 00 00 d0 c3 01 00 00 00 00 00 d0 c3 01 00 00 00 00 00 30 0c 00 00 00 00 00 00 30 0c 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 58 dd 58 d5 32 70 58 e0 81 6f 0f 96 03 dd a7 47 6f 18 d2 99 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 d0 00 00 00 02 00 00 00 07 00 00 00 88 10 04 24 12 05 02 06 10 39 49 20 8c 94 28 61 00 00 00 00 00 00 00 00 d0 00 00 00 d1 00 00 00 d5 00 00 00 00 00 00 00 00 00 00 00 d7 00 00 00 d9 00 00 00 db 00 00 00 00 00 00 00 dd 00 00 00 df 00 00 00 e1 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 400KB and
      8 of them and $magic
}

rule gtfobins_binaries_bzip2 {
   strings:
      $s1 = "   (2) A bug in the compiler used to create this executable" fullword ascii
      $s2 = "   -z --compress       force compression" fullword ascii
      $s3 = "   (3) A bug in the compiler used to create this executable" fullword ascii
      $s4 = "   -d --decompress     force decompression" fullword ascii
      $s5 = "   -t --test           test compressed file integrity" fullword ascii
      $s6 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/bzip2.debug" fullword ascii
      $s7 = "   -c --stdout         output to standard out" fullword ascii
      $s8 = "   usage: %s [flags and input files in any order]" fullword ascii
      $s9 = " no data compressed." fullword ascii
      $s10 = "   -k --keep           keep (don't delete) input files" fullword ascii
      $s11 = "bzip2-devel@sourceware.org" fullword ascii
      $s12 = "   -f --force          overwrite existing output files" fullword ascii
      $s13 = "   -v --verbose        be verbose (a 2nd -v gives more)" fullword ascii
      $s14 = "This is a BUG.  Please report it to:" fullword ascii
      $s15 = "de71b6905f7871e21131f9a544e61dccd38e1f.debug" fullword ascii
      $s16 = "   -h --help           print this message" fullword ascii
      $s17 = "   -s --small          use less memory (at most 2500k)" fullword ascii
      $s18 = "  %s: " fullword ascii
      $s19 = "       failed to detect this.  Try bzip2 -tvv my_file.bz2." fullword ascii
      $s20 = "   If invoked as `bzip2', default action is to compress." fullword ascii
      $s21 = "   -V --version        display software version & license" fullword ascii
      $s22 = "   -L --license        display software version & license" fullword ascii
      $s23 = "   -q --quiet          suppress noncritical error messages" fullword ascii
      $s24 = "   or (3), feel free to report it to: bzip2-devel@sourceware.org." fullword ascii
      $s25 = "   or (2), feel free to report it to: bzip2-devel@sourceware.org." fullword ascii
      $s26 = "libbz2.so.1.0" fullword ascii
      $s27 = "de71b6905f7871e21131f9a544e61dccd38e1f" ascii
      $s28 = "   short flags, so `-v -4' means the same as -v4 or -4v, &c." fullword ascii
      $s29 = "   --best              alias for -9" fullword ascii
      $s30 = "   --fast              alias for -1" fullword ascii
      $s31 = "   (4) A real bug in bzip2 -- I hope this should never be the case." fullword ascii
      $s32 = "   (3) A real bug in bzip2 -- I hope this should never be the case." fullword ascii
      $s33 = "   system, please try and read it before mailing me.  If you don't" fullword ascii
      $s34 = "   The user's manual, Section 4.3, has more info on (1) and (2)." fullword ascii
      $s35 = "              as `bunzip2',  default action is to decompress." fullword ascii
      $s36 = "       (a surprisingly common problem; try a different machine.)" fullword ascii
      $s37 = "       (unlikely, if you didn't compile bzip2 yourself.)" fullword ascii
      $s38 = "   (1) The compressed data is corrupted, and bzip2's usual checks" fullword ascii
      $s39 = "   The user's manual, Section 4.3, has more info on (2) and (3)." fullword ascii
      $s40 = "   bug report should have.  If the manual is available on your" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 40 2e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f8 91 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f8 12 00 00 00 00 00 00 f8 12 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 81 37 00 00 00 00 00 00 81 37 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 a0 21 00 00 00 00 00 00 a0 21 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 8c 00 00 00 00 00 00 30 9c 00 00 00 00 00 00 30 9c 00 00 00 00 00 00 30 04 00 00 00 00 00 00 c0 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 40 8c 00 00 00 00 00 00 40 9c 00 00 00 00 00 00 40 9c 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 80 7b 00 00 00 00 00 00 80 7b 00 00 00 00 00 00 80 7b 00 00 00 00 00 00 e4 00 00 00 00 00 00 00 e4 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 8c 00 00 00 00 00 00 30 9c 00 00 00 00 00 00 30 9c 00 00 00 00 00 00 d0 03 00 00 00 00 00 00 d0 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 16 de 71 b6 90 5f 78 71 e2 11 31 f9 a5 44 e6 1d cc d3 8e 1f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 35 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 35 00 00 00 37 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b3 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_genisoimage {
   strings:
      $s1 = "INFO: /dev/%s, (host%d/bus%d/target%d/lun%d) will be mapped on the schilly bus No %d (%d,%d,%d)" fullword ascii
      $s2 = "EXAMPLE: /dev/ide/host0/bus0/target1/lun0/cd" fullword ascii
      $s3 = "EXAMPLE: /dev/scsi/host1/bus2/target3/lun4/cd" fullword ascii
      $s4 = "Reading directory %s in old session failed, cannot execute -old-root." fullword ascii
      $s5 = "# See <http://www.einval.com/~steve/software/CD/JTE/> for details about JTE" fullword ascii
      $s6 = "JigsawDownload template %s %s/%d.%d " fullword ascii
      $s7 = "Reading old session failed, cannot execute -old-root." fullword ascii
      $s8 = "scsi_format: post processing %d" fullword ascii
      $s9 = "Target (%d,%d,%d): DMA max %d old max: %ld" fullword ascii
      $s10 = "Illegal value for bus, target or lun '%d,%d,%d'" fullword ascii
      $s11 = "Bad options - need to specify output names for jigdo and template file, and also the md5-list input file!" fullword ascii
      $s12 = "Possible Catalog file overflow - please report error" fullword ascii
      $s13 = "Incorrectly encoded string (%s) encountered." fullword ascii
      $s14 = "error scanning afpfile %s - continuing" fullword ascii
      $s15 = "Found mipsel boot loader %s: using extent %lu, #blocks %lu" fullword ascii
      $s16 = "Found hppa bootloader %s: using extent %lu (0x%lX), size %lu (0x%lX)" fullword ascii
      $s17 = "Fatal error - RR overflow (reclen %d) for file %s" fullword ascii
      $s18 = "File %s is not readable - ignoring" fullword ascii
      $s19 = "Error - boot image '%s' has not an allowable size." fullword ascii
      $s20 = "fillbytes" fullword ascii /* base64 encoded string '~)eo+^' */
      $s21 = "TYPE_MBIN error - shouldn't happen!" fullword ascii
      $s22 = "Template=http://localhost/%s" fullword ascii
      $s23 = "Directories too deep for '%s' (%d) max is %d; ignored - continuing." fullword ascii
      $s24 = "Bus: %d Target: %d Lun: %d Chan: %d Ino: %d" fullword ascii
      $s25 = "INFO: Bus: %d Target: %d Lun: %d Chan: %d Ino: %d" fullword ascii
      $s26 = "  - VIDEO_TS has invalid contents" fullword ascii
      $s27 = "JTE at http://www.einval.com/~steve/software/JTE/ ; jigdo at http://atterer.org/jigdo/" fullword ascii
      $s28 = "Set hppa boot loader file name (relative to image root)" fullword ascii
      $s29 = "Bad fifo size (%s) in the config, device description." fullword ascii
      $s30 = "Multisession usage bug: Must specify -C if -M is used." fullword ascii
      $s31 = "Use -o - to force the output." fullword ascii
      $s32 = "Bad speed (%s) in the config, drive description." fullword ascii
      $s33 = "ERROR: with link reading! link %s, result of readlink %i" fullword ascii
      $s34 = "ERROR: this cdrom is already mapped %s(%d,%d,%d)" fullword ascii
      $s35 = "sha1_process_bytes" fullword ascii
      $s36 = "sha1_process_block" fullword ascii
      $s37 = "Usage: %s [options] -o file directory ..." fullword ascii
      $s38 = "# Template Hex %sSum %s" fullword ascii
      $s39 = "Unknown file type (%s) %s - ignoring and continuing." fullword ascii
      $s40 = "Invalid node - '%s'." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 96 01 00 00 00 00 00 40 00 00 00 00 00 00 00 f0 d4 09 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 88 4e 01 00 00 00 00 00 88 4e 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 41 1d 04 00 00 00 00 00 41 1d 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 05 00 00 00 00 00 00 70 05 00 00 00 00 00 00 70 05 00 00 00 00 00 98 cc 01 00 00 00 00 00 98 cc 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 40 07 00 00 00 00 00 f0 40 07 00 00 00 00 00 f0 40 07 00 00 00 00 00 51 92 02 00 00 00 00 00 d8 f4 27 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a0 6d 07 00 00 00 00 00 a0 6d 07 00 00 00 00 00 a0 6d 07 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 5c 8f 06 00 00 00 00 00 5c 8f 06 00 00 00 00 00 5c 8f 06 00 00 00 00 00 f4 18 00 00 00 00 00 00 f4 18 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 40 07 00 00 00 00 00 f0 40 07 00 00 00 00 00 f0 40 07 00 00 00 00 00 10 2f 00 00 00 00 00 00 10 2f 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 c6 96 a6 15 89 5f 24 82 30 fa 74 1c 23 d9 64 3a ab 93 0c e3 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 09 02 00 00 92 00 00 00 80 00 00 00 0d 00 00 00 02 51 00 01 03 00 22 00 02 02 81 a2 82 80 00 26 80 40 00 00 00 08 00 21 12 90 02 18 a0 04 01 39 00 01 01 00 00 00 44 c1 78 01 06 80 00 04 00 00 00 c4 00 06 80 09 54 1e 20 00 09 20 00 00 25 20 00 04 20 09 00 08 c4 00 02 00 00 2d 20 00 00 09}
condition:
      filesize < 2000KB and
      8 of them and $magic
}

rule gtfobins_binaries_arp {
   strings:
      $s1 = "  arp [-v]   [<HW>] [-i <if>] -s  <host> <hwaddr> [temp]            <-Add entry" fullword ascii
      $s2 = "Usage: x25_route [-v] del Target[/mask] [dev] If" fullword ascii
      $s3 = "Usage: inet6_route [-vF] del Target" fullword ascii
      $s4 = "arp: %s: kernel only supports 'inet'." fullword ascii
      $s5 = "getaddrinfo: %s: %d" fullword ascii
      $s6 = "arp: %s: hardware type without ARP support." fullword ascii
      $s7 = "arp: %s: unknown address family." fullword ascii
      $s8 = "        -e                       display (all) hosts in default (Linux) style" fullword ascii
      $s9 = "  arp [-v]          [-i <if>] -d  <host> [pub]               <-Delete ARP entry" fullword ascii
      $s10 = "%s (%s) -- no entry" fullword ascii
      $s11 = "        -a                       display (all) hosts in alternative (BSD) style" fullword ascii
      $s12 = "arp: -N not yet supported." fullword ascii
      $s13 = "arp: cant get HW-Address for `%s': %s." fullword ascii
      $s14 = "X.25 not configured in this system." fullword ascii
      $s15 = "arp: device `%s' has HW address %s `%s'." fullword ascii
      $s16 = "Unknown address family `%s'." fullword ascii
      $s17 = "arp: format error on line %u of etherfile %s !" fullword ascii
      $s18 = "INET6 (IPv6) not configured in this system." fullword ascii
      $s19 = "INCOMPLETE" fullword ascii
      $s20 = "%s:%s:%s:%s:%s:%s:%s:%s" fullword ascii
      $s21 = "arp: %s: unknown hardware type." fullword ascii
      $s22 = "%s: hardware type not supported!" fullword ascii
      $s23 = "%s: address family not supported!" fullword ascii
      $s24 = "Kernel IPv6 routing table" fullword ascii
      $s25 = "Kernel X.25 routing table" fullword ascii
      $s26 = "       x25_route [-v] add Target[/mask] [dev] If" fullword ascii
      $s27 = "       inet6_route [-vF] add Target [gw Gw] [metric M] [[dev] If]" fullword ascii
      $s28 = "arp: need host name" fullword ascii
      $s29 = "dontpub" fullword ascii
      $s30 = "  arp [-v]   [<HW>] [-i <if>] -Ds <host> <if> [netmask <nm>] pub          <-''-" fullword ascii
      $s31 = "HW: (ether) +ETHER +ARC +SLIP +PPP +TUNNEL -TR +AX25 +NETROM +X25 +FR +ROSE +ASH +SIT +FDDI +HIPPI +HDLC/LAPB +EUI64 " fullword ascii
      $s32 = "AF: (inet) +UNIX +INET +INET6 +IPX +AX25 +NETROM +X25 +ATALK +ECONET +ROSE -BLUETOOTH" fullword ascii
      $s33 = "netmask %s " fullword ascii
      $s34 = "<incomplete> " fullword ascii
      $s35 = "Frame Relay DLCI" fullword ascii
      $s36 = "Frame Relay Access Device" fullword ascii
      $s37 = "  <HW>=Use '-H <hw>' to specify hardware address type. Default: %s" fullword ascii
      $s38 = "arp: invalid hardware address" fullword ascii
      $s39 = "Flushing `inet6' routing table not supported" fullword ascii
      $s40 = "arp: need hardware address" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 3f 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 00 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 28 2b 00 00 00 00 00 00 28 2b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 61 74 00 00 00 00 00 00 61 74 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 f4 30 00 00 00 00 00 00 f4 30 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 ea 00 00 00 00 00 00 d0 fa 00 00 00 00 00 00 d0 fa 00 00 00 00 00 00 48 14 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ed 00 00 00 00 00 00 d8 fd 00 00 00 00 00 00 d8 fd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 30 c9 00 00 00 00 00 00 30 c9 00 00 00 00 00 00 30 c9 00 00 00 00 00 00 4c 03 00 00 00 00 00 00 4c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 ea 00 00 00 00 00 00 d0 fa 00 00 00 00 00 00 d0 fa 00 00 00 00 00 00 30 05 00 00 00 00 00 00 30 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 f0 70 53 00 f1 15 71 9d 97 00 98 ee 3d 87 30 e5 72 85 d3 47 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 48 00 00 00 01 00 00 00 06 00 00 00 00 05 81 00 00 01 1c 02 48 00 00 00 4a 00 00 00 4b 00 00 00 28 1d 8c 1c d1 65 ce 6d 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 62 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_wget {
   strings:
      $x1 = "ABEDABELABETABLEABUTACHEACIDACMEACREACTAACTSADAMADDSADENAFARAFROAGEEAHEMAHOYAIDAAIDEAIDSAIRYAJARAKINALANALECALGAALIAALLYALMAALOE" ascii
      $s2 = "Error spawning %s: %d" fullword ascii
      $s3 = "Error reading response from command \"%s %s\": %s" fullword ascii
      $s4 = "metadata://gnu.org/software/wget/warc/wget.log" fullword ascii
      $s5 = "  -e,  --execute=COMMAND           execute a `.wgetrc'-style command" fullword ascii
      $s6 = "gcc -DHAVE_CONFIG_H -DSYSTEM_WGETRC=\"/etc/wgetrc\" -DLOCALEDIR=\"/usr/share/locale\" -I. -I../../src -I../lib -I../../lib -Wdat" ascii
      $s7 = "!!!!!!!!!!!!!!" fullword wide /* reversed goodware string '!!!!!!!!!!!!!!' */
      $s8 = "!!!!!!!!!!!!!!!!!!!!" fullword wide /* reversed goodware string '!!!!!!!!!!!!!!!!!!!!' */
      $s9 = "!!!!!!!!!!!!!!!!!!!!!!!" fullword wide /* reversed goodware string '!!!!!!!!!!!!!!!!!!!!!!!' */
      $s10 = "EMILEMITEMMAENDSERICEROSEVENEVEREVILEYEDFACEFACTFADEFAILFAINFAIRFAKEFALLFAMEFANGFARMFASTFATEFAWNFEARFEATFEEDFEELFEETFELLFELTFEND" ascii
      $s11 = "       --password=PASS             set both ftp and http password to PASS" fullword ascii
      $s12 = "Password for '%s%s@%s': " fullword ascii
      $s13 = "\"LIST -a\" failed: I will use \"LIST\" as standard list command" fullword ascii
      $s14 = "  -U,  --user-agent=AGENT          identify as AGENT instead of Wget/VERSION" fullword ascii
      $s15 = "                                   of base64 encoded sha256 hashes preceded by" fullword ascii
      $s16 = "# HSTS 1.0 Known Hosts database for GNU Wget." fullword ascii
      $s17 = "vvvvvvvx" fullword wide /* reversed goodware string 'xvvvvvvv' */
      $s18 = "Cookie coming from %s attempted to set domain to " fullword ascii
      $s19 = "RUBERUBYRUDERUDYRUINRULERUNGRUNSRUNTRUSERUSHRUSKRUSSRUSTRUTHSACKSAFESAGESAIDSAILSALESALKSALTSAMESANDSANESANGSANKSARASAULSAVESAYS" ascii
      $s20 = "WARNING: No username set with --ask-password. This is usually not what you want." fullword ascii
      $s21 = "metadata://gnu.org/software/wget/warc/MANIFEST.txt" fullword ascii
      $s22 = "Error initializing spawn file actions for use-askpass: %d" fullword ascii
      $s23 = "efix-map=/build/reproducible-path/wget-1.24.5=. -fstack-protector-strong -fstack-clash-protection -Wformat -Werror=format-securi" ascii
      $s24 = "LIST returned the same amount of data of \"LIST -a\": I will use \"LIST -a\" as standard list command" fullword ascii
      $s25 = "metadata://gnu.org/software/wget/warc/wget_arguments.txt" fullword ascii
      $s26 = "retryonhosterror" fullword ascii
      $s27 = "Error setting spawn file actions for use-askpass: %d" fullword ascii
      $s28 = "ftpscleardataconnection" fullword ascii
      $s29 = "LIST returned more data than \"LIST -a\": I will use \"LIST\" as standard list command" fullword ascii
      $s30 = "contentonerror" fullword ascii
      $s31 = "Could not open temporary WARC log file." fullword ascii
      $s32 = "UNIX TYPE L8: I know it and I will use \"LIST -a\" as standard list command" fullword ascii
      $s33 = "LIST returned less data than \"LIST -a\": I will use \"LIST -a\" as standard list command" fullword ascii
      $s34 = "       --ftps-fallback-to-ftp          fall back to FTP if FTPS is not supported in the target server" fullword ascii
      $s35 = "roducible-path/wget-1.24.5=. -fstack-protector-strong -fstack-clash-protection -Wformat -Werror=format-security -fcf-protection " ascii
      $s36 = "       --ftp-password=PASS         set ftp password to PASS" fullword ascii
      $s37 = "http://netpreserve.org/warc/1.0/revisit/identical-payload-digest" fullword ascii
      $s38 = "                                     username and password.  If no COMMAND is " fullword ascii
      $s39 = "Server does not support AUTH TLS. Falling back to FTP." fullword ascii
      $s40 = "warctempdir" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 db 00 00 00 00 00 00 40 00 00 00 00 00 00 00 30 46 07 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 a9 00 00 00 00 00 00 80 a9 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 d9 32 04 00 00 00 00 00 d9 32 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 f0 04 00 00 00 00 00 00 f0 04 00 00 00 00 00 00 f0 04 00 00 00 00 00 b0 e6 01 00 00 00 00 00 b0 e6 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 d8 06 00 00 00 00 00 d0 e8 06 00 00 00 00 00 d0 e8 06 00 00 00 00 00 14 6c 00 00 00 00 00 00 a8 dc 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 f5 06 00 00 00 00 00 e0 05 07 00 00 00 00 00 e0 05 07 00 00 00 00 00 60 02 00 00 00 00 00 00 60 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 68 40 06 00 00 00 00 00 68 40 06 00 00 00 00 00 68 40 06 00 00 00 00 00 4c 14 00 00 00 00 00 00 4c 14 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 d8 06 00 00 00 00 00 d0 e8 06 00 00 00 00 00 d0 e8 06 00 00 00 00 00 30 27 00 00 00 00 00 00 30 27 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 aa 3a 13 4f 6b a9 e5 09 d1 03 02 6f 63 d4 c6 bc f0 66 15 ce 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 f1 00 00 00 02 00 00 00 07 00 00 00 20 01 00 04 50 01 0c 0e 5a 49 01 40 80 14 08 00 f1 00 00 00 f5 00 00 00 fa 00 00 00 a6 dd a3 6b c6 e1 f6 b7 d0 65 ce 6d 29 1d 8c 1c 42 07 b9 27 c4 b9 9c 40 c0 b3 f7 12 66 55 61 10 39 f2 8b 1c 3a 0d 85 b3 32 c4 f7 12 b2 a2 f7 12 5e 96 93 1c}
condition:
      filesize < 1000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_tmate {
   strings:
      $s1 = "[-bF] [-t target-pane] shell-command command [command]" fullword ascii
      $s2 = "[-b] [-t target-pane] shell-command" fullword ascii
      $s3 = "[-suw] [-b session-template] [-c window template] [-S format] [-W format] [-t target-window]" fullword ascii
      $s4 = "Usage: %s [options] [tmux-command [flags]]" fullword ascii
      $s5 = "bind -n WheelUpPane if-shell -Ft= '#{mouse_any_flag}' 'send-keys -M' 'if -Ft= \"#{pane_in_mode}\" \"send-keys -M\" \"copy-mode -" ascii
      $s6 = "bind -n MouseDown3Pane if-shell -Ft= '#{mouse_any_flag}' 'select-pane -t=; send-keys -M' 'select-pane -mt='" fullword ascii
      $s7 = "shell %s, command %s" fullword ascii
      $s8 = "target %s (flags %#x): session=%s, window=%s, pane=%s" fullword ascii
      $s9 = "preparing -t state: target %s" fullword ascii
      $s10 = "preparing -s state: target %s" fullword ascii
      $s11 = "tmate-%s-%ld.log" fullword ascii
      $s12 = "[-I inputs] [-p prompts] [-t target-client] [template]" fullword ascii
      $s13 = "[-t target-window][-F format] [template]" fullword ascii
      $s14 = "bind-key -%st %s%s %*s %s%s%s%s" fullword ascii
      $s15 = "[-t target-window] [-F format] [template]" fullword ascii
      $s16 = "[#{session_name}] #{window_index}:#{window_name}, current pane #{pane_index} - (%H:%M %d-%b-%y)" fullword ascii
      $s17 = "[-AdDEP] [-c start-directory] [-F format] [-n window-name] [-s session-name] [-t target-session] [-x width] [-y height] [command" ascii
      $s18 = "[-AdDEP] [-c start-directory] [-F format] [-n window-name] [-s session-name] [-t target-session] [-x width] [-y height] [command" ascii
      $s19 = "bind \"'\" command-prompt -pindex \"select-window -t ':%%'\"" fullword ascii
      $s20 = "bind . command-prompt \"move-window -t '%%'\"" fullword ascii
      $s21 = "cmd_command_prompt_exec" fullword ascii
      $s22 = "[-Elnpr] [-c target-client] [-t target-session] [-T key-table]" fullword ascii
      $s23 = "[-gu] [-t target-session] hook-name [command]" fullword ascii
      $s24 = "%s: target %s, return %p" fullword ascii
      $s25 = "%s: target %s, type %d" fullword ascii
      $s26 = "command or window name given with target" fullword ascii
      $s27 = "bind '$' command-prompt -I'#S' \"rename-session '%%'\"" fullword ascii
      $s28 = "cmd_kill_session_exec" fullword ascii
      $s29 = "cmd_new_session_exec" fullword ascii
      $s30 = "cmd_respawn_pane_exec" fullword ascii
      $s31 = "getshell" fullword ascii
      $s32 = "ssh_get_publickey_hash" fullword ascii
      $s33 = "bind -n MouseDown1Pane select-pane -t=\\; send-keys -M" fullword ascii
      $s34 = "cmd_list_sessions_exec" fullword ascii
      $s35 = "cmd_list_keys_exec" fullword ascii
      $s36 = "spawn: %s -- %s" fullword ascii
      $s37 = "cmd_pipe_pane_exec" fullword ascii
      $s38 = "cmd_attach_session_exec" fullword ascii
      $s39 = "cmd_respawn_window_exec" fullword ascii
      $s40 = "bind -n MouseDrag1Pane if -Ft= '#{mouse_any_flag}' 'if -Ft= \"#{pane_in_mode}\" \"copy-mode -M\" \"send-keys -M\"' 'copy-mode -M" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 36 02 00 00 00 00 00 40 00 00 00 00 00 00 00 88 f8 09 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 1d 02 00 00 00 00 00 08 1d 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 19 63 05 00 00 00 00 00 19 63 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 90 07 00 00 00 00 00 00 90 07 00 00 00 00 00 00 90 07 00 00 00 00 00 98 d0 01 00 00 00 00 00 98 d0 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 68 09 00 00 00 00 00 d0 78 09 00 00 00 00 00 d0 78 09 00 00 00 00 00 70 8e 00 00 00 00 00 00 58 ec 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 90 e6 09 00 00 00 00 00 90 f6 09 00 00 00 00 00 90 f6 09 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 90 47 08 00 00 00 00 00 90 47 08 00 00 00 00 00 90 47 08 00 00 00 00 00 e4 27 00 00 00 00 00 00 e4 27 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 68 09 00 00 00 00 00 d0 78 09 00 00 00 00 00 d0 78 09 00 00 00 00 00 30 87 00 00 00 00 00 00 30 87 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 e7 05 06 0f 43 61 59 39 dd fc 36 97 67 7d 6f 73 01 9a dc 14 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 07 04 00 00 e2 00 00 00 80 00 00 00 0d 00 00 00 00 21 8a 10 87 a0 70 81 41 42 39 18 50 06 43 1a 04 10 c0 ac 50 00 00 00 02 39 10 59 20 65 19 2e 95 42 93 a4 00 8a 20 92 02 ae 88 ea 89 38 24 30 54 89 84 0c 25 22 52 91 03 a2 01 95 80 3a bc b0 02 62 00 c9 8d f7 26 08 80 22 c9 c2 00 0d 02 00}
condition:
      filesize < 2000KB and
      8 of them and $magic
}

rule gtfobins_binaries_mail {
   strings:
      $s1 = "May not execute \"%s\" -- message file is read only" fullword ascii
      $s2 = "\"%s\": Command execution not allowed." fullword ascii
      $s3 = "Fatal error, process exited with code %d." fullword ascii
      $s4 = "Fatal error in process." fullword ascii
      $s5 = "May not execute \"%s\" while sending" fullword ascii
      $s6 = "May not execute \"%s\" while sourcing" fullword ascii
      $s7 = "Unknown command: \"%s\"" fullword ascii
      $s8 = "Unrecognized scrolling command \"%s\"" fullword ascii
      $s9 = "Empty reply-to field -- replying to author" fullword ascii
      $s10 = "Error creating temporary lockfile" fullword ascii
      $s11 = "Can't send mail: sendmail process failed" fullword ascii
      $s12 = "\"%s\" is not a user of this system" fullword ascii
      $s13 = "temporary file" fullword ascii
      $s14 = "noheader" fullword ascii
      $s15 = "searchheaders" fullword ascii
      $s16 = "user = %s, homedir = %s" fullword ascii
      $s17 = "Command buffer overflow" fullword ascii
      $s18 = "(Interrupt -- one more to kill letter)" fullword ascii
      $s19 = "usage: %s [-dEIinv] [-a header] [-b bcc-addr] [-c cc-addr] [-r from-addr] [-s subject] [--] to-addr ..." fullword ascii
      $s20 = "Content-Type: text/plain; charset=\"%s\"" fullword ascii
      $s21 = "Commands are:" fullword ascii
      $s22 = "Message temporary file corrupted" fullword ascii
      $s23 = "Mail version %s.  Type ? for help." fullword ascii
      $s24 = "Unrecognized if-keyword: \"%s\"" fullword ascii
      $s25 = "\"%s\": Unknown expansion error." fullword ascii
      $s26 = "       %s [-dEIiNnv] -f [name]" fullword ascii
      $s27 = "Failed to write pid into tmp lockfile." fullword ascii
      $s28 = "\"%s\": Syntax error." fullword ascii
      $s29 = "\"inc\" command failed..." fullword ascii
      $s30 = "Message %d:" fullword ascii
      $s31 = "detract asked to insert commas" fullword ascii
      $s32 = "You must specify to-addr recipients when using -s, -c, -b, or -r" fullword ascii
      $s33 = "toplines" fullword ascii
      $s34 = "keepsave" fullword ascii
      $s35 = "saveretain" fullword ascii
      $s36 = "showname" fullword ascii
      $s37 = "Cannot give -f and people to send to" fullword ascii
      $s38 = "indentprefix" fullword ascii
      $s39 = "expandaddr" fullword ascii
      $s40 = "saveignore" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 c0 4e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 08 b2 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 98 31 00 00 00 00 00 00 98 31 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 bd 02 01 00 00 00 00 00 bd 02 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 48 4e 00 00 00 00 00 00 48 4e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 a2 01 00 00 00 00 00 b0 b2 01 00 00 00 00 00 b0 b2 01 00 00 00 00 00 10 0e 00 00 00 00 00 00 f8 6b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a8 a9 01 00 00 00 00 00 a8 b9 01 00 00 00 00 00 a8 b9 01 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 14 6b 01 00 00 00 00 00 14 6b 01 00 00 00 00 00 14 6b 01 00 00 00 00 00 3c 07 00 00 00 00 00 00 3c 07 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 a2 01 00 00 00 00 00 b0 b2 01 00 00 00 00 00 b0 b2 01 00 00 00 00 00 50 0d 00 00 00 00 00 00 50 0d 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 21 c2 14 1b f0 58 7d 60 ae 4d a7 8e 0d c4 05 35 02 be 26 e6 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 81 00 00 00 01 00 00 00 06 00 00 00 00 00 81 00 00 00 00 00 81 00 00 00 00 00 00 00 d1 65 ce 6d 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 8d 03 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e0 02 00 00 12 00 00 00}
condition:
      filesize < 300KB and
      8 of them and $magic
}

rule gtfobins_binaries_telnet {
   strings:
      $s1 = "usage: %s [-4] [-6] [-l user] [-b addr] [-a] host-name [port]" fullword ascii
      $s2 = "Need %s%d argument%s to 'auth %s' command.  'auth ?' for help." fullword ascii
      $s3 = "to 'encrypt %s' command.  'encrypt ?' for help." fullword ascii
      $s4 = "autologin" fullword ascii
      $s5 = "telnet: Kerberos V5: failure on credentials(%s)" fullword ascii
      $s6 = "krb5_auth_con_getkey failed: %s" fullword ascii
      $s7 = "Need an argument to 'encrypt' command.  'encrypt ?' for help." fullword ascii
      $s8 = "%s: Warning, Cannot decrypt type %s (%d)!!!" fullword ascii
      $s9 = "Try '%s --help' or '%s --usage' for more information." fullword ascii
      $s10 = ">>>%s: I support auth type %s (%d) %s (%d)" fullword ascii
      $s11 = ">>>%s: Init failed: auth type %d %d" fullword ascii
      $s12 = "Server lookup failure:  %s:%s, %s" fullword ascii
      $s13 = "Need an argument to 'auth' command.  'auth ?' for help." fullword ascii
      $s14 = "incorrect service name: \"%s\" != \"host\"" fullword ascii
      $s15 = "krb5_auth_con_getrecvsubkey" fullword ascii
      $s16 = "obtain tickets for the remote host in REALM instead of the remote host's realm" fullword ascii
      $s17 = "krb5_auth_con_getsendsubkey" fullword ascii
      $s18 = ">>>%s: in encrypt_wait" fullword ascii
      $s19 = ">>>%s: Request input to be encrypted" fullword ascii
      $s20 = ">>>%s: Started to encrypt output with type %s" fullword ascii
      $s21 = ">>>%s: encrypt_reply returned %d" fullword ascii
      $s22 = ">>>%s: Encrypt start: %s (%d) %s" fullword ascii
      $s23 = "Usage: encrypt disable <type> [input|output]" fullword ascii
      $s24 = "Usage: encrypt stop [input|output]" fullword ascii
      $s25 = "Usage: encrypt start [input|output]" fullword ascii
      $s26 = "Usage: encrypt enable <type> [input|output]" fullword ascii
      $s27 = "Usage: encrypt type <type> [input|output]" fullword ascii
      $s28 = "%s: unrecognized option '%s%s'" fullword ascii
      $s29 = "%s: option '%s%s' is ambiguous" fullword ascii
      $s30 = "%s: option '%s%s' requires an argument" fullword ascii
      $s31 = "%s: option '%s%s' is ambiguous; possibilities:" fullword ascii
      $s32 = "%s: option '%s%s' doesn't allow an argument" fullword ascii
      $s33 = "%s: Warning, Cannot decrypt input stream!!!" fullword ascii
      $s34 = "Need %s%d-%d arguments " fullword ascii
      $s35 = "Kerberos V5: failed to init auth_context (%s)" fullword ascii
      $s36 = "telnet: Kerberos V5: error while constructing service name: %s" fullword ascii
      $s37 = "autoencrypt" fullword ascii
      $s38 = "telnet: Kerberos V5: failure on principal (%s)" fullword ascii
      $s39 = "telnet: Kerberos V5: mk_req failed (%s)" fullword ascii
      $s40 = ">>>%s: auth_send got:" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 7d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 88 f1 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c8 64 00 00 00 00 00 00 c8 64 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 6d 91 01 00 00 00 00 00 6d 91 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 bc 98 00 00 00 00 00 00 bc 98 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 b7 02 00 00 00 00 00 10 b7 02 00 00 00 00 00 10 b7 02 00 00 00 00 00 2c 39 00 00 00 00 00 00 a8 15 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 f0 b8 02 00 00 00 00 00 f0 b8 02 00 00 00 00 00 f0 b8 02 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d0 5f 02 00 00 00 00 00 d0 5f 02 00 00 00 00 00 d0 5f 02 00 00 00 00 00 fc 0a 00 00 00 00 00 00 fc 0a 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 b7 02 00 00 00 00 00 10 b7 02 00 00 00 00 00 10 b7 02 00 00 00 00 00 f0 08 00 00 00 00 00 00 f0 08 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 72 6c ec bf 0c 3f b0 91 e0 0a 95 20 cb aa a4 50 07 38 fc e8 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 97 00 00 00 02 00 00 00 07 00 00 00 02 00 c0 00 52 01 80 9f 30 5b 09 0a a8 04 c8 21 97 00 00 00 00 00 00 00 00 00 00 00 98 00 00 00 9a 00 00 00 9d 00 00 00 9e 00 00 00 9f 00 00 00 a1 00 00 00 00 00 00 00 00 00 00 00 a3 00 00 00 a6 00 00 00 00 00 00 00 a8 00 00 00 00 00 00 00}
condition:
      filesize < 600KB and
      8 of them and $magic
}

rule gtfobins_binaries_systemctl {
   strings:
      $x1 = "Failed to dump process list for '%s', ignoring: %s" fullword ascii
      $s2 = "systemd.log_target" fullword ascii
      $s3 = "Invalid process description in GetUnitProcesses reply: cgroup=\"%s\" pid=%u command=\"%s\", ignoring: %m" fullword ascii
      $s4 = "/run/systemd/ask-password/tmp.XX/usr/share/zonei/sys/firmware/efare/efi/efivars//default.target" fullword ascii
      $s5 = "Failed to convert ExecCommandFlags to strv: %m" fullword ascii
      $s6 = "a fatal signal was delivered causing the control process to dump core" fullword ascii
      $s7 = "Failed to parse systemd.allow_userspace_verity= kernel command line option, refusing userspace dm-verity signature authenticatio" ascii
      $s8 = "Failed to parse systemd.allow_userspace_verity= kernel command line option, refusing userspace dm-verity signature authenticatio" ascii
      $s9 = "org.freedesktop.login1.OperationInProgress" fullword ascii
      $s10 = "Failed to rename temporary file '%s' to target file '%s': %m" fullword ascii
      $s11 = "Failed to convert strv to ExecCommandFlags: %m" fullword ascii
      $s12 = "Failed to process message type=%s sender=%s destination=%s path=%s interface=%s member=%s cookie=%lu reply_cookie=%lu signature=" ascii
      $s13 = "[{\"feature\":\"lzma\",\"description\":\"Support lzma compression in journal and coredump files\",\"priority\":\"suggested\",\"s" ascii
      $s14 = "[{\"feature\":\"zstd\",\"description\":\"Support zstd compression in journal and coredump files\",\"priority\":\"recommended\"," ascii
      $s15 = "[{\"feature\":\"lz4\",\"description\":\"Support lz4 compression in journal and coredump files\",\"priority\":\"suggested\",\"son" ascii
      $s16 = "%s /usr/sbin/kexec --load \"%s\" --append \"%s\"%s%s%s" fullword ascii
      $s17 = "[{\"feature\":\"zstd\",\"description\":\"Support zstd compression in journal and coredump files\",\"priority\":\"recommended\"," ascii
      $s18 = "[{\"feature\":\"lzma\",\"description\":\"Support lzma compression in journal and coredump files\",\"priority\":\"suggested\",\"s" ascii
      $s19 = "[{\"feature\":\"lz4\",\"description\":\"Support lz4 compression in journal and coredump files\",\"priority\":\"suggested\",\"son" ascii
      $s20 = "Note: found \"%s\" on the kernel command line, which overrides the default unit." fullword ascii
      $s21 = "org.freedesktop.login1.SleepVerbNotSupported" fullword ascii
      $s22 = "dump_processes" fullword ascii
      $s23 = "dump_extra_processes" fullword ascii
      $s24 = "Failed to parse log target '%s', ignoring." fullword ascii
      $s25 = "  -H --host=[USER@]HOST  Operate on remote host" fullword ascii
      $s26 = "Userspace dm-verity signature authentication disabled via systemd.allow_userspace_verity= kernel command line variable." fullword ascii
      $s27 = "Failed to process message type=%s sender=%s destination=%s path=%s interface=%s member=%s cookie=%lu reply_cookie=%lu signature=" ascii
      $s28 = "Failed to acquire process name of %i, ignoring: %m" fullword ascii
      $s29 = "Failed to determine whether /run/boot-loader-entries/ exists: %m" fullword ascii
      $s30 = "/usr/bin/systemd-tty-ask-password-agent" fullword ascii
      $s31 = "Failed to parse --boot-loader-menu= argument '%s': %m" fullword ascii
      $s32 = "Failed to process GetAll method reply: %m" fullword ascii
      $s33 = "Failed to add password to kernel keyring: %m" fullword ascii
      $s34 = "Failed to get log %s of %s: %s" fullword ascii
      $s35 = "%s: symlink target \"%s\" has incompatible suffix, rejecting." fullword ascii
      $s36 = "Failed to execute %s: %m" fullword ascii
      $s37 = "org.freedesktop.login1" fullword ascii
      $s38 = "org.freedesktop.login1.Manager" fullword ascii
      $s39 = "org.freedesktop.login1.SessionNotOnSeat" fullword ascii
      $s40 = "org.freedesktop.login1.NoSuchSession" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 c6 01 00 00 00 00 00 40 00 00 00 00 00 00 00 d0 5f 18 00 00 00 00 00 00 00 00 00 40 00 38 00 0e 00 40 00 24 00 23 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 18 82 01 00 00 00 00 00 18 82 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 90 01 00 00 00 00 00 00 90 01 00 00 00 00 00 00 90 01 00 00 00 00 00 e5 ed 0f 00 00 00 00 00 e5 ed 0f 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 11 00 00 00 00 00 00 80 11 00 00 00 00 00 00 80 11 00 00 00 00 00 68 8e 05 00 00 00 00 00 68 8e 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 98 19 17 00 00 00 00 00 98 19 17 00 00 00 00 00 98 19 17 00 00 00 00 00 40 44 01 00 00 00 00 00 00 55 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 80 42 18 00 00 00 00 00 80 42 18 00 00 00 00 00 80 42 18 00 00 00 00 00 60 02 00 00 00 00 00 00 60 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 f4 05 00 00 00 00 00 00 f4 05 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 98 19 17 00 00 00 00 00 98 19 17 00 00 00 00 00 98 19 17 00 00 00 00 00 34 00 00 00 00 00 00 00 c8 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c4 5c 15 00 00 00 00 00 c4 5c 15 00 00 00 00 00 c4 5c 15 00 00 00 00 00 9c 2d 00 00 00 00 00 00 9c 2d 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 98 19 17 00 00 00 00 00 98 19 17 00 00 00 00 00 98 19 17 00 00 00 00 00 68 36 01 00 00 00 00 00 68 36 01 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 64 a5 07 05 98 27 de b3 51 31 27 78 cb 32 92 a0 ae 76 97 4e 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 88 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c}
condition:
      filesize < 5000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_ncftp {
   strings:
      $s1 = "%s%.11s%s%s by Mike Gleason (http://www.NcFTP.com/contact/)." fullword ascii
      $s2 = "miscellaneous error occurred while trying to login to the host" fullword ascii
      $s3 = "remote host disconnected during login" fullword ascii
      $s4 = "# Run the \"ncftpbatch\" program to process the spool directory." fullword ascii
      $s5 = "  -p XX : Login with password XX." fullword ascii
      $s6 = "  -u XX : Login with username XX." fullword ascii
      $s7 = "  -j XX : Login with account XX." fullword ascii
      $s8 = "firewall-host=firewall.domain.com" fullword ascii
      $s9 = "This is a freeware program by Mike Gleason (http://www.NcFTP.com)." fullword ascii
      $s10 = "http://www.ncftp.com/ncftp/donate.html" fullword ascii
      $s11 = "starts a ncftpbatch process to process spooled files" fullword ascii
      $s12 = "or online at http://www.NcFTP.com/ncftp/doc/ncftp.html)." fullword ascii
      $s13 = "  -F     Dump a sample $HOME/.ncftp/firewall prefs file to stdout and exit." fullword ascii
      $s14 = "# ALSO:  A %s file, if present, is processed before this file," fullword ascii
      $s15 = "http://www.ncftp.com/ncftpd/" fullword ascii
      $s16 = "sets the process umask on remote host" fullword ascii
      $s17 = "pre-shell-command=" fullword ascii
      $s18 = "# NcFTP will prompt you each time for the password." fullword ascii
      $s19 = "post-shell-command=" fullword ascii
      $s20 = "  - Remote Mkdir %s Failed: %s" fullword ascii
      $s21 = "login failed" fullword ascii
      $s22 = "sends a host-specific FTP command to the remote server" fullword ascii
      $s23 = "  -p XX  Use password XX with the username." fullword ascii
      $s24 = "  get -z WIN.INI ~/junk/windows-init-file" fullword ascii
      $s25 = "*** Error: gl_getline(): input buffer overflow" fullword ascii
      $s26 = "Author:           Mike Gleason (http://www.NcFTP.com/ncftp/)" fullword ascii
      $s27 = "collects items to download later from the remote host" fullword ascii
      $s28 = "*** Error: gl_getline(): not interactive, use stdio." fullword ascii
      $s29 = "  + Spooled: get [%s]/%s -> [%s]/%s" fullword ascii
      $s30 = "# see your password.  You may also leave this commented out, and then" fullword ascii
      $s31 = "Usage:  ncftp [flags] [<host> | <directory URL to browse>]" fullword ascii
      $s32 = "# NOTE:  NcFTP does NOT support HTTP proxies that do FTP, such as \"squid\"" fullword ascii
      $s33 = "# to a list of comma-delimited domains or hostnames.  The special token" fullword ascii
      $s34 = "Commands may be abbreviated.  'help showall' shows hidden and unsupported " fullword ascii
      $s35 = "log.tmp" fullword ascii
      $s36 = "firewall-exception-list=.probe.net,localhost,foo.bar.com,localdomain" fullword ascii
      $s37 = "  - Link Failed: %s -> %s (%s)" fullword ascii
      $s38 = "List processing failed." fullword ascii
      $s39 = "commands.  'help <command>' gives a brief description of <command>." fullword ascii
      $s40 = "Lost connection during login." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 69 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f0 a1 04 00 00 00 00 00 00 00 00 00 40 00 38 00 09 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f8 01 00 00 00 00 00 00 f8 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 38 02 00 00 00 00 00 00 38 02 00 00 00 00 00 00 38 02 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 81 04 00 00 00 00 00 20 81 04 00 00 00 00 00 00 00 20 00 00 00 00 00 01 00 00 00 06 00 00 00 70 84 04 00 00 00 00 00 70 84 24 00 00 00 00 00 70 84 24 00 00 00 00 00 48 1c 00 00 00 00 00 00 98 72 00 00 00 00 00 00 00 00 20 00 00 00 00 00 02 00 00 00 06 00 00 00 e8 88 04 00 00 00 00 00 e8 88 24 00 00 00 00 00 e8 88 24 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 54 02 00 00 00 00 00 00 54 02 00 00 00 00 00 00 54 02 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d0 04 04 00 00 00 00 00 d0 04 04 00 00 00 00 00 d0 04 04 00 00 00 00 00 0c 10 00 00 00 00 00 00 0c 10 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 84 04 00 00 00 00 00 70 84 24 00 00 00 00 00 70 84 24 00 00 00 00 00 90 0b 00 00 00 00 00 00 90 0b 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 50 57 bb 83 d5 c0 c5 c5 c8 6f 3f 51 ff bf 2c 30 83 6e bf 42 03 00 00 00 a1 00 00 00 01 00 00 00 06 00 00 00 00 01 20 00 80 01 10 02 a1 00 00 00 a2 00 00 00 00 00 00 00 29 1d 8c 1c 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d3 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 59 03 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 9a 04 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ad 03 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 13 03 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a6 05 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 17 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 03 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 75 04 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a0 04 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 fd 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 900KB and
      8 of them and $magic
}

rule gtfobins_binaries_ss {
   strings:
      $s1 = "failed to dump data: %d" fullword ascii
      $s2 = "Command failed %s:%d" fullword ascii
      $s3 = "mnl_nlmsg_get_payload" fullword ascii
      $s4 = "mnl_nlmsg_get_payload_len" fullword ascii
      $s5 = "ss: tcpdiag dump requested and no tcp in filter." fullword ascii
      $s6 = "Bind %s -> %s failed: %s" fullword ascii
      $s7 = "Failed to create btf_dump object" fullword ascii
      $s8 = "   -D, --diag=FILE     Dump raw information about TCP sockets to FILE" fullword ascii
      $s9 = "usersock" fullword ascii
      $s10 = " users:(%s)" fullword ascii
      $s11 = "!!!Deficit %d, rta_len=%d" fullword ascii
      $s12 = "Cannot send dump request" fullword ascii
      $s13 = "Dump terminated" fullword ascii
      $s14 = "Dump was interrupted and may be inconsistent." fullword ascii
      $s15 = "btf_dump__new" fullword ascii
      $s16 = "btf_dump__free" fullword ascii
      $s17 = "btf_dump__dump_type_data" fullword ascii
      $s18 = "   -p, --processes     show process using socket" fullword ascii
      $s19 = "getfilecon" fullword ascii
      $s20 = "Unexpected reply!!!" fullword ascii
      $s21 = "Error: %s address is expected rather than \"%s\"." fullword ascii
      $s22 = "Error: an IP address is expected rather than \"%s\"" fullword ascii
      $s23 = "Error: \"%s\" does not look like a port." fullword ascii
      $s24 = "getpidcon" fullword ascii
      $s25 = "Error: ambiguous port \"%s\"." fullword ascii
      $s26 = "getrpcbynumber" fullword ascii
      $s27 = "Failed to open directory %s: %s" fullword ascii
      $s28 = "mkdir failed for %s: %s" fullword ascii
      $s29 = "Too many arguments to command" fullword ascii
      $s30 = "!!!malformed message: len=%d @%lu" fullword ascii
      $s31 = "Command line is not complete. Try option \"help\"" fullword ascii
      $s32 = "Failed to mount cgroup2. Are CGROUPS enabled in your kernel?" fullword ascii
      $s33 = "Failed to get cgroup2 ID: %s" fullword ascii
      $s34 = "It looks like such filter is not supported! Too old kernel?" fullword ascii
      $s35 = "Reading header from $TCPDIAG_FILE" fullword ascii
      $s36 = "ss: failed to get info for BPF map ID %u" fullword ascii
      $s37 = "mount of /sys failed: %s" fullword ascii
      $s38 = "\"mount --make-rslave /\" failed: %s" fullword ascii
      $s39 = "selinux" fullword ascii
      $s40 = "fiblookup" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 72 00 00 00 00 00 00 40 00 00 00 00 00 00 00 20 25 03 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 70 45 00 00 00 00 00 00 70 45 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 d1 ba 01 00 00 00 00 00 d1 ba 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 98 ad 00 00 00 00 00 00 98 ad 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 cc 02 00 00 00 00 00 90 cc 02 00 00 00 00 00 90 cc 02 00 00 00 00 00 dc 56 00 00 00 00 00 00 90 00 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d0 d8 02 00 00 00 00 00 d0 d8 02 00 00 00 00 00 d0 d8 02 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 9c 64 02 00 00 00 00 00 9c 64 02 00 00 00 00 00 9c 64 02 00 00 00 00 00 44 0c 00 00 00 00 00 00 44 0c 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 cc 02 00 00 00 00 00 90 cc 02 00 00 00 00 00 90 cc 02 00 00 00 00 00 70 13 00 00 00 00 00 00 70 13 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 1b 41 84 07 3f 9a 26 1d d8 ab ff e2 09 f8 8f 4d 6d 63 5e 70 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 69 70 72 6f 75 74 65 32 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 36 2e 31 30 2e 30 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a 22 61}
condition:
      filesize < 600KB and
      8 of them and $magic
}

rule gtfobins_binaries_ed {
   strings:
      $s1 = "the current directory and cannot execute shell commands. Ed is the" fullword ascii
      $s2 = "Number out of raShell access resNo previous commNo current filenInvalid command Invalid address" fullword ascii
      $s3 = "If 'file' begins with a '!', read output of shell command." fullword ascii
      $s4 = "Can't create shell process" fullword ascii
      $s5 = "script, line %d: %s" fullword ascii
      $s6 = "General help using GNU software: http://www.gnu.org/gethelp" fullword ascii
      $s7 = "(invalid command-line options, memory exhausted, command failed, etc)," fullword ascii
      $s8 = "  -l, --loose-exit-status    exit with 0 status even if a command fails" fullword ascii
      $s9 = "Usage: %s [options] [[+line] file]" fullword ascii
      $s10 = "Filename too lonInvalid mark chaDestination expeUnexpected addreUnexpected command suffix" fullword ascii
      $s11 = "invalid option -- '" fullword ascii
      $s12 = "No previous command" fullword ascii
      $s13 = "option requires an argument -- '" fullword ascii
      $s14 = "shell scripts. A restricted version of ed, red, can only edit files in" fullword ascii
      $s15 = "  -v, --verbose              be verbose; equivalent to the 'H' command" fullword ascii
      $s16 = "License GPLv2+: GNU GPL version 2 or later <http://gnu.org/licenses/gpl.html>" fullword ascii
      $s17 = "Report bugs to bug-ed@gnu.org" fullword ascii
      $s18 = "Ed home page: http://www.gnu.org/software/ed/ed.html" fullword ascii
      $s19 = "Cannot read temp file" fullword ascii
      $s20 = "internal error: unterminated line passed to put_sbuf_line" fullword ascii
      $s21 = "%s: %s: No match found." fullword ascii
      $s22 = "%s: %s: Invalid line number; must be >= 1." fullword ascii
      $s23 = "%s: %s: Invalid line number or regular expression." fullword ascii
      $s24 = "  -G, --traditional          run in compatibility mode" fullword ascii
      $s25 = "  -s, --script               suppress byte counts and '!' prompt" fullword ascii
      $s26 = "Shell access restricted" fullword ascii
      $s27 = "Cannot nest global commands" fullword ascii
      $s28 = "tricted" fullword ascii
      $s29 = "Cannot seek temp file" fullword ascii
      $s30 = "Start edit by reading in 'file' if given." fullword ascii
      $s31 = "Cannot close temp file" fullword ascii
      $s32 = "Cannot open temp file" fullword ascii
      $s33 = "9cd346490efd5c3d69deff84da9af0a0035ac4.debug" fullword ascii
      $s34 = "warning: read-only file" fullword ascii
      $s35 = "Copyright (C) %s Antonio Diaz Diaz." fullword ascii
      $s36 = "Cannot write temp file" fullword ascii
      $s37 = "current line to the line number specified or to the first or last line" fullword ascii
      $s38 = "  -r, --restricted           run in restricted mode" fullword ascii
      $s39 = "  -V, --version              output version information and exit" fullword ascii
      $s40 = "racter" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 28 00 00 00 00 00 00 40 00 00 00 00 00 00 00 e0 d2 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 15 00 00 00 00 00 00 08 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 11 7e 00 00 00 00 00 00 11 7e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 d8 2a 00 00 00 00 00 00 d8 2a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 cc 00 00 00 00 00 00 10 dc 00 00 00 00 00 00 10 dc 00 00 00 00 00 00 94 05 00 00 00 00 00 00 f8 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 20 cc 00 00 00 00 00 00 20 dc 00 00 00 00 00 00 20 dc 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d0 b4 00 00 00 00 00 00 d0 b4 00 00 00 00 00 00 d0 b4 00 00 00 00 00 00 9c 03 00 00 00 00 00 00 9c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 cc 00 00 00 00 00 00 10 dc 00 00 00 00 00 00 10 dc 00 00 00 00 00 00 f0 03 00 00 00 00 00 00 f0 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 61 9c d3 46 49 0e fd 5c 3d 69 de ff 84 da 9a f0 a0 03 5a c4 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 3b 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 3b 00 00 00 3d 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 68 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_whois {
   strings:
      $s1 = "whois.dotukr.com" fullword ascii
      $s2 = "whois.networksolutions.com" fullword ascii
      $s3 = "ccwhois.verisign-grs.com" fullword ascii
      $s4 = "whois.verisign-grs.com" fullword ascii
      $s5 = "norton" fullword ascii /* reversed goodware string 'notron' */
      $s6 = "https://register.com.np/whois-lookup" fullword ascii
      $s7 = "The data contained in GoDaddy.com" fullword ascii
      $s8 = "web.com" fullword ascii
      $s9 = "https://nic.com.uy/v2/consulta-whois" fullword ascii
      $s10 = "https://bdia.btcl.com.bd/" fullword ascii
      $s11 = "whois.dotpostregistry.net" fullword ascii
      $s12 = "The data in Register.com's WHOIS database" fullword ascii
      $s13 = "The data in Networksolutions.com's" fullword ascii
      $s14 = "The data in Networksolutions.com's WHOIS database" fullword ascii
      $s15 = "The Data in MarkMonitor.com's" fullword ascii
      $s16 = "whois.na-nic.com.na" fullword ascii
      $s17 = "cologne" fullword ascii
      $s18 = "auspost" fullword ascii
      $s19 = "kerrylogistics" fullword ascii
      $s20 = "https://whois.telecoms.gov.bb/" fullword ascii
      $s21 = "https://services.ph.net/dns/query.pl" fullword ascii
      $s22 = "https://grweb.ics.forth.gr/public/whois" fullword ascii
      $s23 = "https://www.nic.tt/cgi-bin/search.pl" fullword ascii
      $s24 = "Corporation Service Company(c) (CSC)  The Trusted Partner" fullword ascii
      $s25 = "getaddrinfo(%s)" fullword ascii
      $s26 = "getaddrinfo(%s): %s" fullword ascii
      $s27 = "%% referto: whois -h %255s -p %15s %1021[^" fullword ascii
      $s28 = "regexec: %s" fullword ascii
      $s29 = "The WHOIS service offered by the Registry Operator" fullword ascii
      $s30 = "whois.hkirc.hk" fullword ascii
      $s31 = "versicherung" fullword ascii
      $s32 = "commbank" fullword ascii
      $s33 = ".Club Domains, LLC, the Registry Operator" fullword ascii
      $s34 = "Telnames Limited, the Registry Operator for" fullword ascii
      $s35 = "# Welcome to the OVH WHOIS Server" fullword ascii
      $s36 = "whois.twnic.net.tw" fullword ascii
      $s37 = "whois.dotgov.gov" fullword ascii
      $s38 = "whois.nic.ly" fullword ascii
      $s39 = "whois.auda.org.au" fullword ascii
      $s40 = "whois.nic.hr" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 3b 01 00 00 00 00 00 40 00 00 00 00 00 00 00 68 69 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 58 20 01 00 00 00 00 00 58 20 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 01 00 00 00 00 00 00 30 01 00 00 00 00 00 00 30 01 00 00 00 00 00 15 44 00 00 00 00 00 00 15 44 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 01 00 00 00 00 00 00 80 01 00 00 00 00 00 00 80 01 00 00 00 00 00 7c 59 00 00 00 00 00 00 7c 59 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 df 01 00 00 00 00 00 70 ef 01 00 00 00 00 00 70 ef 01 00 00 00 00 00 50 88 00 00 00 00 00 00 b8 88 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a0 1b 02 00 00 00 00 00 a0 2b 02 00 00 00 00 00 a0 2b 02 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 70 cf 01 00 00 00 00 00 70 cf 01 00 00 00 00 00 70 cf 01 00 00 00 00 00 44 01 00 00 00 00 00 00 44 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 df 01 00 00 00 00 00 70 ef 01 00 00 00 00 00 70 ef 01 00 00 00 00 00 90 40 00 00 00 00 00 00 90 40 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 b1 6a 42 87 92 b1 bf 52 d7 81 ef 44 cc bb b2 cc 2d ef 96 72 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 47 00 00 00 01 00 00 00 06 00 00 00 00 05 81 00 00 01 1c 02 47 00 00 00 49 00 00 00 4a 00 00 00 28 1d 8c 1c d1 65 ce 6d 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d3 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_zypper {
   strings:
      $x1 = "]*<(p|!--[- ]*DT:Rich[ -]*ResetRepoManagerNoSystemResolvabLoadTargetResolvLoadRepoResolvabAlias for --repoEnabled in zyppezypper" ascii
      $x2 = "Download rpms specified on the commandline to a local directory. Per default packages are downloaded to the libzypp package cach" ascii
      $x3 = "_ZN4zypp6target3rpm20CommitScriptReportSA13contentRpmoutE" fullword ascii
      $s4 = "Zypper shell does not support execution of subcommands." fullword ascii
      $s5 = "_ZN4zypp6target3rpm20CommitScriptReportSA6finishEN5boost13intrusive_ptrIKNS_10ResolvableEEENS2_5ErrorERKNS_8callback8UserDataE" fullword ascii
      $s6 = "_ZN4zypp6target3rpm17SingleTransReport14contentLoglineE" fullword ascii
      $s7 = "_ZN4zypp6target3rpm20CommitScriptReportSA5startERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEESA_N5boost13intrusive_ptrI" ascii
      $s8 = "Executed pager process (pid: " fullword ascii
      $s9 = "Shows the ID string of the target operating system. The string is defined by the XPath:/product/register/target entry in /etc/pr" ascii
      $s10 = "_ZTSN4zypp6target3rpm20CommitScriptReportSAE" fullword ascii
      $s11 = "Shows the ID string of the target operating system. The string is defined by the XPath:/product/register/target entry in /etc/pr" ascii
      $s12 = "_ZTIN4zypp6target3rpm20CommitScriptReportSAE" fullword ascii
      $s13 = "N4zypp6target3rpm20CommitScriptReportSAE" fullword ascii
      $s14 = "]*<(p|!--[- ]*DT:Rich[ -]*ResetRepoManagerNoSystemResolvabLoadTargetResolvLoadRepoResolvabAlias for --repoEnabled in zyppezypper" ascii
      $s15 = "_ZN4zypp6target3rpm20CommitScriptReportSA5startERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEESA_N5boost13intrusive_ptrI" ascii
      $s16 = "_ZN4zypp4repo24DownloadResolvableReport18startDeltaDownloadERKNS_10filesystem8PathnameERKNS_9ByteCountE" fullword ascii
      $s17 = "_ZN4zypp6target3rpm20CommitScriptReportSA8progressEiN5boost13intrusive_ptrIKNS_10ResolvableEEERKNS_8callback8UserDataE" fullword ascii
      $s18 = "A remove command which prefers replacing dependant packages to removing them as well. In fact this is a full featured install co" ascii
      $s19 = "You have chosen to ignore a problem with download or installation of a package which might lead to broken dependencies of other " ascii
      $s20 = "executing subcommands in '%1%' is currently not supported." fullword ascii
      $s21 = "_ZN4zypp6target17PatchScriptReport5startERKN5boost13intrusive_ptrIKNS_7PackageEEERKNS_10filesystem8PathnameE" fullword ascii
      $s22 = "Going to process command " fullword ascii
      $s23 = "N4zypp6target17PatchScriptReportE" fullword ascii
      $s24 = "_ZN4zypp6target17PatchScriptReport7problemERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s25 = "_ZTSN4zypp6target17PatchScriptReportE" fullword ascii
      $s26 = "_ZTIN4zypp6target17PatchScriptReportE" fullword ascii
      $s27 = "T* boost::intrusive_ptr<T>::operator->() const [with T = const zypp::target::rpm::RpmHeader]" fullword ascii
      $s28 = "_ZN4zypp6target17PatchScriptReport6finishEv" fullword ascii
      $s29 = "_ZN4zypp6target17PatchScriptReport8progressENS1_6NotifyERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s30 = "T* boost::intrusive_ptr<T>::operator->() const [with T = zypp::Target]" fullword ascii
      $s31 = "Executing %s script for: %s" fullword ascii
      $s32 = "_ZGVZN4zypp8callback16DistributeReportINS_6target3rpm20CommitScriptReportSAEE8instanceEvE5_self" fullword ascii
      $s33 = "Abbreviated commandline options will not be supported in future versions: --" fullword ascii
      $s34 = "_ZN4zypp6target3rpm23InstallResolvableReport13contentRpmoutE" fullword ascii
      $s35 = "_ZN4zypp6target3rpm19TransactionReportSA13contentRpmoutE" fullword ascii
      $s36 = "_ZN4zypp6target3rpm22RemoveResolvableReport13contentRpmoutE" fullword ascii
      $s37 = "_ZN4zypp8callback13ReceiveReportINS_6target3rpm20CommitScriptReportSAEED2Ev" fullword ascii
      $s38 = "_ZN4zypp6target3rpm24RemoveResolvableReportSA13contentRpmoutE" fullword ascii
      $s39 = "_ZZN4zypp8callback16DistributeReportINS_6target3rpm20CommitScriptReportSAEE8instanceEvE5_self" fullword ascii
      $s40 = "N4zypp6target3rpm17SingleTransReport8loglevelE" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 40 98 09 00 00 00 00 00 40 00 00 00 00 00 00 00 e0 94 36 00 00 00 00 00 00 00 00 00 40 00 38 00 0e 00 40 00 20 00 1f 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d0 81 04 00 00 00 00 00 d0 81 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 90 04 00 00 00 00 00 00 90 04 00 00 00 00 00 00 90 04 00 00 00 00 00 49 93 28 00 00 00 00 00 49 93 28 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 2d 00 00 00 00 00 00 30 2d 00 00 00 00 00 00 30 2d 00 00 00 00 00 3c 99 08 00 00 00 00 00 3c 99 08 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 d7 35 00 00 00 00 00 30 d7 35 00 00 00 00 00 30 d7 35 00 00 00 00 00 f0 bb 00 00 00 00 00 00 c0 e4 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 70 36 00 00 00 00 00 d8 70 36 00 00 00 00 00 d8 70 36 00 00 00 00 00 60 02 00 00 00 00 00 00 60 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 30 d7 35 00 00 00 00 00 30 d7 35 00 00 00 00 00 30 d7 35 00 00 00 00 00 00 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 58 8f 2f 00 00 00 00 00 58 8f 2f 00 00 00 00 00 58 8f 2f 00 00 00 00 00 64 8d 00 00 00 00 00 00 64 8d 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 d7 35 00 00 00 00 00 30 d7 35 00 00 00 00 00 30 d7 35 00 00 00 00 00 d0 b8 00 00 00 00 00 00 d0 b8 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 f6 f4 7c 15 62 93 4d 9c 7d 06 c0 17 23 a4 0a e3 3d 2a 8b 51 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 09 02 00 00 a6 03 00 00 80 00 00 00 0d 00 00 00 00 00 15 08 ca 00 c4 03 0c 22 40 12 80 20 44 02 06 01 56 42 00 d5 30 60}
condition:
      filesize < 10000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_psftp {
   strings:
      $s1 = "The %s selected for this session is %s, which, with this server, is vulnerable to the 'Terrapin' attack CVE-2023-48795, potentia" ascii
      $s2 = "cmdline_process_param" fullword ascii
      $s3 = "The %s selected for this session is %s, which, with this server, is vulnerable to the 'Terrapin' attack CVE-2023-48795, potentia" ascii
      $s4 = "%s on port %s:%d to forward to client%s%s" fullword ascii
      $s5 = "The first host key type we have stored for this server is %s, which is below the configured warning threshold." fullword ascii
      $s6 = "Agent-forwarding connection closed" fullword ascii
      $s7 = "Proxy password: " fullword ascii
      $s8 = " [ -r ] [ -- ] <filename> [ <remote-filename> ]" fullword ascii
      $s9 = "tempseat_get_userpass_input" fullword ascii
      $s10 = "tempseat_confirm_ssh_host_key" fullword ascii
      $s11 = "  -proxycmd command" fullword ascii
      $s12 = "6666666666666666666666666666666666666666666666666666666666666658" ascii /* hex encoded string 'fffffffffffffffffffffffffffffffX' */
      $s13 = "This means that either another certification authority is operating in this realm AND the server administrator has changed the h" ascii
      $s14 = "ssh-ed25519-cert-v01@openssh.com" fullword ascii
      $s15 = "sntrup761x25519-sha512@openssh.com" fullword ascii
      $s16 = "chacha20-poly1305@openssh.com" fullword ascii
      $s17 = "rsa-sha2-512-cert-v01@openssh.com" fullword ascii
      $s18 = "kex-strict-s-v00@openssh.com" fullword ascii
      $s19 = "kex-strict-c-v00@openssh.com" fullword ascii
      $s20 = "rsa-sha2-256-cert-v01@openssh.com" fullword ascii
      $s21 = "SOCKS 5 password reply had version number %d (expected %d)" fullword ascii
      $s22 = "unable to read a password from file '%s'" fullword ascii
      $s23 = "proxy_socks5_process_queue" fullword ascii
      $s24 = "in.len > 0 && in.len <= k - 2*HLEN - 2" fullword ascii
      $s25 = "GSSAPI import name failed - Bad service name; won't use GSS key exchange" fullword ascii
      $s26 = "ssh1_login_process_queue" fullword ascii
      $s27 = "Leaving host lookup to proxy of \"%s\" (for %s)" fullword ascii
      $s28 = "false && \"get_userpass_input should never be called on TempSeat\"" fullword ascii
      $s29 = "false && \"confirm_ssh_host_key should never be called on TempSeat\"" fullword ascii
      $s30 = "ssh2_userauth_process_queue" fullword ascii
      $s31 = "false && \"confirm_weak_cached_hostkey \" \"should never be called on TempSeat\"" fullword ascii
      $s32 = "Server also has %s host key%s, but we don't know %s" fullword ascii
      $s33 = "priv_encrypted_len - priv_blob->len < 20" fullword ascii
      $s34 = "cmdline_host_ok" fullword ascii
      $s35 = "cmdline_tooltype & TOOLTYPE_HOST_ARG" fullword ascii
      $s36 = "  Establishes an SFTP connection to a given host. Only usable" fullword ascii
      $s37 = "  -be       don't stop batchfile processing if errors" fullword ascii
      $s38 = "  If -r specified, resume interrupted \"get -r\"." fullword ascii
      $s39 = "Post-GSS rekey provided fallback host key:" fullword ascii
      $s40 = "Forwarded connection refused by remote%s%s" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 09 01 00 00 00 00 00 40 00 00 00 00 00 00 00 b0 e8 0c 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 68 fc 00 00 00 00 00 00 68 fc 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 bd 1e 08 00 00 00 00 00 bd 1e 08 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 09 00 00 00 00 00 00 20 09 00 00 00 00 00 00 20 09 00 00 00 00 00 d4 44 03 00 00 00 00 00 d4 44 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 72 0c 00 00 00 00 00 50 72 0c 00 00 00 00 00 50 72 0c 00 00 00 00 00 b8 74 00 00 00 00 00 00 30 7a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 60 d9 0c 00 00 00 00 00 60 d9 0c 00 00 00 00 00 60 d9 0c 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 fc c1 0a 00 00 00 00 00 fc c1 0a 00 00 00 00 00 fc c1 0a 00 00 00 00 00 dc 3f 00 00 00 00 00 00 dc 3f 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 72 0c 00 00 00 00 00 50 72 0c 00 00 00 00 00 50 72 0c 00 00 00 00 00 b0 6d 00 00 00 00 00 00 b0 6d 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 b2 20 e9 49 1b 1a 71 ec 07 bf b6 f4 34 c3 56 e7 ea 6c 13 95 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 8e 00 00 00 01 00 00 00 06 00 00 00 00 01 81 00 00 01 90 03 8e 00 00 00 91 00 00 00 00 00 00 00 28 1d 8c 1c 34 42 74 75 d1 65 ce 6d 36 ae 56 d0 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 2c 03 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 2000KB and
      8 of them and $magic
}

rule gtfobins_binaries_gawk {
   strings:
      $s1 = "source file - execute commands from file" fullword ascii
      $s2 = "commands [num] - starts a list of commands to be executed at a breakpoint(watchpoint) hit" fullword ascii
      $s3 = "until [[filename:]N|function] - execute until program reaches a different line or line N within current frame" fullword ascii
      $s4 = "finish - execute until selected stack frame returns" fullword ascii
      $s5 = "getline: attempt to read from closed read end of two-way pipe" fullword ascii
      $s6 = "co-process flush of pipe to `%s' failed: %s" fullword ascii
      $s7 = "save filename - save commands from the session to file" fullword ascii
      $s8 = "dump [filename] - dump instructions to file or stdout" fullword ascii
      $s9 = "end - end a list of commands or awk statements" fullword ascii
      $s10 = "unknown command - `%.*s', try help" fullword ascii
      $s11 = "help [command] - print list of commands or explanation of command" fullword ascii
      $s12 = "run - start or restart executing program" fullword ascii
      $s13 = "trace on|off - print instruction before executing" fullword ascii
      $s14 = "tbreak [[filename:]N|function] - set a temporary breakpoint" fullword ascii
      $s15 = "fflush: `%.*s' is not an open file, pipe or co-process" fullword ascii
      $s16 = "PLEASE do NOT try to report bugs by posting in comp.lang.awk," fullword ascii
      $s17 = "remote host and port information (%s, %s) invalid: %s" fullword ascii
      $s18 = "print: attempt to write to closed write end of two-way pipe" fullword ascii
      $s19 = "pma.c:255: ERROR: check_and_dump not meaningful in fallback mode" fullword ascii
      $s20 = "printf: attempt to write to closed write end of two-way pipe" fullword ascii
      $s21 = "invalid target of assignment (opcode %s)" fullword ascii
      $s22 = "could not create child process or open pty" fullword ascii
      $s23 = "failure status (%d) on pipe close of `%s': %s" fullword ascii
      $s24 = "pipe flush of `%s' failed: %s" fullword ascii
      $s25 = "failure status (%d) on two-way pipe close of `%s': %s" fullword ascii
      $s26 = "%d: subscript \"%.*s\" is not in array `%s'" fullword ascii
      $s27 = "internal error: file %s, line %d: invalid comparison type %d" fullword ascii
      $s28 = "where [N] - (same as backtrace) print trace of all or N innermost (outermost if N < 0) frames" fullword ascii
      $s29 = "trace: invalid option - `%s'" fullword ascii
      $s30 = "backtrace [N] - print trace of all or N innermost (outermost if N < 0) frames" fullword ascii
      $s31 = "up [N] - move N frames up the stack" fullword ascii
      $s32 = "operator `%s' is not supported in old awk" fullword ascii
      $s33 = "pma.c:678: ERROR: get_root not meaningful in fallback mode" fullword ascii
      $s34 = "no such function - `%s'" fullword ascii
      $s35 = "option: invalid parameter - `%s'" fullword ascii
      $s36 = "enable: invalid option - `%s'" fullword ascii
      $s37 = "frame [N] - select and print stack frame number N" fullword ascii
      $s38 = "info: invalid option - `%s'" fullword ascii
      $s39 = "save: `%s': command not permitted" fullword ascii
      $s40 = "down [N] - move N frames down the stack" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 02 00 3e 00 01 00 00 00 70 7e 40 00 00 00 00 00 40 00 00 00 00 00 00 00 40 ea 0a 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 40 00 00 00 00 00 40 00 40 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 40 00 00 00 00 00 18 03 40 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 e8 4d 00 00 00 00 00 00 e8 4d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 50 00 00 00 00 00 00 00 50 40 00 00 00 00 00 00 50 40 00 00 00 00 00 61 42 08 00 00 00 00 00 61 42 08 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 08 00 00 00 00 00 00 a0 48 00 00 00 00 00 00 a0 48 00 00 00 00 00 4c f3 01 00 00 00 00 00 4c f3 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 a1 0a 00 00 00 00 00 50 a1 4a 00 00 00 00 00 50 a1 4a 00 00 00 00 00 98 47 00 00 00 00 00 00 18 cb 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 58 cd 0a 00 00 00 00 00 58 cd 4a 00 00 00 00 00 58 cd 4a 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 40 00 00 00 00 00 38 03 40 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 40 00 00 00 00 00 58 03 40 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 40 00 00 00 00 00 38 03 40 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c8 af 09 00 00 00 00 00 c8 af 49 00 00 00 00 00 c8 af 49 00 00 00 00 00 34 1b 00 00 00 00 00 00 34 1b 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 a1 0a 00 00 00 00 00 50 a1 4a 00 00 00 00 00 50 a1 4a 00 00 00 00 00 b0 2e 00 00 00 00 00 00 b0 2e 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 88 10 ec 64 11 28 a8 45 b8 d0 c0 6b dd 01 be 6b a2 78 bc 17 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 25 00 00 00 12 01 00 00 04 00 00 00 08 00 00 00 90 18 a0 60 20 61 0c 06 0f 28 61 0c c5 01 04 11 00 a0 46 60 44 c9 0c 08 36 01 00 83 82 b1 0c 52 00 00 00 00 00 00 00 00 12 01 00 00 13 01 00 00 16 01 00 00 17 01 00 00 19 01 00 00 00 00 00 00 1a 01 00 00 1c 01 00 00 00 00 00 00 1e 01 00 00}
condition:
      filesize < 2000KB and
      8 of them and $magic
}

rule gtfobins_binaries_strace {
   strings:
      $s1 = "NS_* ioctl commands are not supported by the kernel" fullword ascii
      $s2 = "Failed to tamper with process %d: unexpectedly got %serror (return value %#lx, error %lu)" fullword ascii
      $s3 = "%s: Failed to tamper with process %d: couldn't poke" fullword ascii
      $s4 = "execution by injecting an arbitrary return" fullword ascii
      $s5 = "Inadvertent injection of error %d is possible in compat personality for retval=%llu" fullword ascii
      $s6 = "%s: [xlat %p, dflt \"%s\", decoders %p] size is zero (going to pass nla_type as decoder argument), but opaque data (%p) is not -" ascii
      $s7 = "%s: [xlat %p, dflt \"%s\", decoders %p] size is zero (going to pass nla_type as decoder argument), but opaque data (%p) is not -" ascii
      $s8 = "--seccomp-bpf is not enabled for processes attached with -p" fullword ascii
      $s9 = "                 synonym for -e inject with default ERRNO set to ENOSYS." fullword ascii
      $s10 = "  -e inject=SET[:error=ERRNO|:retval=VALUE][:signal=SIG][:syscall=SYSCALL]" fullword ascii
      $s11 = "AMDKFD_IOC_GET_PROCESS_APERTURES_NEW" fullword ascii
      $s12 = "  -b execve, --detach-on=execve" fullword ascii
      $s13 = "FS_IOC_REMOVE_ENCRYPTION_KEY_ALL_USERS" fullword ascii
      $s14 = "AMDKFD_IOC_GET_PROCESS_APERTURES" fullword ascii
      $s15 = "with -b execve option." fullword ascii
      $s16 = "CXL_IOCTL_GET_PROCESS_ELEMENT" fullword ascii
      $s17 = "%s: Failed to tamper with process %d: requested to tamper with argument #%u, but system call '%s' has only %u arguments" fullword ascii
      $s18 = "                 dump the data written to the file descriptors in SET" fullword ascii
      $s19 = "                 dump the data read from the file descriptors in SET" fullword ascii
      $s20 = "PR_GET_DUMPABLE" fullword ascii
      $s21 = "of the traced process using the -E/--env" fullword ascii
      $s22 = "%s: reading /proc/sys/kernel/pid_max" fullword ascii
      $s23 = "Invalid process id: '%s'" fullword ascii
      $s24 = "SECCOMP_RET_KILL_PROCESS" fullword ascii
      $s25 = "and modifying process's user/group IDs" fullword ascii
      $s26 = "TEE_IOCTL_LOGIN_PUBLIC" fullword ascii
      $s27 = "Process %d attached" fullword ascii
      $s28 = "dumpstr" fullword ascii
      $s29 = "[ Process PID=%d runs in %s mode. ]" fullword ascii
      $s30 = "%s: Removing variable \"%s\" from the command environment" fullword ascii
      $s31 = "VHOST_VDPA_GET_CONFIG" fullword ascii
      $s32 = "  --inject=SET[:error=ERRNO|:retval=VALUE][:signal=SIG][:syscall=SYSCALL]" fullword ascii
      $s33 = "Inadvertent injection of error %ld is possible for retval=%llu" fullword ascii
      $s34 = " && WCOREDUMP(s)" fullword ascii
      $s35 = "DM_GET_TARGET_VERSION" fullword ascii
      $s36 = "VDUSE_DEV_INJECT_CONFIG_IRQ" fullword ascii
      $s37 = "FAN_REPORT_TARGET_FID" fullword ascii
      $s38 = "injection of arbitrary return/error values," fullword ascii
      $s39 = "SUID_DUMP_USER" fullword ascii
      $s40 = "(\"WIFSIGNALED,%ssig=%s\"), WCOREDUMP(status) ? \"core,\" : \"\", sprintsigname(WTERMSIG(status))" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 13 09 00 00 00 00 00 40 00 00 00 00 00 00 00 78 12 20 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 78 f7 08 00 00 00 00 00 78 f7 08 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 00 09 00 00 00 00 00 00 00 09 00 00 00 00 00 00 00 09 00 00 00 00 00 39 47 0a 00 00 00 00 00 39 47 0a 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 13 00 00 00 00 00 00 50 13 00 00 00 00 00 00 50 13 00 00 00 00 00 48 51 06 00 00 00 00 00 48 51 06 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 b1 19 00 00 00 00 00 10 b1 19 00 00 00 00 00 10 b1 19 00 00 00 00 00 20 60 06 00 00 00 00 00 e0 0a 09 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 08 20 00 00 00 00 00 e0 08 20 00 00 00 00 00 e0 08 20 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c0 f7 17 00 00 00 00 00 c0 f7 17 00 00 00 00 00 c0 f7 17 00 00 00 00 00 9c 38 00 00 00 00 00 00 9c 38 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 b1 19 00 00 00 00 00 10 b1 19 00 00 00 00 00 10 b1 19 00 00 00 00 00 f0 5e 06 00 00 00 00 00 f0 5e 06 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 56 c1 25 02 52 8c 70 06 2f ec 02 ec 9a ae 70 19 a1 52 f4 f2 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 92 00 00 00 02 00 00 00 07 00 00 00 a2 01 60 04 56 00 0c 0e 30 48 09 42 00 10 08 00 92 00 00 00 96 00 00 00 9b 00 00 00 a2 aa 8a 2b c4 89 05 90 a6 dd a3 6b d1 65 ce 6d 86 f0 96 7c 96 a0 89 97 ce 2c 63 72 c4 b9 9c 40 39 f2 8b 1c 3a 0d 85 b3 32 c4 f7 12 5e 96 93 1c b3 a2 f7 12}
condition:
      filesize < 6000KB and
      8 of them and $magic
}

rule gtfobins_binaries_taskset {
   strings:
      $s1 = "failed to get pid %d's affinity" fullword ascii
      $s2 = "Show or change the CPU affinity of a process." fullword ascii
      $s3 = "The default behavior is to run a new command:" fullword ascii
      $s4 = "Usage: %s [options] [mask | cpu-list] [pid|cmd [args...]]" fullword ascii
      $s5 = " -a, --all-tasks         operate on all the tasks (threads) for a given pid" fullword ascii
      $s6 = "failed to set pid %d's affinity" fullword ascii
      $s7 = " reading '%s'" fullword ascii
      $s8 = "sched_getaffinity" fullword ascii
      $s9 = "ul_path_get_dirfd" fullword ascii
      $s10 = "ulprocfs" fullword ascii
      $s11 = " fscanf [%s] '%s'" fullword ascii
      $s12 = " -p, --pid               operate on existing given pid" fullword ascii
      $s13 = "bad usage" fullword ascii
      $s14 = "pid %d's new affinity list: %s" fullword ascii
      $s15 = "pid %d's current affinity list: %s" fullword ascii
      $s16 = "stat '%s' [rc=%d]" fullword ascii
      $s17 = "/proc/%d/%s" fullword ascii
      $s18 = "failed to parse CPU mask: %s" fullword ascii
      $s19 = "stat '%s' [no context, rc=%d]" fullword ascii
      $s20 = "pid %d's current affinity mask: %s" fullword ascii
      $s21 = "List format uses a comma-separated list instead of a mask:" fullword ascii
      $s22 = "access '%s' [no context, rc=%d]" fullword ascii
      $s23 = "internal error: conversion from cpuset to string failed" fullword ascii
      $s24 = "pid %d's new affinity mask: %s" fullword ascii
      $s25 = "opening dir: '%s'" fullword ascii
      $s26 = "a24eaab9e85901255ab06adbc343134db68f08.debug" fullword ascii
      $s27 = "    %1$s 03 sshd -b 1024" fullword ascii
      $s28 = "failed to parse CPU list: %s" fullword ascii
      $s29 = "access: '%s' [rc=%d]" fullword ascii
      $s30 = "new prefix: '%s'" fullword ascii
      $s31 = "opening '%s' [no context]" fullword ascii
      $s32 = "cpuset_alloc failed" fullword ascii
      $s33 = "opening '%s'%s" fullword ascii
      $s34 = "alloc new procfs handler" fullword ascii
      $s35 = "closing dir" fullword ascii
      $s36 = "init procfs stuff" fullword ascii
      $s37 = "ulpath" fullword ascii
      $s38 = "deinit" fullword ascii
      $s39 = "__isoc23_vfscanf" fullword ascii
      $s40 = "lib/fileutils.c" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 3d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 01 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 20 00 00 00 00 00 00 08 20 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 09 8f 00 00 00 00 00 00 09 8f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 d0 2e 00 00 00 00 00 00 d0 2e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 f9 00 00 00 00 00 00 d0 f9 00 00 00 00 00 00 d0 f9 00 00 00 00 00 00 44 06 00 00 00 00 00 00 88 06 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a0 fa 00 00 00 00 00 00 a0 fa 00 00 00 00 00 00 a0 fa 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 ec c9 00 00 00 00 00 00 ec c9 00 00 00 00 00 00 ec c9 00 00 00 00 00 00 3c 05 00 00 00 00 00 00 3c 05 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 f9 00 00 00 00 00 00 d0 f9 00 00 00 00 00 00 d0 f9 00 00 00 00 00 00 30 06 00 00 00 00 00 00 30 06 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 2a a2 4e aa b9 e8 59 01 25 5a b0 6a db c3 43 13 4d b6 8f 08 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_setarch {
   strings:
      $s1 = "Execute command `%s'." fullword ascii
      $s2 = " -X, --read-implies-exec  turns on READ_IMPLIES_EXEC" fullword ascii
      $s3 = "%s%s/%s_host/host%d/%s" fullword ascii
      $s4 = "%s%s/%s_host/host%d" fullword ascii
      $s5 = "%s%s/devices/%d:%d:%d:%d/%s" fullword ascii
      $s6 = "%s%s/devices/%d:%d:%d:%d" fullword ascii
      $s7 = "read-implies-exec" fullword ascii
      $s8 = "/sys/kernel/address_bits" fullword ascii
      $s9 = "READ_IMPLIES_EXEC" fullword ascii
      $s10 = " -R, --addr-no-randomize  disables randomization of the virtual address space" fullword ascii
      $s11 = "partno (%d) -> devno (%d)" fullword ascii
      $s12 = " reading '%s'" fullword ascii
      $s13 = "Can not get current kernel personality" fullword ascii
      $s14 = "/sys/dev/block/%d:%d" fullword ascii
      $s15 = "ul_path_get_dirfd" fullword ascii
      $s16 = " -F, --fdpic-funcptrs     makes function pointers point to descriptors" fullword ascii
      $s17 = "/sys/kernel/cpu_byteorder" fullword ascii
      $s18 = " fscanf [%s] '%s'" fullword ascii
      $s19 = "ulsysfs" fullword ascii
      $s20 = "setarch" fullword ascii
      $s21 = "stat '%s' [rc=%d]" fullword ascii
      $s22 = "stat '%s' [no context, rc=%d]" fullword ascii
      $s23 = "access '%s' [no context, rc=%d]" fullword ascii
      $s24 = "opening dir: '%s'" fullword ascii
      $s25 = "access: '%s' [rc=%d]" fullword ascii
      $s26 = "new prefix: '%s'" fullword ascii
      $s27 = "opening '%s' [no context]" fullword ascii
      $s28 = "opening '%s'%s" fullword ascii
      $s29 = " -L, --addr-compat-layout changes the way virtual memory is allocated" fullword ascii
      $s30 = "%s/sys/block/%s/device/dev" fullword ascii
      $s31 = "addr-compat-layout" fullword ascii
      $s32 = "stratis-1-private" fullword ascii
      $s33 = "%s/sys/block/%s/%s/dev" fullword ascii
      $s34 = "Switching on %s." fullword ascii
      $s35 = "ADDR_COMPAT_LAYOUT" fullword ascii
      $s36 = "failed to set personality to %s" fullword ascii
      $s37 = "%s/sys/block/%s/dev" fullword ascii
      $s38 = "%s/sys/block/%s/hidden" fullword ascii
      $s39 = "Change the reported architecture and set personality flags." fullword ascii
      $s40 = "/sys/dev/char/%u:%u" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 44 00 00 00 00 00 00 40 00 00 00 00 00 00 00 e0 42 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 28 2a 00 00 00 00 00 00 28 2a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 79 bf 00 00 00 00 00 00 79 bf 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 c0 41 00 00 00 00 00 00 c0 41 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 35 01 00 00 00 00 00 b0 45 01 00 00 00 00 00 b0 45 01 00 00 00 00 00 7c 0b 00 00 00 00 00 00 80 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 20 3a 01 00 00 00 00 00 20 4a 01 00 00 00 00 00 20 4a 01 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 14 01 01 00 00 00 00 00 14 01 01 00 00 00 00 00 14 01 01 00 00 00 00 00 b4 06 00 00 00 00 00 00 b4 06 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 35 01 00 00 00 00 00 b0 45 01 00 00 00 00 00 b0 45 01 00 00 00 00 00 50 0a 00 00 00 00 00 00 50 0a 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 3a 34 b9 18 2d ae 6d b7 f7 f8 90 78 25 6a c4 6b e1 30 68 93 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_choom {
   strings:
      $s1 = " %1$s [options] -n number [--] command [args...]]" fullword ascii
      $s2 = " -p, --pid <num>        process ID" fullword ascii
      $s3 = " %1$s [options] -n number -p pid" fullword ascii
      $s4 = " %1$s [options] -p pid" fullword ascii
      $s5 = "no PID or COMMAND specified" fullword ascii
      $s6 = " reading '%s'" fullword ascii
      $s7 = "failed to read OOM score value" fullword ascii
      $s8 = "failed to read OOM score adjust value" fullword ascii
      $s9 = "ul_path_get_dirfd" fullword ascii
      $s10 = "failed to set score adjust value" fullword ascii
      $s11 = " fscanf [%s] '%s'" fullword ascii
      $s12 = "stat '%s' [rc=%d]" fullword ascii
      $s13 = "stat '%s' [no context, rc=%d]" fullword ascii
      $s14 = "access '%s' [no context, rc=%d]" fullword ascii
      $s15 = "opening dir: '%s'" fullword ascii
      $s16 = "access: '%s' [rc=%d]" fullword ascii
      $s17 = "new prefix: '%s'" fullword ascii
      $s18 = "opening '%s' [no context]" fullword ascii
      $s19 = "opening '%s'%s" fullword ascii
      $s20 = "pid %d's current OOM score: %d" fullword ascii
      $s21 = "pid %d's current OOM score adjust value: %d" fullword ascii
      $s22 = "pid %d's OOM score adjust value changed from %d to %d" fullword ascii
      $s23 = "closing dir" fullword ascii
      $s24 = "invalid adjust argument" fullword ascii
      $s25 = "ulpath" fullword ascii
      $s26 = "__isoc23_vfscanf" fullword ascii
      $s27 = "lib/fileutils.c" fullword ascii
      $s28 = "%s/%s.XXXXXX" fullword ascii
      $s29 = "invalid PID argument" fullword ascii
      $s30 = "ULPATH_DEBUG" fullword ascii
      $s31 = "ul_path_set_prefix" fullword ascii
      $s32 = "__sched_cpufree" fullword ascii
      $s33 = "(re)set dialect" fullword ascii
      $s34 = "__sched_cpualloc" fullword ascii
      $s35 = "__openat_2" fullword ascii
      $s36 = " [redirected]" fullword ascii
      $s37 = "/proc/self/fd/%d" fullword ascii
      $s38 = "ul_path_close_dirfd" fullword ascii
      $s39 = "ul_path_is_accessible" fullword ascii
      $s40 = "new dir: '%s'" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 10 2d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 d1 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f8 1e 00 00 00 00 00 00 f8 1e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 89 7a 00 00 00 00 00 00 89 7a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 b8 25 00 00 00 00 00 00 b8 25 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 ca 00 00 00 00 00 00 10 da 00 00 00 00 00 00 10 da 00 00 00 00 00 00 04 06 00 00 00 00 00 00 60 06 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c0 ca 00 00 00 00 00 00 c0 da 00 00 00 00 00 00 c0 da 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 fc a6 00 00 00 00 00 00 fc a6 00 00 00 00 00 00 fc a6 00 00 00 00 00 00 64 04 00 00 00 00 00 00 64 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 ca 00 00 00 00 00 00 10 da 00 00 00 00 00 00 10 da 00 00 00 00 00 00 f0 05 00 00 00 00 00 00 f0 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 46 58 db 99 06 a3 8a c4 39 f4 c2 c2 3c 4a da 0c b3 2c b0 cd 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_unshare {
   strings:
      $s1 = " --map-users=<inneruid>:<outeruid>:<count>" fullword ascii
      $s2 = " -R, --root=<dir>          run the command with root directory set to <dir>" fullword ascii
      $s3 = "unsupported --setgroups argument '%s'" fullword ascii
      $s4 = " --propagation slave|shared|private|unchanged" fullword ascii
      $s5 = "xgetgrnam" fullword ascii
      $s6 = "xgetpwnam" fullword ascii
      $s7 = "xgetpwuid" fullword ascii
      $s8 = " --mount-binfmt[=<dir>]    mount binfmt filesystem first (implies --user and --mount)" fullword ascii
      $s9 = "unshare failed" fullword ascii
      $s10 = "failed to read eventfd" fullword ascii
      $s11 = " -l, --load-interp <file>  load binfmt definition in the namespace (implies --mount-binfmt)" fullword ascii
      $s12 = "                           map count users from outeruid to inneruid (implies --user)" fullword ascii
      $s13 = "failed to open /proc/self/timens_offsets" fullword ascii
      $s14 = " -u, --uts[=<file>]        unshare UTS namespace (hostname etc)" fullword ascii
      $s15 = " --map-group=<gid>|<name>  map current group to gid (implies --user)" fullword ascii
      $s16 = "failed to write to /proc/self/timens_offsets" fullword ascii
      $s17 = " reading '%s'" fullword ascii
      $s18 = "stat of %s failed" fullword ascii
      $s19 = "invalid mapping '%s'" fullword ascii
      $s20 = "write failed %s/register" fullword ascii
      $s21 = "capget failed" fullword ascii
      $s22 = "map-root-user" fullword ascii
      $s23 = "mount %s failed" fullword ascii
      $s24 = "no line matching user \"%s\" in %s" fullword ascii
      $s25 = "mount %s on %s failed" fullword ascii
      $s26 = "you (user %d) don't exist." fullword ascii
      $s27 = "ul_path_get_dirfd" fullword ascii
      $s28 = "setgid failed" fullword ascii
      $s29 = "setgroups failed" fullword ascii
      $s30 = "setuid failed" fullword ascii
      $s31 = "failed to parse gid" fullword ascii
      $s32 = "poll parent pidfd failed" fullword ascii
      $s33 = "sigprocmask restore failed" fullword ascii
      $s34 = "failed to parse uid" fullword ascii
      $s35 = "map-users" fullword ascii
      $s36 = "failed to parse subid map" fullword ascii
      $s37 = "sigprocmask block failed" fullword ascii
      $s38 = " -U, --user[=<file>]       unshare user namespace" fullword ascii
      $s39 = "failed to parse boottime offset" fullword ascii
      $s40 = "signal handler reset failed" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 10 5a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 62 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 2e 00 00 00 00 00 00 40 2e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 09 c6 00 00 00 00 00 00 09 c6 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 00 00 18 47 00 00 00 00 00 00 18 47 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 53 01 00 00 00 00 00 30 53 01 00 00 00 00 00 30 53 01 00 00 00 00 00 d0 0d 00 00 00 00 00 00 28 0e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c0 59 01 00 00 00 00 00 c0 59 01 00 00 00 00 00 c0 59 01 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 54 18 01 00 00 00 00 00 54 18 01 00 00 00 00 00 54 18 01 00 00 00 00 00 bc 06 00 00 00 00 00 00 bc 06 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 53 01 00 00 00 00 00 30 53 01 00 00 00 00 00 30 53 01 00 00 00 00 00 d0 0c 00 00 00 00 00 00 d0 0c 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 b2 4d b8 a1 c4 59 61 e2 5d a0 b0 1d d5 67 a9 9c 10 6e e7 1a 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 300KB and
      8 of them and $magic
}

rule gtfobins_binaries_nsenter {
   strings:
      $s1 = " -e, --env              inherit environment variables from target process" fullword ascii
      $s2 = " -c, --join-cgroup      join the cgroup of the target process" fullword ascii
      $s3 = " -t, --target <pid>     target process to get namespaces from" fullword ascii
      $s4 = "no target PID specified for --follow-context" fullword ascii
      $s5 = "can not get process stat" fullword ascii
      $s6 = "no target PID specified for --all" fullword ascii
      $s7 = "failed to set exec context to '%s'" fullword ascii
      $s8 = "failed to get %d SELinux context" fullword ascii
      $s9 = "setexeccon" fullword ascii
      $s10 = " -Z, --follow-context   set SELinux context according to --target PID" fullword ascii
      $s11 = "change directory by working directory file descriptor failed" fullword ascii
      $s12 = "change directory by root file descriptor failed" fullword ascii
      $s13 = "Run a program with namespaces of other processes." fullword ascii
      $s14 = "neither filename nor target pid supplied for %s" fullword ascii
      $s15 = "failed to get cgroup path" fullword ascii
      $s16 = "failed to get environment variables" fullword ascii
      $s17 = "getpidcon" fullword ascii
      $s18 = "chroot failed" fullword ascii
      $s19 = "no namespaces to get parent of" fullword ascii
      $s20 = " -F, --no-fork          do not fork before exec'ing <program>" fullword ascii
      $s21 = " reading '%s'" fullword ascii
      $s22 = "stat of %s failed" fullword ascii
      $s23 = "capget failed" fullword ascii
      $s24 = "reassociate to namespace '%s' failed" fullword ascii
      $s25 = "statfs %s failed" fullword ascii
      $s26 = "ul_path_get_dirfd" fullword ascii
      $s27 = "setgid failed" fullword ascii
      $s28 = "setgroups failed" fullword ascii
      $s29 = "setuid failed" fullword ascii
      $s30 = "failed to parse gid" fullword ascii
      $s31 = "failed to parse uid" fullword ascii
      $s32 = "failed to set environment variables" fullword ascii
      $s33 = "preserve-credentials" fullword ascii
      $s34 = "failed to parse pid" fullword ascii
      $s35 = "ulprocfs" fullword ascii
      $s36 = " fscanf [%s] '%s'" fullword ascii
      $s37 = " -u, --uts[=<file>]     enter UTS namespace (hostname etc)" fullword ascii
      $s38 = "     --preserve-credentials do not touch uids or gids" fullword ascii
      $s39 = " -C, --cgroup[=<file>]  enter cgroup namespace" fullword ascii
      $s40 = "stat '%s' [rc=%d]" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 4e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 32 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 2b 00 00 00 00 00 00 00 2b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 39 ab 00 00 00 00 00 00 39 ab 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 88 3a 00 00 00 00 00 00 88 3a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 25 01 00 00 00 00 00 f0 25 01 00 00 00 00 00 f0 25 01 00 00 00 00 00 30 0b 00 00 00 00 00 00 88 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a8 29 01 00 00 00 00 00 a8 29 01 00 00 00 00 00 a8 29 01 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 e4 f1 00 00 00 00 00 00 e4 f1 00 00 00 00 00 00 e4 f1 00 00 00 00 00 00 c4 05 00 00 00 00 00 00 c4 05 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 25 01 00 00 00 00 00 f0 25 01 00 00 00 00 00 f0 25 01 00 00 00 00 00 10 0a 00 00 00 00 00 00 10 0a 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 51 c1 6c b2 e6 ee 37 45 10 03 99 2e 78 71 a4 49 ba 20 da 61 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_start_stop_daemon {
   strings:
      $s1 = "Program %s, %d process(es), refused to die." fullword ascii
      $s2 = "need at least one of --exec, --pid, --ppid, --pidfile, --user or --name" fullword ascii
      $s3 = "  2 = with --retry, processes would not die" fullword ascii
      $s4 = "longer than %d characters, please use --exec instead of --name." fullword ascii
      $s5 = "process in pidfile '%s'" fullword ascii
      $s6 = "process(es) owned by '%s'" fullword ascii
      $s7 = "invalid process scheduler policy" fullword ascii
      $s8 = "unable to set process scheduler" fullword ascii
      $s9 = "invalid process scheduler priority" fullword ascii
      $s10 = "process scheduler priority greater than max" fullword ascii
      $s11 = "this system is not able to track process names" fullword ascii
      $s12 = "process scheduler priority less than min" fullword ascii
      $s13 = "  -u, --user <username|uid>     process owner to check" fullword ascii
      $s14 = "--start needs --exec or --startas" fullword ascii
      $s15 = "%s:%s:%d:%s: internal error: " fullword ascii
      $s16 = "process with pid %d" fullword ascii
      $s17 = "process(es) with parent pid %d" fullword ascii
      $s18 = "gettimeofday failed" fullword ascii
      $s19 = "  -N, --nicelevel <incr>        add incr to the process' nice level" fullword ascii
      $s20 = "  -n, --name <process-name>     process name to check" fullword ascii
      $s21 = "  -b, --background              force the process to detach" fullword ascii
      $s22 = "  -R, --retry <schedule>        check whether processes die, and retry" fullword ascii
      $s23 = "  -g, --group <group|gid>       run process as this group" fullword ascii
      $s24 = "failed to kill %d: %s" fullword ascii
      $s25 = "strndup(%s, %zu) failed" fullword ascii
      $s26 = "Usage: start-stop-daemon [<option>...] <command>" fullword ascii
      $s27 = "nothing in /proc - not mounted?" fullword ascii
      $s28 = "                                  process" fullword ascii
      $s29 = "  -a, --startas <pathname>      program to start (default is <executable>)" fullword ascii
      $s30 = "The process scheduler <policy> can be one of:" fullword ascii
      $s31 = "  -x, --exec <executable>       program to start/check if it is running" fullword ascii
      $s32 = "only one command can be specified" fullword ascii
      $s33 = "  -S, --start -- <argument>...  start a program and pass <arguments> to it" fullword ascii
      $s34 = "No %s found running; none killed." fullword ascii
      $s35 = "user '%s' not found" fullword ascii
      $s36 = "                                  process scheduler (default prio is 0)" fullword ascii
      $s37 = "matching only on non-root pidfile %s is insecure" fullword ascii
      $s38 = "-> Notification => ready for service." fullword ascii
      $s39 = " (as user %s[%d]" fullword ascii
      $s40 = "program failed to initialize" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 4e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 30 a6 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 38 21 00 00 00 00 00 00 38 21 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 e9 3b 00 00 00 00 00 00 e9 3b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 b8 28 00 00 00 00 00 00 b8 28 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 99 00 00 00 00 00 00 b0 a9 00 00 00 00 00 00 b0 a9 00 00 00 00 00 00 e0 0a 00 00 00 00 00 00 d0 0c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 f0 9a 00 00 00 00 00 00 f0 aa 00 00 00 00 00 00 f0 aa 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 80 91 00 00 00 00 00 00 80 91 00 00 00 00 00 00 80 91 00 00 00 00 00 00 0c 01 00 00 00 00 00 00 0c 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 99 00 00 00 00 00 00 b0 a9 00 00 00 00 00 00 b0 a9 00 00 00 00 00 00 50 06 00 00 00 00 00 00 50 06 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 9e 1e 6a 4e 77 3a d9 ca 3a e1 4e c6 7a 17 a5 1c 31 a1 60 e5 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 04 00 00 00 5e 00 00 00 01 00 00 00 06 00 00 00 00 05 81 00 00 01 1c 02 5e 00 00 00 60 00 00 00 61 00 00 00 62 00 00 00 28 1d 8c 1c d1 65 ce 6d 39 f2 8b 1c b3 a2 f7 12 33 c4 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 76 02 00 00 12 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_dpkg {
   strings:
      $s1 = "  --status-logger=<command>  Send status change updates to <command>'s stdin." fullword ascii
      $s2 = "post_script_tasks - ensure_diversions" fullword ascii
      $s3 = "process_archive conffile '%s' in package %s - conff ?" fullword ascii
      $s4 = "process_archive conffile '%s' in package %s - conff ? not '%s'" fullword ascii
      $s5 = "process_archive tmp.ci script/file '%s' is control" fullword ascii
      $s6 = "process_archive tmp.ci script/file '%s' installed as '%s'" fullword ascii
      $s7 = "process_archive tmp.ci script/file '%s' contains dot" fullword ascii
      $s8 = "process_archive: old conff %s is same as new conff %s, copying hash" fullword ascii
      $s9 = "process queue pkg %s queue.len %d progress %d, try %d" fullword ascii
      $s10 = "post_script_tasks - trig_incorporate" fullword ascii
      $s11 = "dependency problems - leaving triggers unprocessed" fullword ascii
      $s12 = "wait for %s subprocess failed" fullword ascii
      $s13 = "subprocess %s returned error exit status %d" fullword ascii
      $s14 = "process_archive: old conff %s is same as new conff %s but latter already has hash" fullword ascii
      $s15 = "error processing package %s (--%s):" fullword ascii
      $s16 = "process_archive conffile '%s' package=%s %s hash=%s" fullword ascii
      $s17 = "error processing archive %s (--%s):" fullword ascii
      $s18 = "process_archive conffile '%s' no package, no hash" fullword ascii
      $s19 = "there is no script in the new version of the package - giving up" fullword ascii
      $s20 = "processing: %s: %s" fullword ascii
      $s21 = "process_archive: not removing %s, since it matches %s" fullword ascii
      $s22 = "dependency problems prevent processing triggers for %s:" fullword ascii
      $s23 = "  --compare-versions <a> <op> <b>  Compare version numbers - see below." fullword ascii
      $s24 = "Comparison operators for --compare-versions are:" fullword ascii
      $s25 = "process_archive looking for overwriting '%s' (overridden by %s)" fullword ascii
      $s26 = "Errors were encountered while processing:" fullword ascii
      $s27 = "process_archive: %s is a directory" fullword ascii
      $s28 = "package %s was on hold, processing it anyway as you requested" fullword ascii
      $s29 = "  Package %s awaits trigger processing." fullword ascii
      $s30 = "unknown system user '%s' in statoverride file; the system user got removed" fullword ascii
      $s31 = "process_archive looking for overwriting '%s'" fullword ascii
      $s32 = "process_archive not overwriting any '%s' (overriding, '%s')" fullword ascii
      $s33 = "process_archive: checking %s for same files on upgrade/downgrade" fullword ascii
      $s34 = "Options marked [*] produce a lot of output - pipe it through 'less' or 'more' !" fullword ascii
      $s35 = "%s subprocess was killed by signal (%s)%s" fullword ascii
      $s36 = "process_archive oldversionstatus=%s" fullword ascii
      $s37 = "unable to get file descriptor for directory '%s'" fullword ascii
      $s38 = "Process even packages with wrong versions" fullword ascii
      $s39 = "%s subprocess returned error exit status %d" fullword ascii
      $s40 = "%s subprocess failed with wait status code %d" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 7c 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 d3 04 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 30 62 00 00 00 00 00 00 30 62 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 d9 ab 02 00 00 00 00 00 d9 ab 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 03 00 00 00 00 00 00 20 03 00 00 00 00 00 00 20 03 00 00 00 00 00 f0 7a 01 00 00 00 00 00 f0 7a 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 a1 04 00 00 00 00 00 d0 a1 04 00 00 00 00 00 d0 a1 04 00 00 00 00 00 a0 2f 00 00 00 00 00 00 08 71 28 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 c8 04 00 00 00 00 00 d8 c8 04 00 00 00 00 00 d8 c8 04 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 b4 12 04 00 00 00 00 00 b4 12 04 00 00 00 00 00 b4 12 04 00 00 00 00 00 6c 14 00 00 00 00 00 00 6c 14 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 a1 04 00 00 00 00 00 d0 a1 04 00 00 00 00 00 d0 a1 04 00 00 00 00 00 30 2e 00 00 00 00 00 00 30 2e 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 de c4 8a 00 77 71 ed 76 9d 33 c0 e6 f0 cb 19 56 f9 d5 5b 77 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 9c 00 00 00 01 00 00 00 06 00 00 00 86 29 a1 00 e0 01 10 12 9c 00 00 00 9d 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 9e 00 00 00 00 00 00 00 9f 00 00 00 a1 00 00 00 a2 00 00 00 00 00 00 00 00 00 00 00 a3 00 00 00 a4 00 00 00 00 00 00 00 00 00 00 00 d1 65 ce 6d 81 19 9e 7c}
condition:
      filesize < 900KB and
      8 of them and $magic
}

rule gtfobins_binaries_ionice {
   strings:
      $s1 = " %1$s [options] <command>" fullword ascii
      $s2 = "$tI(knNioprio_get failed" fullword ascii
      $s3 = " -u, --uid <uid>...     act on already running processes owned by these users" fullword ascii
      $s4 = "Show or change the I/O-scheduling class and priority of a process." fullword ascii
      $s5 = " -p, --pid <pid>...     act on these already running processes" fullword ascii
      $s6 = " -P, --pgid <pgrp>...   act on already running processes in these groups" fullword ascii
      $s7 = "bad usage" fullword ascii
      $s8 = "ioprio_set failed" fullword ascii
      $s9 = " %1$s [options] -p <pid>..." fullword ascii
      $s10 = " %1$s [options] -u <uid>..." fullword ascii
      $s11 = "%s: prio %lu" fullword ascii
      $s12 = " -t, --ignore           ignore failures" fullword ascii
      $s13 = "invalid PID argument" fullword ascii
      $s14 = "best-effort" fullword ascii
      $s15 = "invalid UID argument" fullword ascii
      $s16 = "invalid class argument" fullword ascii /* Goodware String - occured 1 times */
      $s17 = "classdata" fullword ascii
      $s18 = "invalid PGID argument" fullword ascii
      $s19 = "34e3fc7011e04d34e01388e07337f68146928c.debug" fullword ascii
      $s20 = "ionice(1)" fullword ascii
      $s21 = " %1$s [options] -P <pgid>..." fullword ascii
      $s22 = "unknown scheduling class: '%s'" fullword ascii
      $s23 = "ignoring given class data for none class" fullword ascii
      $s24 = "invalid class data argument" fullword ascii
      $s25 = "ignoring given class data for idle class" fullword ascii
      $s26 = "34e3fc7011e04d34e01388e07337f68146928c" ascii
      $s27 = "+n:c:p:P:u:tVh" fullword ascii
      $s28 = "%-24s%s" fullword ascii
      $s29 = "realtime" fullword ascii /* Goodware String - occured 5 times */
      $s30 = "unknown prio class %d" fullword ascii
      $s31 = "can handle only one of pid, pgid or uid at once" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 2d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 81 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 68 15 00 00 00 00 00 00 68 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 09 35 00 00 00 00 00 00 09 35 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 d8 13 00 00 00 00 00 00 d8 13 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 7a 00 00 00 00 00 00 d0 8a 00 00 00 00 00 00 d0 8a 00 00 00 00 00 00 44 05 00 00 00 00 00 00 a0 05 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 20 7c 00 00 00 00 00 00 20 8c 00 00 00 00 00 00 20 8c 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d0 66 00 00 00 00 00 00 d0 66 00 00 00 00 00 00 d0 66 00 00 00 00 00 00 dc 01 00 00 00 00 00 00 dc 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 7a 00 00 00 00 00 00 d0 8a 00 00 00 00 00 00 d0 8a 00 00 00 00 00 00 30 05 00 00 00 00 00 00 30 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 9f 34 e3 fc 70 11 e0 4d 34 e0 13 88 e0 73 37 f6 81 46 92 8c 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_sudo {
   strings:
      $x1 = "%s - execute a command as another user" fullword ascii
      $x2 = "run login shell as the target user; a command may also be specified" fullword ascii
      $s3 = "run shell as the target user; a command may also be specified" fullword ascii
      $s4 = "--build=x86_64-linux-gnu --prefix=/usr --includedir=${prefix}/include --mandir=${prefix}/share/man --infodir=${prefix}/share/inf" ascii
      $s5 = "%s: %d failed to intercept execve" fullword ascii
      $s6 = "stop processing command line arguments" fullword ascii
      $s7 = "plugin did not return a command to execute" fullword ascii
      $s8 = "run command on host (if supported by plugin)" fullword ascii
      $s9 = "%s: %d: unable to get execve info" fullword ascii
      $s10 = "got InterceptHello without an accepted command" fullword ascii
      $s11 = "a terminal is required to read the password; either use the -S option to read from standard input or configure an askpass helper" ascii
      $s12 = "=15 --with-password-timeout=0 --with-passprompt=[sudo] password for %p:  --with-tty-tickets --without-lecture --disable-root-mai" ascii
      $s13 = "process_vm_writev(%d, 0x%lx, %zu, 0x%lx, %zu, 0): %s" fullword ascii
      $s14 = "process_vm_writev(%d, [0x%lx, %zu], 1, [0x%lx, %zu], 1, 0): %s" fullword ascii
      $s15 = "%s: unable to trace process %d, already being traced?" fullword ascii
      $s16 = "process_vm_readv(%d, [0x%lx, %zu], 1, [0x%lx, %zu], 1, 0)" fullword ascii
      $s17 = "%s: process %d exited: %d" fullword ascii
      $s18 = "%s: process %d stopped, SIG%s" fullword ascii
      $s19 = "%s: failed to read command status: short read" fullword ascii
      $s20 = "%s: unexpected wait status 0x%x for process (%d)" fullword ascii
      $s21 = "process_vm_writev(%d, [0x%lx, %zu], 1, [0x%lx, %zu], 1, 0)" fullword ascii
      $s22 = "%s: process %d killed, SIG%s" fullword ascii
      $s23 = "process_vm_readv(%d, [0x%lx, %zu], 1, [0x%lx, %zu], 1, 0): %s" fullword ascii
      $s24 = "process_vm_writev(%d, 0x%lx, %zu, 0x%lx, %zu, 0)" fullword ascii
      $s25 = "%s: failed to read command status: %s" fullword ascii
      $s26 = "unable to get event message for process %d" fullword ascii
      $s27 = "unable to get registers for process %d" fullword ascii
      $s28 = "preserve user environment when running command" fullword ascii
      $s29 = "get_process_ttyname" fullword ascii
      $s30 = "unable to read execve argv for process %d" fullword ascii
      $s31 = "selinux_getexeccon" fullword ascii
      $s32 = "message->base.descriptor == &intercept_hello__descriptor" fullword ascii
      $s33 = "  -T, --command-timeout=timeout %s" fullword ascii
      $s34 = "unable to read execve pathname for process %d" fullword ascii
      $s35 = "unable to read execve envp for process %d" fullword ascii
      $s36 = "prctl(PR_SET_DUMPABLE, %d, 0, 0, 0)" fullword ascii
      $s37 = "effective uid is not %d, is %s on a file system with the 'nosuid' option set or an NFS file system without root privileges?" fullword ascii
      $s38 = "executed %s, pid %d" fullword ascii
      $s39 = "th-fqdn --with-logging=syslog --with-logfac=authpriv --with-devel --with-env-editor --with-editor=/usr/bin/editor --with-timeout" ascii
      $s40 = "prctl(PR_GET_DUMPABLE, 0, 0, 0, 0)" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 96 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 a5 04 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 88 5b 00 00 00 00 00 00 88 5b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 71 06 03 00 00 00 00 00 71 06 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 18 ff 00 00 00 00 00 00 18 ff 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 7b 04 00 00 00 00 00 30 7b 04 00 00 00 00 00 30 7b 04 00 00 00 00 00 e8 28 00 00 00 00 00 00 00 37 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a8 85 04 00 00 00 00 00 a8 85 04 00 00 00 00 00 a8 85 04 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 e4 f3 03 00 00 00 00 00 e4 f3 03 00 00 00 00 00 e4 f3 03 00 00 00 00 00 e4 08 00 00 00 00 00 00 e4 08 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 7b 04 00 00 00 00 00 30 7b 04 00 00 00 00 00 30 7b 04 00 00 00 00 00 d0 14 00 00 00 00 00 00 d0 14 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 5f 8f 8f e0 be c3 a6 06 ad 65 f9 7b 34 55 fb 3d b9 92 9d 63 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 ff 00 00 00 02 00 00 00 07 00 00 00 a6 01 01 00 52 41 2c 2e 10 08 01 00 80 14 08 00 ff 00 00 00 05 01 00 00 0b 01 00 00 28 1d 8c 1c d0 65 ce 6d 3c f3 f5 9c 82 3e df ad a6 dd a3 6b af 60 87 ff c4 b9 9c 40 a6 3d 5f 69 66 55 61 10 86 f0 96 7c 38 f2 8b 1c 91 ba 44 05 b2 a2 f7 12}
condition:
      filesize < 900KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_unsquashfs {
   strings:
      $s1 = "FATAL ERROR - Failed to read xattr id table block %d, from 0x%llx, length %d.  File system corrupted?" fullword ascii
      $s2 = "https://github.com/plougher/squashfs-tools/blob/master/USAGE-4.6" fullword ascii
      $s3 = "%s: -processors missing or invalid processor number" fullword ascii
      $s4 = "%s: -processors should be 1 or larger" fullword ascii
      $s5 = "FATAL ERROR - Failed to read xattr block %d.  File system corrupted?" fullword ascii
      $s6 = "FATAL ERROR: File system corrupted - gid index in inode too large (gid: %d)" fullword ascii
      $s7 = "Error executing date, pipe failed" fullword ascii
      $s8 = "read here https://github.com/plougher/squashfs-tools/blob/master/README-4.6.1" fullword ascii
      $s9 = "run_length_encoded and fixed" fullword ascii
      $s10 = "Filesystem uses %s compression, this is unsupported by this version" fullword ascii
      $s11 = "FATAL ERROR: File system corrupted - gid index in inode too large (gid: %u)" fullword ascii
      $s12 = "FATAL ERROR: File system corrupted - uid index in inode too large (uid: %u)" fullword ascii
      $s13 = "FATAL ERROR: File system corrupted - inode number zero is invalid" fullword ascii
      $s14 = "FATAL ERROR: Unknown inode type %d in read_inode_header_2!" fullword ascii
      $s15 = "FATAL ERROR: Processors too large" fullword ascii
      $s16 = "FATAL ERROR: File system corrupted - xattr index in inode too large (xattr: %u)" fullword ascii
      $s17 = "FATAL ERROR: File system corrupted - fragment index in inode too large (fragment: %u)" fullword ascii
      $s18 = "Parallel unsquashfs: Using %d processor%s" fullword ascii
      $s19 = "FATAL ERROR: File system corrupted  - Bad xattr_ids count in super block" fullword ascii
      $s20 = "FATAL ERROR: File system corrupted - xattr_ids is 0 in xattr table" fullword ascii
      $s21 = "FATAL ERROR: File system corrupted - inode number in inode too large (inode_number: %u)" fullword ascii
      $s22 = "FATAL ERROR: file system is corrupt - incorrect xattr value in metadata" fullword ascii
      $s23 = "FATAL ERROR: File system corrupted - invalid type in inode (type: %u)" fullword ascii
      $s24 = "FATAL ERROR: File system corrupted - symlink_size in inode too large (symlink_size: %u)" fullword ascii
      $s25 = "FATAL ERROR: Unknown inode type %d in  read_inode_header_1!" fullword ascii
      $s26 = "write_xattr: to avoid this error message, either specify -xattrs-include '^user.', -no-xattrs, or run as superuser!" fullword ascii
      $s27 = "lzo: -Xcompression-level not supported by selected %s algorithm" fullword ascii
      $s28 = "get_xattr: xattr count unexpectedly 0 - corrupt fs?" fullword ascii
      $s29 = "FATAL ERROR: write_xattr: to avoid this error message, either specify -xattrs-include '^user.', -no-xattrs, or run as superuser!" ascii
      $s30 = "the number of processors available" fullword ascii
      $s31 = "  (no options) (deprecated - no kernel support)" fullword ascii
      $s32 = "xz: -Xdict-size is an unsupported value, dict-size must be storable in xz header" fullword ascii
      $s33 = "# START OF DATA - DO NOT MODIFY" fullword ascii
      $s34 = "Squashfs filesystem, use - for stdout" fullword ascii
      $s35 = "FATAL ERROR: Block size and block_log do not match.  File system is corrupt." fullword ascii
      $s36 = "process_filename" fullword ascii
      $s37 = "get_metadata: failed to read block" fullword ascii
      $s38 = "-processors" fullword ascii
      $s39 = "use <number> processors.  " fullword ascii
      $s40 = "value which is passed to the \"date\" command to" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 f0 4e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f8 5d 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 38 31 00 00 00 00 00 00 38 31 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 35 59 01 00 00 00 00 00 35 59 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 01 00 00 00 00 00 00 a0 01 00 00 00 00 00 00 a0 01 00 00 00 00 00 fc 9f 00 00 00 00 00 00 fc 9f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 4c 02 00 00 00 00 00 d0 4c 02 00 00 00 00 00 d0 4c 02 00 00 00 00 00 70 0f 00 00 00 00 00 00 00 16 18 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 70 4d 02 00 00 00 00 00 70 4d 02 00 00 00 00 00 70 4d 02 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 28 0e 02 00 00 00 00 00 28 0e 02 00 00 00 00 00 28 0e 02 00 00 00 00 00 a4 06 00 00 00 00 00 00 a4 06 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 4c 02 00 00 00 00 00 d0 4c 02 00 00 00 00 00 d0 4c 02 00 00 00 00 00 30 03 00 00 00 00 00 00 30 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 f0 db 52 01 18 5f db 1d 6b c7 a5 57 0a 5d ac df 20 96 74 89 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 87 00 00 00 01 00 00 00 06 00 00 00 00 01 81 00 00 01 10 02 87 00 00 00 89 00 00 00 00 00 00 00 d0 65 ce 6d 29 1d 8c 1c 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 46 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_sort {
   strings:
      $s1 = "couldn't execute compress program (with -d)" fullword ascii
      $s2 = "  -T, --temporary-directory=DIR  use DIR for temporaries, not $TMPDIR or %s;" fullword ascii
      $s3 = "couldn't execute compress program" fullword ascii
      $s4 = "the entire line as the key.  Use --debug to diagnose incorrect key usage." fullword ascii
      $s5 = "  -C, --check=quiet, --check=silent  like -c, but do not report first bad line" fullword ascii
      $s6 = "randread_error" fullword ascii
      $s7 = "obsolescent key %s used; consider %s instead" fullword ascii
      $s8 = "options '-%s' are incompatible" fullword ascii
      $s9 = "      --compress-program=PROG  compress temporaries with PROG;" fullword ascii
      $s10 = "                            If F is - then read names from standard input" fullword ascii
      $s11 = "sched_getaffinity" fullword ascii
      $s12 = "text ordering performed using simple byte comparison" fullword ascii
      $s13 = "  -h, --human-numeric-sort    compare human readable numbers (e.g., 2K 1G)" fullword ascii
      $s14 = "failed to set locale" fullword ascii
      $s15 = "                            for more use temp files" fullword ascii
      $s16 = "  -b, --ignore-leading-blanks  ignore leading blanks" fullword ascii
      $s17 = "      --random-source=FILE    get random bytes from FILE" fullword ascii
      $s18 = "  -t, --field-separator=SEP  use SEP instead of non-blank to blank transition" fullword ascii
      $s19 = "  -c, --check, --check=diagnose-first  check for sorted input; do not sort" fullword ascii
      $s20 = "!\"unexpected mode passed to stream_open\"" fullword ascii
      $s21 = "option '-%s' is ignored" fullword ascii
      $s22 = "field separator %s is treated as a plus sign in numbers" fullword ascii
      $s23 = "field separator %s is treated as a decimal point in numbers" fullword ascii
      $s24 = "  -g, --general-numeric-sort  compare according to general numerical value" fullword ascii
      $s25 = "field separator %s is treated as a group separator in numbers" fullword ascii
      $s26 = "option '-r' only applies to last-resort comparison" fullword ascii
      $s27 = "text ordering performed using %s sorting rules" fullword ascii
      $s28 = "options '-%s' are ignored" fullword ascii
      $s29 = "field separator %s is treated as a minus sign in numbers" fullword ascii
      $s30 = "lib/randread.c" fullword ascii
      $s31 = "4e42a71995cc5a976d90137221df7aaeccfde5.debug" fullword ascii
      $s32 = "  or:  %s [OPTION]... --files0-from=F" fullword ascii
      $s33 = "      --files0-from=F       read input from the files specified by" fullword ascii
      $s34 = "                              decompress them with PROG -d" fullword ascii
      $s35 = "  -V, --version-sort          natural sort of (version) numbers within text" fullword ascii
      $s36 = "%snumbers use %s as a decimal point in this locale" fullword ascii
      $s37 = "      --parallel=N          change the number of sorts run concurrently to N" fullword ascii
      $s38 = "  -r, --reverse               reverse the result of comparisons" fullword ascii
      $s39 = "                              and warn about questionable usage to stderr" fullword ascii
      $s40 = "                              without -c, output only the first of an equal run" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 65 00 00 00 00 00 00 40 00 00 00 00 00 00 00 18 c7 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a8 2d 00 00 00 00 00 00 a8 2d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 79 13 01 00 00 00 00 00 79 13 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 c0 5d 00 00 00 00 00 00 c0 5d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 b9 01 00 00 00 00 00 10 b9 01 00 00 00 00 00 10 b9 01 00 00 00 00 00 58 0c 00 00 00 00 00 00 98 14 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 b8 bd 01 00 00 00 00 00 b8 bd 01 00 00 00 00 00 b8 bd 01 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d4 7c 01 00 00 00 00 00 d4 7c 01 00 00 00 00 00 d4 7c 01 00 00 00 00 00 ac 07 00 00 00 00 00 00 ac 07 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 b9 01 00 00 00 00 00 10 b9 01 00 00 00 00 00 10 b9 01 00 00 00 00 00 f0 06 00 00 00 00 00 00 f0 06 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 0c 4e 42 a7 19 95 cc 5a 97 6d 90 13 72 21 df 7a ae cc fd e5 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 7b 00 00 00 02 00 00 00 07 00 00 00 a6 a1 48 04 12 01 ae 36 20 d8 11 12 a0 04 00 90 7b 00 00 00 00 00 00 00 7c 00 00 00 7d 00 00 00 7f 00 00 00 80 00 00 00 81 00 00 00 83 00 00 00 84 00 00 00 00 00 00 00 86 00 00 00 88 00 00 00 89 00 00 00 00 00 00 00 8b 00 00 00 8c 00 00 00}
condition:
      filesize < 300KB and
      8 of them and $magic
}

rule gtfobins_binaries_ltrace {
   strings:
      $s1 = "Error processing $XDG_CONFIG_DIRS '%s': %s" fullword ascii
      $s2 = "failed to initialize process %d: %s" fullword ascii
      $s3 = "Failed to clone process %d to %d: %s" fullword ascii
      $s4 = "couldn't reinitialize process %d after exec" fullword ascii
      $s5 = "  -u USERNAME         run command with the userid, groupid of username." fullword ascii
      $s6 = "Couldn't determine status of process %d: %s" fullword ascii
      $s7 = "process_vfork_on_event: pid %d; event type %d" fullword ascii
      $s8 = "process_stopping_on_event: pid %d; event type %d; state %d" fullword ascii
      $s9 = "  -p PID              attach to the process with the process ID pid." fullword ascii
      $s10 = "stop_non_p_processes: %d terminated?" fullword ascii
      $s11 = "[%d] event: new process" fullword ascii
      $s12 = "Couldn't initialize tracing of process %d." fullword ascii
      $s13 = "process stopping done %d" fullword ascii
      $s14 = "Error occurred when attempting to load a prototype library for %s." fullword ascii
      $s15 = "execveat" fullword ascii
      $s16 = "--- Called exec() ---" fullword ascii
      $s17 = "%s: Options -r and -t can't be used together" fullword ascii
      $s18 = "Couldn't add imports to config module %s: %s" fullword ascii
      $s19 = "process_madvise" fullword ascii
      $s20 = "process_mrelease" fullword ascii
      $s21 = "process_vm_readv" fullword ascii
      $s22 = "process_vm_writev" fullword ascii
      $s23 = "process_clone" fullword ascii
      $s24 = "process_install_stopping_handler: pid=%d" fullword ascii
      $s25 = "continue_process: pid=%d" fullword ascii
      $s26 = "[%d] event: exec()" fullword ascii
      $s27 = "Unknown process status: %s" fullword ascii
      $s28 = "process_vfork_on_event" fullword ascii
      $s29 = "unlist_process" fullword ascii
      $s30 = "self->super.on_event == process_stopping_on_event" fullword ascii
      $s31 = "\"%s\" is neither an ELF executable nor a shared library" fullword ascii
      $s32 = "process_tasks" fullword ascii
      $s33 = "process_hit_start" fullword ascii
      $s34 = "proc->event_handler->on_event == &process_stopping_on_event" fullword ascii
      $s35 = "you must be root to use the -u option" fullword ascii
      $s36 = "Couldn't get .rel*.plt data from \"%s\": %s" fullword ascii
      $s37 = "process not stopped, is it terminating?" fullword ascii
      $s38 = "Sending SIGSTOP to process %u" fullword ascii
      $s39 = "This process does not have a debug structure!" fullword ascii
      $s40 = "Usage: %s [option ...] [command [arg ...]]" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 a9 00 00 00 00 00 00 40 00 00 00 00 00 00 00 38 39 05 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 9c 00 00 00 00 00 00 20 9c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 a9 17 03 00 00 00 00 00 a9 17 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 c0 03 00 00 00 00 00 00 c0 03 00 00 00 00 00 00 c0 03 00 00 00 00 00 08 3c 01 00 00 00 00 00 08 3c 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 fd 04 00 00 00 00 00 30 0d 05 00 00 00 00 00 30 0d 05 00 00 00 00 00 b0 3a 00 00 00 00 00 00 e8 54 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 70 0d 05 00 00 00 00 00 70 1d 05 00 00 00 00 00 70 1d 05 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 80 5f 04 00 00 00 00 00 80 5f 04 00 00 00 00 00 80 5f 04 00 00 00 00 00 1c 17 00 00 00 00 00 00 1c 17 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 fd 04 00 00 00 00 00 30 0d 05 00 00 00 00 00 30 0d 05 00 00 00 00 00 d0 12 00 00 00 00 00 00 d0 12 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 77 b4 4f d1 9e 7d ca 78 af 8b e2 35 bc f1 c4 48 15 9e 8a fb 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 7a 00 00 00 01 00 00 00 06 00 00 00 00 00 81 00 00 00 04 08 7a 00 00 00 00 00 00 00 f2 be 47 3e d1 65 ce 6d 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 6e 03 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 6b 00 00 00 12 00 00 00}
condition:
      filesize < 1000KB and
      8 of them and $magic
}

rule gtfobins_binaries_ncdu {
   strings:
      $s1 = "ERROR: Can't execute shell interpreter: %s" fullword ascii
      $s2 = "Error reading from %s: %s" fullword ascii
      $s3 = "Spawn shell in current directory" fullword ascii
      $s4 = "  -o FILE                    Export scanned directory to FILE" fullword ascii
      $s5 = "  -f FILE                    Import scanned directory from FILE" fullword ascii
      $s6 = "Run with --ignore-config to skip reading config files." fullword ascii
      $s7 = "Error opening %s: %s." fullword ascii
      $s8 = "-- more --" fullword ascii
      $s9 = "error scanning %-32s" fullword ascii
      $s10 = "Standard input is not a TTY. Did you mean to import a file using '-f -'?" fullword ascii
      $s11 = "Invalid argument to --sort: '%s'." fullword ascii
      $s12 = "Error opening /dev/tty: %s" fullword ascii
      $s13 = ",\"read_error\":true" fullword ascii
      $s14 = "Error reading directory: %s" fullword ascii
      $s15 = "%s %s ~ Use the arrow keys to navigate, press " fullword ascii
      $s16 = "read_error" fullword ascii
      $s17 = "Unknown option in config file '%s': %s." fullword ascii
      $s18 = "An error occurred while reading this directory" fullword ascii
      $s19 = "An error occurred while reading a subdirectory" fullword ascii
      $s20 = "  -r                         Read only" fullword ascii
      $s21 = "  -x                         Same filesystem" fullword ascii
      $s22 = "Incompatible major format version" fullword ascii
      $s23 = "Line %d byte %d: %s" fullword ascii
      $s24 = "--disk-usage" fullword ascii
      $s25 = "Shell feature disabled." fullword ascii
      $s26 = "and all of its contents?" fullword ascii
      $s27 = "--disable-shell" fullword ascii
      $s28 = "NCDU_SHELL" fullword ascii
      $s29 = "Total disk usage: " fullword ascii
      $s30 = "--enable-shell" fullword ascii
      $s31 = "Toggle between apparent size and disk usage" fullword ascii
      $s32 = "dark-bg" fullword ascii
      $s33 = "  -0,-1,-2                   UI to use when scanning (0=none,2=full ncurses)" fullword ascii
      $s34 = "Unknown --color option: %s" fullword ascii
      $s35 = "Show/hide hidden or excluded files" fullword ascii
      $s36 = "  --color SCHEME             Set color scheme (off/dark/dark-bg)" fullword ascii
      $s37 = "otherfs" fullword ascii
      $s38 = "  -q                         Quiet mode, refresh interval 2 seconds" fullword ascii
      $s39 = "Are you sure you want to delete \"%s\"%c" fullword ascii
      $s40 = "Directory was on another filesystem" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 3e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 a0 51 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 21 00 00 00 00 00 00 00 21 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 a1 de 00 00 00 00 00 00 a1 de 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 10 01 00 00 00 00 00 00 10 01 00 00 00 00 00 00 10 01 00 00 00 00 00 c0 37 00 00 00 00 00 00 c0 37 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 48 01 00 00 00 00 00 f0 58 01 00 00 00 00 00 f0 58 01 00 00 00 00 00 64 07 00 00 00 00 00 00 68 1b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d0 4a 01 00 00 00 00 00 d0 5a 01 00 00 00 00 00 d0 5a 01 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 b0 33 01 00 00 00 00 00 b0 33 01 00 00 00 00 00 b0 33 01 00 00 00 00 00 64 02 00 00 00 00 00 00 64 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 48 01 00 00 00 00 00 f0 58 01 00 00 00 00 00 f0 58 01 00 00 00 00 00 10 07 00 00 00 00 00 00 10 07 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 02 f0 b8 40 7d 4c 8a 98 3c 5e 1e 2d 7a d0 ae 5f 9d 87 ac a1 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 61 00 00 00 01 00 00 00 06 00 00 00 00 00 81 00 00 00 00 00 61 00 00 00 00 00 00 00 d1 65 ce 6d 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f5 02 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 53 02 00 00 12 00 00 00}
condition:
      filesize < 300KB and
      8 of them and $magic
}

rule gtfobins_binaries_tcpdump {
   strings:
      $s1 = "[ -z postrotate-command ] [ -Z user ] [ expression ]" fullword ascii
      $s2 = "compress_savefile: execlp(%s, %s) failed: %s" fullword ascii
      $s3 = "hlim %u, next-header %s (%u) payload length: %u) " fullword ascii
      $s4 = "  undecoded non-header data, length %u" fullword ascii
      $s5 = ", incomplete header chain - octet %u" fullword ascii
      $s6 = " BEEP (payload or undecoded)" fullword ascii
      $s7 = "Login-IPv6-Host" fullword ascii
      $s8 = "host %s unreachable - unknown" fullword ascii
      $s9 = "host %s unreachable - precedence cutoff" fullword ascii
      $s10 = "Usage: %s [-AbdDefhHIJKlLnNOpqStuUvxX#] [ -B size ] [ -c count ] [--count]" fullword ascii
      $s11 = "host %s unreachable - admin prohibited" fullword ascii
      $s12 = "Login-IP-Host" fullword ascii
      $s13 = "host %s unreachable - host precedence violation" fullword ascii
      $s14 = "host %s unreachable - admin prohibited filter" fullword ascii
      $s15 = "host %s unreachable - tos prohibited" fullword ascii
      $s16 = "route-target: %u:%u/%d (%s)" fullword ascii
      $s17 = "target dev %u, port %u, " fullword ascii
      $s18 = "route-target: %s:%u/%d (%s)" fullword ascii
      $s19 = "route-target: %u.%u.%u.%u:%u/%d (%s)" fullword ascii
      $s20 = "  Original-MAC %s, Target-MAC %s" fullword ascii
      $s21 = ", Request for targeted Hellos" fullword ascii
      $s22 = "%s, vpi %u, vci %u, payload [ %s ], clp %u, length %u" fullword ascii
      $s23 = "%u, password: " fullword ascii
      $s24 = "Login-LAT-Service" fullword ascii
      $s25 = "rpltargetdesc" fullword ascii
      $s26 = "tcpdump" fullword ascii
      $s27 = "rpltarget" fullword ascii
      $s28 = "Login-Service" fullword ascii
      $s29 = "Login-LAT-Port" fullword ascii
      $s30 = "Other Proxy Processing Error" fullword ascii
      $s31 = "Login-TCP-Port" fullword ascii
      $s32 = "FST pending, in process of admitting FST session" fullword ascii
      $s33 = "GTS Descriptor Count = %d, " fullword ascii
      $s34 = "LWAPPv%u, %s frame, Radio-id  %u, Flags [%s], length %u < transport header length" fullword ascii
      $s35 = "%s  Error Node Address: %s, Flags: [0x%02x]%s  Error Code: %s (%u)" fullword ascii
      $s36 = "continue-execute-on-failure" fullword ascii
      $s37 = "continue processing" fullword ascii
      $s38 = "(jumbo: %u - payload len != 0) " fullword ascii
      $s39 = "SHELL_COMMAND" fullword ascii
      $s40 = "route-target: partial-type: (%s/%d)" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 29 03 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 68 13 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 58 fb 02 00 00 00 00 00 58 fb 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 00 03 00 00 00 00 00 00 00 03 00 00 00 00 00 00 00 03 00 00 00 00 00 e9 2d 0a 00 00 00 00 00 e9 2d 0a 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 0d 00 00 00 00 00 00 30 0d 00 00 00 00 00 00 30 0d 00 00 00 00 00 a4 0d 04 00 00 00 00 00 a4 0d 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 49 11 00 00 00 00 00 10 49 11 00 00 00 00 00 10 49 11 00 00 00 00 00 80 1e 02 00 00 00 00 00 38 08 18 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 90 29 13 00 00 00 00 00 90 29 13 00 00 00 00 00 90 29 13 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 48 26 10 00 00 00 00 00 48 26 10 00 00 00 00 00 48 26 10 00 00 00 00 00 1c 1a 00 00 00 00 00 00 1c 1a 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 49 11 00 00 00 00 00 10 49 11 00 00 00 00 00 10 49 11 00 00 00 00 00 f0 e6 01 00 00 00 00 00 f0 e6 01 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 1b 17 da 30 ef 7d ec f5 45 51 e2 a4 4b c8 67 be c8 e3 33 61 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 89 00 00 00 01 00 00 00 06 00 00 00 00 05 a1 00 80 01 1c 02 89 00 00 00 8b 00 00 00 8d 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c b2 a2 f7 12 33 c4 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 2f 05 00 00 12 00 00 00}
condition:
      filesize < 4000KB and
      8 of them and $magic
}

rule gtfobins_binaries_mount {
   strings:
      $s1 = "%s: parse error at line %d -- ignored" fullword ascii
      $s2 = " %1$s <operation> <mountpoint> [<target>]" fullword ascii
      $s3 = "failed to set target namespace to %s" fullword ascii
      $s4 = "mnt_context_helper_executed" fullword ascii
      $s5 = "target-prefix" fullword ascii
      $s6 = " %1$s [options] [--source] <source> | [--target] <directory>" fullword ascii
      $s7 = "mnt_context_get_target" fullword ascii
      $s8 = "mnt_context_set_target_ns" fullword ascii
      $s9 = "mnt_context_set_target_prefix" fullword ascii
      $s10 = "mnt_context_set_target" fullword ascii
      $s11 = "getfilecon" fullword ascii
      $s12 = "     --target-prefix <path>" fullword ascii
      $s13 = "     --target <target>   explicitly specifies mountpoint" fullword ascii
      $s14 = " %1$s -a [options]" fullword ascii
      $s15 = "failed to read mtab" fullword ascii
      $s16 = "mnt_get_library_version" fullword ascii
      $s17 = "drop permissions failed" fullword ascii
      $s18 = "mnt_fs_get_target" fullword ascii
      $s19 = " -w, --rw, --read-write  mount the filesystem read-write (default)" fullword ascii
      $s20 = "     --map-users /proc/<pid>/ns/user" fullword ascii
      $s21 = "     --map-users <inner>:<outer>:<count>" fullword ascii
      $s22 = " -O, --test-opts <list>  limit the set of filesystems (use with -a)" fullword ascii
      $s23 = "mnt_fs_set_target" fullword ascii
      $s24 = "make-runbindable" fullword ascii
      $s25 = "failed to append option '%s'" fullword ascii
      $s26 = " -r, --read-only         mount the filesystem read-only (same as -o ro)" fullword ascii
      $s27 = "mount: %s does not contain SELinux labels." fullword ascii
      $s28 = " -B, --bind              mount a subtree somewhere else (same as -o bind)" fullword ascii
      $s29 = "%s: %s bound on %s." fullword ascii
      $s30 = "%s: failed to parse" fullword ascii
      $s31 = "%s: %s moved to %s." fullword ascii
      $s32 = "%s: %s mounted on %s." fullword ascii
      $s33 = "%s: %s propagation flags changed." fullword ascii
      $s34 = "map-users" fullword ascii
      $s35 = "security_get_initial_context" fullword ascii
      $s36 = "drop permissions failed." fullword ascii
      $s37 = "mnt_context_enable_fake" fullword ascii
      $s38 = "failed to set options pattern" fullword ascii
      $s39 = "mnt_context_get_excode" fullword ascii
      $s40 = "failed to initialize libmount table" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 6d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 f1 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 50 38 00 00 00 00 00 00 50 38 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 39 69 00 00 00 00 00 00 39 69 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 c0 2b 00 00 00 00 00 00 c0 2b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 e2 00 00 00 00 00 00 50 e2 00 00 00 00 00 00 50 e2 00 00 00 00 00 00 c4 0d 00 00 00 00 00 00 30 0e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c8 e8 00 00 00 00 00 00 c8 e8 00 00 00 00 00 00 c8 e8 00 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 00 ca 00 00 00 00 00 00 00 ca 00 00 00 00 00 00 00 ca 00 00 00 00 00 00 7c 02 00 00 00 00 00 00 7c 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 e2 00 00 00 00 00 00 50 e2 00 00 00 00 00 00 50 e2 00 00 00 00 00 00 b0 0d 00 00 00 00 00 00 b0 0d 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 86 50 fa e8 62 a8 1b 9d 28 8b 93 9b 28 7f b6 c0 97 a3 4e 17 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_wall {
   strings:
      $s1 = "will not read %s - use stdin." fullword ascii
      $s2 = "get user name failed: %s" fullword ascii
      $s3 = "error getting sessions: %s" fullword ascii
      $s4 = "xgetgrnam" fullword ascii
      $s5 = "xgetpwnam" fullword ascii
      $s6 = "xgetpwuid" fullword ascii
      $s7 = "sd_get_sessions" fullword ascii
      $s8 = "sd_session_get_username" fullword ascii
      $s9 = "sd_session_get_tty" fullword ascii
      $s10 = "Write a message to all users." fullword ascii
      $s11 = "getgrouplist found more groups than sysconf allows" fullword ascii
      $s12 = "debian.net\"}" fullword ascii
      $s13 = "cannot get passwd uid" fullword ascii
      $s14 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"util-linux\",\"version\":\"2.40.2-11\",\"architecture\":\"amd64\",\"debugInfoUrl" ascii
      $s15 = "%s: BAD ERROR, message is far too long" fullword ascii
      $s16 = "nobanner" fullword ascii
      $s17 = " -t, --timeout <timeout> write timeout in seconds" fullword ascii
      $s18 = "libsystemd.so.0" fullword ascii
      $s19 = "LIBSYSTEMD_209" fullword ascii
      $s20 = "0034ceeb721d165b16f809eda5cf055f27e72b.debug" fullword ascii
      $s21 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"util-linux\",\"version\":\"2.40.2-11\",\"architecture\":\"amd64\",\"debugInfoUrl" ascii
      $s22 = "internal error: too many iov's" fullword ascii
      $s23 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/bsdutils.debug" fullword ascii
      $s24 = "--nobanner is available only for root" fullword ascii
      $s25 = " %s [options] [<file> | <message>]" fullword ascii
      $s26 = "LIBSYSTEMD_254" fullword ascii
      $s27 = "%s: unknown gid" fullword ascii
      $s28 = "invalid timeout argument" fullword ascii
      $s29 = " -n, --nobanner          do not print banner, works only for root" fullword ascii
      $s30 = "excessively long line arg" fullword ascii
      $s31 = "invalid group argument" fullword ascii
      $s32 = "grpbuf" fullword ascii
      $s33 = "pwdbuf" fullword ascii
      $s34 = "lib/pwdutils.c" fullword ascii
      $s35 = "0034ceeb721d165b16f809eda5cf055f27e72b" ascii
      $s36 = "wall(1)" fullword ascii
      $s37 = "<someone>" fullword ascii
      $s38 = "fork: %m" fullword ascii
      $s39 = "34ceeb721d165b16f809eda5cf055f27e72b" ascii
      $s40 = "invalid timeout argument: %s" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 f0 33 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 91 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e8 1e 00 00 00 00 00 00 e8 1e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 09 47 00 00 00 00 00 00 09 47 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 48 15 00 00 00 00 00 00 48 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 8a 00 00 00 00 00 00 10 9a 00 00 00 00 00 00 10 9a 00 00 00 00 00 00 04 06 00 00 00 00 00 00 70 0c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 8a 00 00 00 00 00 00 e0 9a 00 00 00 00 00 00 e0 9a 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e4 00 00 00 00 00 00 00 e4 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c8 75 00 00 00 00 00 00 c8 75 00 00 00 00 00 00 c8 75 00 00 00 00 00 00 34 02 00 00 00 00 00 00 34 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 8a 00 00 00 00 00 00 10 9a 00 00 00 00 00 00 10 9a 00 00 00 00 00 00 f0 05 00 00 00 00 00 00 f0 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 25 00 34 ce eb 72 1d 16 5b 16 f8 09 ed a5 cf 05 5f 27 e7 2b 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 90 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_chown {
   strings:
      $s1 = "  %s root:staff /u  Likewise, but also change its group to \"staff\"." fullword ascii
      $s2 = "to login group if implied by a ':' following a symbolic OWNER." fullword ascii
      $s3 = "  -v, --verbose          output a diagnostic for every file processed" fullword ascii
      $s4 = "      --preserve-root    fail to operate recursively on '/'" fullword ascii
      $s5 = "  %s root /u        Change the owner of /u to \"root\"." fullword ascii
      $s6 = "  %s -hR root /u    Change the owner of /u and subfiles to \"root\"." fullword ascii
      $s7 = "  -f, --silent, --quiet  suppress most error messages" fullword ascii
      $s8 = "  -H                     if a command line argument is a symbolic link" fullword ascii
      $s9 = "  -P                     do not traverse any symbolic links (default)" fullword ascii
      $s10 = "  -L                     traverse every symbolic link to a directory" fullword ascii
      $s11 = "  -R, --recursive        operate on files and directories recursively" fullword ascii
      $s12 = "  or:  %s [OPTION]... --reference=RFILE FILE..." fullword ascii
      $s13 = "      --no-preserve-root  do not treat '/' specially (the default)" fullword ascii
      $s14 = "  -c, --changes          like verbose but report only when a change is made" fullword ascii
      $s15 = "__openat_2" fullword ascii
      $s16 = "warning: '.' should be ':'" fullword ascii
      $s17 = "src/chown-core.c" fullword ascii
      $s18 = "                         to a directory, traverse it" fullword ascii
      $s19 = "lib/cycle-check.c" fullword ascii
      $s20 = "b8ad6ffb1ea42a1a0abe3dfd86ff34a7693908.debug" fullword ascii
      $s21 = "state->magic == 9827862" fullword ascii
      $s22 = "describe_change" fullword ascii
      $s23 = "invalid spec" fullword ascii /* Goodware String - occured 2 times */
      $s24 = "With --reference, change the owner and group of each FILE to those of RFILE." fullword ascii /* Goodware String - occured 2 times */
      $s25 = "      --from=CURRENT_OWNER:CURRENT_GROUP" fullword ascii
      $s26 = "failed to change group of %s from %s to %s" fullword ascii /* Goodware String - occured 2 times */
      $s27 = "changed group of %s from %s to %s" fullword ascii /* Goodware String - occured 2 times */
      $s28 = "  -h, --no-dereference   affect symbolic links instead of any referenced file" fullword ascii
      $s29 = "failed to change ownership of %s from %s to %s" fullword ascii /* Goodware String - occured 2 times */
      $s30 = "      --dereference      affect the referent of each symbolic link (this is" fullword ascii
      $s31 = "changed ownership of %s from %s to %s" fullword ascii /* Goodware String - occured 2 times */
      $s32 = "      --reference=RFILE  use RFILE's owner and group rather than specifying" fullword ascii
      $s33 = "Usage: %s [OPTION]... [OWNER][:[GROUP]] FILE..." fullword ascii /* Goodware String - occured 2 times */
      $s34 = "OWNER and GROUP may be numeric as well as symbolic." fullword ascii /* Goodware String - occured 2 times */
      $s35 = "Change the owner and/or group of each FILE to OWNER and/or GROUP." fullword ascii /* Goodware String - occured 3 times */
      $s36 = "Owner is unchanged if missing.  Group is unchanged if missing, but changed" fullword ascii /* Goodware String - occured 3 times */
      $s37 = "invalid group" fullword ascii /* Goodware String - occured 4 times */
      $s38 = "invalid user" fullword ascii /* Goodware String - occured 4 times */
      $s39 = "H=OAFSt" fullword ascii
      $s40 = "no change to ownership of %s" fullword ascii /* Goodware String - occured 4 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 2a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 70 24 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 98 1b 00 00 00 00 00 00 98 1b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 39 a2 00 00 00 00 00 00 39 a2 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 60 3e 00 00 00 00 00 00 60 3e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 1b 01 00 00 00 00 00 b0 1b 01 00 00 00 00 00 b0 1b 01 00 00 00 00 00 10 07 00 00 00 00 00 00 d8 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 1d 01 00 00 00 00 00 d8 1d 01 00 00 00 00 00 d8 1d 01 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 f4 eb 00 00 00 00 00 00 f4 eb 00 00 00 00 00 00 f4 eb 00 00 00 00 00 00 b4 05 00 00 00 00 00 00 b4 05 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 1b 01 00 00 00 00 00 b0 1b 01 00 00 00 00 00 b0 1b 01 00 00 00 00 00 50 04 00 00 00 00 00 00 50 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 4f b8 ad 6f fb 1e a4 2a 1a 0a be 3d fd 86 ff 34 a7 69 39 08 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 4c 00 00 00 01 00 00 00 06 00 00 00 84 4d c1 00 20 01 1c 12 4c 00 00 00 4e 00 00 00 54 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 86 f0 96 7c 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_sysctl {
   strings:
      $s1 = "reading key \"%s\"" fullword ascii
      $s2 = " -V, --version  output version information and exit" fullword ascii
      $s3 = "  -p, --load[=<file>]  read values from file" fullword ascii
      $s4 = "setting key \"%s\"%s" fullword ascii
      $s5 = "setting key \"%s\"" fullword ascii
      $s6 = "permission denied on key '%s'" fullword ascii
      $s7 = "* Applying %s ..." fullword ascii
      $s8 = "\"%s\" is an unknown key" fullword ascii
      $s9 = "permission denied on key \"%s\"%s" fullword ascii
      $s10 = "\"%s\" is an unknown key%s" fullword ascii
      $s11 = "Path is not under %s: %s" fullword ascii
      $s12 = "      --dry-run        Print the key and values but do not write" fullword ascii
      $s13 = "strdup key" fullword ascii
      $s14 = "  -r, --pattern <expression>" fullword ascii
      $s15 = "options -N and -q cannot coexist" fullword ascii
      $s16 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/procps.debug" fullword ascii
      $s17 = "/run/sysctl.d" fullword ascii
      $s18 = "  -f                   alias of -p" fullword ascii
      $s19 = "  -o                   does nothing" fullword ascii
      $s20 = "  -d                   alias of -h" fullword ascii
      $s21 = "unable to open directory \"%s\"" fullword ascii
      $s22 = "  -x                   does nothing" fullword ascii
      $s23 = "      --system         read values from all system directories" fullword ascii
      $s24 = "  -e, --ignore         ignore unknown variables errors" fullword ascii
      $s25 = "no variables specified" fullword ascii
      $s26 = "  -b, --binary         print value without new line" fullword ascii
      $s27 = "__openat_2" fullword ascii
      $s28 = "procps-ng 4.0.4" fullword ascii
      $s29 = "procps-ng" fullword ascii
      $s30 = "/etc/sysctl.conf" fullword ascii
      $s31 = "/etc/sysctl.d" fullword ascii
      $s32 = "retrans_time" fullword ascii
      $s33 = "sysctl(8)" fullword ascii
      $s34 = "separators should not be repeated: %s" fullword ascii
      $s35 = "/proc/sys/" fullword ascii
      $s36 = "7cb1304315d81b33ff3b888c5a32902ff32285.debug" fullword ascii
      $s37 = "/usr/lib/sysctl.d" fullword ascii
      $s38 = "base_reachable_time" fullword ascii
      $s39 = "glob failed" fullword ascii /* Goodware String - occured 1 times */
      $s40 = "bneNwfp::qoxaAXr:Vdh" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 2c 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c0 71 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 68 16 00 00 00 00 00 00 68 16 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 79 29 00 00 00 00 00 00 79 29 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 48 0f 00 00 00 00 00 00 48 0f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 69 00 00 00 00 00 00 f0 69 00 00 00 00 00 00 f0 69 00 00 00 00 00 00 28 06 00 00 00 00 00 00 98 06 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 20 6c 00 00 00 00 00 00 20 6c 00 00 00 00 00 00 20 6c 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 a4 59 00 00 00 00 00 00 a4 59 00 00 00 00 00 00 a4 59 00 00 00 00 00 00 bc 00 00 00 00 00 00 00 bc 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 69 00 00 00 00 00 00 f0 69 00 00 00 00 00 00 f0 69 00 00 00 00 00 00 10 06 00 00 00 00 00 00 10 06 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 52 7c b1 30 43 15 d8 1b 33 ff 3b 88 8c 5a 32 90 2f f3 22 85 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 39 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 39 00 00 00 3b 00 00 00 41 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 90KB and
      8 of them and $magic
}

rule gtfobins_binaries_ip {
   strings:
      $s1 = "Command \"%s\" is unknown, try \"ip -f inet6 tunnel help\"." fullword ascii
      $s2 = "incomplete dump message" fullword ascii
      $s3 = "cmd_exec" fullword ascii
      $s4 = "Failed to send dump request" fullword ascii
      $s5 = "Error: Invalid address length %d - must be %d bytes" fullword ascii
      $s6 = "Couldn't find runtime libbpf version - falling back to compile-time value!" fullword ascii
      $s7 = "Command failed %s:%d" fullword ascii
      $s8 = "*** Round %d, deleting %d addresses ***" fullword ascii
      $s9 = "Invalid \"vlan protocol\" value - supported %s, %s" fullword ascii
      $s10 = "mnl_nlmsg_get_payload" fullword ascii
      $s11 = "mnl_nlmsg_get_payload_len" fullword ascii
      $s12 = "*** Flush not complete bailing out after %d rounds" fullword ascii
      $s13 = "setexecfilecon for \"%s\" failed" fullword ascii
      $s14 = "*** Flush remains incomplete after %d rounds. ***" fullword ascii
      $s15 = "mount -t bpf bpf %s failed: %s" fullword ascii
      $s16 = "exec of \"%s\" failed: %s" fullword ascii
      $s17 = "Warning: Executing wildcard deletion to stay compatible with old scripts." fullword ascii
      $s18 = "Invalid address length %d - must be %d bytes" fullword ascii
      $s19 = "nolocalbypass" fullword ascii
      $s20 = "Failed to process link information" fullword ascii
      $s21 = "Command \"%s\" is unknown, try \"ip address help\"." fullword ascii
      $s22 = "showdump" fullword ascii
      $s23 = "*** Flush is complete after %d round%s ***" fullword ascii
      $s24 = "*** Flush not completed after %ld seconds, %d entries remain ***" fullword ascii
      $s25 = "Command \"%s\" is unknown, try \"ip token help\"." fullword ascii
      $s26 = "Database %s, id %u is reserved - ignoring!" fullword ascii
      $s27 = "*** Round %d, deleting %d entries ***" fullword ascii
      $s28 = "Bind %s -> %s failed: %s" fullword ascii
      $s29 = "Can't restore address dump from a terminal" fullword ascii
      $s30 = "mount --make-private %s failed: %s" fullword ascii
      $s31 = "arp_all_targets %s " fullword ascii
      $s32 = "Usage: ip [ OPTIONS ] OBJECT { COMMAND | help }" fullword ascii
      $s33 = "mount --make-shared %s failed: %s" fullword ascii
      $s34 = "RTM_GETNSID is not supported by the kernel." fullword ascii
      $s35 = "Usage: ip sr { COMMAND | help }" fullword ascii
      $s36 = "Usage: ip xfrm XFRM-OBJECT { COMMAND | help }" fullword ascii
      $s37 = "Dump terminated. Failed to flush nexthops" fullword ascii
      $s38 = "Error parsing section %d! Perhaps check with readelf -a?" fullword ascii
      $s39 = "mount --bind %s %s failed: %s" fullword ascii
      $s40 = "Usage: ip -f inet6 tunnel { add | change | del | show } [ NAME ]" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 0b 01 00 00 00 00 00 40 00 00 00 00 00 00 00 38 dc 0a 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c0 e3 00 00 00 00 00 00 c0 e3 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 d1 e6 06 00 00 00 00 00 d1 e6 06 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 07 00 00 00 00 00 00 e0 07 00 00 00 00 00 00 e0 07 00 00 00 00 00 58 5d 02 00 00 00 00 00 58 5d 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 4c 0a 00 00 00 00 00 70 4c 0a 00 00 00 00 00 70 4c 0a 00 00 00 00 00 14 8e 00 00 00 00 00 00 d0 58 05 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 38 67 0a 00 00 00 00 00 38 67 0a 00 00 00 00 00 38 67 0a 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 8c 5a 09 00 00 00 00 00 8c 5a 09 00 00 00 00 00 8c 5a 09 00 00 00 00 00 34 1d 00 00 00 00 00 00 34 1d 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 4c 0a 00 00 00 00 00 70 4c 0a 00 00 00 00 00 70 4c 0a 00 00 00 00 00 90 23 00 00 00 00 00 00 90 23 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 f5 69 0c 33 80 a0 23 7b 36 f7 4a 89 8e c1 63 12 46 91 f4 03 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 69 70 72 6f 75 74 65 32 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 36 2e 31 30 2e 30 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a 22 61}
condition:
      filesize < 2000KB and
      8 of them and $magic
}

rule gtfobins_binaries_screen {
   strings:
      $s1 = "User %s has a password, cannot use remote commands (using -Q or -X option)." fullword ascii
      $s2 = "-X            Execute <cmd> as a screen command in the specified session." fullword ascii
      $s3 = "Error dumping layout." fullword ascii
      $s4 = " or: %s -r [host.tty]" fullword ascii
      $s5 = "LoginName too long - sorry." fullword ascii
      $s6 = "Welcome to hacker's treasure zoo - Column %d Line %d(+%d) (%d,%d)" fullword ascii
      $s7 = "%s: at [identifier][%%|*|#] command [args]" fullword ascii
      $s8 = "Layout dumped to \"%s\"" fullword ascii
      $s9 = "%s: bindkey: -a only works with -k" fullword ascii
      $s10 = "%s: bindkey: unknown command '%s'" fullword ascii
      $s11 = "%s: bindkey: -d does not work with -m" fullword ascii
      $s12 = "%s:%s screen login" fullword ascii
      $s13 = "[ Passwords don't match - checking turned off ]" fullword ascii
      $s14 = "[ Passwords don't match - your armor crumbles away ]" fullword ascii
      $s15 = "[ No password - no secure ]" fullword ascii
      $s16 = "-Q            Commands will send the response to the stdout of the querying process." fullword ascii
      $s17 = "Copy mode - Column %d Line %d(+%d) (%d,%d)" fullword ascii
      $s18 = "deflogin" fullword ascii
      $s19 = "You drop a magic marker - Column %d Line %d" fullword ascii
      $s20 = "%s: password: window required" fullword ascii
      $s21 = "Attach: passed fd does not match tty: %s - %s!" fullword ascii
      $s22 = "Unknown user %s tried to send a command!" fullword ascii
      $s23 = "-r [session]  Reattach to a detached screen process." fullword ascii
      $s24 = " (Core dumped)" fullword ascii
      $s25 = "%s: unknown command '%s'" fullword ascii
      $s26 = "command from %s: %s %s" fullword ascii
      $s27 = "-- %n:%t -- time-stamp -- %M/%d/%y %c:%s --" fullword ascii
      $s28 = "%s: bind: unknown command '%s'" fullword ascii
      $s29 = "%s: idle: unknown command '%s'" fullword ascii
      $s30 = "%s: process: character, ^x, or (octal) \\032 expected." fullword ascii
      $s31 = "BREAK stuck!!! -- HELP! (TIOCCBRK)" fullword ascii
      $s32 = "Type \"screen [-d] -r [pid.]tty.host\" to resume one of them." fullword ascii
      $s33 = "-l            Login mode on (update %s), -ln = off." fullword ascii
      $s34 = "First mark set - Column %d Line %d" fullword ascii
      $s35 = "=== Command %s (%s) ===" fullword ascii
      $s36 = "Usage: screen //telnet host [port]" fullword ascii
      $s37 = "User's UNIX Password: " fullword ascii
      $s38 = "User's Screen Password: " fullword ascii
      $s39 = "Specify command characters with -e" fullword ascii
      $s40 = "Screen password: " fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 b1 00 00 00 00 00 00 40 00 00 00 00 00 00 00 18 65 07 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c0 72 00 00 00 00 00 00 c0 72 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 c1 5a 05 00 00 00 00 00 c1 5a 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 05 00 00 00 00 00 00 e0 05 00 00 00 00 00 00 e0 05 00 00 00 00 00 e4 30 01 00 00 00 00 00 e4 30 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 16 07 00 00 00 00 00 10 26 07 00 00 00 00 00 10 26 07 00 00 00 00 00 c0 4d 00 00 00 00 00 00 48 4f 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 28 18 07 00 00 00 00 00 28 28 07 00 00 00 00 00 28 28 07 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 38 74 06 00 00 00 00 00 38 74 06 00 00 00 00 00 38 74 06 00 00 00 00 00 7c 13 00 00 00 00 00 00 7c 13 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 16 07 00 00 00 00 00 10 26 07 00 00 00 00 00 10 26 07 00 00 00 00 00 f0 09 00 00 00 00 00 00 f0 09 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 d8 45 81 0a b5 6b e2 9f 83 97 5b 45 d9 af da 2f 9a 0d eb fc 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 b0 00 00 00 01 00 00 00 06 00 00 00 30 01 a1 00 c0 01 50 02 b0 00 00 00 b3 00 00 00 b6 00 00 00 28 1d 8c 1c a6 dd a3 6b d1 65 ce 6d 66 55 61 10 c4 b9 9c 40 39 f2 8b 1c 05 ca 2b 13 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b6 04 00 00 12 00 00 00}
condition:
      filesize < 1000KB and
      8 of them and $magic
}

rule gtfobins_binaries_more {
   strings:
      $s1 = "*** %s: directory ***" fullword ascii
      $s2 = "******** %s: Not a text file ********" fullword ascii
      $s3 = "!<cmd> or :!<cmd>       Execute <cmd> in a subshell" fullword ascii
      $s4 = "No previous command to substitute for" fullword ascii
      $s5 = "Most commands optionally preceded by integer argument k.  Defaults in brackets." fullword ascii
      $s6 = "drop permissions failed" fullword ascii
      $s7 = "stat of %s failed" fullword ascii
      $s8 = "failed to parse number" fullword ascii
      $s9 = "argument error" fullword ascii
      $s10 = "Display the contents of a file in a terminal." fullword ascii
      $s11 = "bad usage" fullword ascii
      $s12 = "signalfd" fullword ascii
      $s13 = " -n, --lines <number>  the number of lines per screenful" fullword ascii
      $s14 = "\"%s\" line %d" fullword ascii
      $s15 = ".                       Repeat previous command" fullword ascii
      $s16 = "8ddae47ef0f44309c7f4a14be31c61c387524c.debug" fullword ascii
      $s17 = "(Next file: %s)" fullword ascii
      $s18 = "...skipping %d line" fullword ascii
      $s19 = "...skipping %d lines" fullword ascii
      $s20 = "cur_term" fullword ascii /* Goodware String - occured 1 times */
      $s21 = "exec failed" fullword ascii /* Goodware String - occured 1 times */
      $s22 = "./include/xalloc.h" fullword ascii
      $s23 = " -f, --logical         count logical rather than screen lines" fullword ascii
      $s24 = "text-utils/more.c" fullword ascii
      $s25 = "sz == sizeof(info)" fullword ascii
      $s26 = "more_poll" fullword ascii
      $s27 = "exit-on-eof" fullword ascii
      $s28 = "[Not a file] line %d" fullword ascii
      $s29 = "8ddae47ef0f44309c7f4a14be31c61c387524c" ascii
      $s30 = "$tI(knN/usr/bin/vi" fullword ascii
      $s31 = "[Press 'h' for instructions.]" fullword ascii
      $s32 = "more(1)" fullword ascii
      $s33 = "dflcpsun:eVh" fullword ascii
      $s34 = "f                       Skip forward k screenfuls of text [1]" fullword ascii
      $s35 = "clean-print" fullword ascii
      $s36 = "print-over" fullword ascii
      $s37 = "***Back***" fullword ascii
      $s38 = "s                       Skip forward k lines of text [1]" fullword ascii
      $s39 = "[Press space to continue, 'q' to quit.]" fullword ascii
      $s40 = "MORE environment variable" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 45 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d0 e1 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a0 23 00 00 00 00 00 00 a0 23 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 d9 7b 00 00 00 00 00 00 d9 7b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 d8 22 00 00 00 00 00 00 d8 22 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 d8 00 00 00 00 00 00 b0 e8 00 00 00 00 00 00 b0 e8 00 00 00 00 00 00 68 07 00 00 00 00 00 00 d0 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 40 da 00 00 00 00 00 00 40 ea 00 00 00 00 00 00 40 ea 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 f8 c0 00 00 00 00 00 00 f8 c0 00 00 00 00 00 00 f8 c0 00 00 00 00 00 00 74 02 00 00 00 00 00 00 74 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 d8 00 00 00 00 00 00 b0 e8 00 00 00 00 00 00 b0 e8 00 00 00 00 00 00 50 07 00 00 00 00 00 00 50 07 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 4a 8d da e4 7e f0 f4 43 09 c7 f4 a1 4b e3 1c 61 c3 87 52 4c 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_look {
   strings:
      $s1 = "bad usage" fullword ascii
      $s2 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/bsdextrautils.debug" fullword ascii
      $s3 = "/usr/share/dict/words" fullword ascii
      $s4 = "/usr/share/dict/web2" fullword ascii
      $s5 = " -d, --alphanum           compare only blanks and alphanumeric characters" fullword ascii
      $s6 = "07791c2aaa7a9ad4bd5f2da435094332e2759e.debug" fullword ascii
      $s7 = "alphanum" fullword ascii /* Goodware String - occured 1 times */
      $s8 = "Display lines beginning with a specified string." fullword ascii
      $s9 = "adft:Vh" fullword ascii
      $s10 = "look(1)" fullword ascii
      $s11 = " -a, --alternative        use the alternative dictionary" fullword ascii
      $s12 = " -t, --terminate <char>   define the string-termination character" fullword ascii
      $s13 = " %s [options] <string> [<file>...]" fullword ascii
      $s14 = " -f, --ignore-case        ignore case differences when comparing" fullword ascii
      $s15 = "%-26s%s" fullword ascii
      $s16 = "07791c2aaa7a9ad4bd5f2da435094332e2759e" ascii
      $s17 = "WORDLIST" fullword ascii /* Goodware String - occured 5 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 29 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 41 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c8 10 00 00 00 00 00 00 c8 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 89 0c 00 00 00 00 00 00 89 0c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 90 05 00 00 00 00 00 00 90 05 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 3b 00 00 00 00 00 00 b0 4b 00 00 00 00 00 00 b0 4b 00 00 00 00 00 00 60 04 00 00 00 00 00 00 e0 04 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a0 3c 00 00 00 00 00 00 a0 4c 00 00 00 00 00 00 a0 4c 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 8c 33 00 00 00 00 00 00 8c 33 00 00 00 00 00 00 8c 33 00 00 00 00 00 00 54 00 00 00 00 00 00 00 54 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 3b 00 00 00 00 00 00 b0 4b 00 00 00 00 00 00 b0 4b 00 00 00 00 00 00 50 04 00 00 00 00 00 00 50 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 77 07 79 1c 2a aa 7a 9a d4 bd 5f 2d a4 35 09 43 32 e2 75 9e 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 60KB and
      8 of them and $magic
}

rule gtfobins_binaries_su {
   strings:
      $x1 = "options --{shell,fast,command,session-command,login} and --user are mutually exclusive" fullword ascii
      $s2 = "starting shell [shell=%s, command=\"%s\"%s%s]" fullword ascii
      $s3 = " --session-command <command>     pass a single command to the shell with -c" fullword ascii
      $s4 = "Run <command> with the effective user ID and group ID of <user>.  If -u is" fullword ascii
      $s5 = " -c, --command <command>         pass a single command to the shell with -c" fullword ascii
      $s6 = " %1$s [options] -u <user> [[--] <command>]" fullword ascii
      $s7 = "not given, fall back to su(1)-compatible semantics and execute standard shell." fullword ascii
      $s8 = "session-command" fullword ascii
      $s9 = "ignoring --preserve-environment, it's mutually exclusive with --login" fullword ascii
      $s10 = " -, -l, --login                  make the shell a login shell" fullword ascii
      $s11 = "hush login status: restore original IDs failed" fullword ascii
      $s12 = "login-utils/su-common.c" fullword ascii
      $s13 = "A mere - implies -l.  If <user> is not given, root is assumed." fullword ascii
      $s14 = " -f, --fast                      pass -f to the shell (for csh or tcsh)" fullword ascii
      $s15 = "loading logindefs" fullword ascii
      $s16 = " stdin --> master %zd bytes queued" fullword ascii
      $s17 = " stdin --> master trying %zu bytes" fullword ascii
      $s18 = "%s is restricted shell (not in /etc/shells)" fullword ascii
      $s19 = "/etc/hushlogins" fullword ascii
      $s20 = "HUSHLOGIN_FILE" fullword ascii
      $s21 = "/etc/login.defs" fullword ascii
      $s22 = " child got SIGSTOP -- stop all session" fullword ascii
      $s23 = "failed to establish user credentials: %s" fullword ascii
      $s24 = "may not be used by non-root users" fullword ascii
      $s25 = " session resumed -- continue" fullword ascii
      $s26 = " login" fullword ascii
      $s27 = "no command was specified" fullword ascii
      $s28 = "btmp logging" fullword ascii
      $s29 = "getttynam" fullword ascii
      $s30 = "xgetgrnam" fullword ascii
      $s31 = "xgetpwnam" fullword ascii
      $s32 = "xgetpwuid" fullword ascii
      $s33 = " master --> stdout %zd bytes" fullword ascii
      $s34 = "cannot create child process" fullword ascii
      $s35 = "FAILED RUNUSER " fullword ascii
      $s36 = "The options -c, -f, -l, and -s are mutually exclusive with -u." fullword ascii
      $s37 = "syslog logging" fullword ascii
      $s38 = "failed to set the %s environment variable" fullword ascii
      $s39 = "Session terminated, killing shell..." fullword ascii
      $s40 = "runuser-l" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 f0 40 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 31 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 58 2b 00 00 00 00 00 00 58 2b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 a9 a7 00 00 00 00 00 00 a9 a7 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 d0 3a 00 00 00 00 00 00 d0 3a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 27 01 00 00 00 00 00 50 27 01 00 00 00 00 00 50 27 01 00 00 00 00 00 c4 08 00 00 00 00 00 00 48 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 40 29 01 00 00 00 00 00 40 29 01 00 00 00 00 00 40 29 01 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 80 fb 00 00 00 00 00 00 80 fb 00 00 00 00 00 00 80 fb 00 00 00 00 00 00 bc 04 00 00 00 00 00 00 bc 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 27 01 00 00 00 00 00 50 27 01 00 00 00 00 00 50 27 01 00 00 00 00 00 b0 08 00 00 00 00 00 00 b0 08 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 65 47 d3 99 5c cb 57 1e 13 ea 4f 18 d9 7a 50 48 0f 44 fd c6 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 200KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_nohup {
   strings:
      $s1 = "  125  if the %s command itself fails" fullword ascii
      $s2 = "To save output to FILE, use '%s COMMAND > FILE'." fullword ascii
      $s3 = "  -    the exit status of COMMAND otherwise" fullword ascii
      $s4 = "  126  if COMMAND is found but cannot be invoked" fullword ascii
      $s5 = "  127  if COMMAND cannot be found" fullword ascii
      $s6 = "'$HOME/nohup.out' otherwise." fullword ascii
      $s7 = "If standard input is a terminal, redirect it from an unreadable file." fullword ascii
      $s8 = "If standard output is a terminal, append output to 'nohup.out' if possible," fullword ascii
      $s9 = "ignoring input and appending output to %s" fullword ascii /* Goodware String - occured 1 times */
      $s10 = "ignoring input" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "ignoring input and redirecting stderr to stdout" fullword ascii /* Goodware String - occured 1 times */
      $s12 = "redirecting stderr to stdout" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "failed to render standard input unusable" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "  or:  %s OPTION" fullword ascii
      $s15 = "If standard error is a terminal, redirect it to standard output." fullword ascii /* Goodware String - occured 1 times */
      $s16 = "Usage: %s COMMAND [ARG]..." fullword ascii /* Goodware String - occured 2 times */
      $s17 = "Run COMMAND, ignoring hangup signals." fullword ascii /* Goodware String - occured 2 times */
      $s18 = "nohup.out" fullword ascii /* Goodware String - occured 2 times */
      $s19 = "failed to redirect standard error" fullword ascii /* Goodware String - occured 2 times */
      $s20 = "appending output to %s" fullword ascii /* Goodware String - occured 2 times */
      $s21 = "failed to run command %s" fullword ascii /* Goodware String - occured 3 times */
      $s22 = "Exit status:" fullword ascii /* Goodware String - occured 3 times */
      $s23 = "02c7aca804d8fea4011c1c88328e89cf2f2e11.debug" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 29 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d0 a3 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c8 15 00 00 00 00 00 00 c8 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 e9 4b 00 00 00 00 00 00 e9 4b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 28 21 00 00 00 00 00 00 28 21 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 9d 00 00 00 00 00 00 10 ad 00 00 00 00 00 00 10 ad 00 00 00 00 00 00 10 05 00 00 00 00 00 00 d0 06 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 9d 00 00 00 00 00 00 d8 ad 00 00 00 00 00 00 d8 ad 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 50 7e 00 00 00 00 00 00 50 7e 00 00 00 00 00 00 50 7e 00 00 00 00 00 00 3c 03 00 00 00 00 00 00 3c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 9d 00 00 00 00 00 00 10 ad 00 00 00 00 00 00 10 ad 00 00 00 00 00 00 f0 02 00 00 00 00 00 00 f0 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 e3 02 c7 ac a8 04 d8 fe a4 01 1c 1c 88 32 8e 89 cf 2f 2e 11 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 39 00 00 00 01 00 00 00 06 00 00 00 06 c9 c1 00 20 01 18 12 39 00 00 00 3b 00 00 00 41 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 c0 b3 f7 12 39 f2 8b 1c 33 c4 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_nice {
   strings:
      $s1 = "  125  if the %s command itself fails" fullword ascii
      $s2 = "%d (most favorable to the process) to %d (least favorable to the process)." fullword ascii
      $s3 = "  -    the exit status of COMMAND otherwise" fullword ascii
      $s4 = "  126  if COMMAND is found but cannot be invoked" fullword ascii
      $s5 = "With no COMMAND, print the current niceness.  Niceness values range from" fullword ascii
      $s6 = "  127  if COMMAND cannot be found" fullword ascii
      $s7 = "9f08887f4a62a61f4172374fe27ee13df54030.debug" fullword ascii
      $s8 = "Run COMMAND with an adjusted niceness, which affects process scheduling." fullword ascii /* Goodware String - occured 2 times */
      $s9 = "Usage: %s [OPTION] [COMMAND [ARG]...]" fullword ascii /* Goodware String - occured 2 times */
      $s10 = "invalid adjustment %s" fullword ascii /* Goodware String - occured 2 times */
      $s11 = "  -n, --adjustment=N   add integer N to the niceness (default 10)" fullword ascii
      $s12 = "a command must be given with an adjustment" fullword ascii /* Goodware String - occured 2 times */
      $s13 = "cannot get niceness" fullword ascii /* Goodware String - occured 2 times */
      $s14 = "cannot set niceness" fullword ascii /* Goodware String - occured 2 times */
      $s15 = "Exit status:" fullword ascii /* Goodware String - occured 3 times */
      $s16 = "xstrtol" fullword ascii /* Goodware String - occured 4 times */
      $s17 = "9f08887f4a62a61f4172374fe27ee13df54030" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 27 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b0 a3 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 18 15 00 00 00 00 00 00 18 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 c9 48 00 00 00 00 00 00 c9 48 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 08 20 00 00 00 00 00 00 08 20 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 9c 00 00 00 00 00 00 f0 ac 00 00 00 00 00 00 f0 ac 00 00 00 00 00 00 10 05 00 00 00 00 00 00 d0 06 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 9d 00 00 00 00 00 00 d8 ad 00 00 00 00 00 00 d8 ad 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 b0 7e 00 00 00 00 00 00 b0 7e 00 00 00 00 00 00 b0 7e 00 00 00 00 00 00 0c 03 00 00 00 00 00 00 0c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 9c 00 00 00 00 00 00 f0 ac 00 00 00 00 00 00 f0 ac 00 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 61 9f 08 88 7f 4a 62 a6 1f 41 72 37 4f e2 7e e1 3d f5 40 30 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 35 00 00 00 01 00 00 00 06 00 00 00 04 4d c1 00 20 01 1c 12 35 00 00 00 37 00 00 00 3c 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_chroot {
   strings:
      $s1 = "If no command is given, run '\"$SHELL\" -i' (default: '/bin/sh -i')." fullword ascii
      $s2 = "  125  if the %s command itself fails" fullword ascii
      $s3 = "  -    the exit status of COMMAND otherwise" fullword ascii
      $s4 = "failed to get supplemental groups" fullword ascii
      $s5 = "  126  if COMMAND is found but cannot be invoked" fullword ascii
      $s6 = "      --userspec=USER:GROUP  specify user and group (ID or name) to use" fullword ascii
      $s7 = "option --skip-chdir only permitted if NEWROOT is old %s" fullword ascii
      $s8 = "failed to set supplemental groups" fullword ascii
      $s9 = "  127  if COMMAND cannot be found" fullword ascii
      $s10 = "  or:  %s OPTION" fullword ascii
      $s11 = "skip-chdir" fullword ascii
      $s12 = "Usage: %s [OPTION] NEWROOT [COMMAND [ARG]...]" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "failed to set user-ID" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "warning: '.' should be ':'" fullword ascii
      $s15 = "no group specified for unknown uid: %d" fullword ascii
      $s16 = "failed to set group-ID" fullword ascii /* Goodware String - occured 1 times */
      $s17 = "invalid group list %s" fullword ascii /* Goodware String - occured 1 times */
      $s18 = "cannot change root directory to %s" fullword ascii /* Goodware String - occured 2 times */
      $s19 = "      --skip-chdir           do not change working directory to %s" fullword ascii
      $s20 = "invalid spec" fullword ascii /* Goodware String - occured 2 times */
      $s21 = "Roland McGrath" fullword ascii /* Goodware String - occured 2 times */
      $s22 = "Run COMMAND with root directory set to NEWROOT." fullword ascii /* Goodware String - occured 2 times */
      $s23 = "cannot chdir to root directory" fullword ascii /* Goodware String - occured 2 times */
      $s24 = "failed to run command %s" fullword ascii /* Goodware String - occured 3 times */
      $s25 = "Exit status:" fullword ascii /* Goodware String - occured 3 times */
      $s26 = "userspec" fullword ascii /* Goodware String - occured 3 times */
      $s27 = "invalid group" fullword ascii /* Goodware String - occured 4 times */
      $s28 = "invalid user" fullword ascii /* Goodware String - occured 4 times */
      $s29 = "D$@L9d$8" fullword ascii
      $s30 = "getgrouplist" fullword ascii /* Goodware String - occured 4 times */
      $s31 = "invalid group %s" fullword ascii /* Goodware String - occured 4 times */
      $s32 = "61bc3e74678d326fdc97541c895caf64cb9789.debug" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 2b 00 00 00 00 00 00 40 00 00 00 00 00 00 00 30 b4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c0 18 00 00 00 00 00 00 c0 18 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 a9 5b 00 00 00 00 00 00 a9 5b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 e8 23 00 00 00 00 00 00 e8 23 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 ac 00 00 00 00 00 00 b0 bc 00 00 00 00 00 00 b0 bc 00 00 00 00 00 00 d0 05 00 00 00 00 00 00 90 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ad 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 3c 90 00 00 00 00 00 00 3c 90 00 00 00 00 00 00 3c 90 00 00 00 00 00 00 44 03 00 00 00 00 00 00 44 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 ac 00 00 00 00 00 00 b0 bc 00 00 00 00 00 00 b0 bc 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 fa 61 bc 3e 74 67 8d 32 6f dc 97 54 1c 89 5c af 64 cb 97 89 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 44 00 00 00 01 00 00 00 06 00 00 00 04 4d c1 00 20 01 1c 12 44 00 00 00 46 00 00 00 4b 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_stdbuf {
   strings:
      $s1 = "Run COMMAND, with modified buffering operations for its standard streams." fullword ascii
      $s2 = "  125  if the %s command itself fails" fullword ascii
      $s3 = "  -    the exit status of COMMAND otherwise" fullword ascii
      $s4 = "Usage: %s OPTION... COMMAND" fullword ascii
      $s5 = "  126  if COMMAND is found but cannot be invoked" fullword ascii
      $s6 = "/usr/libexec/coreutils" fullword ascii
      $s7 = "NOTE: If COMMAND adjusts the buffering of its standard streams ('tee' does" fullword ascii
      $s8 = "for example) then that will override corresponding changes by 'stdbuf'." fullword ascii
      $s9 = "line buffering stdin is meaningless" fullword ascii
      $s10 = "  127  if COMMAND cannot be found" fullword ascii
      $s11 = "  -o, --output=MODE  adjust standard output stream buffering" fullword ascii
      $s12 = "failed to find %s" fullword ascii
      $s13 = "failed to update the environment with %s" fullword ascii
      $s14 = "0 <= opt_fileno && opt_fileno < (sizeof (stdbuf) / sizeof *(stdbuf))" fullword ascii
      $s15 = "%s=%s:%s" fullword ascii
      $s16 = "  -e, --error=MODE   adjust standard error stream buffering" fullword ascii
      $s17 = "you must specify a buffering mode option" fullword ascii
      $s18 = "stdbuf" fullword ascii
      $s19 = "%s%c=L" fullword ascii
      $s20 = "%s%c=%lu" fullword ascii
      $s21 = "EGkKMPQRTYZ0" fullword ascii
      $s22 = "This option is invalid with standard input." fullword ascii
      $s23 = "src/stdbuf.c" fullword ascii
      $s24 = "and are thus unaffected by 'stdbuf' settings." fullword ascii
      $s25 = "If MODE is 'L' the corresponding stream will be line buffered." fullword ascii
      $s26 = "libstdbuf.so" fullword ascii
      $s27 = "/usr/lib/x86_64-linux-gnu/coreutils" fullword ascii
      $s28 = "e639dc87263b1e4ba211ccc9f367c7808278f9.debug" fullword ascii
      $s29 = "size set to MODE bytes." fullword ascii
      $s30 = "Otherwise MODE is a number which may be followed by one of the following:" fullword ascii
      $s31 = "If MODE is '0' the corresponding stream will be unbuffered." fullword ascii
      $s32 = "_STDBUF_" fullword ascii
      $s33 = "Binary prefixes can be used, too: KiB=K, MiB=M, and so on." fullword ascii
      $s34 = "  -i, --input=MODE   adjust standard input stream buffering" fullword ascii
      $s35 = "failed to run command %s" fullword ascii /* Goodware String - occured 3 times */
      $s36 = "Exit status:" fullword ascii /* Goodware String - occured 3 times */
      $s37 = "Padraig Brady" fullword ascii /* Goodware String - occured 3 times */
      $s38 = "draig Brady" fullword ascii /* Goodware String - occured 3 times */
      $s39 = "D$HtRH" fullword ascii
      $s40 = "e639dc87263b1e4ba211ccc9f367c7808278f9" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 f0 2a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f0 d3 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 17 00 00 00 00 00 00 80 17 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 c9 7a 00 00 00 00 00 00 c9 7a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 60 2b 00 00 00 00 00 00 60 2b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 cc 00 00 00 00 00 00 90 dc 00 00 00 00 00 00 90 dc 00 00 00 00 00 00 b0 05 00 00 00 00 00 00 d0 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 cd 00 00 00 00 00 00 e0 dd 00 00 00 00 00 00 e0 dd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c0 b6 00 00 00 00 00 00 c0 b6 00 00 00 00 00 00 c0 b6 00 00 00 00 00 00 94 03 00 00 00 00 00 00 94 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 cc 00 00 00 00 00 00 90 dc 00 00 00 00 00 00 90 dc 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 fe e6 39 dc 87 26 3b 1e 4b a2 11 cc c9 f3 67 c7 80 82 78 f9 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 3d 00 00 00 01 00 00 00 06 00 00 00 04 4d c1 00 20 01 1c 12 3d 00 00 00 3f 00 00 00 44 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_timeout {
   strings:
      $s1 = "the monitored command dumped core" fullword ascii
      $s2 = "warning: disabling core dumps failed" fullword ascii
      $s3 = "  124  if COMMAND times out, and --preserve-status is not specified" fullword ascii
      $s4 = "  -    the exit status of COMMAND otherwise" fullword ascii
      $s5 = "  125  if the timeout command itself fails" fullword ascii
      $s6 = "unknown status from command (%d)" fullword ascii
      $s7 = "sending signal %s to command %s" fullword ascii
      $s8 = "  126  if COMMAND is found but cannot be invoked" fullword ascii
      $s9 = "Upon timeout, send the TERM signal to COMMAND, if no other SIGNAL specified." fullword ascii
      $s10 = "  137  if COMMAND (or timeout itself) is sent the KILL (9) signal (128+9)" fullword ascii
      $s11 = "The TERM signal kills any process that does not block or catch that signal." fullword ascii
      $s12 = "                   allow COMMAND to read from the TTY and get TTY signals;" fullword ascii
      $s13 = "                 also send a KILL signal if COMMAND is still running" fullword ascii
      $s14 = "                   command times out" fullword ascii
      $s15 = "  127  if COMMAND cannot be found" fullword ascii
      $s16 = "  -s, --signal=SIGNAL" fullword ascii
      $s17 = "  -k, --kill-after=DURATION" fullword ascii
      $s18 = "  -v, --verbose  diagnose to stderr any signal sent upon timeout" fullword ascii
      $s19 = "  or:  %s [OPTION]" fullword ascii
      $s20 = "                 when not running timeout directly from a shell prompt," fullword ascii
      $s21 = "                 exit with the same status as COMMAND, even when the" fullword ascii
      $s22 = "                   in this mode, children of COMMAND will not be timed out" fullword ascii
      $s23 = "strtod_l" fullword ascii
      $s24 = "616e4c389743d2871de7ab8077d006e46ab268.debug" fullword ascii
      $s25 = "warning: sigprocmask" fullword ascii
      $s26 = "warning: timer_create" fullword ascii /* Goodware String - occured 1 times */
      $s27 = "preserve-status" fullword ascii
      $s28 = "Start COMMAND, and kill it if still running after DURATION." fullword ascii /* Goodware String - occured 1 times */
      $s29 = "'s' for seconds (the default), 'm' for minutes, 'h' for hours or 'd' for days." fullword ascii
      $s30 = "warning: timer_settime" fullword ascii /* Goodware String - occured 1 times */
      $s31 = "A duration of 0 disables the associated timeout." fullword ascii
      $s32 = "error waiting for command" fullword ascii /* Goodware String - occured 1 times */
      $s33 = "kill-after" fullword ascii /* Goodware String - occured 1 times */
      $s34 = "Usage: %s [OPTION] DURATION COMMAND [ARG]..." fullword ascii /* Goodware String - occured 1 times */
      $s35 = "DURATION is a floating point number with an optional suffix:" fullword ascii /* Goodware String - occured 1 times */
      $s36 = "      --preserve-status" fullword ascii
      $s37 = "                   see 'kill -l' for a list of signals" fullword ascii
      $s38 = "      --foreground" fullword ascii
      $s39 = "failed to run command %s" fullword ascii /* Goodware String - occured 3 times */
      $s40 = "Exit status:" fullword ascii /* Goodware String - occured 3 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 2b 00 00 00 00 00 00 40 00 00 00 00 00 00 00 38 b6 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 68 1a 00 00 00 00 00 00 68 1a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 99 52 00 00 00 00 00 00 99 52 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 e8 26 00 00 00 00 00 00 e8 26 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 ac 00 00 00 00 00 00 70 bc 00 00 00 00 00 00 70 bc 00 00 00 00 00 00 14 08 00 00 00 00 00 00 18 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ad 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 50 93 00 00 00 00 00 00 50 93 00 00 00 00 00 00 50 93 00 00 00 00 00 00 5c 03 00 00 00 00 00 00 5c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 ac 00 00 00 00 00 00 70 bc 00 00 00 00 00 00 70 bc 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 c2 61 6e 4c 38 97 43 d2 87 1d e7 ab 80 77 d0 06 e4 6a b2 68 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 4a 00 00 00 01 00 00 00 06 00 00 00 04 4d c1 00 20 01 1c 12 4a 00 00 00 4c 00 00 00 51 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_env {
   strings:
      $s1 = "failed to get signal process mask" fullword ascii
      $s2 = "failed to set signal process mask" fullword ascii
      $s3 = "  -S, --split-string=S  process and split S into separate arguments;" fullword ascii
      $s4 = "  125  if the %s command itself fails" fullword ascii
      $s5 = "must specify command with --chdir (-C)" fullword ascii
      $s6 = "  -    the exit status of COMMAND otherwise" fullword ascii
      $s7 = "  -v, --debug          print verbose information for each processing step" fullword ascii
      $s8 = "  126  if COMMAND is found but cannot be invoked" fullword ascii
      $s9 = "failed to get signal action for signal %d" fullword ascii
      $s10 = "invalid option -- '%c'" fullword ascii
      $s11 = "executing: %s" fullword ascii
      $s12 = "Reset signal %s (%d) to %s%s" fullword ascii
      $s13 = "      --block-signal[=SIG]    block delivery of SIG signal(s) to COMMAND" fullword ascii
      $s14 = "use -[v]S to pass options in shebang lines" fullword ascii
      $s15 = "only ${VARNAME} expansion is supported, error at: %s" fullword ascii
      $s16 = "SIG may be a signal name like 'PIPE', or a signal number like '13'." fullword ascii
      $s17 = "  127  if COMMAND cannot be found" fullword ascii
      $s18 = "%-10s (%2d): %s%s%s" fullword ascii
      $s19 = "invalid backslash at end of string in -S" fullword ascii
      $s20 = "invalid sequence '\\%c' in -S" fullword ascii
      $s21 = "no terminating quote in -S string" fullword ascii
      $s22 = "'\\c' must not appear in double-quoted -S string" fullword ascii
      $s23 = "split -S:  %s" fullword ascii
      $s24 = "  -i, --ignore-environment  start with an empty environment" fullword ascii
      $s25 = "replacing ${%s} with null string" fullword ascii
      $s26 = "signal %s (%d) mask set to %s" fullword ascii
      $s27 = "expanding ${%s} into %s" fullword ascii
      $s28 = "failed to set signal action for signal %d" fullword ascii
      $s29 = " (failure ignored)" fullword ascii
      $s30 = "comma-separated.  An empty SIG argument is a no-op." fullword ascii
      $s31 = "cleaning environ" fullword ascii
      $s32 = "UNBLOCK" fullword ascii /* Goodware String - occured 1 times */
      $s33 = "Assaf Gordon" fullword ascii
      $s34 = "split-string" fullword ascii
      $s35 = "cannot change directory to %s" fullword ascii /* Goodware String - occured 1 times */
      $s36 = "cannot unset %s" fullword ascii /* Goodware String - occured 1 times */
      $s37 = "default-signal" fullword ascii
      $s38 = "cannot set %s" fullword ascii /* Goodware String - occured 1 times */
      $s39 = "list-signal-handling" fullword ascii
      $s40 = "31b42ed203277658fd829c4632180b3f490ab9.debug" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 50 35 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 b5 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 1a 00 00 00 00 00 00 10 1a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 b9 5b 00 00 00 00 00 00 b9 5b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 b0 2a 00 00 00 00 00 00 b0 2a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 ab 00 00 00 00 00 00 d0 bb 00 00 00 00 00 00 d0 bb 00 00 00 00 00 00 54 08 00 00 00 00 00 00 b0 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ad 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 10 97 00 00 00 00 00 00 10 97 00 00 00 00 00 00 10 97 00 00 00 00 00 00 44 03 00 00 00 00 00 00 44 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 ab 00 00 00 00 00 00 d0 bb 00 00 00 00 00 00 d0 bb 00 00 00 00 00 00 30 04 00 00 00 00 00 00 30 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 0d 31 b4 2e d2 03 27 76 58 fd 82 9c 46 32 18 0b 3f 49 0a b9 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 45 00 00 00 01 00 00 00 06 00 00 00 14 4d c1 00 e0 01 5c 12 45 00 00 00 48 00 00 00 4e 00 00 00 28 1d 8c 1c a6 dd a3 6b d1 65 ce 6d bc 50 76 9e 96 a0 89 97 ce 2c 63 72 c4 b9 9c 40 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_dd {
   strings:
      $s1 = "Sending a %s signal to a running 'dd' process makes it" fullword ascii
      $s2 = "%ld bytes (%s) copied, %s, %s" fullword ascii
      $s3 = "%ld bytes (%s, %s) copied, %s, %s" fullword ascii
      $s4 = "%ld bytes copied, %s, %s" fullword ascii
      $s5 = "%ld byte copied, %s, %s" fullword ascii
      $s6 = "  directory  fail unless a directory" fullword ascii
      $s7 = "memory exhausted by output buffer of size %td bytes (%s)" fullword ascii
      $s8 = "  excl      fail if the output file already exists" fullword ascii
      $s9 = "warning: partial read (%td byte); suggest iflag=fullblock" fullword ascii
      $s10 = "6cb485ffb20f4fecb9565eb3d1734fb88dcbe9.debug" fullword ascii
      $s11 = "warning: partial read (%td bytes); suggest iflag=fullblock" fullword ascii
      $s12 = "memory exhausted by input buffer of size %td bytes (%s)" fullword ascii
      $s13 = "warning: %s is a zero multiplier; use %s if that is intended" fullword ascii
      $s14 = "  noerror   continue after read errors" fullword ascii
      $s15 = "KMGTPEZYRQ" fullword ascii
      $s16 = "invalid status level" fullword ascii
      $s17 = "failed to truncate to %ld bytes in output file %s" fullword ascii
      $s18 = "  nofollow  do not follow symlinks" fullword ascii
      $s19 = "                  overrides ibs and obs" fullword ascii
      $s20 = "  iflag=FLAGS     read as per the comma separated symbol list" fullword ascii
      $s21 = "bcEGkKMPQRTwYZ0" fullword ascii
      $s22 = "  or:  %s OPTION" fullword ascii
      $s23 = "aligned_alloc" fullword ascii
      $s24 = "%ld+%ld records out" fullword ascii
      $s25 = "%ld+%ld records in" fullword ascii
      $s26 = "seek_bytes" fullword ascii
      $s27 = "fullblock" fullword ascii /* Goodware String - occured 1 times */
      $s28 = "skip_bytes" fullword ascii
      $s29 = "count_bytes" fullword ascii
      $s30 = "invalid output flag" fullword ascii /* Goodware String - occured 1 times */
      $s31 = "nolinks" fullword ascii /* Goodware String - occured 1 times */
      $s32 = "failed to turn off O_DIRECT: %s" fullword ascii /* Goodware String - occured 1 times */
      $s33 = "closing input file %s" fullword ascii /* Goodware String - occured 1 times */
      $s34 = "  fullblock  accumulate full blocks of input (iflag only)" fullword ascii
      $s35 = "  nonblock  use non-blocking I/O" fullword ascii
      $s36 = "%s: cannot skip to specified offset" fullword ascii /* Goodware String - occured 1 times */
      $s37 = "failed to discard cache for: %s" fullword ascii /* Goodware String - occured 1 times */
      $s38 = "warning: invalid file offset after failed read" fullword ascii /* Goodware String - occured 1 times */
      $s39 = "invalid conversion" fullword ascii /* Goodware String - occured 1 times */
      $s40 = "cannot combine direct and nocache" fullword ascii /* Goodware String - occured 1 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 50 41 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f8 44 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 48 1c 00 00 00 00 00 00 48 1c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 19 c6 00 00 00 00 00 00 19 c6 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 d8 47 00 00 00 00 00 00 d8 47 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 3c 01 00 00 00 00 00 f0 4c 01 00 00 00 00 00 f0 4c 01 00 00 00 00 00 58 06 00 00 00 00 00 00 f0 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 3d 01 00 00 00 00 00 d8 4d 01 00 00 00 00 00 d8 4d 01 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c0 18 01 00 00 00 00 00 c0 18 01 00 00 00 00 00 c0 18 01 00 00 00 00 00 bc 04 00 00 00 00 00 00 bc 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 3c 01 00 00 00 00 00 f0 4c 01 00 00 00 00 00 f0 4c 01 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 db 6c b4 85 ff b2 0f 4f ec b9 56 5e b3 d1 73 4f b8 8d cb e9 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 52 00 00 00 01 00 00 00 06 00 00 00 06 c9 c1 00 20 01 18 12 52 00 00 00 54 00 00 00 5a 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 c0 b3 f7 12 39 f2 8b 1c 33 c4 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_base64 {
   strings:
      $s1 = "The data are encoded as described for the %s alphabet in RFC 4648." fullword ascii
      $s2 = "the formal %s alphabet.  Use --ignore-garbage to attempt to recover" fullword ascii
      $s3 = "  -w, --wrap=COLS       wrap encoded lines after COLS character (default 76)." fullword ascii
      $s4 = "  -i, --ignore-garbage  when decoding, ignore non-alphabet characters" fullword ascii
      $s5 = "425e2ceabc79d9ce0f6d36620c0e1565665672.debug" fullword ascii
      $s6 = "Base%d encode or decode FILE, or standard input, to standard output." fullword ascii
      $s7 = "invalid wrap size" fullword ascii
      $s8 = "VUUUUUUUAV1" fullword ascii
      $s9 = "  -d, --decode          decode data" fullword ascii
      $s10 = "When decoding, the input may contain newlines in addition to the bytes of" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "ignore-garbage" fullword ascii /* Goodware String - occured 1 times */
      $s12 = "425e2ceabc79d9ce0f6d36620c0e1565665672" ascii
      $s13 = "from any other non-alphabet bytes in the encoded stream." fullword ascii /* Goodware String - occured 1 times */
      $s14 = "Simon Josefsson" fullword ascii /* Goodware String - occured 1 times */
      $s15 = "closing standard input" fullword ascii /* Goodware String - occured 3 times */
      $s16 = "E(I;E0sSH" fullword ascii
      $s17 = "E(I;E0s@H" fullword ascii
      $s18 = "invalid input" fullword ascii /* Goodware String - occured 5 times */
      $s19 = "Usage: %s [OPTION]... [FILE]" fullword ascii /* Goodware String - occured 5 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 2a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 b4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 18 00 00 00 00 00 00 20 18 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 b9 56 00 00 00 00 00 00 b9 56 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 c0 23 00 00 00 00 00 00 c0 23 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 ac 00 00 00 00 00 00 b0 bc 00 00 00 00 00 00 b0 bc 00 00 00 00 00 00 b0 05 00 00 00 00 00 00 70 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ad 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 34 90 00 00 00 00 00 00 34 90 00 00 00 00 00 00 34 90 00 00 00 00 00 00 6c 03 00 00 00 00 00 00 6c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 ac 00 00 00 00 00 00 b0 bc 00 00 00 00 00 00 b0 bc 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 7e 42 5e 2c ea bc 79 d9 ce 0f 6d 36 62 0c 0e 15 65 66 56 72 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 40 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 40 00 00 00 42 00 00 00 48 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_basenc {
   strings:
      $s1 = "  -w, --wrap=COLS       wrap encoded lines after COLS character (default 76)." fullword ascii
      $s2 = "the formal alphabet.  Use --ignore-garbage to attempt to recover" fullword ascii
      $s3 = "  -i, --ignore-garbage  when decoding, ignore non-alphabet characters" fullword ascii
      $s4 = "      --base64url       file- and url-safe base64 (RFC4648 section 5)" fullword ascii
      $s5 = "invalid wrap size" fullword ascii
      $s6 = "basenc encode or decode FILE, or standard input, to standard output." fullword ascii
      $s7 = "missing encoding type" fullword ascii
      $s8 = "VUUUUUUUAV1" fullword ascii
      $s9 = "  -d, --decode          decode data" fullword ascii
      $s10 = "gfffffffAV1" fullword ascii
      $s11 = "basenc" fullword ascii
      $s12 = "When decoding, the input may contain newlines in addition to the bytes of" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "ignore-garbage" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "from any other non-alphabet bytes in the encoded stream." fullword ascii /* Goodware String - occured 1 times */
      $s15 = "Simon Josefsson" fullword ascii /* Goodware String - occured 1 times */
      $s16 = "Assaf Gordon" fullword ascii
      $s17 = "1ddd7b65efe33df9c2932ee9b66ef59140ed20.debug" fullword ascii
      $s18 = "invalid input (length must be multiple of 4 characters)" fullword ascii
      $s19 = "base2lsbf" fullword ascii
      $s20 = "base64url" fullword ascii
      $s21 = "base32hex_encode" fullword ascii
      $s22 = "ABCDEFGHIJ:;<=>?@KLMNOPQRSTUVWXYZ234567" fullword ascii
      $s23 = "base2msbf" fullword ascii
      $s24 = "QRSTUV89:;<=>?@0123456789ABCDEFGHIJKLMNOP" fullword ascii
      $s25 = "0x32 <= *p && *p <= 0x5a" fullword ascii
      $s26 = "src/basenc.c" fullword ascii
      $s27 = "base32hex" fullword ascii
      $s28 = "      --base16          hex encoding (RFC4648 section 8)" fullword ascii
      $s29 = "      --z85             ascii85-like encoding (ZeroMQ spec:32/Z85);" fullword ascii
      $s30 = "      --base64          same as 'base64' program (RFC4648 section 4)" fullword ascii
      $s31 = "      --base32hex       extended hex alphabet base32 (RFC4648 section 7)" fullword ascii
      $s32 = "      --base32          same as 'base32' program (RFC4648 section 6)" fullword ascii
      $s33 = "closing standard input" fullword ascii /* Goodware String - occured 3 times */
      $s34 = "base16" fullword ascii
      $s35 = "base32" fullword ascii
      $s36 = "+t;<-u" fullword ascii
      $s37 = ".-:+=^!/*?&<>()[]{}@%$#" fullword ascii
      $s38 = "1ddd7b65efe33df9c2932ee9b66ef59140ed20" ascii
      $s39 = "G(I;G0sUH" fullword ascii
      $s40 = "a```````" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 c0 2c 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 d4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e0 18 00 00 00 00 00 00 e0 18 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 d9 6c 00 00 00 00 00 00 d9 6c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 08 30 00 00 00 00 00 00 08 30 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 cb 00 00 00 00 00 00 b0 db 00 00 00 00 00 00 b0 db 00 00 00 00 00 00 b0 06 00 00 00 00 00 00 90 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 cd 00 00 00 00 00 00 d8 dd 00 00 00 00 00 00 d8 dd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 54 a6 00 00 00 00 00 00 54 a6 00 00 00 00 00 00 54 a6 00 00 00 00 00 00 9c 04 00 00 00 00 00 00 9c 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 cb 00 00 00 00 00 00 b0 db 00 00 00 00 00 00 b0 db 00 00 00 00 00 00 50 04 00 00 00 00 00 00 50 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 e3 1d dd 7b 65 ef e3 3d f9 c2 93 2e e9 b6 6e f5 91 40 ed 20 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 40 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 40 00 00 00 42 00 00 00 48 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_base32 {
   strings:
      $s1 = "The data are encoded as described for the %s alphabet in RFC 4648." fullword ascii
      $s2 = "the formal %s alphabet.  Use --ignore-garbage to attempt to recover" fullword ascii
      $s3 = "  -w, --wrap=COLS       wrap encoded lines after COLS character (default 76)." fullword ascii
      $s4 = "  -i, --ignore-garbage  when decoding, ignore non-alphabet characters" fullword ascii
      $s5 = "Base%d encode or decode FILE, or standard input, to standard output." fullword ascii
      $s6 = "invalid wrap size" fullword ascii
      $s7 = "  -d, --decode          decode data" fullword ascii
      $s8 = "gfffffffAV1" fullword ascii
      $s9 = "When decoding, the input may contain newlines in addition to the bytes of" fullword ascii /* Goodware String - occured 1 times */
      $s10 = "ignore-garbage" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "from any other non-alphabet bytes in the encoded stream." fullword ascii /* Goodware String - occured 1 times */
      $s12 = "Simon Josefsson" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "7e3651d411530059c960c49fd9c55f6b665cbf.debug" fullword ascii
      $s14 = "closing standard input" fullword ascii /* Goodware String - occured 3 times */
      $s15 = "base32" fullword ascii
      $s16 = "E(I;E0sSH" fullword ascii
      $s17 = "E(I;E0s@H" fullword ascii
      $s18 = "7e3651d41153" ascii
      $s19 = "7e3651d411530059c960c49fd9c55f6b665cbf" ascii
      $s20 = "59c960c49fd9c55f6b665cbf" ascii
      $s21 = "invalid input" fullword ascii /* Goodware String - occured 5 times */
      $s22 = "Usage: %s [OPTION]... [FILE]" fullword ascii /* Goodware String - occured 5 times */
      $s23 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ234567" fullword ascii /* Goodware String - occured 5 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 2a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 b4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 18 00 00 00 00 00 00 20 18 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 f9 57 00 00 00 00 00 00 f9 57 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 c8 23 00 00 00 00 00 00 c8 23 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 ac 00 00 00 00 00 00 b0 bc 00 00 00 00 00 00 b0 bc 00 00 00 00 00 00 b0 05 00 00 00 00 00 00 70 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ad 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 14 90 00 00 00 00 00 00 14 90 00 00 00 00 00 00 14 90 00 00 00 00 00 00 6c 03 00 00 00 00 00 00 6c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 ac 00 00 00 00 00 00 b0 bc 00 00 00 00 00 00 b0 bc 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 8a 7e 36 51 d4 11 53 00 59 c9 60 c4 9f d9 c5 5f 6b 66 5c bf 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 40 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 40 00 00 00 42 00 00 00 48 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_shuf {
   strings:
      $s1 = "randread_error" fullword ascii
      $s2 = "  or:  %s -e [OPTION]... [ARG]..." fullword ascii
      $s3 = "  or:  %s -i LO-HI [OPTION]..." fullword ascii
      $s4 = "      --random-source=FILE  get random bytes from FILE" fullword ascii
      $s5 = "  -n, --head-count=COUNT    output at most COUNT lines" fullword ascii
      $s6 = "lib/randread.c" fullword ascii
      $s7 = "2c84f7431cdea13cd2033fd72bc9c23a1e490e.debug" fullword ascii
      $s8 = "too many input lines" fullword ascii
      $s9 = "no lines to repeat" fullword ascii
      $s10 = "invalid input range" fullword ascii
      $s11 = "input-range" fullword ascii /* Goodware String - occured 1 times */
      $s12 = "head-count" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "cannot combine -e and -i options" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "Write a random permutation of the input lines to standard output." fullword ascii /* Goodware String - occured 1 times */
      $s15 = "multiple -i options specified" fullword ascii /* Goodware String - occured 1 times */
      $s16 = "invalid line count: %s" fullword ascii
      $s17 = "2c84f7431cdea13cd2033fd72bc9c23a1e490e" ascii
      $s18 = "exit_failure" fullword ascii /* Goodware String - occured 2 times */
      $s19 = "  -o, --output=FILE         write result to FILE instead of standard output" fullword ascii
      $s20 = "%s: end of file" fullword ascii /* Goodware String - occured 2 times */
      $s21 = "  -z, --zero-terminated     line delimiter is NUL, not newline" fullword ascii
      $s22 = "  -i, --input-range=LO-HI   treat each number LO through HI as an input line" fullword ascii
      $s23 = "  -e, --echo                treat each ARG as an input line" fullword ascii
      $s24 = "random-source" fullword ascii /* Goodware String - occured 3 times */
      $s25 = "multiple output files specified" fullword ascii /* Goodware String - occured 3 times */
      $s26 = "multiple random sources specified" fullword ascii /* Goodware String - occured 3 times */
      $s27 = "D$+A8G" fullword ascii
      $s28 = "ei:n:o:rz" fullword ascii
      $s29 = "D$(L9t$" fullword ascii
      $s30 = "D$7u$E1" fullword ascii
      $s31 = "Usage: %s [OPTION]... [FILE]" fullword ascii /* Goodware String - occured 5 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 31 00 00 00 00 00 00 40 00 00 00 00 00 00 00 50 f4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f0 1a 00 00 00 00 00 00 f0 1a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 19 80 00 00 00 00 00 00 19 80 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 a8 2f 00 00 00 00 00 00 a8 2f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 ec 00 00 00 00 00 00 30 ec 00 00 00 00 00 00 30 ec 00 00 00 00 00 00 70 06 00 00 00 00 00 00 38 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ed 00 00 00 00 00 00 d8 ed 00 00 00 00 00 00 d8 ed 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 40 c1 00 00 00 00 00 00 40 c1 00 00 00 00 00 00 40 c1 00 00 00 00 00 00 1c 05 00 00 00 00 00 00 1c 05 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 ec 00 00 00 00 00 00 30 ec 00 00 00 00 00 00 30 ec 00 00 00 00 00 00 d0 03 00 00 00 00 00 00 d0 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 f7 2c 84 f7 43 1c de a1 3c d2 03 3f d7 2b c9 c2 3a 1e 49 0e 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 49 00 00 00 01 00 00 00 06 00 00 00 84 4d e1 00 a0 01 1c 12 49 00 00 00 4b 00 00 00 52 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 86 f0 96 7c 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_fmt {
   strings:
      $s1 = "d33a841664d2e2e2eeffcb522f424e125ba014.debug" fullword ascii
      $s2 = "invalid width" fullword ascii
      $s3 = "The option -WIDTH is an abbreviated form of --width=DIGITS." fullword ascii /* Goodware String - occured 1 times */
      $s4 = "Usage: %s [-WIDTH] [OPTION]... [FILE]..." fullword ascii /* Goodware String - occured 1 times */
      $s5 = "d33a841664d2e2e2eeffcb522f424e125ba014" ascii
      $s6 = "0123456789cstuw:p:g:" fullword ascii
      $s7 = "Ross Paterson" fullword ascii /* Goodware String - occured 2 times */
      $s8 = "  -u, --uniform-spacing     one space between words, two after sentences" fullword ascii
      $s9 = "crown-margin" fullword ascii /* Goodware String - occured 2 times */
      $s10 = "invalid option -- %c; -WIDTH is recognized only when it is the first" fullword ascii /* Goodware String - occured 2 times */
      $s11 = "split-only" fullword ascii /* Goodware String - occured 2 times */
      $s12 = "  -s, --split-only          split long lines, but do not refill" fullword ascii
      $s13 = "  -w, --width=WIDTH         maximum line width (default of 75 columns)" fullword ascii
      $s14 = "  -p, --prefix=STRING       reformat only lines beginning with STRING," fullword ascii
      $s15 = "uniform-spacing" fullword ascii /* Goodware String - occured 2 times */
      $s16 = "  -g, --goal=WIDTH          goal width (default of 93% of width)" fullword ascii
      $s17 = "Reformat each paragraph in the FILE(s), writing to standard output." fullword ascii /* Goodware String - occured 2 times */
      $s18 = "  -t, --tagged-paragraph    indentation of first line different from second" fullword ascii
      $s19 = "tagged-paragraph" fullword ascii /* Goodware String - occured 2 times */
      $s20 = "  -c, --crown-margin        preserve indentation of first two lines" fullword ascii
      $s21 = "option; use -w N instead" fullword ascii /* Goodware String - occured 2 times */
      $s22 = "closing standard input" fullword ascii /* Goodware String - occured 3 times */
      $s23 = "G(H;G0swH" fullword ascii
      $s24 = "G(H;G0sOH" fullword ascii
      $s25 = "G(H;G0s" fullword ascii
      $s26 = "                              reattaching the prefix to reformatted lines" fullword ascii
      $s27 = "G(H;G0s'H" fullword ascii
      $s28 = "0123456789c" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 29 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f0 b3 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c8 17 00 00 00 00 00 00 c8 17 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 49 5d 00 00 00 00 00 00 49 5d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 f0 24 00 00 00 00 00 00 f0 24 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 ac 00 00 00 00 00 00 30 bc 00 00 00 00 00 00 30 bc 00 00 00 00 00 00 10 06 00 00 00 00 00 00 30 b8 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ad 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 54 90 00 00 00 00 00 00 54 90 00 00 00 00 00 00 54 90 00 00 00 00 00 00 7c 03 00 00 00 00 00 00 7c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 ac 00 00 00 00 00 00 30 bc 00 00 00 00 00 00 30 bc 00 00 00 00 00 00 d0 03 00 00 00 00 00 00 d0 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 a5 d3 3a 84 16 64 d2 e2 e2 ee ff cb 52 2f 42 4e 12 5b a0 14 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 3d 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 3d 00 00 00 3f 00 00 00 45 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_cat {
   strings:
      $s1 = "  %s f - g  Output f's contents, then standard input, then g's contents." fullword ascii
      $s2 = "  -b, --number-nonblank    number nonempty output lines, overrides -n" fullword ascii
      $s3 = "  -e                       equivalent to -vE" fullword ascii
      $s4 = "  -t                       equivalent to -vT" fullword ascii
      $s5 = "  -v, --show-nonprinting   use ^ and M- notation, except for LFD and TAB" fullword ascii
      $s6 = "  -u                       (ignored)" fullword ascii
      $s7 = "587dafd2356ccd0e26919acb716e9131362712.debug" fullword ascii
      $s8 = "aligned_alloc" fullword ascii
      $s9 = "587dafd2356ccd0e26919acb716e9131362712" ascii
      $s10 = "  %s        Copy standard input to standard output." fullword ascii
      $s11 = "  -E, --show-ends          display $ at end of each line" fullword ascii
      $s12 = "  -A, --show-all           equivalent to -vET" fullword ascii
      $s13 = "%s: input file is output file" fullword ascii /* Goodware String - occured 2 times */
      $s14 = "  -s, --squeeze-blank      suppress repeated empty output lines" fullword ascii
      $s15 = "  -n, --number             number all output lines" fullword ascii
      $s16 = "  -T, --show-tabs          display TAB characters as ^I" fullword ascii
      $s17 = "squeeze-blank" fullword ascii /* Goodware String - occured 2 times */
      $s18 = "number-nonblank" fullword ascii /* Goodware String - occured 2 times */
      $s19 = "benstuvAET" fullword ascii /* Goodware String - occured 2 times */
      $s20 = "show-ends" fullword ascii /* Goodware String - occured 2 times */
      $s21 = "closing standard input" fullword ascii /* Goodware String - occured 3 times */
      $s22 = "D$@9l$P" fullword ascii /* Goodware String - occured 3 times */
      $s23 = "show-nonprinting" fullword ascii /* Goodware String - occured 4 times */
      $s24 = "^M^?M-^I" fullword ascii
      $s25 = "show-all" fullword ascii /* Goodware String - occured 5 times */
      $s26 = "show-tabs" fullword ascii /* Goodware String - occured 5 times */
      $s27 = "Concatenate FILE(s) to standard output." fullword ascii
      $s28 = "cannot do ioctl on %s" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 50 31 00 00 00 00 00 00 40 00 00 00 00 00 00 00 50 b4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 18 18 00 00 00 00 00 00 18 18 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 49 50 00 00 00 00 00 00 49 50 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 c8 21 00 00 00 00 00 00 c8 21 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 ac 00 00 00 00 00 00 30 bc 00 00 00 00 00 00 30 bc 00 00 00 00 00 00 70 06 00 00 00 00 00 00 30 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ad 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 10 8f 00 00 00 00 00 00 10 8f 00 00 00 00 00 00 10 8f 00 00 00 00 00 00 4c 03 00 00 00 00 00 00 4c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 ac 00 00 00 00 00 00 30 bc 00 00 00 00 00 00 30 bc 00 00 00 00 00 00 d0 03 00 00 00 00 00 00 d0 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 53 58 7d af d2 35 6c cd 0e 26 91 9a cb 71 6e 91 31 36 27 12 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 3f 00 00 00 01 00 00 00 06 00 00 00 04 49 c1 00 20 01 18 12 3f 00 00 00 41 00 00 00 46 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 33 c4 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_dash {
   strings:
      $s1 = "dumped)" fullword ascii
      $s2 = " is a shell keyword" fullword ascii
      $s3 = " is a shell function" fullword ascii
      $s4 = " is a %sshell builtin" fullword ascii
      $s5 = "xvsnprintf failed" fullword ascii
      $s6 = "Usage: getopts optstring var [arg...]" fullword ascii
      $s7 = "sigsetmask" fullword ascii
      $s8 = "Maximum function recursion depth (%d) reached" fullword ascii
      $s9 = "AVAUATS" fullword ascii
      $s10 = "AUATUSE" fullword ascii
      $s11 = " a tracked alias for" fullword ascii
      $s12 = "rtprio" fullword ascii
      $s13 = "redirection" fullword ascii /* Goodware String - occured 7 times */
      $s14 = "process" fullword ascii /* Goodware String - occured 171 times */
      $s15 = "Running" fullword ascii /* Goodware String - occured 192 times */
      $s16 = "RTMAX-4" fullword ascii
      $s17 = "RTMIN+15" fullword ascii
      $s18 = "RTMIN+8" fullword ascii
      $s19 = "RTMAX-2" fullword ascii
      $s20 = "RTMAX-12" fullword ascii
      $s21 = "RTMAX-7" fullword ascii
      $s22 = " (core dH" fullword ascii
      $s23 = "RTMAX-1" fullword ascii
      $s24 = "RTMIN+3" fullword ascii
      $s25 = "sh: turning off NDELAY mode" fullword ascii /* Goodware String - occured 1 times */
      $s26 = "RTMIN+13" fullword ascii
      $s27 = "RTMAX-14" fullword ascii
      $s28 = "RTMAX-13" fullword ascii
      $s29 = "RTMIN+6" fullword ascii
      $s30 = "RTMAX-5" fullword ascii
      $s31 = "RTMAX-11" fullword ascii
      $s32 = "RTMIN+11" fullword ascii
      $s33 = "RTMIN+1" fullword ascii
      $s34 = "RTMIN+14" fullword ascii
      $s35 = "RTMAX-9" fullword ascii
      $s36 = "RTMAX-8" fullword ascii
      $s37 = "RTMAX-3" fullword ascii
      $s38 = "RTMIN+10" fullword ascii
      $s39 = " is an alias for %s" fullword ascii
      $s40 = "RTMIN+9" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 47 00 00 00 00 00 00 40 00 00 00 00 00 00 00 88 f3 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 48 37 00 00 00 00 00 00 48 37 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 61 34 01 00 00 00 00 00 61 34 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 01 00 00 00 00 00 00 80 01 00 00 00 00 00 00 80 01 00 00 00 00 00 ec 59 00 00 00 00 00 00 ec 59 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 de 01 00 00 00 00 00 30 ee 01 00 00 00 00 00 30 ee 01 00 00 00 00 00 10 14 00 00 00 00 00 00 40 41 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 28 eb 01 00 00 00 00 00 28 fb 01 00 00 00 00 00 28 fb 01 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 24 a0 01 00 00 00 00 00 24 a0 01 00 00 00 00 00 24 a0 01 00 00 00 00 00 04 08 00 00 00 00 00 00 04 08 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 de 01 00 00 00 00 00 30 ee 01 00 00 00 00 00 30 ee 01 00 00 00 00 00 d0 11 00 00 00 00 00 00 d0 11 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 bd 04 3f e0 b3 e8 80 bd 0c 69 5e 3c 8b 53 ec ac cd c0 bd f3 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 66 00 00 00 01 00 00 00 06 00 00 00 30 00 81 00 c0 00 40 00 66 00 00 00 69 00 00 00 00 00 00 00 c4 89 05 90 a6 dd a3 6b d1 65 ce 6d c5 b9 9c 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 1e 02 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 400KB and
      8 of them and $magic
}

rule gtfobins_binaries_csh {
   strings:
      $s1 = "%s: shell built-in command." fullword ascii
      $s2 = "Not a login shell" fullword ascii
      $s3 = "coredumpsize" fullword ascii
      $s4 = "%s: illegal process id" fullword ascii
      $s5 = "No operand for -h flag" fullword ascii
      $s6 = "%s: Command not found." fullword ascii
      $s7 = "/etc/csh.login" fullword ascii
      $s8 = "Can't suspend a login shell (yet)" fullword ascii
      $s9 = "/.login" fullword wide
      $s10 = "Arguments should be jobs or process id's" fullword ascii
      $s11 = "BUG: process flushed twice" fullword ascii
      $s12 = "No more processes" fullword ascii
      $s13 = "/bin/login" fullword ascii
      $s14 = "Subscript error" fullword ascii
      $s15 = "error inside publib library function: %s:%ld: %s" fullword ascii
      $s16 = "Thus no job control in this shell." fullword ascii
      $s17 = "Invalid null command" fullword ascii
      $s18 = "No job control in this shell" fullword ascii
      $s19 = "Unknown signal; kill -l lists signals" fullword ascii
      $s20 = "usage: %s [-lnv]%s" fullword ascii
      $s21 = "* not allowed with $# or $?" fullword ascii
      $s22 = "LOGNAME" fullword wide
      $s23 = "%d hits, %d misses, %d%%" fullword ascii
      $s24 = "hashstat" fullword ascii
      $s25 = "/etc/csh.logout" fullword ascii
      $s26 = "/.logout" fullword wide
      $s27 = "%s: Already suspended" fullword ascii
      $s28 = "%s: %s. Wrong Architecture" fullword ascii
      $s29 = "Use \"logout\" to logout." fullword ascii
      $s30 = "usage: jobs [-l]" fullword ascii
      $s31 = "usage: history [-hr] [n]" fullword ascii
      $s32 = "Unknown operator" fullword ascii
      $s33 = "malloc or realloc failed" fullword ascii
      $s34 = "No job control in subshells" fullword ascii
      $s35 = "erwxfdzopls" fullword ascii
      $s36 = "linedit" fullword ascii
      $s37 = "breaksw" fullword ascii
      $s38 = "unlimit" fullword ascii
      $s39 = "maxproc" fullword ascii
      $s40 = "cputime" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 10 56 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 86 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d8 3d 00 00 00 00 00 00 d8 3d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 ed bf 01 00 00 00 00 00 ed bf 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 e8 5c 00 00 00 00 00 00 e8 5c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 68 02 00 00 00 00 00 d0 68 02 00 00 00 00 00 d0 68 02 00 00 00 00 00 18 1c 00 00 00 00 00 00 a0 ed 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 38 6d 02 00 00 00 00 00 38 6d 02 00 00 00 00 00 38 6d 02 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 6c 15 02 00 00 00 00 00 6c 15 02 00 00 00 00 00 6c 15 02 00 00 00 00 00 9c 09 00 00 00 00 00 00 9c 09 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 68 02 00 00 00 00 00 d0 68 02 00 00 00 00 00 d0 68 02 00 00 00 00 00 30 07 00 00 00 00 00 00 30 07 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 43 86 81 d7 86 49 43 e8 9c ec 1d 92 7e 42 3f 6b f1 1e 5b 56 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 72 00 00 00 01 00 00 00 06 00 00 00 10 01 a1 00 c0 01 50 02 72 00 00 00 75 00 00 00 00 00 00 00 28 1d 8c 1c a6 dd a3 6b d1 65 ce 6d 66 55 61 10 c4 b9 9c 40 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0a 03 00 00 12 00 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_posh {
   strings:
      $s1 = "%s: cannot execute - %s" fullword ascii
      $s2 = "exchild: execute() returned" fullword ascii
      $s3 = "exchild: XPIPEI and no last_job - pid %d" fullword ascii
      $s4 = "EXECSHELL" fullword ascii
      $s5 = "argument must be %job or process id" fullword ascii
      $s6 = "shcomexec: %s" fullword ascii
      $s7 = "setexecsig: unset signal %d(%s)" fullword ascii
      $s8 = "%s: function definition must use compound command" fullword ascii
      $s9 = "can't create pipe - try again" fullword ascii
      $s10 = "too many files open in shell" fullword ascii
      $s11 = "%s: can't open function definition file %s - %s" fullword ascii
      $s12 = "can't get current directory - %s" fullword ascii
      $s13 = "error writing %s: %s" fullword ascii
      $s14 = "can't %s temporary file %s: %s" fullword ascii
      $s15 = "%s: %s applied to read only variable" fullword ascii
      $s16 = "%s: subscript out of range" fullword ascii
      $s17 = "trap -- " fullword ascii
      $s18 = "executable: %s" fullword ascii
      $s19 = "illegal file descriptor name" fullword ascii
      $s20 = "No controlling tty (open /dev/tty: %s)" fullword ascii
      $s21 = "You have %s%s%s jobs" fullword ascii
      $s22 = "missing expression operator" fullword ascii
      $s23 = "%s: can't find function definition file - %s" fullword ascii
      $s24 = "%s%s-%c: unknown option" fullword ascii
      $s25 = "%s%s-`%c' requires argument" fullword ascii
      $s26 = "syntax error: `%s' %s" fullword ascii
      $s27 = "here document `%s' unclosed" fullword ascii
      $s28 = "builtin: %s: not a builtin" fullword ascii
      $s29 = "%s: expression recurses on parameter `%s'" fullword ascii
      $s30 = "%s: is not an identifier" fullword ascii
      $s31 = "%s: is read only" fullword ascii
      $s32 = "%s: bad identifier" fullword ascii
      $s33 = "%s: not identifier" fullword ascii
      $s34 = "%s: unexpected `%s'" fullword ascii
      $s35 = "%s: %s requires lvalue" fullword ascii
      $s36 = "bad signal %s, not setting trap" fullword ascii
      $s37 = "could not finish (dup) redirection %s: %s" fullword ascii
      $s38 = "%s: bad number `%s'" fullword ascii
      $s39 = "shell builtin: %s" fullword ascii
      $s40 = "shf_getchar: flags %x" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 3c 00 00 00 00 00 00 40 00 00 00 00 00 00 00 58 32 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0b 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 68 02 00 00 00 00 00 00 68 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 a8 02 00 00 00 00 00 00 a8 02 00 00 00 00 00 00 a8 02 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 58 2a 00 00 00 00 00 00 58 2a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 fd 7b 01 00 00 00 00 00 fd 7b 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 b0 01 00 00 00 00 00 00 b0 01 00 00 00 00 00 00 b0 01 00 00 00 00 00 a0 5a 00 00 00 00 00 00 a0 5a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 16 02 00 00 00 00 00 f0 26 02 00 00 00 00 00 f0 26 02 00 00 00 00 00 24 1a 00 00 00 00 00 00 18 25 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 f0 1d 02 00 00 00 00 00 f0 2d 02 00 00 00 00 00 f0 2d 02 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 c4 02 00 00 00 00 00 00 c4 02 00 00 00 00 00 00 c4 02 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 dc cf 01 00 00 00 00 00 dc cf 01 00 00 00 00 00 dc cf 01 00 00 00 00 00 24 08 00 00 00 00 00 00 24 08 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 16 02 00 00 00 00 00 f0 26 02 00 00 00 00 00 f0 26 02 00 00 00 00 00 10 09 00 00 00 00 00 00 10 09 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 e0 62 7d 27 3e 93 51 db 28 97 db 6f a5 d8 2b dd f1 ad 3a 31 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 03 00 00 00 4f 00 00 00 01 00 00 00 06 00 00 00 32 8c 81 00 c0 00 4c 01 4f 00 00 00 53 00 00 00 55 00 00 00 c4 89 05 90 a6 dd a3 6b 0a de f7 12 d1 65 ce 6d c4 b9 9c 40 c1 b3 f7 12 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ae 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b6 02 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0b 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a0 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 26 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 07 03 00 00 20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0b 00 00 00 12 00 00 00}
condition:
      filesize < 400KB and
      8 of them and $magic
}

rule gtfobins_binaries_pwsh {
   strings:
      $s1 = "--- Invoked %s [version: %s, commit hash: %s] main = {" fullword ascii
      $s2 = "This executable is not bound to a managed DLL to execute. The binding value is: '%s'" fullword ascii
      $s3 = "  - %s&apphost_version=%s" fullword ascii
      $s4 = "pwsh.dll" fullword ascii
      $s5 = "The managed DLL bound to this executable is: '%s'" fullword ascii
      $s6 = "A fatal error was encountered. This executable was not bound to load a managed DLL." fullword ascii
      $s7 = "Failed to resolve full path of the current executable [%s]" fullword ascii
      $s8 = "https://go.microsoft.com/fwlink/?linkid=2063370" fullword ascii
      $s9 = "Download the .NET runtime:" fullword ascii
      $s10 = "apphost.dbg" fullword ascii
      $s11 = "  - Installing .NET prerequisites might help resolve this problem." fullword ascii
      $s12 = "The required library %s does not support relative app dll paths." fullword ascii
      $s13 = "Runtime config is cfg=%s dev=%s" fullword ascii
      $s14 = "The application to execute does not exist: '%s'." fullword ascii
      $s15 = ".runtimeconfig.dev.json" fullword ascii
      $s16 = "not enough space for format expansion (Please submit full bug report at https://gcc.gnu.org/bugsbasic_string::_M_create" fullword ascii
      $s17 = "apphost" fullword ascii
      $s18 = "Failed to load %s, error: %s" fullword ascii
      $s19 = "Probed for and did not find library symbol %s, error: %s" fullword ascii
      $s20 = "Invoking fx resolver [%s] hostfxr_main_startupinfo" fullword ascii
      $s21 = "App host version: %s" fullword ascii
      $s22 = "Invoking fx resolver [%s] hostfxr_main_bundle_startupinfo" fullword ascii
      $s23 = "Host path: [%s]" fullword ascii
      $s24 = "Unable to open COREHOST_TRACEFILE=%s for writing" fullword ascii
      $s25 = "@(#)Version 6.0.822.36306 @Commit: 55fb7ef977e7d120dc12f0960edcff0739d7ee0e" fullword ascii
      $s26 = "hostfxr_set_error_writer" fullword ascii
      $s27 = "%s&apphost_version=%s" fullword ascii
      $s28 = "_ZNSs6insertEmPKcm" fullword ascii
      $s29 = "The install_location file ['%s'] does not exist - skipping." fullword ascii
      $s30 = "corebreadcrumbs" fullword ascii
      $s31 = "  _ To run this application, you need to install a newer version of .NET Core." fullword ascii
      $s32 = "Reading fx resolver directory=[%s]" fullword ascii
      $s33 = "Failed to map file. fstat(%s) failed with error %d" fullword ascii
      $s34 = ".runtimeconfig.json" fullword ascii
      $s35 = "The required library %s does not support single-file apps." fullword ascii
      $s36 = "_ITM_addUserCommitAction" fullword ascii
      $s37 = "A fatal error occurred, the required library %s could not be found in [%s]" fullword ascii
      $s38 = "realpath(%s) failed: %s" fullword ascii
      $s39 = "&framework_version=" fullword ascii
      $s40 = "The library %s was found, but loading it from %s failed" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 51 4d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 78 26 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0c 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 a0 02 00 00 00 00 00 00 a0 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 e0 02 00 00 00 00 00 00 e0 02 00 00 00 00 00 00 e0 02 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b8 3c 00 00 00 00 00 00 b8 3c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 7d 5d 01 00 00 00 00 00 7d 5d 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 01 00 00 00 00 00 00 a0 01 00 00 00 00 00 00 a0 01 00 00 00 00 00 fe 75 00 00 00 00 00 00 fe 75 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 58 17 02 00 00 00 00 00 58 27 02 00 00 00 00 00 58 27 02 00 00 00 00 00 69 0d 00 00 00 00 00 00 b8 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 b0 17 02 00 00 00 00 00 b0 27 02 00 00 00 00 00 b0 27 02 00 00 00 00 00 50 02 00 00 00 00 00 00 50 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 fc 02 00 00 00 00 00 00 fc 02 00 00 00 00 00 00 fc 02 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 58 17 02 00 00 00 00 00 58 27 02 00 00 00 00 00 58 27 02 00 00 00 00 00 00 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 e0 b3 01 00 00 00 00 00 e0 b3 01 00 00 00 00 00 e0 b3 01 00 00 00 00 00 c4 0e 00 00 00 00 00 00 c4 0e 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 58 17 02 00 00 00 00 00 58 27 02 00 00 00 00 00 58 27 02 00 00 00 00 00 a8 08 00 00 00 00 00 00 a8 08 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 8a 0b 62 3b b0 e5 5e 51 0d 8c 7f c1 f3 81 84 ce 01 9b b0 d3 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 02 00 00 00 06 00 00 00 20 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05 12 00 00 20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 1e 12 00 00 20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 83 05 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 4f 0e 00 00 11 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d0 06 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 19 05 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 400KB and
      8 of them and $magic
}

rule gtfobins_binaries_dotnet {
   strings:
      $s1 = "--- Invoked %s [version: %s, commit hash: %s] main = {" fullword ascii
      $s2 = "  - %s&apphost_version=%s" fullword ascii
      $s3 = "  The path to an application .dll file to execute." fullword ascii
      $s4 = "Failed to resolve full path of the current executable [%s]" fullword ascii
      $s5 = "https://go.microsoft.com/fwlink/?linkid=2063370" fullword ascii
      $s6 = "A fatal error was encountered. Cannot execute %s when renamed to %s." fullword ascii
      $s7 = "  - Installing .NET prerequisites might help resolve this problem." fullword ascii
      $s8 = "Runtime config is cfg=%s dev=%s" fullword ascii
      $s9 = ".runtimeconfig.dev.json" fullword ascii
      $s10 = "not enough space for format expansion (Please submit full bug report at https://gcc.gnu.org/bugsbasic_string::_M_create" fullword ascii
      $s11 = "Failed to load %s, error: %s" fullword ascii
      $s12 = "Probed for and did not find library symbol %s, error: %s" fullword ascii
      $s13 = "Invoking fx resolver [%s] hostfxr_main_startupinfo" fullword ascii
      $s14 = "Host path: [%s]" fullword ascii
      $s15 = "Unable to open COREHOST_TRACEFILE=%s for writing" fullword ascii
      $s16 = "hostfxr_set_error_writer" fullword ascii
      $s17 = "@(#)Version 6.0.922.41905 @Commit: 163a63591cf9e9b682063cf3995948c2b885a042" fullword ascii
      $s18 = "_ZNSs6insertEmPKcm" fullword ascii
      $s19 = "The install_location file ['%s'] does not exist - skipping." fullword ascii
      $s20 = "corebreadcrumbs" fullword ascii
      $s21 = "  _ To run this application, you need to install a newer version of .NET Core." fullword ascii
      $s22 = "Reading fx resolver directory=[%s]" fullword ascii
      $s23 = "Failed to map file. fstat(%s) failed with error %d" fullword ascii
      $s24 = ".runtimeconfig.json" fullword ascii
      $s25 = "_ITM_addUserCommitAction" fullword ascii
      $s26 = "A fatal error occurred, the required library %s could not be found in [%s]" fullword ascii
      $s27 = "realpath(%s) failed: %s" fullword ascii
      $s28 = "&framework_version=" fullword ascii
      $s29 = "The library %s was found, but loading it from %s failed" fullword ascii
      $s30 = "A fatal error occurred. The folder [%s] does not exist" fullword ascii
      $s31 = "__pthread_key_create" fullword ascii
      $s32 = "Fallback directory core breadcrumbs at [%s] was not found" fullword ascii
      $s33 = "A fatal error occurred, the folder [%s] does not contain any version-numbered child folders" fullword ascii
      $s34 = "Directory core breadcrumbs [%s] was not specified or found" fullword ascii
      $s35 = "Failed to map file. open(%s) failed with error %d" fullword ascii
      $s36 = "Failed to map file. mmap(%s) failed with error %d" fullword ascii
      $s37 = "Breadcrumb store [%s] is not ACL-ed with rw-" fullword ascii
      $s38 = "open(%s) failed in %s" fullword ascii
      $s39 = "Realpath CORE_BREADCRUMBS [%s]" fullword ascii
      $s40 = "dotnet.dbg" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 01 4d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b0 21 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0c 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 a0 02 00 00 00 00 00 00 a0 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 e0 02 00 00 00 00 00 00 e0 02 00 00 00 00 00 00 e0 02 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 3c 00 00 00 00 00 00 40 3c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 8d 54 01 00 00 00 00 00 8d 54 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 01 00 00 00 00 00 00 a0 01 00 00 00 00 00 00 a0 01 00 00 00 00 00 82 71 00 00 00 00 00 00 82 71 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 78 17 02 00 00 00 00 00 78 27 02 00 00 00 00 00 78 27 02 00 00 00 00 00 0d 09 00 00 00 00 00 00 58 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c8 17 02 00 00 00 00 00 c8 27 02 00 00 00 00 00 c8 27 02 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 fc 02 00 00 00 00 00 00 fc 02 00 00 00 00 00 00 fc 02 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 78 17 02 00 00 00 00 00 78 27 02 00 00 00 00 00 78 27 02 00 00 00 00 00 00 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c0 b0 01 00 00 00 00 00 c0 b0 01 00 00 00 00 00 c0 b0 01 00 00 00 00 00 a4 0e 00 00 00 00 00 00 a4 0e 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 78 17 02 00 00 00 00 00 78 27 02 00 00 00 00 00 78 27 02 00 00 00 00 00 88 08 00 00 00 00 00 00 88 08 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 6b 39 3f 89 ac 70 48 7c f1 de 0a 43 14 9f 72 22 3c 73 9d 58 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 02 00 00 00 06 00 00 00 20 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 dc 11 00 00 20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f5 11 00 00 20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 83 05 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 3a 0e 00 00 11 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d0 06 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 19 05 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 400KB and
      8 of them and $magic
}

rule gtfobins_binaries_openvpn {
   strings:
      $x1 = "PORT SHARE: sendmsg failed -- unable to communicate with background process (%d,%d,%d,%d)" fullword ascii
      $s2 = "enable_async_push=no enable_comp_stub=no enable_crypto_ofb_cfb=yes enable_dco=yes enable_dco_arg=yes enable_debug=yes enable_dep" ascii
      $s3 = "In %s:%d: Maximum recursive include levels exceeded in include attempt of file %s -- probably you have a configuration file that" ascii
      $s4 = "WARNING: potential conflict between --%s address [%s] and --ifconfig address pair [%s, %s] -- this is a warning only that is tri" ascii
      $s5 = "WARNING: Compression for sending and receiving enabled. Compression has been used in the past to break encryption. Allowing comp" ascii
      $s6 = "******* WARNING *******: All encryption and authentication features disabled -- All data will be tunnelled as clear text and wil" ascii
      $s7 = "                  setting or change -- execute as: cmd ip-address port#" fullword ascii
      $s8 = "Decoding PKCS12 failed. Probably wrong password or unsupported/legacy encryption" fullword ascii
      $s9 = "PKCS#11: pkcs11_management_id_get - return success=%d, id='%s'" fullword ascii
      $s10 = "HEADER%cCLIENT_LIST%cCommon Name%cReal Address%cVirtual Address%cVirtual IPv6 Address%cBytes Received%cBytes Sent%cConnected Sin" ascii
      $s11 = "TLS Auth Error: --username-as-common name specified and username is longer than the maximum permitted Common Name length of %d c" ascii
      $s12 = "Error: DER encoded ECDSA signature is too long (%d)" fullword ascii
      $s13 = "--port-share host port [dir] : When run in TCP mode, proxy incoming HTTPS" fullword ascii
      $s14 = "PORT SHARE PROXY: RECEIVED COMMAND_EXIT" fullword ascii
      $s15 = "Key file '%s' used in --%s contains insufficient key material [keys found=%d required=%d] -- try generating a new key file with " ascii
      $s16 = "NOTE: failed to obtain options consistency info from peer -- this could occur if the remote peer is running a version of OpenVPN" ascii
      $s17 = "                  3 -- allow password to be passed to scripts via env" fullword ascii
      $s18 = "ERROR: The '%s' command is not supported by the current daemon mode" fullword ascii
      $s19 = "ression allows attacks that break encryption. Using \"--allow-compression yes\" is strongly discouraged for common usage. See --" ascii
      $s20 = "Key %s [%d] not authorized%s, dropping packet." fullword ascii
      $s21 = "%s: netlink reports blocking read - aborting wait" fullword ascii
      $s22 = "hash fingerprint is wrong length - expected %d bytes, got %d: %s" fullword ascii
      $s23 = "ERROR: --x509-username-field 'ext:%s' not supported" fullword ascii
      $s24 = "NOTE: failed to obtain options consistency info from peer -- this could occur if the remote peer is running a version of OpenVPN" ascii
      $s25 = "buf_init(&b->encrypt_buf, c->c2.frame.buf.headroom)" fullword ascii
      $s26 = "tls-crypt-v2 force-cookie is enabled, ignoring connection attempt from old client (%s)" fullword ascii
      $s27 = "PORT SHARE PROXY: client origin %s -> %s" fullword ascii
      $s28 = "SOCKS failed to get username/password." fullword ascii
      $s29 = "neither stdin nor stderr are a tty device and you have neither a controlling tty nor systemd - can't ask for '%s'.  If you used " ascii
      $s30 = "******* WARNING *******: All encryption and authentication features disabled -- All data will be tunnelled as clear text and wil" ascii
      $s31 = "ERROR: tls-crypt-v2 client key too large to work with requested --max-packet-size %d, requires at least --max-packet-size %d. Pa" ascii
      $s32 = "ERROR: tls-crypt-v2 client key too large to work with requested --max-packet-size %d, requires at least --max-packet-size %d. Pa" ascii
      $s33 = "WARNING: --%s address [%s] conflicts with --ifconfig subnet [%s, %s] -- local and remote addresses cannot be inside of the --ifc" ascii
      $s34 = " pass backslash characters as part of a Windows filename, you should use double backslashes such as \"c:\\\\openvpn\\\\static.ke" ascii
      $s35 = "WARNING: Using --management on a TCP port WITHOUT passwords is STRONGLY discouraged and considered insecure" fullword ascii
      $s36 = "WARNING: --topology net30 support for server configs with IPv4 pools will be removed in a future release. Please migrate to --to" ascii
      $s37 = "WARNING: Since you are using --dev tun with a point-to-point topology, the second argument to --ifconfig must be an IP address. " ascii
      $s38 = "c->c2.tls_multi->opt.frame.buf.payload_size <= c->c2.frame.buf.payload_size" fullword ascii
      $s39 = "NOTE: This connection is unable to accommodate a UDP packet size of %d. Consider using --fragment or --mssfix options as a worka" ascii
      $s40 = "HEADER%cCLIENT_LIST%cCommon Name%cReal Address%cVirtual Address%cVirtual IPv6 Address%cBytes Received%cBytes Sent%cConnected Sin" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 dd 00 00 00 00 00 00 40 00 00 00 00 00 00 00 a8 73 0e 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 70 b2 00 00 00 00 00 00 70 b2 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 99 4b 09 00 00 00 00 00 99 4b 09 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 10 0a 00 00 00 00 00 00 10 0a 00 00 00 00 00 00 10 0a 00 00 00 00 00 34 37 04 00 00 00 00 00 34 37 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 49 0e 00 00 00 00 00 50 59 0e 00 00 00 00 00 50 59 0e 00 00 00 00 00 10 29 00 00 00 00 00 00 58 ad 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a0 5e 0e 00 00 00 00 00 a0 6e 0e 00 00 00 00 00 a0 6e 0e 00 00 00 00 00 80 02 00 00 00 00 00 00 80 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 64 e7 0c 00 00 00 00 00 64 e7 0c 00 00 00 00 00 64 e7 0c 00 00 00 00 00 64 2c 00 00 00 00 00 00 64 2c 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 49 0e 00 00 00 00 00 50 59 0e 00 00 00 00 00 50 59 0e 00 00 00 00 00 b0 26 00 00 00 00 00 00 b0 26 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 7d a4 be 2c f5 68 f7 f6 7f 13 b5 05 39 e3 50 f2 2e 8b ba e3 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 d2 01 00 00 01 00 00 00 06 00 00 00 84 11 a1 00 80 83 10 02 d2 01 00 00 d6 01 00 00 00 00 00 00 28 1d 8c 1c d0 65 ce 6d 2e 53 f1 ac 35 42 74 75 28 ea 69 a4 66 55 61 10 86 f0 96 7c 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 3000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_busctl {
   strings:
      $x1 = "     --xml-interface       Dump the XML description in introspect command" fullword ascii
      $s2 = "sd_bus_creds_get_description" fullword ascii
      $s3 = "Failed to acquire credentials of service %s, ignoring: %m" fullword ascii
      $s4 = "sd_bus_creds_get_comm" fullword ascii
      $s5 = "%sFailed to introspect object %s of service %s: %s%s" fullword ascii
      $s6 = "  -H --host=[USER@]HOST    Operate on remote host" fullword ascii
      $s7 = "Failed to process bus: %m" fullword ascii
      $s8 = "Failed to get property %s on interface %s: %s" fullword ascii
      $s9 = "Failed to get all properties on interface %s: %s" fullword ascii
      $s10 = "ask_password_agent_close" fullword ascii
      $s11 = "sd_bus_get_name_creds" fullword ascii
      $s12 = "sd_bus_get_owner_creds" fullword ascii
      $s13 = "sd_bus_creds_get_euid" fullword ascii
      $s14 = "Failed to get credentials: %m" fullword ascii
      $s15 = "sd_bus_creds_get_pid" fullword ascii
      $s16 = "sd_bus_creds_get_unit" fullword ascii
      $s17 = "sd_bus_creds_get_session" fullword ascii
      $s18 = "sd_bus_creds_get_unique_name" fullword ascii
      $s19 = "bus_creds_dump" fullword ascii
      $s20 = "Service %s%s%s:" fullword ascii
      $s21 = "Failed to introspect object %s of service %s: %s" fullword ascii
      $s22 = "sd_bus_process" fullword ascii
      $s23 = "bus_log_address_error" fullword ascii
      $s24 = "  status [SERVICE]         Show bus service, process or bus owner credentials" fullword ascii
      $s25 = "Failed to parse --timeout= parameter '%s': %m" fullword ascii
      $s26 = "json_variant_dump" fullword ascii
      $s27 = "BusAddress=%s%s%s" fullword ascii
      $s28 = "sd_bus_message_dump" fullword ascii
      $s29 = "     --augment-creds=BOOL  Extend credential data with data read from /proc/$PID" fullword ascii
      $s30 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"systemd\",\"version\":\"256.2-1\",\"architecture\":\"amd64\",\"debugInfoUrl\":\"h" ascii
      $s31 = "Failed to set watch-bind setting to '%s': %m" fullword ascii
      $s32 = "UNIX file descriptor not supported as type." fullword ascii
      $s33 = "Failed to set property %s on interface %s: %s" fullword ascii
      $s34 = "log_assert_failed_unreachable" fullword ascii
      $s35 = "log_assert_failed" fullword ascii
      $s36 = "bus_log_connect_error" fullword ascii
      $s37 = "sd_bus_creds_unref" fullword ascii
      $s38 = "sd_bus_negotiate_creds" fullword ascii
      $s39 = "augment-creds" fullword ascii
      $s40 = "_hashmap_get" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 f0 62 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 62 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 20 00 1f 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 18 42 00 00 00 00 00 00 18 42 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 7d bc 00 00 00 00 00 00 7d bc 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 10 01 00 00 00 00 00 00 10 01 00 00 00 00 00 00 10 01 00 00 00 00 00 ac 3e 00 00 00 00 00 00 ac 3e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 51 01 00 00 00 00 00 90 51 01 00 00 00 00 00 90 51 01 00 00 00 00 00 b8 0e 00 00 00 00 00 00 18 0f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 68 57 01 00 00 00 00 00 68 57 01 00 00 00 00 00 68 57 01 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 dc 00 00 00 00 00 00 00 dc 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 f8 3d 01 00 00 00 00 00 f8 3d 01 00 00 00 00 00 f8 3d 01 00 00 00 00 00 5c 01 00 00 00 00 00 00 5c 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 51 01 00 00 00 00 00 90 51 01 00 00 00 00 00 90 51 01 00 00 00 00 00 70 0e 00 00 00 00 00 00 70 0e 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 67 4b b7 20 df 0a eb 42 2f 9e bd c3 40 b1 87 b4 ac 74 ca e7 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 88 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 73 79 73 74 65 6d 64 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 35 36 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a 22 61 6d 64}
condition:
      filesize < 300KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_zsh {
   strings:
      $s1 = "  -c         take first argument as a command to execute" fullword ascii
      $s2 = "exec requires a command to execute" fullword ascii
      $s3 = "%s: shell built-in command" fullword ascii
      $s4 = "not login shell" fullword ascii
      $s5 = "cmdnamtab" fullword ascii /* base64 encoded string 'rggjkZ' */
      $s6 = "file descriptor %d used by shell, not closed" fullword ascii
      $s7 = "gettempfile" fullword ascii
      $s8 = "exec flag -a requires a parameter" fullword ascii
      $s9 = "parse error in process substitution" fullword ascii
      $s10 = "gettempname" fullword ascii
      $s11 = "hashexecutablesonly" fullword ascii
      $s12 = "failed to close file descriptor %d: %e" fullword ascii
      $s13 = "decrdumpcount" fullword ascii
      $s14 = "  -b         end option processing, like --" fullword ascii
      $s15 = "incrdumpcount" fullword ascii
      $s16 = "%s (core dumped)%*s" fullword ascii
      $s17 = "process substitution failed: %e" fullword ascii
      $s18 = "failed to find end of command substitution" fullword ascii
      $s19 = "parse error in command substitution" fullword ascii
      $s20 = "invalid syntax for process substitution in redirection" fullword ascii
      $s21 = "execbuiltin" fullword ascii
      $s22 = "can't suspend login shell" fullword ascii
      $s23 = "exectry" fullword ascii
      $s24 = "execrepeat" fullword ascii
      $s25 = "which-command" fullword ascii
      $s26 = "getkeystring" fullword ascii
      $s27 = "execsave" fullword ascii
      $s28 = "execfor" fullword ascii
      $s29 = "execsubst" fullword ascii
      $s30 = "singlecommand" fullword ascii
      $s31 = "execlist" fullword ascii
      $s32 = "execselect" fullword ascii
      $s33 = "keyboardhackgetfn" fullword ascii
      $s34 = "execrestore" fullword ascii
      $s35 = "execstring" fullword ascii
      $s36 = "unknown exec flag -%c" fullword ascii
      $s37 = "gethashnode" fullword ascii
      $s38 = "execode" fullword ascii
      $s39 = "preexec" fullword ascii
      $s40 = "hashgetfn" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 10 7d 01 00 00 00 00 00 40 00 00 00 00 00 00 00 68 3e 0d 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 68 62 01 00 00 00 00 00 68 62 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 70 01 00 00 00 00 00 00 70 01 00 00 00 00 00 00 70 01 00 00 00 00 00 01 a3 09 00 00 00 00 00 01 a3 09 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 0b 00 00 00 00 00 00 20 0b 00 00 00 00 00 00 20 0b 00 00 00 00 00 a8 a2 01 00 00 00 00 00 a8 a2 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 ca 0c 00 00 00 00 00 f0 da 0c 00 00 00 00 00 f0 da 0c 00 00 00 00 00 d8 71 00 00 00 00 00 00 f0 a8 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 28 d7 0c 00 00 00 00 00 28 e7 0c 00 00 00 00 00 28 e7 0c 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 dc b7 0b 00 00 00 00 00 dc b7 0b 00 00 00 00 00 dc b7 0b 00 00 00 00 00 a4 21 00 00 00 00 00 00 a4 21 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 ca 0c 00 00 00 00 00 f0 da 0c 00 00 00 00 00 f0 da 0c 00 00 00 00 00 10 15 00 00 00 00 00 00 10 15 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 02 57 16 cf f4 a3 c5 7c 79 6a b8 f9 d2 95 3e e5 b3 ff bb 71 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 07 04 00 00 cc 00 00 00 80 00 00 00 0d 00 00 00 30 90 10 42 00 00 a4 00 00 5c 6c 20 32 44 20 08 12 60 2c 00 26 0c 05 bb a0 00 05 20 90 42 0a 85 02 00 00 04 48 00 00 00 03 80 4a 0c 52 00 0b 40 18 00 20 38 07 27 00 02 10 a0 72 40 84 82 84 00 02 04 80 58 00 86 26 60 80 00 00 00 00 08 24 00}
condition:
      filesize < 3000KB and
      8 of them and $magic
}

rule gtfobins_binaries_nasm {
   strings:
      $s1 = "syntax error processing `%s' directive" fullword ascii
      $s2 = "Motorola S-records encoded flat binary" fullword ascii
      $s3 = "Intel Hex encoded flat binary" fullword ascii
      $s4 = "`%s' directive not preprocessed early" fullword ascii
      $s5 = "tokens processed during single-lime macro expansion" fullword ascii
      $s6 = "*** pass reset: pass = %ld (%s)" fullword ascii
      $s7 = "unknown preprocessor directive `%s'" fullword ascii
      $s8 = "maxdump" fullword ascii
      $s9 = "    -a            don't preprocess (assemble only)" fullword ascii
      $s10 = "total source lines processed" fullword ascii
      $s11 = "instruction %s %s the target CPU" fullword ascii
      $s12 = "attempt to assemble code in section %d: defaulting to `.text'" fullword ascii
      $s13 = "UUUUUUUUUUUUD" fullword ascii /* reversed goodware string 'DUUUUUUUUUUUU' */
      $s14 = "UUUUUUA" fullword ascii /* reversed goodware string 'AUUUUUU' */
      $s15 = "attempt to assemble code in segment %d: defaulting to `.text'" fullword ascii
      $s16 = "UUUUUUUUV" fullword ascii /* reversed goodware string 'VUUUUUUUU' */
      $s17 = " target %x:%lx" fullword ascii
      $s18 = "UUUUUUUUUUUUUUUUZ" fullword ascii /* reversed goodware string 'ZUUUUUUUUUUUUUUUU' */
      $s19 = "       -Ov        display the number of passes executed at the end" fullword ascii
      $s20 = "`incbin': error while reading file `%s'" fullword ascii
      $s21 = "UUUUUUUUUU0" fullword ascii /* reversed goodware string '0UUUUUUUUUU' */
      $s22 = "`incbin': unable to get length of file `%s'" fullword ascii
      $s23 = "UUUUUUUUUUUUUU5" fullword ascii /* reversed goodware string '5UUUUUUUUUUUUUU' */
      $s24 = "unrecognised output format `%s' - use -hf for a list" fullword ascii
      $s25 = "%s not supported in preprocess-only mode" fullword ascii
      $s26 = "UUUUUU0" fullword ascii /* reversed goodware string '0UUUUUU' */
      $s27 = "Type %s -h for help." fullword ascii
      $s28 = "UUUUUUUUUUUUUUUU5" fullword ascii /* reversed goodware string '5UUUUUUUUUUUUUUUU' */
      $s29 = "    -E (or -e)    preprocess only (writes output to stdout by default)" fullword ascii
      $s30 = "UUUUUU<" fullword ascii /* reversed goodware string '<UUUUUU' */
      $s31 = "comma expected after operand" fullword ascii
      $s32 = "UUUUUU=" fullword ascii /* reversed goodware string '=UUUUUU' */
      $s33 = "UUUUUUUU%" fullword ascii /* reversed goodware string '%UUUUUUUU' */
      $s34 = "UUUUUUx" fullword ascii /* reversed goodware string 'xUUUUUU' */
      $s35 = "attempt to redefine reserved section name `%s'" fullword ascii
      $s36 = "target of WRT must be a section" fullword ascii
      $s37 = "NASM Output format debug dump" fullword ascii
      $s38 = "   --before str   add line (usually a preprocessor statement) before the input" fullword ascii
      $s39 = "NASM version %s%s" fullword ascii
      $s40 = "       -Le        show the preprocessed output" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 53 06 00 00 00 00 00 40 00 00 00 00 00 00 00 30 53 1d 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 22 06 00 00 00 00 00 08 22 06 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 06 00 00 00 00 00 00 30 06 00 00 00 00 00 00 30 06 00 00 00 00 00 8d 0e 04 00 00 00 00 00 8d 0e 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 0a 00 00 00 00 00 00 40 0a 00 00 00 00 00 00 40 0a 00 00 00 00 00 cc 3c 04 00 00 00 00 00 cc 3c 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 87 0e 00 00 00 00 00 b0 87 0e 00 00 00 00 00 b0 87 0e 00 00 00 00 00 e0 c9 0e 00 00 00 00 00 78 26 0f 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 60 4b 1d 00 00 00 00 00 60 4b 1d 00 00 00 00 00 60 4b 1d 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 88 f4 0d 00 00 00 00 00 88 f4 0d 00 00 00 00 00 88 f4 0d 00 00 00 00 00 14 14 00 00 00 00 00 00 14 14 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 87 0e 00 00 00 00 00 b0 87 0e 00 00 00 00 00 b0 87 0e 00 00 00 00 00 50 c8 0e 00 00 00 00 00 50 c8 0e 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 e5 2f 1e 81 18 2f bf da 52 7f 15 61 8a 6f c8 3c ac ba a0 4e 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 51 00 00 00 01 00 00 00 06 00 00 00 00 01 81 00 00 01 10 02 51 00 00 00 53 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 4f 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 6000KB and
      8 of them and $magic
}

rule gtfobins_binaries_tmux {
   strings:
      $x1 = "[-aP] [-E shell-command] [-s target-session] [-t target-client]" fullword ascii
      $x2 = "usage: %s [-2CDlNuVv] [-c shell-command] [-f file] [-L socket-name]" fullword ascii
      $s3 = "bind < { display-menu -xW -yW -T '#[align=centre]#{window_index}:#{window_name}'  '#{?#{>:#{session_windows},1},,-}Swap Left' 'l" ascii
      $s4 = "bind -n MouseDown3Status { display-menu -t= -xW -yW -T '#[align=centre]#{window_index}:#{window_name}'  '#{?#{>:#{session_window" ascii
      $s5 = "bind -n M-MouseDown3Status { display-menu -t= -xW -yW -T '#[align=centre]#{window_index}:#{window_name}'  '#{?#{>:#{session_wind" ascii
      $s6 = "[-bF] [-t target-pane] shell-command command [command]" fullword ascii
      $s7 = "[-AdDEPX] [-c start-directory] [-e environment] [-F format] [-f flags] [-n window-name] [-s session-name] [-t target-session] [-" ascii
      $s8 = "bind -n M-MouseDown3StatusLeft { display-menu -t= -xM -yW -T '#[align=centre]#{session_name}'  'Next' 'n' {switch-client -n} 'Pr" ascii
      $s9 = "bind -n MouseDown3StatusLeft { display-menu -t= -xM -yW -T '#[align=centre]#{session_name}'  'Next' 'n' {switch-client -n} 'Prev" ascii
      $s10 = "[-bC] [-c start-directory] [-d delay] [-t target-pane] [shell-command]" fullword ascii
      $s11 = "[-k] [-c start-directory] [-e environment] [-t target-window] [shell-command]" fullword ascii
      $s12 = "[-abdkPS] [-c start-directory] [-e environment] [-F format] [-n window-name] [-t target-window] [shell-command]" fullword ascii
      $s13 = "[-bdefhIPvZ] [-c start-directory] [-e environment] [-F format] [-l size] [-t target-pane][shell-command]" fullword ascii
      $s14 = "[-BCE] [-b border-lines] [-c target-client] [-d start-directory] [-e environment] [-h height] [-s style] [-S border-style] [-t t" ascii
      $s15 = "[-IOo] [-t target-pane] [shell-command]" fullword ascii
      $s16 = "[-k] [-c start-directory] [-e environment] [-t target-pane] [shell-command]" fullword ascii
      $s17 = "bind -N 'Prompt for window index to select' \"'\" { command-prompt -T window-target -pindex { select-window -t ':%%' } }" fullword ascii
      $s18 = "bind -N 'Move the current window' . { command-prompt -T target { move-window -t '%%' } }" fullword ascii
      $s19 = "rk}' 'm' {select-pane -m} 'Rename' 'n' {command-prompt -FI \"#W\" {rename-window -t '#{window_id}' -- '%%'}} '' 'New After' 'w' " ascii
      $s20 = "}' 'm' {select-pane -m} 'Rename' 'n' {command-prompt -FI \"#W\" {rename-window -t '#{window_id}' -- '%%'}} '' 'New After' 'w' {n" ascii
      $s21 = "} 'Rename' 'n' {command-prompt -FI \"#W\" {rename-window -t '#{window_id}' -- '%%'}} '' 'New After' 'w' {new-window -a} 'New At " ascii
      $s22 = "[-GNrswZ] [-F format] [-f filter] [-K key-format] [-O sort-order] [-t target-pane] [template]" fullword ascii
      $s23 = "[-NrZ] [-F format] [-f filter] [-K key-format] [-O sort-order] [-t target-pane] [template]" fullword ascii
      $s24 = "%s: target %s is %s%s%s%s%s%s" fullword ascii
      $s25 = "bind -N 'Rename current session' '$' { command-prompt -I'#S' { rename-session -- '%%' } }" fullword ascii
      $s26 = "evious' 'p' {switch-client -p} '' 'Renumber' 'N' {move-window -r} 'Rename' 'n' {command-prompt -I \"#S\" {rename-session -- '%%'" ascii
      $s27 = "ious' 'p' {switch-client -p} '' 'Renumber' 'N' {move-window -r} 'Rename' 'n' {command-prompt -I \"#S\" {rename-session -- '%%'}}" ascii
      $s28 = "shell %s, command %s" fullword ascii
      $s29 = "tmux-%s-%ld.log" fullword ascii
      $s30 = "[-bN] [-d duration] [-t target-client] [template]" fullword ascii
      $s31 = "bind -Tcopy-mode-vi t { command-prompt -1p'(jump to forward)' { send -X jump-to-forward '%%' } }" fullword ascii
      $s32 = "bind -Tcopy-mode-vi f { command-prompt -1p'(jump forward)' { send -X jump-forward '%%' } }" fullword ascii
      $s33 = "bind -Tcopy-mode C-s { command-prompt -T search -ip'(search down)' -I'#{pane_search_string}' { send -X search-forward-incrementa" ascii
      $s34 = "bind -Tcopy-mode C-s { command-prompt -T search -ip'(search down)' -I'#{pane_search_string}' { send -X search-forward-incrementa" ascii
      $s35 = "arget-pane][-T title] [-w width] [-x position] [-y position] [shell-command]" fullword ascii
      $s36 = "bind -Tcopy-mode t { command-prompt -1p'(jump to forward)' { send -X jump-to-forward '%%' } }" fullword ascii
      $s37 = "%%subscription-changed %s $%u @%u %u - : %s" fullword ascii
      $s38 = "[-1bFkiN] [-I inputs] [-p prompts] [-t target-client] [-T type] [template]" fullword ascii
      $s39 = "%%subscription-changed %s $%u - - - : %s" fullword ascii
      $s40 = "bind -Tcopy-mode f { command-prompt -1p'(jump forward)' { send -X jump-forward '%%' } }" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 e7 01 00 00 00 00 00 40 00 00 00 00 00 00 00 a8 5b 10 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 48 c2 01 00 00 00 00 00 48 c2 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 d0 01 00 00 00 00 00 00 d0 01 00 00 00 00 00 00 d0 01 00 00 00 00 00 11 c5 09 00 00 00 00 00 11 c5 09 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 0b 00 00 00 00 00 00 a0 0b 00 00 00 00 00 00 a0 0b 00 00 00 00 00 9c 7b 03 00 00 00 00 00 9c 7b 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 1f 0f 00 00 00 00 00 10 2f 0f 00 00 00 00 00 10 2f 0f 00 00 00 00 00 50 3b 01 00 00 00 00 00 a0 b2 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 78 36 10 00 00 00 00 00 78 46 10 00 00 00 00 00 78 46 10 00 00 00 00 00 50 02 00 00 00 00 00 00 50 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 68 68 0d 00 00 00 00 00 68 68 0d 00 00 00 00 00 68 68 0d 00 00 00 00 00 dc 3b 00 00 00 00 00 00 dc 3b 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 1f 0f 00 00 00 00 00 10 2f 0f 00 00 00 00 00 10 2f 0f 00 00 00 00 00 f0 20 01 00 00 00 00 00 f0 20 01 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 a9 91 ce eb 88 57 ca 58 0e 0e 2d 07 ef de 91 12 1b 8f 56 cc 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 e3 00 00 00 01 00 00 00 06 00 00 00 74 09 a1 00 e0 01 50 12 e3 00 00 00 e7 00 00 00 ec 00 00 00 a6 dd a3 6b d0 65 ce 6d c4 89 05 90 29 1d 8c 1c e4 62 41 f5 c4 b9 9c 40 66 55 61 10 bc 50 76 9e 39 f2 8b 1c 87 e9 6a 18 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 3000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_msgmerge {
   strings:
      $s1 = "https://savannah.gnu.org/projects/gettext" fullword ascii
      $s2 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/gettext.debug" fullword ascii
      $s3 = "bug-gettext@gnu.org" fullword ascii
      $s4 = "Project-Id-VersiReport-Msgid-BugPOT-Creation-DatPO-Revision-DateLast-Translator:Content-Transfernsfer-Encoding:" fullword ascii
      $s5 = "Report bugs in the bug tracker at <%s>" fullword ascii
      $s6 = "License GPLv3+: GNU GPL version 3 or later <%s>" fullword ascii
      $s7 = "libgettextlib-0.22.5.so" fullword ascii
      $s8 = "libgettextsrc-0.22.5.so" fullword ascii
      $s9 = "      --lang=CATALOGNAME      set 'Language' field in the header entry" fullword ascii
      $s10 = "Content-H" fullword ascii
      $s11 = "      --suffix=SUFFIX         override the usual backup suffix" fullword ascii
      $s12 = "or by email to <%s>." fullword ascii
      $s13 = "handle_filepos_comment_option" fullword ascii
      $s14 = "last_component" fullword ascii
      $s15 = "message_print_style_comment" fullword ascii
      $s16 = "  -V, --version               output version information and exit" fullword ascii
      $s17 = "  -C, --compendium=FILE       additional library of message translations," fullword ascii
      $s18 = "  -m, --multi-domain          apply ref.pot to each of the domains in def.po" fullword ascii
      $s19 = "      --for-msgfmt            produce output for '%s', not for a translator" fullword ascii
      $s20 = "Languagef" fullword ascii
      $s21 = "error_message_count" fullword ascii /* Goodware String - occured 1 times */
      $s22 = "error_print_progname" fullword ascii /* Goodware String - occured 1 times */
      $s23 = "message_print_style_filepos" fullword ascii
      $s24 = "libtextstyle.so.0" fullword ascii
      $s25 = "--update" fullword ascii /* Goodware String - occured 1 times */
      $s26 = "--suffix" fullword ascii /* Goodware String - occured 1 times */
      $s27 = "I;\\$Hr" fullword ascii /* Goodware String - occured 1 times */
      $s28 = "GOMP_4.5" fullword ascii
      $s29 = "style_file_name" fullword ascii /* Goodware String - occured 1 times */
      $s30 = "GOMP_loop_nonmonotonic_dynamic_start" fullword ascii
      $s31 = "old translations, or a PO Template file (generally created by xgettext);" fullword ascii /* Goodware String - occured 1 times */
      $s32 = "The backup suffix is '~', unless set with --suffix or the SIMPLE_BACKUP_SUFFIX" fullword ascii /* Goodware String - occured 1 times */
      $s33 = "%s is only valid with %s" fullword ascii /* Goodware String - occured 1 times */
      $s34 = "libgomp.so.1" fullword ascii
      $s35 = "any translations or comments in the file will be discarded, however dot" fullword ascii /* Goodware String - occured 1 times */
      $s36 = "GOMP_4.0" fullword ascii
      $s37 = "C:D:eEFhimn:No:pPqsUvVw:" fullword ascii
      $s38 = "this message should not define plural forms" fullword ascii /* Goodware String - occured 1 times */
      $s39 = "GOMP_loop_nonmonotonic_dynamic_next" fullword ascii
      $s40 = "ersion:" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 c0 80 00 00 00 00 00 00 40 00 00 00 00 00 00 00 38 23 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f8 61 00 00 00 00 00 00 f8 61 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 a9 50 00 00 00 00 00 00 a9 50 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 78 2a 00 00 00 00 00 00 78 2a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 04 01 00 00 00 00 00 70 04 01 00 00 00 00 00 70 04 01 00 00 00 00 00 20 1d 00 00 00 00 00 00 10 1e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 f8 09 01 00 00 00 00 00 f8 09 01 00 00 00 00 00 f8 09 01 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 00 f6 00 00 00 00 00 00 00 f6 00 00 00 00 00 00 00 f6 00 00 00 00 00 00 ac 00 00 00 00 00 00 00 ac 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 04 01 00 00 00 00 00 70 04 01 00 00 00 00 00 70 04 01 00 00 00 00 00 90 0b 00 00 00 00 00 00 90 0b 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 0a 50 c9 c3 f3 66 c8 52 00 23 28 87 5c 65 e2 ee 87 38 01 89 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 73 00 00 00 02 00 00 00 07 00 00 00 e8 27 28 2d 12 00 9d 1a 11 08 31 10 10 02 38 19 73 00 00 00 74 00 00 00 75 00 00 00 76 00 00 00 78 00 00 00 79 00 00 00 00 00 00 00 7a 00 00 00 7b 00 00 00 7c 00 00 00 7d 00 00 00 7f 00 00 00 80 00 00 00 81 00 00 00 83 00 00 00 86 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_mtr {
   strings:
      $s1 = "command reply read failure" fullword ascii
      $s2 = "mtr-packet command pipe write failure" fullword ascii
      $s3 = "%s.origin.asn.cymru.com" fullword ascii
      $s4 = "%s.origin6.asn.cymru.com" fullword ascii
      $s5 = "Failed to resolve host: %s: %s" fullword ascii
      $s6 = " -P, --port PORT            target port number for TCP, SCTP, or UDP" fullword ascii
      $s7 = "value out of range (%d - %d): %s" fullword ascii
      $s8 = "couldn't write to resolver process" fullword ascii
      $s9 = "value %d out of range (0 - 4)" fullword ascii
      $s10 = "getifaddrs failure" fullword ascii
      $s11 = "David Stone <stone@AsIf.com>" fullword ascii
      $s12 = "json_dumpf" fullword ascii
      $s13 = "Marc Bejarano <marc.bejarano@openwave.com>" fullword ascii
      $s14 = "Matt Kimball <matt.kimball@gmail.com>" fullword ascii
      $s15 = "can't make a pipe for DNS process" fullword ascii
      $s16 = "Russell Nelson <rn-mtr@crynwr.com>" fullword ascii
      $s17 = "Philip Kizer <pckizer@nostrum.com>" fullword ascii
      $s18 = "Bill Bogstad <bogstad@pobox.com> " fullword ascii
      $s19 = "Robert Sparks <rjsparks@nostrum.com>" fullword ascii
      $s20 = "Mike Simons <msimons@moria.simons-clan.com>" fullword ascii
      $s21 = "Steve Kann <stevek@spheara.horizonlive.com>" fullword ascii
      $s22 = "Travis Cross <tc@traviscross.com>" fullword ascii
      $s23 = "F_GETFL failure" fullword ascii
      $s24 = "Mtr_Version,Start_Time,Status,Host,Hop,Ip," fullword ascii
      $s25 = "Failed to resolve host: %s" fullword ascii
      $s26 = " -B, --bitpattern NUMBER    set bit pattern to use in payload" fullword ascii
      $s27 = "UNKNOWNHOST" fullword ascii
      $s28 = "no route to host" fullword ascii
      $s29 = "aslookup" fullword ascii
      $s30 = "dns_ack: Couldn't find host %s" fullword ascii
      $s31 = " -F, --filename FILE        read hostname(s) from a file" fullword ascii
      $s32 = "can't fork for DNS process" fullword ascii
      $s33 = "non-root users cannot request an interval < 1.0 seconds" fullword ascii
      $s34 = " -c, --report-cycles COUNT  set the number of pings sent" fullword ascii
      $s35 = " -Q, --tos NUMBER           type of service field in IP header" fullword ascii
      $s36 = "G G G > G > G < ( * 7.> > > > > J ^ K G G > + D 7.7.7.7 N ( < 7.7.7.G G ) B * < G 7.G 7.G 7.7.G " fullword ascii
      $s37 = "G 7.G G G G G 7.G < z  . .* k 1.G G G G G G 0.K x 7.7.7.7.7.< J Y D M D ) 7.7.7.7.7.7.< 7.7.7.7." fullword ascii
      $s38 = "Rob Foehl <rwf@loonybin.net>" fullword ascii
      $s39 = "Brett Johnson <brett@jdacareers.com>" fullword ascii
      $s40 = "Josh Martin <jmartin@columbiaservices.net>" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 72 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 b0 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 98 57 00 00 00 00 00 00 98 57 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 09 b5 00 00 00 00 00 00 09 b5 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 01 00 00 00 00 00 00 20 01 00 00 00 00 00 00 20 01 00 00 00 00 00 50 62 00 00 00 00 00 00 50 62 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 8e 01 00 00 00 00 00 70 9e 01 00 00 00 00 00 70 9e 01 00 00 00 00 00 30 20 00 00 00 00 00 00 a8 99 28 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 40 97 01 00 00 00 00 00 40 a7 01 00 00 00 00 00 40 a7 01 00 00 00 00 00 70 02 00 00 00 00 00 00 70 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 64 65 01 00 00 00 00 00 64 65 01 00 00 00 00 00 64 65 01 00 00 00 00 00 84 04 00 00 00 00 00 00 84 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 8e 01 00 00 00 00 00 70 9e 01 00 00 00 00 00 70 9e 01 00 00 00 00 00 90 11 00 00 00 00 00 00 90 11 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 4e 44 f7 f5 ff f1 e8 6b 6a 5d 8a ac 8d cc cd 24 79 9c cc ae 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 c4 00 00 00 01 00 00 00 06 00 00 00 88 45 a1 01 80 81 1c 0a c4 00 00 00 c8 00 00 00 cc 00 00 00 28 1d 8c 1c 42 45 d5 ec d0 65 ce 6d bb e3 92 7c 66 55 61 10 d8 2b 8c 1c 38 f2 8b 1c d9 71 58 1c b2 a2 f7 12 33 c4 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 300KB and
      8 of them and $magic
}

rule gtfobins_binaries_smbclient {
   strings:
      $s1 = "Execute semicolon separated commands" fullword ascii
      $s2 = "samba_cmdline_get_creds" fullword ascii
      $s3 = "cli_credentials_get_password_obtained" fullword ascii
      $s4 = "system command '%s' returned -1" fullword ascii
      $s5 = "system() command %s failed." fullword ascii
      $s6 = "run a shell command on the local system" fullword ascii
      $s7 = "<domain> <user> <password> start up transport encryption" fullword ascii
      $s8 = "samba_cmdline_set_creds" fullword ascii
      $s9 = "cli_credentials_get_smb_encryption" fullword ascii
      $s10 = "tar: dumped %lu files and %lu directories" fullword ascii
      $s11 = "display_finfo() failed to get security descriptor: %s" fullword ascii
      $s12 = "tar_process failed" fullword ascii
      $s13 = "failed to open secrets.tdb to obtain our trust credentials for %s" fullword ascii
      $s14 = "getfacl file %s, unknown POSIX acl version %u." fullword ascii
      $s15 = "samba_cmdline_get_daemon_cfg" fullword ascii
      $s16 = "posix_encrypt domain user password" fullword ascii
      $s17 = "DUMP:t->path_list @ %p (%d elem)" fullword ascii
      $s18 = "samba_cmdline_get_lp_ctx" fullword ascii
      $s19 = "samba_cmdline_get_popt" fullword ascii
      $s20 = "DUMP: t->path_list[%2d] = %s" fullword ascii
      $s21 = "timeout <number> - set the per-operation timeout in seconds (default 20)" fullword ascii
      $s22 = "Get a list of shares available on a host" fullword ascii
      $s23 = "timeout <n> (per-operation timeout in seconds - currently %u)." fullword ascii
      $s24 = "cli_credentials_set_password" fullword ascii
      $s25 = "cli_credentials_get_username" fullword ascii
      $s26 = "failed to create temporary file for more" fullword ascii
      $s27 = "SAMBA_HOSTCONFIG_0.0.1" fullword ascii
      $s28 = "Error closing remote file %s: %s" fullword ascii
      $s29 = "Error setting attributes on remote file %s: %s" fullword ascii
      $s30 = "Error writing remote file %s: %s" fullword ascii
      $s31 = "Error opening remote file %s: %s" fullword ascii
      $s32 = "samba_cmdline_set_machine_account_fn" fullword ascii
      $s33 = "%s is an IPv6 address -- no workgroup available" fullword ascii
      $s34 = "tar_process" fullword ascii
      $s35 = "tar_to_process" fullword ascii
      $s36 = "Failed to init cmdline parser!" fullword ascii
      $s37 = "tar_process do_list with mask: %s" fullword ascii
      $s38 = "cli_session_creds_init() failed." fullword ascii
      $s39 = "cli_credentials_set_machine_account_db_ctx failed: %s" fullword ascii
      $s40 = "tar_process done, err = %d" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 aa 00 00 00 00 00 00 40 00 00 00 00 00 00 00 20 52 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 7b 00 00 00 00 00 00 40 7b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 d9 1d 01 00 00 00 00 00 d9 1d 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 01 00 00 00 00 00 00 a0 01 00 00 00 00 00 00 a0 01 00 00 00 00 00 d4 89 00 00 00 00 00 00 d4 89 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 37 02 00 00 00 00 00 30 37 02 00 00 00 00 00 30 37 02 00 00 00 00 00 48 19 00 00 00 00 00 00 08 1b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a0 42 02 00 00 00 00 00 a0 42 02 00 00 00 00 00 a0 42 02 00 00 00 00 00 60 03 00 00 00 00 00 00 60 03 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 f4 04 02 00 00 00 00 00 f4 04 02 00 00 00 00 00 f4 04 02 00 00 00 00 00 4c 04 00 00 00 00 00 00 4c 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 37 02 00 00 00 00 00 30 37 02 00 00 00 00 00 30 37 02 00 00 00 00 00 d0 18 00 00 00 00 00 00 d0 18 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 ca 4d 16 2b 31 68 2b f5 fe c5 d1 5c 8f fb c9 bd fc af 81 bb 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 39 01 00 00 04 00 00 00 08 00 00 00 44 10 10 00 14 02 04 04 28 3e 2d a0 40 86 45 81 00 8c 00 06 18 25 61 0a 00 40 81 05 20 00 0a c2 39 01 00 00 3a 01 00 00 3c 01 00 00 3d 01 00 00 3f 01 00 00 42 01 00 00 44 01 00 00 48 01 00 00 4b 01 00 00 4d 01 00 00 4e 01 00 00 50 01 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_openssl {
   strings:
      $x1 = "%s:%s:%d:CMP %s: failed to load ir/cr/kur file '%s' attempting to get fallback public key%s%s" fullword ascii
      $x2 = "%s:%s:%d:CMP %s: no cmp command to execute%s%s%s" fullword ascii
      $x3 = "%s:%s:%d:CMP %s: server credentials (-srv_secret or -srv_cert) must be given if -use_mock_srv or -port is used%s%s%s" fullword ascii
      $x4 = "%s:%s:%d:CMP %s: failed to get fallback public key from ir/cr/kur file '%s'%s%s" fullword ascii
      $x5 = "%s:%s:%d:CMP %s: failed to get fallback public key obtained from ir/cr/kur file '%s'%s%s" fullword ascii
      $s6 = "%s:%s:%d:CMP %s: no -newkey option given with private key for POPO, -csr option provides just public key%s%s%s" fullword ascii
      $s7 = "%s:%s:%d:CMP %s: -oldcert option is ignored for 'genm' command%s%s%s" fullword ascii
      $s8 = "%s:%s:%d:CMP %s: Ignoring -serial for command other than 'rr'%s%s%s" fullword ascii
      $s9 = "%s:%s:%d:CMP %s: -infotype option is ignored for commands other than 'genm'%s%s%s" fullword ascii
      $s10 = "%s:%s:%d:CMP %s: Ignoring -oldcert since -issuer and -serial is given for command 'rr'%s%s%s" fullword ascii
      $s11 = "%s:%s:%d:CMP %s: -failurebits overrides -failure%s%s%s" fullword ascii
      $s12 = "%s:%s:%d:CMP %s: -csr option is ignored for 'genm' command%s%s%s" fullword ascii
      $s13 = "%s:%s:%d:CMP %s: Ignoring -csr since -issuer and -serial is given for command 'rr'%s%s%s" fullword ascii
      $s14 = "%s:%s:%d:CMP %s: -cert and -key not used for protection since -secret is given%s%s%s" fullword ascii
      $s15 = "%s:%s:%d:CMP %s: -newkeypass %s%s%s" fullword ascii
      $s16 = "%s:%s:%d:CMP %s: missing -newkey (or -key) to be certified and no -csr, -oldcert, -cert, or -reqin option given, which could pro" ascii
      $s17 = "%s:%s:%d:CMP %s: must give -key or -secret unless -unprotected_requests is used%s%s%s" fullword ascii
      $s18 = "ERROR PROCESSING COMMAND. REST OF LINE IGNORED: %s" fullword ascii
      $s19 = "Error getting private key password" fullword ascii
      $s20 = "Use specified hex-encoded key to decrypt/encrypt recipients or content" fullword ascii
      $s21 = "%s:%s:%d:CMP %s: unknown cmp command '%s'%s%s" fullword ascii
      $s22 = "%s:%s:%d:CMP %s: Failed to add ITAV for geninfo of the PKI message header%s%s%s" fullword ascii
      $s23 = "Key to decrypt the private key or cert files if encrypted. Better use -passin" fullword ascii
      $s24 = "%s: -proxy requires use of -connect or target parameter" fullword ascii
      $s25 = "%s:%s:%d:CMP %s: must give both -cert and -key options or neither%s%s%s" fullword ascii
      $s26 = "%s:%s:%d:CMP %s: missing -tls_key option%s%s%s" fullword ascii
      $s27 = "%s:%s:%d:CMP %s: -tls_used option not supported with -port option%s%s%s" fullword ascii
      $s28 = "%s:%s:%d:CMP %s: -failure out of range, should be >= 0 and <= %d%s%s" fullword ascii
      $s29 = "%s:%s:%d:CMP %s: ignoring -proxy option since -server is not given%s%s%s" fullword ascii
      $s30 = "%s:%s:%d:CMP %s: The -port option does not support -rspin and -rspout%s%s%s" fullword ascii
      $s31 = "%s:%s:%d:CMP %s: missing -newkey (or -key) option for key to be certified and for POPO%s%s%s" fullword ascii
      $s32 = "%s:%s:%d:CMP %s: cannot set up error reporting and logging for %s%s%s" fullword ascii
      $s33 = "%s:%s:%d:CMP %s: -newkey %s%s%s" fullword ascii
      $s34 = "%s:%s:%d:CMP %s: -failurebits out of range%s%s%s" fullword ascii
      $s35 = "%s:%s:%d:CMP %s: No specific support for -infotype %s available%s%s" fullword ascii
      $s36 = "%s:%s:%d:CMP %s: The -port option does not support -reqin and -reqout%s%s%s" fullword ascii
      $s37 = "%s:%s:%d:CMP %s: Failed to create genm for -infotype %s%s%s" fullword ascii
      $s38 = "%s:%s:%d:CMP %s: server will not be able to handle PBM-protected requests since -srv_secret is not given%s%s%s" fullword ascii
      $s39 = "%s:%s:%d:CMP %s: ignoring -no_proxy option since -server is not given%s%s%s" fullword ascii
      $s40 = "%s:%s:%d:CMP %s: The -port option excludes -server and -use_mock_srv%s%s%s" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 49 04 00 00 00 00 00 40 00 00 00 00 00 00 00 68 fe 0f 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e0 d8 03 00 00 00 00 00 e0 d8 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 e0 03 00 00 00 00 00 00 e0 03 00 00 00 00 00 00 e0 03 00 00 00 00 00 c1 44 07 00 00 00 00 00 c1 44 07 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 0b 00 00 00 00 00 00 30 0b 00 00 00 00 00 00 30 0b 00 00 00 00 00 38 1f 03 00 00 00 00 00 38 1f 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 57 0e 00 00 00 00 00 30 57 0e 00 00 00 00 00 30 57 0e 00 00 00 00 00 f0 a5 01 00 00 00 00 00 48 dc 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 10 4a 0f 00 00 00 00 00 10 4a 0f 00 00 00 00 00 10 4a 0f 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 40 a0 0d 00 00 00 00 00 40 a0 0d 00 00 00 00 00 40 a0 0d 00 00 00 00 00 6c 12 00 00 00 00 00 00 6c 12 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 57 0e 00 00 00 00 00 30 57 0e 00 00 00 00 00 30 57 0e 00 00 00 00 00 d0 28 01 00 00 00 00 00 d0 28 01 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 c5 ac 76 89 1a 99 7f 4b 46 05 18 4a 16 aa fc 0a a8 79 73 e3 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 57 06 00 00 04 00 00 00 08 00 00 00 02 81 4c 21 58 89 00 25 60 1a 30 62 c3 60 58 10 80 42 80 10 44 00 00 00 00 41 01 90 a2 50 22 00 00 00 00 00 57 06 00 00 5b 06 00 00 5e 06 00 00 60 06 00 00 61 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 63 06 00 00 66 06 00 00 67 06 00 00}
condition:
      filesize < 3000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_sash {
   strings:
      $s1 = "Execute another program in place of this sash process" fullword ascii
      $s2 = "e != EDEADLK || (kind != PTHREAD_MUTEX_ERRORCHECK_NP && kind != PTHREAD_MUTEX_RECURSIVE_NP)" fullword ascii
      $s3 = "Usage: sash [-a] [-q] [-f fileName] [-c command] [-p prompt] [-i] [script]" fullword ascii
      $s4 = "%s: IFUNC symbol '%s' referenced in '%s' is defined in the executable and creates an unsatisfiable circular dependency." fullword ascii
      $s5 = "cy == 0 || p.tmp[p.tmpsize - 1] < 20" fullword ascii
      $s6 = "__pthread_mutex_unlock_usercnt" fullword ascii
      $s7 = "type == PTHREAD_MUTEX_ERRORCHECK_NP" fullword ascii
      $s8 = "glibc.pthread.mutex_spin_count" fullword ascii
      $s9 = "PTHREAD_MUTEX_TYPE (mutex) == PTHREAD_MUTEX_ERRORCHECK_NP" fullword ascii
      $s10 = "?33333333" fullword ascii /* reversed goodware string '33333333?' */ /* hex encoded string '3333' */
      $s11 = "getsecretkey" fullword ascii
      $s12 = "getpublickey" fullword ascii
      $s13 = "Unexpected error %d on netlink descriptor %d (address family %d)." fullword ascii
      $s14 = "pthread_mutex_unlock.c" fullword ascii
      $s15 = "pthread_mutex_lock.c" fullword ascii
      $s16 = "glibc.cpu.prefer_map_32bit_exec" fullword ascii
      $s17 = "___pthread_mutex_lock" fullword ascii
      $s18 = "Stand-alone shell (version %s)" fullword ascii
      $s19 = "relocation processing: %s%s" fullword ascii
      $s20 = "__pthread_mutex_lock_full" fullword ascii
      $s21 = "%s: Short read - zero filling" fullword ascii
      $s22 = "%s: line %d: bad command `%s'" fullword ascii
      $s23 = "glibc.cpu.x86_non_temporal_threshold" fullword ascii
      $s24 = "Usage: sash [-a] [-q] [-f fileName] [-c command] [-p prompt] [-i]" fullword ascii
      $s25 = "EHWPOISON" fullword ascii
      $s26 = "Unexpected error %d on netlink descriptor %d." fullword ascii
      $s27 = "Unexpected netlink response of size %zd on descriptor %d (address family %d)" fullword ascii
      $s28 = "cy == 1 || (p.frac[p.fracsize - 2] == 0 && p.frac[0] == 0)" fullword ascii
      $s29 = "Error starting command: %s" fullword ascii
      $s30 = "Error reading archive header: %s" fullword ascii
      $s31 = "__nss_database_fork_subprocess" fullword ascii
      $s32 = "glibc.pthread.stack_hugetlb" fullword ascii
      $s33 = "Bad read command" fullword ascii
      $s34 = "Error reading member header: %s" fullword ascii
      $s35 = "mutex->__data.__owner == 0" fullword ascii
      $s36 = "Send a signal to the specified process" fullword ascii
      $s37 = "Read commands from the specified file" fullword ascii
      $s38 = "*** %s ***: terminated" fullword ascii
      $s39 = "dig_no > int_no && exponent <= 0 && exponent >= MIN_10_EXP - (DIG + 2)" fullword ascii
      $s40 = "Reading command line" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 02 00 3e 00 01 00 00 00 80 28 40 00 00 00 00 00 40 00 00 00 00 00 00 00 78 0c 12 00 00 00 00 00 00 00 00 00 40 00 38 00 0a 00 40 00 18 00 17 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 c0 05 00 00 00 00 00 00 c0 05 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 40 00 00 00 00 00 00 10 40 00 00 00 00 00 ed 7e 0d 00 00 00 00 00 ed 7e 0d 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 90 0d 00 00 00 00 00 00 90 4d 00 00 00 00 00 00 90 4d 00 00 00 00 00 bd 00 04 00 00 00 00 00 bd 00 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 c8 9d 11 00 00 00 00 00 c8 ad 51 00 00 00 00 00 c8 ad 51 00 00 00 00 00 94 6d 00 00 00 00 00 00 40 e9 00 00 00 00 00 00 00 10 00 00 00 00 00 00 04 00 00 00 04 00 00 00 70 02 00 00 00 00 00 00 70 02 40 00 00 00 00 00 70 02 40 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 90 02 00 00 00 00 00 00 90 02 40 00 00 00 00 00 90 02 40 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 c8 9d 11 00 00 00 00 00 c8 ad 51 00 00 00 00 00 c8 ad 51 00 00 00 00 00 20 00 00 00 00 00 00 00 6c 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 70 02 00 00 00 00 00 00 70 02 40 00 00 00 00 00 70 02 40 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 c8 9d 11 00 00 00 00 00 c8 ad 51 00 00 00 00 00 c8 ad 51 00 00 00 00 00 38 52 00 00 00 00 00 00 38 52 00 00 00 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 95 c8 90 fe 5a 34 9e 81 f1 bf 23 df 14 2b b5 47 4d f5 9c 01 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 f0 00 52 00 00 00 00 00 25 00 00 00 00 00 00 00 d0 09 4c 00 00 00 00 00 e8 00 52 00 00 00 00 00 25 00 00 00 00 00 00 00 60 ed 43 00 00 00 00 00 e0 00 52 00 00 00 00 00 25 00 00 00 00 00 00 00 a0 f0 43 00 00 00 00 00 d8 00 52 00 00 00 00 00 25 00 00 00 00 00 00 00 00 14 4b 00 00 00 00 00 d0 00 52 00 00 00 00 00 25 00 00 00 00 00 00 00 90 ec 43 00 00 00 00 00 c8 00 52 00 00 00 00 00 25 00 00 00 00 00 00 00 50 53 49 00 00 00 00 00 c0 00 52 00 00 00 00 00 25 00 00 00 00 00 00 00 30 53 49 00 00 00 00 00 b8 00 52 00 00 00 00 00 25 00 00 00 00 00 00 00 40 ea 43 00 00 00 00 00 b0 00 52 00 00 00 00 00 25 00 00 00 00 00 00 00 40 bc 49 00 00 00 00 00 a8 00 52 00 00 00 00 00 25 00 00 00 00 00 00 00 40 ee 43 00 00 00 00 00 a0 00 52 00 00 00 00 00 25 00 00 00 00 00 00 00 d0 b8 49 00 00 00 00 00 98 00 52 00 00 00 00 00 25 00 00 00 00 00 00 00 40 eb 43 00 00 00 00 00 90 00 52 00 00 00 00 00}
condition:
      filesize < 3000KB and
      8 of them and $magic
}

rule gtfobins_binaries_yash {
   strings:
      $s1 = "replace the shell process with an external command" fullword ascii
      $s2 = "execute or identify a command" fullword ascii
      $s3 = "read a file and execute commands" fullword ascii
      $s4 = "list or re-execute command history" fullword ascii
      $s5 = "cannot execute command `%s' (%s)" fullword ascii
      $s6 = "cannot execute command `%s'" fullword ascii
      $s7 = "  Use the -f option to exec anyway." fullword ascii
      $s8 = "the -c option is specified but no command is given" fullword ascii
      $s9 = "user processes" fullword ascii
      $s10 = "unclosed process redirection" fullword ascii
      $s11 = "cannot invoke a new shell to execute script `%s'" fullword ascii
      $s12 = "this command requires an operand" fullword ascii
      $s13 = "bindkey -aev [key_sequence [command]]" fullword ascii
      $s14 = "bindkey -%c -- %ls %s" fullword ascii
      $s15 = "hash -r [command...]" fullword ascii
      $s16 = "failed to remove temporary file `%s'" fullword ascii
      $s17 = "print usage of built-in commands" fullword ascii
      $s18 = "this command requires %zu operands" fullword ascii
      $s19 = "send a signal to processes" fullword ascii
      $s20 = "the backquoted command substitution is not closed" fullword ascii
      $s21 = "identify a command" fullword ascii
      $s22 = "here-document content for %s%ls is missing" fullword ascii
      $s23 = "alias -g -- %ls=%ls" fullword ascii
      $s24 = "the redirection target is missing" fullword ascii
      $s25 = "redirection: %d>>|%d: the input and output file descriptors are same" fullword ascii
      $s26 = "process redirection is not supported in the POSIXly-correct mode" fullword ascii
      $s27 = "executing file \"%s\" (autoload)" fullword ascii
      $s28 = "command `%s' was not found in $PATH" fullword ascii
      $s29 = "exec [-cf] [-a name] [command [argument...]]" fullword ascii
      $s30 = "finished executing file \"%s\"" fullword ascii
      $s31 = "finished executing completion function \"%ls\"" fullword ascii
      $s32 = "The process was killed by SIG%ls: %s" fullword ascii
      $s33 = "hash -d  # print remembered paths" fullword ascii
      $s34 = "%ls: a shell keyword" fullword ascii
      $s35 = "no such command `%s'" fullword ascii
      $s36 = "executing completion function \"%ls\"" fullword ascii
      $s37 = "%s [option...] -c command [command_name [argument...]]" fullword ascii
      $s38 = "Yet another shell, version %s" fullword ascii
      $s39 = "%s: an external command at %s" fullword ascii
      $s40 = "bindkey" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 b4 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 89 06 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d0 9f 00 00 00 00 00 00 d0 9f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 f1 2b 04 00 00 00 00 00 f1 2b 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 d0 04 00 00 00 00 00 00 d0 04 00 00 00 00 00 00 d0 04 00 00 00 00 00 d8 63 01 00 00 00 00 00 d8 63 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 3d 06 00 00 00 00 00 10 4d 06 00 00 00 00 00 10 4d 06 00 00 00 00 00 61 4b 00 00 00 00 00 00 90 5c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a0 7d 06 00 00 00 00 00 a0 8d 06 00 00 00 00 00 a0 8d 06 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 ac 77 05 00 00 00 00 00 ac 77 05 00 00 00 00 00 ac 77 05 00 00 00 00 00 2c 1a 00 00 00 00 00 00 2c 1a 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 3d 06 00 00 00 00 00 10 4d 06 00 00 00 00 00 10 4d 06 00 00 00 00 00 f0 42 00 00 00 00 00 00 f0 42 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 14 f1 e4 7c dd 65 b5 50 04 3f 21 67 56 ff f2 1c 48 4c db 62 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 bb 00 00 00 01 00 00 00 06 00 00 00 f6 21 81 42 c8 01 50 02 bb 00 00 00 be 00 00 00 c3 00 00 00 a6 dd a3 6b d0 65 ce 6d 29 1d 8c 1c c4 b9 9c 40 86 f0 96 7c 38 f2 8b 1c 8c 60 e2 0f 81 19 9e 7c 62 21 05 c0 5e 96 93 1c 87 e9 6a 18 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 1000KB and
      8 of them and $magic
}

rule gtfobins_binaries_scanmem {
   strings:
      $s1 = "set the target process pid" fullword ascii
      $s2 = "Enter the pid of the process to search using the \"pid\" command." fullword ascii
      $s3 = "See https://github.com/scanmem/scanmem/blob/master/AUTHORS for a full author list" fullword ascii
      $s4 = "Report bugs to <https://github.com/scanmem/scanmem>." fullword ascii
      $s5 = "sm_execcommand" fullword ascii
      $s6 = "-c, --command" fullword ascii
      $s7 = "failed to read in a command." fullword ascii
      $s8 = "Interactively locate and modify variables in an executing process." fullword ascii
      $s9 = "getcommand" fullword ascii
      $s10 = "run given commands (separated by `;`)" fullword ascii
      $s11 = "Please enter current value, or \"help\" for other commands." fullword ascii
      $s12 = "Enter \"help\" for other commands." fullword ascii
      $s13 = "-v, --version" fullword ascii
      $s14 = "scanmem" fullword ascii
      $s15 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/scanmem.debug" fullword ascii
      $s16 = "scanmem version %s" fullword ascii
      $s17 = "Run scanmem as root if memory regions are missing. See scanmem man page." fullword ascii
      $s18 = "Copyright (C) 2006-2017 Scanmem authors" fullword ascii
      $s19 = "scanmem comes with ABSOLUTELY NO WARRANTY; for details type `show warranty'." fullword ascii
      $s20 = "show_error" fullword ascii
      $s21 = "show_user" fullword ascii
      $s22 = "sm_printversion" fullword ascii
      $s23 = "Usage: scanmem [OPTION]... [PID]" fullword ascii
      $s24 = "/usr/lib/scanmem" fullword ascii
      $s25 = "libscanmem.so.1" fullword ascii
      $s26 = "scanmem is an interactive debugging utility, enter `help` at the prompt" fullword ascii
      $s27 = "-p, --pid=pid" fullword ascii
      $s28 = "for further assistance." fullword ascii /* Goodware String - occured 1 times */
      $s29 = "show_warn" fullword ascii
      $s30 = "vars != NULL" fullword ascii
      $s31 = "print version information" fullword ascii /* Goodware String - occured 1 times */
      $s32 = "e00f763c2ea88c3219d00d877d9a41b17c3702.debug" fullword ascii
      $s33 = "sm_cleanup" fullword ascii
      $s34 = "-h, --help" fullword ascii /* Goodware String - occured 1 times */
      $s35 = "invalid pid specified." fullword ascii
      $s36 = "vhdep:c:" fullword ascii
      $s37 = "print this message" fullword ascii /* Goodware String - occured 1 times */
      $s38 = "sm_globals" fullword ascii
      $s39 = "under certain conditions; type `show copying' for details." fullword ascii
      $s40 = "sorry, there was a memory allocation error." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 16 00 00 00 00 00 00 40 00 00 00 00 00 00 00 a8 31 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 0e 00 00 00 00 00 00 20 0e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 c9 0a 00 00 00 00 00 00 c9 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 b4 07 00 00 00 00 00 00 b4 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 2c 00 00 00 00 00 00 d0 3c 00 00 00 00 00 00 d0 3c 00 00 00 00 00 00 40 03 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 2c 00 00 00 00 00 00 e0 3c 00 00 00 00 00 00 e0 3c 00 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 84 25 00 00 00 00 00 00 84 25 00 00 00 00 00 00 84 25 00 00 00 00 00 00 5c 00 00 00 00 00 00 00 5c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 2c 00 00 00 00 00 00 d0 3c 00 00 00 00 00 00 d0 3c 00 00 00 00 00 00 30 03 00 00 00 00 00 00 30 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 d6 e0 0f 76 3c 2e a8 8c 32 19 d0 0d 87 7d 9a 41 b1 7c 37 02 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 1d 00 00 00 01 00 00 00 06 00 00 00 02 07 81 40 40 41 1c 02 1d 00 00 00 20 00 00 00 23 00 00 00 28 1d 8c 1c a8 cb 82 48 d1 65 ce 6d 68 20 4f 47 9e 52 e5 0c 39 f2 8b 1c 32 c4 f7 12 b2 a2 f7 12 67 b2 99 e2 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 40KB and
      8 of them and $magic
}

rule gtfobins_binaries_watch {
   strings:
      $s1 = "  -x, --exec             pass command to exec instead of \"sh -c\"" fullword ascii
      $s2 = "  -p, --precise          attempt run command in precise intervals" fullword ascii
      $s3 = "unable to fork process" fullword ascii
      $s4 = "unable to execute '%s'" fullword ascii
      $s5 = "command exit with a non-zero status, press a key to exit" fullword ascii
      $s6 = " %s [options] command" fullword ascii
      $s7 = "  -g, --chgexit          exit when output from command changes" fullword ascii
      $s8 = " -v, --version  output version information and exit" fullword ascii
      $s9 = "  -b, --beep             beep if command has a non-zero exit" fullword ascii
      $s10 = "  -e, --errexit          exit if command has a non-zero exit" fullword ascii
      $s11 = "unable to create IPC pipes" fullword ascii
      $s12 = "                         exit when output from command does not change" fullword ascii
      $s13 = "failed to parse argument" fullword ascii
      $s14 = "unicode handling error" fullword ascii
      $s15 = "chgexit" fullword ascii
      $s16 = "  -n, --interval <secs>  seconds to wait between updates" fullword ascii
      $s17 = "equexit" fullword ascii
      $s18 = "  -t, --no-title         turn off header" fullword ascii
      $s19 = "  -q, --equexit <cycles>" fullword ascii
      $s20 = "  -d, --differences[=<permanent>]" fullword ascii
      $s21 = "unicode handling error (malloc)" fullword ascii
      $s22 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/procps.debug" fullword ascii
      $s23 = "  -r, --no-rerun         do not rerun program on window resize" fullword ascii
      $s24 = "stdscr" fullword ascii
      $s25 = "dup2 failed" fullword ascii /* Goodware String - occured 1 times */
      $s26 = "NCURSESW6_5.3.20021019" fullword ascii
      $s27 = "libncursesw.so.6" fullword ascii
      $s28 = "NCURSESW6_5.1.20000708" fullword ascii
      $s29 = "COLUMNS=%ld" fullword ascii
      $s30 = "Could not parse interval from WATCH_INTERVAL" fullword ascii
      $s31 = "waddnwstr" fullword ascii /* Goodware String - occured 1 times */
      $s32 = "WATCH_INTERVAL" fullword ascii
      $s33 = "LINES=%ld" fullword ascii
      $s34 = "Every %.1fs: " fullword ascii
      $s35 = "COLOR_PAIRS" fullword ascii
      $s36 = "procps-ng 4.0.4" fullword ascii
      $s37 = "procps-ng" fullword ascii
      $s38 = "+bCced::ghq:n:prtwvx" fullword ascii
      $s39 = "differences" fullword ascii /* Goodware String - occured 1 times */
      $s40 = "watch(1)" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 3e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 73 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d8 1c 00 00 00 00 00 00 d8 1c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 69 2a 00 00 00 00 00 00 69 2a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 e8 0b 00 00 00 00 00 00 e8 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 40 6b 00 00 00 00 00 00 40 6b 00 00 00 00 00 00 40 6b 00 00 00 00 00 00 00 07 00 00 00 00 00 00 e0 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 50 6b 00 00 00 00 00 00 50 6b 00 00 00 00 00 00 50 6b 00 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c0 58 00 00 00 00 00 00 c0 58 00 00 00 00 00 00 c0 58 00 00 00 00 00 00 8c 00 00 00 00 00 00 00 8c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 40 6b 00 00 00 00 00 00 40 6b 00 00 00 00 00 00 40 6b 00 00 00 00 00 00 c0 04 00 00 00 00 00 00 c0 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 ed 76 b9 b6 f3 3e 57 5a 40 15 32 3f 18 1e 6c 1d c5 48 81 1d 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 51 00 00 00 02 00 00 00 07 00 00 00 22 01 40 00 12 01 0c 16 24 48 81 03 a0 24 80 10 51 00 00 00 54 00 00 00 5c 00 00 00 28 1d 8c 1c c2 56 c0 1a d1 65 ce 6d bc 50 76 9e 66 55 61 10 d8 2b 8c 1c 76 3e e9 a9 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12}
condition:
      filesize < 90KB and
      8 of them and $magic
}

rule gtfobins_binaries_rev {
   strings:
      $s1 = "Usage: %s [options] [file ...]" fullword ascii
      $s2 = "Reverse lines characterwise." fullword ascii
      $s3 = "239c3081b3648ee874008939694013220e0375.debug" fullword ascii
      $s4 = "%s: %ju" fullword ascii
      $s5 = "%-16s%s" fullword ascii /* Goodware String - occured 3 times */
      $s6 = "239c3081b3648ee874008939694013220e0375" ascii
      $s7 = "8939694013220e0375" ascii
      $s8 = "239c3081b3648ee874" ascii
      $s9 = "rev(1)" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 3e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 73 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d8 1c 00 00 00 00 00 00 d8 1c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 69 2a 00 00 00 00 00 00 69 2a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 e8 0b 00 00 00 00 00 00 e8 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 40 6b 00 00 00 00 00 00 40 6b 00 00 00 00 00 00 40 6b 00 00 00 00 00 00 00 07 00 00 00 00 00 00 e0 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 50 6b 00 00 00 00 00 00 50 6b 00 00 00 00 00 00 50 6b 00 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c0 58 00 00 00 00 00 00 c0 58 00 00 00 00 00 00 c0 58 00 00 00 00 00 00 8c 00 00 00 00 00 00 00 8c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 40 6b 00 00 00 00 00 00 40 6b 00 00 00 00 00 00 40 6b 00 00 00 00 00 00 c0 04 00 00 00 00 00 00 c0 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 ed 76 b9 b6 f3 3e 57 5a 40 15 32 3f 18 1e 6c 1d c5 48 81 1d 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 51 00 00 00 02 00 00 00 07 00 00 00 22 01 40 00 12 01 0c 16 24 48 81 03 a0 24 80 10 51 00 00 00 54 00 00 00 5c 00 00 00 28 1d 8c 1c c2 56 c0 1a d1 65 ce 6d bc 50 76 9e 66 55 61 10 d8 2b 8c 1c 76 3e e9 a9 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12}
condition:
      filesize < 40KB and
      all of them
}

rule gtfobins_binaries_as {
   strings:
      $s1 = "  -f                      skip whitespace and comment preprocessing" fullword ascii
      $s2 = "symbol type \"%s\" is not supported by MIPS targets" fullword ascii
      $s3 = "symbol type \"%s\" is supported only by GNU targets" fullword ascii
      $s4 = "symbol type \"%s\" is supported only by GNU and FreeBSD targets" fullword ascii
      $s5 = "SCFI: forward pass failed for func '%s'" fullword ascii
      $s6 = "invalid attempt to declare external version name as default in symbol `%s'" fullword ascii
      $s7 = ".cfi_personality_id is not supported for this target" fullword ascii
      $s8 = ".cfi_inline_lsda is not supported for this target" fullword ascii
      $s9 = ".sframe not supported for target" fullword ascii
      $s10 = "%s section is supported only by GNU and FreeBSD targets" fullword ascii
      $s11 = ".cfi_fde_data is not supported for this target" fullword ascii
      $s12 = "  --dump-config           display how the assembler is configured and then exit" fullword ascii
      $s13 = "  -moperand-check=[none|error|warning] (default: warning)" fullword ascii
      $s14 = "jump target out of range" fullword ascii
      $s15 = "noexecstack" fullword ascii
      $s16 = "GINSN process for prev func not done" fullword ascii
      $s17 = "negative count for %s - ignored" fullword ascii
      $s18 = "bfd_target_list" fullword ascii
      $s19 = "attempt to .org/.space/.nops backwards? (%ld)" fullword ascii
      $s20 = "`%s%c' is only supported in 64-bit mode" fullword ascii
      $s21 = "attempt to store float in section `%s'" fullword ascii
      $s22 = "Invalid --compress-debug-sections option: `%s'" fullword ascii
      $s23 = "Invalid --gdwarf-cie-version `%s'" fullword ascii
      $s24 = "attempt to store non-zero value in section `%s'" fullword ascii
      $s25 = "Invalid --elf-stt-common= option: `%s'" fullword ascii
      $s26 = "attempt to fill section `%s' with non-zero value" fullword ascii
      $s27 = "Attempt to purge non-existing macro `%s'" fullword ascii
      $s28 = "attempt to store non-empty string in section `%s'" fullword ascii
      $s29 = "file table slot %u is already occupied by a different file (%s%s%s vs %s%s%s)" fullword ascii
      $s30 = "`%s%c' is not supported in 64-bit mode" fullword ascii
      $s31 = ".largecomm supported only in 64bit mode, producing .comm" fullword ascii
      $s32 = "%s:%u: add %d%s at 0x%llx to align %s within %d-byte boundary" fullword ascii
      $s33 = "%s:%u: add additional %d%s at 0x%llx to align %s within %d-byte boundary" fullword ascii
      $s34 = "%s:%u: add %d%s-byte nop at 0x%llx to align %s within %d-byte boundary" fullword ascii
      $s35 = "skipping SFrame FDE; CFI insn %s (%#x)" fullword ascii
      $s36 = "  --reduce-memory-overheads ignored" fullword ascii
      $s37 = "SCFI: backward pass failed for func '%s'" fullword ascii
      $s38 = "vgetexpps" fullword ascii
      $s39 = "vgetexpsd" fullword ascii
      $s40 = "vgetmantpd" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 c0 04 00 00 00 00 00 40 00 00 00 00 00 00 00 d0 ce 0b 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d8 8c 00 00 00 00 00 00 d8 8c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 55 75 05 00 00 00 00 00 55 75 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 10 06 00 00 00 00 00 00 10 06 00 00 00 00 00 00 10 06 00 00 00 00 00 4c 46 05 00 00 00 00 00 4c 46 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 63 0b 00 00 00 00 00 10 63 0b 00 00 00 00 00 10 63 0b 00 00 00 00 00 38 6a 00 00 00 00 00 00 30 00 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 28 bd 0b 00 00 00 00 00 28 bd 0b 00 00 00 00 00 28 bd 0b 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 bc 00 00 00 00 00 00 00 bc 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 e0 b0 0a 00 00 00 00 00 e0 b0 0a 00 00 00 00 00 e0 b0 0a 00 00 00 00 00 c4 1a 00 00 00 00 00 00 c4 1a 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 63 0b 00 00 00 00 00 10 63 0b 00 00 00 00 00 10 63 0b 00 00 00 00 00 f0 5c 00 00 00 00 00 00 f0 5c 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 ec aa 91 7c 46 d6 39 82 98 70 a9 2d 70 18 98 eb 07 9f cc 2e 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 68 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 64 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 62 69 6e 75 74 69 6c 73 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 32 2e 39 30 2e 32 30 32 34 30 37 32 30 2d 32 22 2c 22 61 72 63 68 69 74}
condition:
      filesize < 2000KB and
      8 of them and $magic
}

rule gtfobins_binaries_opkg {
   strings:
      $s1 = "opkg_cmd_exec" fullword ascii
      $s2 = "%s: unknown sub-command %s" fullword ascii
      $s3 = "%s: the ``%s'' command requires at least one argument" fullword ascii
      $s4 = "usage: opkg [options...] sub-command [arguments...]" fullword ascii
      $s5 = "where sub-command is one of:" fullword ascii
      $s6 = "opkg must have one sub-command argument" fullword ascii
      $s7 = "Encountered unhandled option %d during command line parsing" fullword ascii
      $s8 = "Informational Commands:" fullword ascii
      $s9 = "--download-only                 No action -- download only" fullword ascii
      $s10 = "GNU C17 13.3.0 -mtune=generic -march=x86-64 -g -O2 -fasynchronous-unwind-tables" fullword ascii
      $s11 = "noreadfeedsfile" fullword ascii
      $s12 = "compare-versions" fullword ascii
      $s13 = "compare_versions" fullword ascii
      $s14 = "proxy_passwd" fullword ascii
      $s15 = "compare-versions <v1> <op> <v2>" fullword ascii
      $s16 = "download_only" fullword ascii
      $s17 = "opkg version 0.7.0+git (%s)" fullword ascii
      $s18 = "http_auth" fullword ascii
      $s19 = "opkg_download_cleanup" fullword ascii
      $s20 = "ARGS_OPT_SHORT_DESCRIPTION" fullword ascii
      $s21 = "ARGS_OPT_DOWNLOAD_ONLY" fullword ascii
      $s22 = "short-description" fullword ascii
      $s23 = "--force-postinstall             Run postinstall scripts even in offline mode" fullword ascii
      $s24 = "download_first" fullword ascii
      $s25 = "opkg_download.h" fullword ascii
      $s26 = "proxy_user" fullword ascii
      $s27 = "force-postinstall" fullword ascii
      $s28 = "getopt_long@GLIBC_2.2.5" fullword ascii
      $s29 = "list_head" fullword ascii
      $s30 = "intercepts_dir" fullword ascii
      $s31 = "force_postinstall" fullword ascii
      $s32 = "getopt_core.h" fullword ascii
      $s33 = "--combine                       Combine upgrade and install operations, this" fullword ascii
      $s34 = "ARGS_OPT_FORCE_POSTINSTALL" fullword ascii
      $s35 = "getopt_ext.h" fullword ascii
      $s36 = "ftp_explicit_ssl" fullword ascii
      $s37 = "autoremove" fullword ascii
      $s38 = "noloadconf" fullword ascii
      $s39 = "--force-remove                  Remove package even if prerm script fails" fullword ascii
      $s40 = "nocheckfordirorfile" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 2b 00 00 00 00 00 00 40 00 00 00 00 00 00 00 48 c7 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 27 00 26 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a0 12 00 00 00 00 00 00 a0 12 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 91 11 00 00 00 00 00 00 91 11 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 70 20 00 00 00 00 00 00 70 20 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 6d 00 00 00 00 00 00 b0 7d 00 00 00 00 00 00 b0 7d 00 00 00 00 00 00 50 0a 00 00 00 00 00 00 a0 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c0 6d 00 00 00 00 00 00 c0 7d 00 00 00 00 00 00 c0 7d 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 1c 5f 00 00 00 00 00 00 1c 5f 00 00 00 00 00 00 1c 5f 00 00 00 00 00 00 3c 00 00 00 00 00 00 00 3c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 6d 00 00 00 00 00 00 b0 7d 00 00 00 00 00 00 b0 7d 00 00 00 00 00 00 50 02 00 00 00 00 00 00 50 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 4e a6 9c 92 fb fa 62 4f c7 bb 9f 27 78 a6 72 6c 10 09 ac 2d 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 1f 00 00 00 01 00 00 00 06 00 00 00 00 0d 81 00 00 00 0c 02 1f 00 00 00 20 00 00 00 21 00 00 00 d1 65 ce 6d 39 f2 8b 1c ca b2 9d c1 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 92 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_mawk {
   strings:
      $s1 = "failed to exec %s -c \"%s\"" fullword ascii
      $s2 = "-W exec is incompatible with -f" fullword ascii
      $s3 = "    If no -f option is given, a \"--\" ends option processing; the following" fullword ascii
      $s4 = "    -W dump          show assembler-like listing of program and exit." fullword ascii
      $s5 = "j > 0 && fbankv[j - 1] != 0 && fbankv[j] == 0" fullword ascii
      $s6 = "                     command-line.  Multiple -f options are accepted." fullword ascii
      $s7 = "REcompile() - panic:  " fullword ascii
      $s8 = "resource exhaustion -- regular expression too large" fullword ascii
      $s9 = "pqrstu" fullword wide /* reversed goodware string 'utsrqp' */
      $s10 = "execute A_LENGTH" fullword ascii
      $s11 = "execute _LENGTH" fullword ascii
      $s12 = "%s: %s%sline %u: " fullword ascii
      $s13 = "regular expression compile failed (%s)" fullword ascii
      $s14 = "%s: run time error: " fullword ascii
      $s15 = "bad cell type passed to compare" fullword ascii
      $s16 = "improper assignment: -v %s" fullword ascii
      $s17 = "    -W exec file     use file as program as well as last option." fullword ascii
      $s18 = "ambiguous -W value: \"%.*s\" (%s vs %s)" fullword ascii
      $s19 = "syntax error ^* or ^+" fullword ascii
      $s20 = "mawk %d.%d%s %s" fullword ascii
      $s21 = "ambiguous long option: \"--%.*s\" (--%s vs --%s)" fullword ascii
      $s22 = "vacuous option: -W \"%s\"" fullword ascii
      $s23 = "%s%sline %u: missing %c near %s" fullword ascii
      $s24 = "not enough arguments passed to %s(\"%s\")" fullword ascii
      $s25 = "improper conversion(number %d) in %s(\"%s\")" fullword ascii
      $s26 = "    -f program-file  Program  text is read from file instead of from the" fullword ascii
      $s27 = "close failed on file \"%s\"" fullword ascii
      $s28 = "syntax error at or near /%s/" fullword ascii
      $s29 = "illegal format assigned to %s: %s" fullword ascii
      $s30 = "8post_dec" fullword ascii
      $s31 = "type clash or keyword" fullword ascii
      $s32 = "unexpected write error" fullword ascii
      $s33 = ";f_post_inc" fullword ascii
      $s34 = "type in bi_getline" fullword ascii
      $s35 = "<f_post_dec" fullword ascii
      $s36 = "7post_inc" fullword ascii
      $s37 = "aabbbbbbbbbbbbbbbbbbbcddeef" ascii
      $s38 = "# regex %p" fullword ascii
      $s39 = "cannot command line assign to %s" fullword ascii
      $s40 = "# patching %s" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 26 00 00 00 00 00 00 40 00 00 00 00 00 00 00 68 83 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 58 1f 00 00 00 00 00 00 58 1f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 49 ba 01 00 00 00 00 00 49 ba 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 f8 8c 00 00 00 00 00 00 f8 8c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 77 02 00 00 00 00 00 d0 77 02 00 00 00 00 00 d0 77 02 00 00 00 00 00 50 0a 00 00 00 00 00 00 c8 33 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 58 7b 02 00 00 00 00 00 58 7b 02 00 00 00 00 00 58 7b 02 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 a8 35 02 00 00 00 00 00 a8 35 02 00 00 00 00 00 a8 35 02 00 00 00 00 00 74 07 00 00 00 00 00 00 74 07 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 77 02 00 00 00 00 00 d0 77 02 00 00 00 00 00 d0 77 02 00 00 00 00 00 30 08 00 00 00 00 00 00 30 08 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 38 d9 1b 2a b3 d9 be cb 33 d4 d5 b3 7d 13 0e 44 78 45 24 3f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 4f 00 00 00 01 00 00 00 06 00 00 00 10 01 a1 00 c0 01 50 02 4f 00 00 00 52 00 00 00 00 00 00 00 28 1d 8c 1c a6 dd a3 6b d1 65 ce 6d 66 55 61 10 c4 b9 9c 40 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 85 00 00 00 12 00 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_rc {
   strings:
      $s1 = "named pipes cannot be executed as commands" fullword ascii
      $s2 = "%s--core dumped" fullword ascii
      $s3 = "coredumpsize" fullword ascii
      $s4 = "usage: flag f [ + | - ]" fullword ascii
      $s5 = "rc-complete-command" fullword ascii
      $s6 = "sigpipe" fullword ascii
      $s7 = "pipe too long" fullword ascii
      $s8 = "bad subscript" fullword ascii
      $s9 = "%s: bad option: -%c" fullword ascii
      $s10 = "$Release: @(#)rc 1.7.4 (git description unavailable) $" fullword ascii
      $s11 = "rc: line %d: %s near %s" fullword ascii
      $s12 = "rc: line %d: %s" fullword ascii
      $s13 = "istack->ungetcount < UNGETSIZE" fullword ascii
      $s14 = "bad conversion character in printfmt" fullword ascii
      $s15 = "heredoc incomplete" fullword ascii
      $s16 = "backquote read" fullword ascii
      $s17 = "floating point error" fullword ascii
      $s18 = "background tty read" fullword ascii
      $s19 = "maxproc" fullword ascii
      $s20 = "cputime" fullword ascii
      $s21 = "memoryuse" fullword ascii
      $s22 = "memorylocked" fullword ascii
      $s23 = "sigtrap" fullword ascii
      $s24 = "sigalrm" fullword ascii
      $s25 = "sigwinch" fullword ascii
      $s26 = "sigexit" fullword ascii
      $s27 = "sigstkflt" fullword ascii
      $s28 = "sigttin" fullword ascii
      $s29 = "filelocks" fullword ascii
      $s30 = "whatis -p: must specify argument" fullword ascii
      $s31 = "tcsetgrp" fullword ascii
      $s32 = "unexcept" fullword ascii
      $s33 = "$^%s%#T%s" fullword ascii
      $s34 = "memoryrss" fullword ascii
      $s35 = "sigxcpu" fullword ascii
      $s36 = "sigxfsz" fullword ascii
      $s37 = "sigsegv" fullword ascii
      $s38 = "sigvtalrm" fullword ascii
      $s39 = "sigkill" fullword ascii
      $s40 = "sigabrt" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 49 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 d7 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 30 00 00 00 00 00 00 20 30 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 45 ed 00 00 00 00 00 00 45 ed 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 01 00 00 00 00 00 00 30 01 00 00 00 00 00 00 30 01 00 00 00 00 00 18 8e 00 00 00 00 00 00 18 8e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 c8 01 00 00 00 00 00 70 c8 01 00 00 00 00 00 70 c8 01 00 00 00 00 00 84 0d 00 00 00 00 00 00 b0 27 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 88 cb 01 00 00 00 00 00 88 cb 01 00 00 00 00 00 88 cb 01 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 70 8b 01 00 00 00 00 00 70 8b 01 00 00 00 00 00 70 8b 01 00 00 00 00 00 24 07 00 00 00 00 00 00 24 07 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 c8 01 00 00 00 00 00 70 c8 01 00 00 00 00 00 70 c8 01 00 00 00 00 00 90 07 00 00 00 00 00 00 90 07 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 d9 a7 7c 41 ee b2 f8 ce b6 1b 8e df 45 82 3b 5d bd 0c 48 3d 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 48 00 00 00 02 00 00 00 07 00 00 00 22 02 00 48 20 42 01 0a 4d 08 01 00 51 81 b0 00 48 00 00 00 4a 00 00 00 51 00 00 00 76 fa 32 04 d1 65 ce 6d 80 bc 6c 3b 68 20 4f 47 42 d0 3f c2 9e 52 e5 0c 6e c3 4f 75 a8 64 97 7c c3 fb a5 a2 b8 8d ee 02 ba 4d b5 01 b0 cd 08 7b ae 22 e1 a3}
condition:
      filesize < 400KB and
      8 of them and $magic
}

rule gtfobins_binaries_bridge {
   strings:
      $s1 = "Command failed %s:%d" fullword ascii
      $s2 = "Usage: bridge mdb { add | del | replace } dev DEV port PORT grp GROUP [src SOURCE] [permanent | temp] [vid VID]" fullword ascii
      $s3 = "mnl_nlmsg_get_payload" fullword ascii
      $s4 = "mnl_nlmsg_get_payload_len" fullword ascii
      $s5 = "Bind %s -> %s failed: %s" fullword ascii
      $s6 = "Usage: bridge [ OPTIONS ] OBJECT { COMMAND | help }" fullword ascii
      $s7 = "usersock" fullword ascii
      $s8 = "bridge fdb: unknown command \"%s\"?" fullword ascii
      $s9 = "Command \"%s\" is unknown, try \"bridge fdb help\"." fullword ascii
      $s10 = "Command \"%s\" is unknown, try \"bridge vlan help\"." fullword ascii
      $s11 = "Command \"%s\" is unknown, try \"bridge link help\"." fullword ascii
      $s12 = "Command \"%s\" is unknown, try \"bridge vni help\"." fullword ascii
      $s13 = "Command \"%s\" is unknown, try \"bridge mdb help\"." fullword ascii
      $s14 = "!!!Deficit %d, rta_len=%d" fullword ascii
      $s15 = "Cannot send dump request" fullword ascii
      $s16 = "Cannot send slave dump request" fullword ascii
      $s17 = "Dump ternminated" fullword ascii
      $s18 = "Dump terminated" fullword ascii
      $s19 = "Dump was interrupted and may be inconsistent." fullword ascii
      $s20 = "Unexpected reply!!!" fullword ascii
      $s21 = "Error: %s address is expected rather than \"%s\"." fullword ascii
      $s22 = "Error: an IP address is expected rather than \"%s\"" fullword ascii
      $s23 = "Failed to open directory %s: %s" fullword ascii
      $s24 = "router ports on %s: " fullword ascii
      $s25 = "router ports on %s: %s" fullword ascii
      $s26 = "Too many arguments to command" fullword ascii
      $s27 = "!!!malformed message: len=%d @%lu" fullword ascii
      $s28 = "Command line is not complete. Try option \"help\"" fullword ascii
      $s29 = "mount of /sys failed: %s" fullword ascii
      $s30 = "\"mount --make-rslave /\" failed: %s" fullword ascii
      $s31 = "selinux" fullword ascii
      $s32 = "fiblookup" fullword ascii
      $s33 = "Invalid address \"%s\"" fullword ascii
      $s34 = "root_block %s " fullword ascii
      $s35 = "Invalid source address \"%s\"" fullword ascii
      $s36 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"iproute2\",\"version\":\"6.10.0-1\",\"architecture\":\"amd64\",\"debugInfoUrl\":" ascii
      $s37 = "Error: \"%s\" may be inet prefix, but it is not allowed in this context." fullword ascii
      $s38 = "Error: argument \"%s\" is wrong: %s" fullword ascii
      $s39 = "setting the network namespace \"%s\" failed: %s" fullword ascii
      $s40 = "Error: device %s does not exist" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 3d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 92 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 2b 00 00 00 00 00 00 40 2b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 41 7b 01 00 00 00 00 00 41 7b 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 b0 01 00 00 00 00 00 00 b0 01 00 00 00 00 00 00 b0 01 00 00 00 00 00 38 8f 00 00 00 00 00 00 38 8f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 48 02 00 00 00 00 00 90 48 02 00 00 00 00 00 90 48 02 00 00 00 00 00 74 48 00 00 00 00 00 00 00 96 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 40 4a 02 00 00 00 00 00 40 4a 02 00 00 00 00 00 40 4a 02 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 ec ec 01 00 00 00 00 00 ec ec 01 00 00 00 00 00 ec ec 01 00 00 00 00 00 64 0b 00 00 00 00 00 00 64 0b 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 48 02 00 00 00 00 00 90 48 02 00 00 00 00 00 90 48 02 00 00 00 00 00 70 07 00 00 00 00 00 00 70 07 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 b5 5d 9e 39 cc 1d 78 b9 7c f8 0d b5 f9 33 13 af 6d f5 26 c3 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 69 70 72 6f 75 74 65 32 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 36 2e 31 30 2e 30 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a 22 61}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_socat {
   strings:
      $s1 = ":<socks-server>:<socks-port>:<target-host>:<target-port>" fullword ascii
      $s2 = "getsockopt(%d, SOL_SOCKET, SO_ERROR, { %d }) -> 0" fullword ascii
      $s3 = "      -x     verbose hexadecimal dump of data traffic" fullword ascii
      $s4 = "sending socks5 request version=%d command=%d reserved=%d address_type=%d" fullword ascii
      $s5 = "      -v     verbose text dump of data traffic" fullword ascii
      $s6 = "      -r <file>      raw dump of data flowing from left to right" fullword ascii
      $s7 = "fcntl(%d, F_GETPIPE_SZ): %s" fullword ascii
      $s8 = "readlink(\"%s\", linktarget, %d): %s" fullword ascii
      $s9 = "SOCKS5 authentication negotiation failed - client & server have no common supported methods" fullword ascii
      $s10 = "target hostname too long (>255 bytes), aborting" fullword ascii
      $s11 = "xio_tempnam(\"%s\"): trying path names, suppressing stat() logs" fullword ascii
      $s12 = "getaddrinfo(%s%s%s, %s%s%s, {0x%02x,%d,%d,%d,%u,%p,%p,%p}, %p)" fullword ascii
      $s13 = "getgrouplist(,, [%u,%u], [%d]) -> %d" fullword ascii
      $s14 = "%s: wrong number of parameters (%d instead of %d): usage: %s%s" fullword ascii
      $s15 = "tcgetattr(, {%08x,%08x,%08x,%08x, %u,%u, %s}) -> %d" fullword ascii
      $s16 = "sockaddr_vm - garbage in port: \"%s\"" fullword ascii
      $s17 = "SOCKS5 Server Hello version was %d, not the expected %d, peer might not be a SOCKS5 server" fullword ascii
      $s18 = "open(%s, O_RDONLY|O_CLOEXEC): %s" fullword ascii
      $s19 = "notifying parent that child process is ready" fullword ascii
      $s20 = "socatsignalpass(): propagated signal to %d sub processes" fullword ascii
      $s21 = "      -R <file>      raw dump of data flowing from right to left" fullword ascii
      $s22 = "child process notified parent that it is ready" fullword ascii
      $s23 = "dumpopts(): %d %s" fullword ascii
      $s24 = "gethostname(%p, %lu)" fullword ascii
      $s25 = "getaddrinfo() -> flags=0x%02x family=%d socktype=%d protocol=%d addr=%s" fullword ascii
      $s26 = "using file descriptor %d accepting a connection for %s" fullword ascii
      $s27 = "getgrouplist(,, [%u], [%d]) -> %d" fullword ascii
      $s28 = "getpeername(, {%s}, {%u}) -> %d" fullword ascii
      $s29 = "getsockname(, {%s}, {%u}) -> %d" fullword ascii
      $s30 = "getgrouplist(,, [], [%d]) -> %d" fullword ascii
      $s31 = "securityencryptiontransport" fullword ascii
      $s32 = "read(%d, %p, %lu): %s (probably PTY closed)" fullword ascii
      $s33 = "option -r \"%s\": %s" fullword ascii
      $s34 = "SSL_get_session(%p) failed" fullword ascii
      $s35 = "F_GETPIPE_SZ=%d" fullword ascii
      $s36 = "Waiting for child processes to terminate" fullword ascii
      $s37 = "execl(\"%s\") returned with status %d" fullword ascii
      $s38 = "sending socks5 client hello version=%d nmethods=%d" fullword ascii
      $s39 = "SIGALRM while waiting for wo child process to die, killing it now" fullword ascii
      $s40 = "specified SNI host \"%s\" is an IP address" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 9f 01 00 00 00 00 00 40 00 00 00 00 00 00 00 e8 30 07 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a8 77 01 00 00 00 00 00 a8 77 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 80 01 00 00 00 00 00 00 80 01 00 00 00 00 00 00 80 01 00 00 00 00 00 79 46 03 00 00 00 00 00 79 46 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 d0 04 00 00 00 00 00 00 d0 04 00 00 00 00 00 00 d0 04 00 00 00 00 00 80 77 01 00 00 00 00 00 80 77 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 52 06 00 00 00 00 00 d0 52 06 00 00 00 00 00 d0 52 06 00 00 00 00 00 6c dc 00 00 00 00 00 00 90 de 04 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 98 1d 07 00 00 00 00 00 98 1d 07 00 00 00 00 00 98 1d 07 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 cc ba 05 00 00 00 00 00 cc ba 05 00 00 00 00 00 cc ba 05 00 00 00 00 00 94 0f 00 00 00 00 00 00 94 0f 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 52 06 00 00 00 00 00 d0 52 06 00 00 00 00 00 d0 52 06 00 00 00 00 00 30 cd 00 00 00 00 00 00 30 cd 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 12 19 f8 05 b7 fc 19 bd 57 6f a0 ac 6b 84 95 40 92 3a ad 24 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 20 01 00 00 01 00 00 00 06 00 00 00 16 c1 89 58 c0 11 52 02 20 01 00 00 23 01 00 00 27 01 00 00 28 1d 8c 1c d0 65 ce 6d a7 dd a3 6b c4 b9 9c 40 5c d0 8a c7 38 f2 8b 1c ed 64 cd e4 9a 20 f3 ee 9e 83 ba 2b 4f 9c 12 ca 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 1000KB and
      8 of them and $magic
}

rule gtfobins_binaries_top {
   strings:
      $s1 = "  /bin/echo -e \"pipe\\tLog\\ttail -n200 /var/log/syslog | sort -Mr\" >> ~/.toprc" fullword ascii
      $s2 = "Help for Interactive Commands~2 - %s" fullword ascii
      $s3 = "  /bin/echo -e \"pipe\\tOpen Files\\tlsof -P -p %d 2>&1\" >> ~/.toprc" fullword ascii
      $s4 = "the '=' key will eventually show the actual file read or command(s) executed ..." fullword ascii
      $s5 = "Unknown command - try 'h' for help" fullword ascii
      $s6 = "%s's Config File (Linux processes with windows)" fullword ascii
      $s7 = "  /bin/echo -e \"file\\tNUMA Info\\t/proc/%d/numa_maps\" >> ~/.toprc" fullword ascii
      $s8 = ". Commands ~1requiring~2 '~1A~2' mode~1  -------------~2" fullword ascii
      $s9 = "command line for pid %d, %s" fullword ascii
      $s10 = " -u, --filter-only-euser =USER   show only processes owned by USER" fullword ascii
      $s11 = "that 'pipe' type entries can include shell scripts too!" fullword ascii
      $s12 = " -U, --filter-any-user =USER     show only processes owned by USER" fullword ascii
      $s13 = "commands plus the 'g' sub-commands NOW.  Press <Enter> to make 'Current' " fullword ascii
      $s14 = "failed pthread_create() at %d: %s" fullword ascii
      $s15 = "Help for Windows / Field Groups~2 - \"Current Window\" = ~1 %s ~6" fullword ascii
      $s16 = "Parent Process pid" fullword ascii
      $s17 = "   color - 04:25:44 up 8 days, 50 min,  7 users,  load average:" fullword ascii
      $s18 = "conflicting process selections (U/p/u)" fullword ascii
      $s19 = "Process Group Id" fullword ascii
      $s20 = "Login User Id" fullword ascii
      $s21 = "Help for color mapping~2 - \"Current Window\" = ~1 %s ~6" fullword ascii
      $s22 = "Process Status" fullword ascii
      $s23 = "Command disabled, activate %s with '-' or '_'" fullword ascii
      $s24 = "Tty Process Grp Id" fullword ascii
      $s25 = "In '~1A~2' mode, '~1*~4' keys are your ~1essential~2 commands.  Please try the '~1a~2' and '~1w~2'" fullword ascii
      $s26 = "Process Id" fullword ascii
      $s27 = "summclr=%d, msgsclr=%d, headclr=%d, taskclr=%d" fullword ascii
      $s28 = "failed tty get" fullword ascii
      $s29 = "width incr is %d, change to (0 default, -1 auto)" fullword ascii
      $s30 = ". Commands ~1available anytime   -------------~2" fullword ascii
      $s31 = "library failed memory statistics, at %d: %s" fullword ascii
      $s32 = "winflags=%d, sortindx=%d, maxtasks=%d, graph_cpus=%d, graph_mems=%d, double_up=%d, combine_cpus=%d, core_types=%d" fullword ascii
      $s33 = "library failed cpu statistics, at %d: %s" fullword ascii
      $s34 = "library failed pids statistics, at %d: %s" fullword ascii
      $s35 = "Failed renice of PID %d to %d: %s" fullword ascii
      $s36 = "failed sem_init() at %d: %s" fullword ascii
      $s37 = ". The 'current' window controls the ~1Summary Area~2 and responds to your ~1Commands~2" fullword ascii
      $s38 = "I/O Read Operations" fullword ascii
      $s39 = "wrong mode, command inactive" fullword ascii
      $s40 = "from some command.  Exactly which commands and/or files are solely up to you." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 55 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b0 06 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0e 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 2f 00 00 00 00 00 00 40 2f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 99 3a 01 00 00 00 00 00 99 3a 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 01 00 00 00 00 00 00 70 01 00 00 00 00 00 00 70 01 00 00 00 00 00 30 6e 00 00 00 00 00 00 30 6e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 e4 01 00 00 00 00 00 70 e4 01 00 00 00 00 00 70 e4 01 00 00 00 00 00 98 20 00 00 00 00 00 00 d0 db 02 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 b0 e9 01 00 00 00 00 00 b0 e9 01 00 00 00 00 00 b0 e9 01 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 70 e4 01 00 00 00 00 00 70 e4 01 00 00 00 00 00 70 e4 01 00 00 00 00 00 00 00 00 00 00 00 00 00 0c 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d0 c1 01 00 00 00 00 00 d0 c1 01 00 00 00 00 00 d0 c1 01 00 00 00 00 00 94 02 00 00 00 00 00 00 94 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 e4 01 00 00 00 00 00 70 e4 01 00 00 00 00 00 70 e4 01 00 00 00 00 00 90 0b 00 00 00 00 00 00 90 0b 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 26 9c cf d8 70 37 51 1f ec 90 2c f0 3c 1f e2 c8 cf 40 fc 66 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 80 00 00 00 01 00 00 00 06 00 00 00 40 05 81 42 40 21 1c 06 80 00 00 00 82 00 00 00 84 00 00 00 28 1d 8c 1c}
condition:
      filesize < 400KB and
      8 of them and $magic
}

rule gtfobins_binaries_rlwrap {
   strings:
      $s1 = "tcgetattr error on slave pty (from parent process)" fullword ascii
      $s2 = "decode_field_length(&encoded) == testval && (*encoded == '\\0')" fullword ascii
      $s3 = "(without dumping core) " fullword ascii
      $s4 = "If you need a core dump, re-configure with --enable-debug and rebuild" fullword ascii
      $s5 = "rlwrap-dump-all-keybindings" fullword ascii
      $s6 = "Usage: %s [options] command ..." fullword ascii
      $s7 = "https://github.com/hanslub42/rlwrap" fullword ascii
      $s8 = "tcgetattr error on stdin" fullword ascii
      $s9 = "you specified the -N (--no-children) option  - but spying" fullword ascii
      $s10 = "emacs-standard; vi-insert; vi-command" fullword ascii
      $s11 = "emacs-standard;vi-insert;vi-command" fullword ascii
      $s12 = "(user) interrupt reading %s, filter_hangs?" fullword ascii
      $s13 = "rl_executing_keyseq" fullword ascii
      $s14 = "%s/%d/cmdline" fullword ascii
      $s15 = "this filter handles signals, which means that signals are blocked during filter processing" fullword ascii
      $s16 = "The -F (--history-format) option is obsolete. Use -z \"history_format '%s'\" instead" fullword ascii
      $s17 = "(user) interrupt - filter hangs?" fullword ascii
      $s18 = "read_options_and_command_name" fullword ascii
      $s19 = "Could not get keymap '%s'" fullword ascii
      $s20 = "Then you should write -%c%s, without the space(s)" fullword ascii
      $s21 = "password prompt" fullword ascii
      $s22 = "could not read temp file %s" fullword ascii
      $s23 = "filter command" fullword ascii
      $s24 = "cannot mirror command's command line, as %s is unreadable" fullword ascii
      $s25 = "could not create readable/writable temporary file %s" fullword ascii
      $s26 = "unreadable temp file %s" fullword ascii
      $s27 = "To use -d( for debugging), configure %s with --enable-debug and rebuild" fullword ascii
      $s28 = "single keypresses all the time. Don't you need --always-readline" fullword ascii
      $s29 = "%s: Oops, crashed (caught %s) - this should not have happened!" fullword ascii
      $s30 = "to temporary file" fullword ascii
      $s31 = "Could not bind key %d (%s) in keymap '%s'" fullword ascii
      $s32 = "command_name != NULL" fullword ascii
      $s33 = "tcsetattr error on stdin" fullword ascii
      $s34 = "*copy - scratchpad < padsize" fullword ascii
      $s35 = "RLWRAP_COMMAND_PID" fullword ascii
      $s36 = "command_is_dead || kill(command_pid,0) == 0" fullword ascii
      $s37 = " --%s%s" fullword ascii
      $s38 = "-i option has to precede -f options" fullword ascii
      $s39 = "copy_cursor + match_length - copy_with_replacements < max_copylen" fullword ascii
      $s40 = "('rlwrap -z listing' writes a list of installed filters)" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 58 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 8c 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 70 37 00 00 00 00 00 00 70 37 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 71 d6 00 00 00 00 00 00 71 d6 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 01 00 00 00 00 00 00 20 01 00 00 00 00 00 00 20 01 00 00 00 00 00 e8 58 00 00 00 00 00 00 e8 58 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 a8 7d 01 00 00 00 00 00 a8 8d 01 00 00 00 00 00 a8 8d 01 00 00 00 00 00 d8 0d 00 00 00 00 00 00 00 1d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 b8 7d 01 00 00 00 00 00 b8 8d 01 00 00 00 00 00 b8 8d 01 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 08 4d 01 00 00 00 00 00 08 4d 01 00 00 00 00 00 08 4d 01 00 00 00 00 00 44 06 00 00 00 00 00 00 44 06 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 a8 7d 01 00 00 00 00 00 a8 8d 01 00 00 00 00 00 a8 8d 01 00 00 00 00 00 58 02 00 00 00 00 00 00 58 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 60 4a 29 48 82 31 a8 24 7b fa 84 7e 88 f0 be 31 82 91 b2 f6 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 98 00 00 00 04 00 00 00 08 00 00 00 90 00 00 22 50 91 1c 02 1c 01 17 f0 40 0b 24 10 01 20 00 00 84 00 05 02 06 01 01 09 28 10 0a 08 00 00 00 00 98 00 00 00 99 00 00 00 9b 00 00 00 9c 00 00 00 9f 00 00 00 00 00 00 00 a1 00 00 00 a6 00 00 00 a7 00 00 00 a8 00 00 00 00 00 00 00}
condition:
      filesize < 300KB and
      8 of them and $magic
}

rule gtfobins_binaries_gtester {
   strings:
      $s1 = "Failed to execute test binary: %s: %s" fullword ascii
      $s2 = "http://www.example.com/bugtracker?bugnum=%s;cmd=showbug" fullword ascii
      $s3 = "Failed to open pipe for test binary: %s: %s" fullword ascii
      $s4 = "http://www.example.com/bugtracker/" fullword ascii
      $s5 = "https://example.com/no-base-used" fullword ascii
      $s6 = "<!-- Deprecated: Since GLib 2.62, gtester and gtester-report are deprecated. Port to TAP. -->" fullword ascii
      $s7 = "Failed to open log file '%s': %s" fullword ascii
      $s8 = "  -m {perf|slow|thorough|quick} Run test cases according to mode" fullword ascii
      $s9 = "  -k, --keep-going              Continue running after tests failed" fullword ascii
      $s10 = "%s<testbinary path=\"%s\">" fullword ascii
      $s11 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/libgio-2.0-dev-bin.debug" fullword ascii
      $s12 = "%s<error>%s</error>" fullword ascii
      $s13 = "gtester version %d.%d.%d" fullword ascii
      $s14 = "%s<binary file=\"%s\"/>" fullword ascii
      $s15 = "g_unix_open_pipe" fullword ascii
      $s16 = "--GTestLogFD=%u" fullword ascii
      $s17 = "test_log_msg" fullword ascii
      $s18 = "  -o=LOGFILE                    Write the test log to LOGFILE" fullword ascii
      $s19 = "%s<performance minimize=\"%d\" maximize=\"%d\" value=\"%.16Lg\">" fullword ascii
      $s20 = "%s<status exit-status=\"%d\" n-forks=\"%d\" result=\"%s\"/>" fullword ascii
      $s21 = "%s</testbinary>" fullword ascii
      $s22 = "%s<random-seed>%s</random-seed>" fullword ascii
      $s23 = "  -q, --quiet                   Suppress per test binary output" fullword ascii
      $s24 = "  -v, --version                 Print version information" fullword ascii
      $s25 = "  -m {undefined|no-undefined}   Run test cases according to mode" fullword ascii
      $s26 = "Hct$DH" fullword ascii /* Goodware String - occured 1 times */
      $s27 = "g_assertion_message_cmpint" fullword ascii
      $s28 = "%s<duration>%.6Lf</duration>" fullword ascii
      $s29 = "%s</message>" fullword ascii
      $s30 = "--test-arg=" fullword ascii
      $s31 = "fixture_test" fullword ascii
      $s32 = "*fix == 0xdeadbeef" fullword ascii
      $s33 = "--GTestSkipCount=%u" fullword ascii
      $s34 = "%s<message>" fullword ascii
      $s35 = "%s</gtester>" fullword ascii
      $s36 = "This is a test message API test message." fullword ascii
      $s37 = "--test-arg" fullword ascii
      $s38 = "GTester: last random seed: %s" fullword ascii
      $s39 = "%s<gtester>" fullword ascii
      $s40 = "fixture_setup" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 35 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 71 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f8 15 00 00 00 00 00 00 f8 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 d1 20 00 00 00 00 00 00 d1 20 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 a4 0e 00 00 00 00 00 00 a4 0e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 6b 00 00 00 00 00 00 b0 6b 00 00 00 00 00 00 b0 6b 00 00 00 00 00 00 70 04 00 00 00 00 00 00 f0 04 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c0 6b 00 00 00 00 00 00 c0 6b 00 00 00 00 00 00 c0 6b 00 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 30 5b 00 00 00 00 00 00 30 5b 00 00 00 00 00 00 30 5b 00 00 00 00 00 00 7c 00 00 00 00 00 00 00 7c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 6b 00 00 00 00 00 00 b0 6b 00 00 00 00 00 00 b0 6b 00 00 00 00 00 00 50 04 00 00 00 00 00 00 50 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 37 6d 87 9f 30 f0 f3 eb b4 d8 0d 63 49 66 bb 6e 5f 9c 71 64 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 42 00 00 00 01 00 00 00 06 00 00 00 00 00 81 02 00 20 00 00 42 00 00 00 43 00 00 00 d1 65 ce 6d 6d 56 13 ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 77 02 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 81 01 00 00 12 00 00 00}
condition:
      filesize < 90KB and
      8 of them and $magic
}

rule gtfobins_binaries_virsh {
   strings:
      $s1 = "execute command without timeout" fullword ascii
      $s2 = "execute command without waiting for timeout" fullword ascii
      $s3 = "perform a live core dump if supported" fullword ascii
      $s4 = "internal command for testing virt shells" fullword ascii
      $s5 = "the password is already encrypted" fullword ascii
      $s6 = "port to use by target server for incoming disks migration" fullword ascii
      $s7 = "Failed to core dump domain '%1$s' to %2$s" fullword ascii
      $s8 = "Output attributes of a secret as an XML dump to stdout." fullword ascii
      $s9 = "Output the network port information as an XML dump to stdout." fullword ascii
      $s10 = "Run a reboot command in the target domain." fullword ascii
      $s11 = "where to dump the core" fullword ascii
      $s12 = "base64-encoded secret value" fullword ascii
      $s13 = "command '%1$s' doesn't support option --%2$s" fullword ascii
      $s14 = "avoid file system cache when dumping" fullword ascii
      $s15 = "target config data type format" fullword ascii
      $s16 = "Connect to local hypervisor. This is built-in command after shell start up." fullword ascii
      $s17 = "failed to get hostname" fullword ascii
      $s18 = "%1$s: temporary filename contains shell meta or other unacceptable characters (is $TMPDIR wrong?)" fullword ascii
      $s19 = "Failed to initialize mutex" fullword ascii
      $s20 = "Output the network information as an XML dump to stdout." fullword ascii
      $s21 = "Output the node device details as an XML dump to stdout." fullword ascii
      $s22 = "Output the vol information as an XML dump to stdout." fullword ascii
      $s23 = "Failed to get network description xml" fullword ascii
      $s24 = "Core dump a domain." fullword ascii
      $s25 = "Output the domain information as an XML dump to stdout." fullword ascii
      $s26 = "targetbus" fullword ascii
      $s27 = "Output the pool information as an XML dump to stdout." fullword ascii
      $s28 = "Failed to get domain description xml" fullword ascii
      $s29 = "Snapshot Dump XML" fullword ascii
      $s30 = "Domain '%1$s' dumped to %2$s" fullword ascii
      $s31 = "Backup Dump XML" fullword ascii
      $s32 = "Checkpoint Dump XML" fullword ascii
      $s33 = "Output the network filter information as an XML dump to stdout." fullword ascii
      $s34 = "multiple optional positional arguments (%s, %s) of command '%s' are not allowed" fullword ascii
      $s35 = "download volume contents to a file" fullword ascii
      $s36 = "net-port-dumpxml" fullword ascii
      $s37 = "virshDomainCoreDumpFormatCompleter" fullword ascii
      $s38 = "auth secret usage to be used for underlying storage" fullword ascii
      $s39 = "report operating system information" fullword ascii
      $s40 = "Run shutdown in the target domain." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 ca 03 00 00 00 00 00 40 00 00 00 00 00 00 00 60 30 0e 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 50 0b 03 00 00 00 00 00 50 0b 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 a5 2b 06 00 00 00 00 00 a5 2b 06 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 09 00 00 00 00 00 00 40 09 00 00 00 00 00 00 40 09 00 00 00 00 00 80 4a 03 00 00 00 00 00 80 4a 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 92 0c 00 00 00 00 00 10 92 0c 00 00 00 00 00 10 92 0c 00 00 00 00 00 f4 9c 01 00 00 00 00 00 b0 9e 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 b0 e5 0d 00 00 00 00 00 b0 e5 0d 00 00 00 00 00 b0 e5 0d 00 00 00 00 00 70 02 00 00 00 00 00 00 70 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 38 17 0b 00 00 00 00 00 38 17 0b 00 00 00 00 00 38 17 0b 00 00 00 00 00 0c 22 00 00 00 00 00 00 0c 22 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 92 0c 00 00 00 00 00 10 92 0c 00 00 00 00 00 10 92 0c 00 00 00 00 00 f0 6d 01 00 00 00 00 00 f0 6d 01 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 e6 81 49 70 27 14 d1 8f e2 82 6d 85 36 c9 64 64 ba 92 b6 f6 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 f3 02 00 00 01 00 00 00 06 00 00 00 06 6d 81 08 02 a1 1c 03 f3 02 00 00 f9 02 00 00 fc 02 00 00 a8 5c 92 98 9a d3 8b 7d 28 1d 8c 1c 0a de f7 12 8c 10 69 e9 d1 65 ce 6d 6c 98 1e b5 38 f2 8b 1c 6f 10 00 27 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 3000KB and
      8 of them and $magic
}

rule gtfobins_binaries_ssh {
   strings:
      $s1 = "publickey-hostbound-v00@openssh.com" fullword ascii
      $s2 = "publickey-hostbound@openssh.com" fullword ascii
      $s3 = "UpdateHostKeys=ask is incompatible with remote command execution; disabling" fullword ascii
      $s4 = "Executing proxy dialer command: %.500s" fullword ascii
      $s5 = "hostkeys-prove-00@openssh.com" fullword ascii
      $s6 = "hostkeys-00@openssh.com" fullword ascii
      $s7 = "key(s) for %s%s%s exist under other names; skipping UserKnownHostsFile update" fullword ascii
      $s8 = "Executing command: '%.500s'" fullword ascii
      $s9 = "%s: Failed to set SELinux execution context for %s (in enforcing mode)" fullword ascii
      $s10 = "process_cmdline" fullword ascii
      $s11 = "missing hostkey loader" fullword ascii
      $s12 = "forwarded-streamlocal@openssh.com" fullword ascii
      $s13 = "ProxyCommand=- and ProxyUseFDPass are incompatible" fullword ascii
      $s14 = "cancel-streamlocal-forward@openssh.com" fullword ascii
      $s15 = "streamlocal-forward@openssh.com" fullword ascii
      $s16 = "%s%s%s:%ld: Removed %s key for host %s" fullword ascii
      $s17 = "remote forward %s for: listen %s%s%d, connect %s:%d" fullword ascii
      $s18 = "private key %s contents do not match public" fullword ascii
      $s19 = "login failed for always-auth key" fullword ascii
      $s20 = "Skipping %s key %s - corresponding algorithm not in PubkeyAcceptedAlgorithms" fullword ascii
      $s21 = "Skipping %s key %s - corresponding algorithm not supported by server" fullword ascii
      $s22 = "ext-info-in-auth@openssh.com" fullword ascii
      $s23 = "webauthn-sk-ecdsa-sha2-nistp256@openssh.com" fullword ascii
      $s24 = "Cannot execute command-line and remote command." fullword ascii
      $s25 = "knownhostscommand" fullword ascii
      $s26 = "session-bind@openssh.com" fullword ascii
      $s27 = "%.200s line %d: match exec '%.100s' error" fullword ascii
      $s28 = "%s: Failed to set SELinux execution context for %s" fullword ascii
      $s29 = "%s: Failed to get default SELinux security context for %s (in enforcing mode)" fullword ascii
      $s30 = "Read from remote host %s: %s" fullword ascii
      $s31 = "Host directive not supported as a command-line option" fullword ascii
      $s32 = "KnownHostsCommand failed" fullword ascii
      $s33 = "login failed" fullword ascii
      $s34 = "host key found via KnownHostsCommand; disabling UpdateHostkeys" fullword ascii
      $s35 = "credentials updated - forcing rekey" fullword ascii
      $s36 = "load_hostkeys_command" fullword ascii
      $s37 = "ssh_agent_bind_hostkey" fullword ascii
      $s38 = "      !args                                  Execute local command" fullword ascii
      $s39 = "channel %d: request tty %d, X %d, agent %d, subsys %d, term \"%s\", cmd \"%s\", env %u" fullword ascii
      $s40 = "expanded UserKnownHostsFile '%s' -> '%s'" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 16 01 00 00 00 00 00 40 00 00 00 00 00 00 00 a0 04 0f 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 28 ac 00 00 00 00 00 00 28 ac 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 7d 2a 09 00 00 00 00 00 7d 2a 09 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 09 00 00 00 00 00 00 e0 09 00 00 00 00 00 00 e0 09 00 00 00 00 00 5c e3 04 00 00 00 00 00 5c e3 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 cb 0e 00 00 00 00 00 f0 db 0e 00 00 00 00 00 f0 db 0e 00 00 00 00 00 00 37 00 00 00 00 00 00 10 63 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 80 f0 0e 00 00 00 00 00 80 00 0f 00 00 00 00 00 80 00 0f 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 a0 16 0d 00 00 00 00 00 a0 16 0d 00 00 00 00 00 a0 16 0d 00 00 00 00 00 24 27 00 00 00 00 00 00 24 27 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 cb 0e 00 00 00 00 00 f0 db 0e 00 00 00 00 00 f0 db 0e 00 00 00 00 00 10 34 00 00 00 00 00 00 10 34 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 b1 21 08 f0 aa 91 d4 47 96 fd ae 9b 54 1a a7 ab 06 e9 1f d4 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 ba 01 00 00 02 00 00 00 07 00 00 00 0b 00 04 12 52 81 00 5e 36 0e 89 04 e2 84 08 00 ba 01 00 00 00 00 00 00 00 00 00 00 bb 01 00 00 00 00 00 00 00 00 00 00 be 01 00 00 bf 01 00 00 c3 01 00 00 c4 01 00 00 00 00 00 00 c5 01 00 00 c6 01 00 00 00 00 00 00 c9 01 00 00 ca 01 00 00}
condition:
      filesize < 3000KB and
      8 of them and $magic
}

rule gtfobins_binaries_sed {
   strings:
      $s1 = "                 add the contents of script-file to the commands to be executed" fullword ascii
      $s2 = "                 add the script to the commands to be executed" fullword ascii
      $s3 = "  -f script-file, --file=script-file" fullword ascii
      $s4 = "  -e script, --expression=script" fullword ascii
      $s5 = "%s: warning: failed to get security context of %s: %s" fullword ascii
      $s6 = "General help using GNU software: <https://www.gnu.org/gethelp/>." fullword ascii
      $s7 = "fgetfilecon" fullword ascii
      $s8 = "getfscreatecon" fullword ascii
      $s9 = "lgetfilecon" fullword ascii
      $s10 = "%s: warning: failed to set default file creation context to %s: %s" fullword ascii
      $s11 = "couldn't readlink %s: %s" fullword ascii
      $s12 = "* at start of expression" fullword ascii
      $s13 = "                 follow symlinks when processing in place" fullword ascii
      $s14 = "                 operate in sandbox mode (disable e/r/w commands)." fullword ascii
      $s15 = "missing filename in r/R/w/W commands" fullword ascii
      $s16 = "COMMAND: " fullword ascii
      $s17 = "e/r/w commands disabled in sandbox mode" fullword ascii
      $s18 = "  -l N, --line-length=N" fullword ascii
      $s19 = "SELinux is disabled on this system." fullword ascii
      $s20 = "https://www.gnu.org/software/sed/" fullword ascii
      $s21 = "This sed program was built with SELinux support." fullword ascii
      $s22 = "SELinux is enabled on this system." fullword ascii
      $s23 = "GNU sed home page: <https://www.gnu.org/software/sed/>." fullword ascii
      $s24 = "couldn't write %llu items to %s: %s" fullword ascii
      $s25 = "  regex[%d] = %d-%d '" fullword ascii
      $s26 = "couldn't write %llu item to %s: %s" fullword ascii
      $s27 = "invalid content of \\{\\}" fullword ascii
      $s28 = "                 annotate program execution" fullword ascii
      $s29 = "setfscreatecon" fullword ascii
      $s30 = "+ at start of expression" fullword ascii
      $s31 = "  -n, --quiet, --silent" fullword ascii
      $s32 = "  -E, -r, --regexp-extended" fullword ascii
      $s33 = "dfamust" fullword ascii
      $s34 = "  -i[SUFFIX], --in-place[=SUFFIX]" fullword ascii
      $s35 = "  -z, --null-data" fullword ascii
      $s36 = "  -s, --separate" fullword ascii
      $s37 = "  --follow-symlinks" fullword ascii
      $s38 = "  -u, --unbuffered" fullword ascii
      $s39 = "                 use extended regular expressions in the script" fullword ascii
      $s40 = "                 specify the desired line-wrap length for the `l' command" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 3c 00 00 00 00 00 00 40 00 00 00 00 00 00 00 58 e6 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 38 2c 00 00 00 00 00 00 38 2c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 49 3c 01 00 00 00 00 00 49 3c 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 01 00 00 00 00 00 00 70 01 00 00 00 00 00 00 70 01 00 00 00 00 00 28 5a 00 00 00 00 00 00 28 5a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 d9 01 00 00 00 00 00 b0 d9 01 00 00 00 00 00 b0 d9 01 00 00 00 00 00 54 0b 00 00 00 00 00 00 e8 14 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 b8 dd 01 00 00 00 00 00 b8 dd 01 00 00 00 00 00 b8 dd 01 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d0 99 01 00 00 00 00 00 d0 99 01 00 00 00 00 00 d0 99 01 00 00 00 00 00 34 07 00 00 00 00 00 00 34 07 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 d9 01 00 00 00 00 00 b0 d9 01 00 00 00 00 00 b0 d9 01 00 00 00 00 00 50 06 00 00 00 00 00 00 50 06 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 69 6e 41 d8 b1 10 df 1c 37 6b eb 83 e5 dc 24 c9 77 e2 3f f6 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 7e 00 00 00 02 00 00 00 07 00 00 00 a6 a1 48 00 12 01 ae 16 20 d8 11 12 a0 04 00 90 7e 00 00 00 00 00 00 00 7f 00 00 00 80 00 00 00 82 00 00 00 83 00 00 00 84 00 00 00 86 00 00 00 87 00 00 00 00 00 00 00 89 00 00 00 8b 00 00 00 8c 00 00 00 00 00 00 00 8e 00 00 00 00 00 00 00}
condition:
      filesize < 400KB and
      8 of them and $magic
}

rule gtfobins_binaries_grep {
   strings:
      $s1 = "if any error occurs and -q is not given, the exit status is 2." fullword ascii
      $s2 = "<https://git.savannah.gnu.org/cgit/grep.git/tree/AUTHORS>." fullword ascii
      $s3 = "* at start of expression" fullword ascii
      $s4 = "pcre2_get_error_message_8" fullword ascii
      $s5 = "https://www.gnu.org/software/grep/" fullword ascii
      $s6 = "%s: internal PCRE error: %d" fullword ascii
      $s7 = "%s: binary file matches" fullword ascii
      $s8 = "invalid content of \\{\\}" fullword ascii
      $s9 = "pcre2_get_ovector_pointer_8" fullword ascii
      $s10 = "pcre2_get_startchar_8" fullword ascii
      $s11 = "program error" fullword ascii
      $s12 = "+ at start of expression" fullword ascii
      $s13 = "dfamust" fullword ascii
      $s14 = "warning: --unix-byte-offsets (-u) is obsolete" fullword ascii
      $s15 = "  -L, --files-without-match  print only names of FILEs with no selected lines" fullword ascii
      $s16 = "grep -P uses PCRE2 %s" fullword ascii
      $s17 = "  -B, --before-context=NUM  print NUM lines of leading context" fullword ascii
      $s18 = "recursive, '-' otherwise.  With fewer than two FILEs, assume -h." fullword ascii
      $s19 = "  -l, --files-with-matches  print only names of FILEs with selected lines" fullword ascii
      $s20 = "  -R, --dereference-recursive  likewise, but follow all symlinks" fullword ascii
      $s21 = "  -d, --directories=ACTION  how to handle directories;" fullword ascii
      $s22 = "posixawk" fullword ascii
      $s23 = "pcre2_compile_8" fullword ascii
      $s24 = "pcre2_jit_compile_8" fullword ascii
      $s25 = "pcre2_compile_context_free_8" fullword ascii
      $s26 = "pcre2_config_8" fullword ascii
      $s27 = "pcre2_compile_context_create_8" fullword ascii
      $s28 = "pcre2_set_compile_extra_options_8" fullword ascii
      $s29 = "Usage: %s [OPTION]... PATTERNS [FILE]..." fullword ascii
      $s30 = "When FILE is '-', read standard input.  With no FILE, read '.' if" fullword ascii
      $s31 = "%s: exceeded PCRE's heap limit" fullword ascii
      $s32 = "%s: warning: recursive directory loop" fullword ascii
      $s33 = "%s: PCRE detected recurse loop" fullword ascii
      $s34 = "AWAVATD" fullword ascii
      $s35 = "%s: exceeded PCRE's backtracking limit" fullword ascii
      $s36 = "%s: exceeded PCRE's nested backtracking limit" fullword ascii
      $s37 = "%s: input file is also the output" fullword ascii
      $s38 = "_%s:%td: %s" fullword ascii
      $s39 = "%s: memory exhausted" fullword ascii
      $s40 = "%s: exhausted PCRE JIT stack" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 62 00 00 00 00 00 00 40 00 00 00 00 00 00 00 50 12 03 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 38 00 00 00 00 00 00 08 38 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 79 3e 02 00 00 00 00 00 79 3e 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 02 00 00 00 00 00 00 80 02 00 00 00 00 00 00 80 02 00 00 00 00 00 70 79 00 00 00 00 00 00 70 79 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 ff 02 00 00 00 00 00 50 0f 03 00 00 00 00 00 50 0f 03 00 00 00 00 00 b4 11 00 00 00 00 00 00 40 1d 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 98 09 03 00 00 00 00 00 98 19 03 00 00 00 00 00 98 19 03 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c4 ae 02 00 00 00 00 00 c4 ae 02 00 00 00 00 00 c4 ae 02 00 00 00 00 00 4c 0a 00 00 00 00 00 00 4c 0a 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 ff 02 00 00 00 00 00 50 0f 03 00 00 00 00 00 50 0f 03 00 00 00 00 00 b0 10 00 00 00 00 00 00 b0 10 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 b1 c6 39 c3 72 4b 99 f5 e5 02 ce 5b b3 5b bf 99 87 2e 8a 67 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 93 00 00 00 02 00 00 00 07 00 00 00 a4 a1 08 00 12 01 ae 16 20 98 11 10 a0 04 00 90 93 00 00 00 99 00 00 00 a0 00 00 00 b6 fa 01 eb 8c c7 e0 60 28 1d 8c 1c 7e 6a 9a 75 02 3e 7f 5b d1 65 ce 6d bc 50 76 9e 86 f0 96 7c 66 55 61 10 4e 8e fd 7f 92 98 3c ad e4 62 41 f5 39 f2 8b 1c}
condition:
      filesize < 600KB and
      8 of them and $magic
}

rule gtfobins_binaries_scp {
   strings:
      $s1 = "users-groups-by-id@openssh.com" fullword ascii
      $s2 = "target port not supported with two remote hosts and the -R option" fullword ascii
      $s3 = "Sending SSH2_FXP_EXTENDED(users-groups-by-id@openssh.com)" fullword ascii
      $s4 = "subprocess" fullword ascii
      $s5 = "%s command \"%s\" running as %s (flags 0x%x)" fullword ascii
      $s6 = "limits@openssh.com" fullword ascii
      $s7 = "lsetstat@openssh.com" fullword ascii
      $s8 = "Ensure the remote shell produces no output for non-interactive sessions." fullword ascii
      $s9 = "expand-path@openssh.com" fullword ascii
      $s10 = "incorrect passphrase supplied to decrypt private key" fullword ascii
      $s11 = "Server does not support lsetstat@openssh.com extension" fullword ascii
      $s12 = "sftp_get_users_groups_by_id" fullword ascii
      $s13 = "Sending SSH2_FXP_EXTENDED(posix-rename@openssh.com) \"%s\" to \"%s\"" fullword ascii
      $s14 = "Server does not support limits@openssh.com extension" fullword ascii
      $s15 = "Sending SSH2_FXP_EXTENDED(hardlink@openssh.com) \"%s\" to \"%s\"" fullword ascii
      $s16 = "Sending SSH2_FXP_EXTENDED(statvfs@openssh.com) \"%s\"" fullword ascii
      $s17 = "Sending SSH2_FXP_EXTENDED(lsetstat@openssh.com) \"%s\"" fullword ascii
      $s18 = "sftp connection failed" fullword ascii
      $s19 = "usage: scp [-346ABCOpqRrsTv] [-c cipher] [-D sftp_server_path] [-F ssh_config]" fullword ascii
      $s20 = "Sending SSH2_FXP_EXTENDED(expand-path@openssh.com) \"%s\"" fullword ascii
      $s21 = "target directory \"%s\" does not exist" fullword ascii
      $s22 = "%s: invalid target" fullword ascii
      $s23 = "agent refused operation" fullword ascii
      $s24 = "remote readdir \"%s\" failed" fullword ascii
      $s25 = "download remote \"%s\": server did not send permissions" fullword ascii
      $s26 = "%s: failed to configure tunnel (mode %d): %s" fullword ascii
      $s27 = "download %s: not a regular file" fullword ascii
      $s28 = "sftp_download" fullword ascii
      $s29 = "sftp_download_dir" fullword ascii
      $s30 = "-oRemoteCommand=none" fullword ascii
      $s31 = "fcntl(%d, F_GETFL): %s" fullword ascii
      $s32 = "Couldn't open logfile %s: %s" fullword ascii
      $s33 = "key encrypted using unsupported cipher" fullword ascii
      $s34 = "could not load host key" fullword ascii
      $s35 = "no matching host key type found" fullword ascii
      $s36 = "Sent message limits@openssh.com I:%u" fullword ascii
      $s37 = "Sending SSH2_FXP_EXTENDED(fsync@openssh.com)" fullword ascii
      $s38 = "Sent message fsync@openssh.com I:%u" fullword ascii
      $s39 = "stdio rpath wpath cpath fattr tty proc exec" fullword ascii
      $s40 = "communication with agent failed" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 53 00 00 00 00 00 00 40 00 00 00 00 00 00 00 00 63 03 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 33 00 00 00 00 00 00 10 33 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 fd 4e 02 00 00 00 00 00 fd 4e 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 90 02 00 00 00 00 00 00 90 02 00 00 00 00 00 00 90 02 00 00 00 00 00 bc c4 00 00 00 00 00 00 bc c4 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 55 03 00 00 00 00 00 b0 65 03 00 00 00 00 00 b0 65 03 00 00 00 00 00 a0 0b 00 00 00 00 00 00 50 29 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 10 59 03 00 00 00 00 00 10 69 03 00 00 00 00 00 10 69 03 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 40 dc 02 00 00 00 00 00 40 dc 02 00 00 00 00 00 40 dc 02 00 00 00 00 00 6c 0c 00 00 00 00 00 00 6c 0c 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 55 03 00 00 00 00 00 b0 65 03 00 00 00 00 00 b0 65 03 00 00 00 00 00 50 0a 00 00 00 00 00 00 50 0a 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 ea 25 b6 54 20 6a f4 52 8b 55 a9 ce 68 02 73 ac 61 a0 36 23 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 a3 00 00 00 01 00 00 00 06 00 00 00 07 0d a9 00 30 81 30 12 a3 00 00 00 a7 00 00 00 ac 00 00 00 28 1d 8c 1c 40 4d 9d 7c 00 89 db 3d d1 65 ce 6d bc 50 76 9e 50 b5 a8 10 2e 32 21 1e e4 62 41 f5 39 f2 8b 1c cb 44 77 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 700KB and
      8 of them and $magic
}

rule gtfobins_binaries_sftp {
   strings:
      $s1 = "users-groups-by-id@openssh.com" fullword ascii
      $s2 = "Sending SSH2_FXP_EXTENDED(users-groups-by-id@openssh.com)" fullword ascii
      $s3 = "process_get" fullword ascii
      $s4 = "subprocess" fullword ascii
      $s5 = "%s command \"%s\" running as %s (flags 0x%x)" fullword ascii
      $s6 = "limits@openssh.com" fullword ascii
      $s7 = "lsetstat@openssh.com" fullword ascii
      $s8 = "Ensure the remote shell produces no output for non-interactive sessions." fullword ascii
      $s9 = "expand-path@openssh.com" fullword ascii
      $s10 = "incorrect passphrase supplied to decrypt private key" fullword ascii
      $s11 = "Server does not support lsetstat@openssh.com extension" fullword ascii
      $s12 = "sftp_get_users_groups_by_id" fullword ascii
      $s13 = "Sending SSH2_FXP_EXTENDED(posix-rename@openssh.com) \"%s\" to \"%s\"" fullword ascii
      $s14 = "Server does not support limits@openssh.com extension" fullword ascii
      $s15 = "Sending SSH2_FXP_EXTENDED(hardlink@openssh.com) \"%s\" to \"%s\"" fullword ascii
      $s16 = "Sending SSH2_FXP_EXTENDED(statvfs@openssh.com) \"%s\"" fullword ascii
      $s17 = "Sending SSH2_FXP_EXTENDED(lsetstat@openssh.com) \"%s\"" fullword ascii
      $s18 = "Sending SSH2_FXP_EXTENDED(expand-path@openssh.com) \"%s\"" fullword ascii
      $s19 = "agent refused operation" fullword ascii
      $s20 = "remote readdir \"%s\" failed" fullword ascii
      $s21 = "download remote \"%s\": server did not send permissions" fullword ascii
      $s22 = "%s: failed to configure tunnel (mode %d): %s" fullword ascii
      $s23 = "download %s: not a regular file" fullword ascii
      $s24 = "sftp_download" fullword ascii
      $s25 = "sftp_download_dir" fullword ascii
      $s26 = "process_put" fullword ascii
      $s27 = "fcntl(%d, F_GETFL): %s" fullword ascii
      $s28 = "Couldn't open logfile %s: %s" fullword ascii
      $s29 = "key encrypted using unsupported cipher" fullword ascii
      $s30 = "could not load host key" fullword ascii
      $s31 = "no matching host key type found" fullword ascii
      $s32 = "Sent message limits@openssh.com I:%u" fullword ascii
      $s33 = "Sending SSH2_FXP_EXTENDED(fsync@openssh.com)" fullword ascii
      $s34 = "Sent message fsync@openssh.com I:%u" fullword ascii
      $s35 = "communication with agent failed" fullword ascii
      $s36 = "template string too short" fullword ascii
      $s37 = "origin readdir \"%s\" failed" fullword ascii
      $s38 = "stat remote \"%s\" directory failed" fullword ascii
      $s39 = "stat remote \"%s\" failed" fullword ascii
      $s40 = "Unable to resume download of \"%s\": server reordered requests" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 f0 56 00 00 00 00 00 00 40 00 00 00 00 00 00 00 e0 a2 03 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 88 3d 00 00 00 00 00 00 88 3d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 2d 66 02 00 00 00 00 00 2d 66 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 b0 02 00 00 00 00 00 00 b0 02 00 00 00 00 00 00 b0 02 00 00 00 00 00 c4 d2 00 00 00 00 00 00 c4 d2 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 91 03 00 00 00 00 00 50 91 03 00 00 00 00 00 50 91 03 00 00 00 00 00 e0 0f 00 00 00 00 00 00 b0 50 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 50 98 03 00 00 00 00 00 50 98 03 00 00 00 00 00 50 98 03 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 a0 09 03 00 00 00 00 00 a0 09 03 00 00 00 00 00 a0 09 03 00 00 00 00 00 84 0c 00 00 00 00 00 00 84 0c 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 91 03 00 00 00 00 00 50 91 03 00 00 00 00 00 50 91 03 00 00 00 00 00 b0 0e 00 00 00 00 00 00 b0 0e 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 7f 14 06 60 07 8b 7d 29 32 ac 89 f3 6f 0a c8 11 ce db 3e 17 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 b6 00 00 00 04 00 00 00 08 00 00 00 81 02 81 60 40 81 06 aa 0a 20 21 01 a0 10 60 00 00 00 01 00 40 00 01 10 10 06 81 00 24 40 40 01 b6 00 00 00 00 00 00 00 b9 00 00 00 ba 00 00 00 bc 00 00 00 bd 00 00 00 be 00 00 00 bf 00 00 00 c1 00 00 00 c2 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 700KB and
      8 of them and $magic
}

rule gtfobins_binaries_ssh_keyscan {
   strings:
      $s1 = "publickey-hostbound@openssh.com" fullword ascii
      $s2 = "%s: Failed to set SELinux execution context for %s (in enforcing mode)" fullword ascii
      $s3 = "missing hostkey loader" fullword ascii
      $s4 = "%s%s%s:%ld: Removed %s key for host %s" fullword ascii
      $s5 = "ext-info-in-auth@openssh.com" fullword ascii
      $s6 = "webauthn-sk-ecdsa-sha2-nistp256@openssh.com" fullword ascii
      $s7 = "%s: Failed to set SELinux execution context for %s" fullword ascii
      $s8 = "%s: Failed to get default SELinux security context for %s (in enforcing mode)" fullword ascii
      $s9 = "subprocess" fullword ascii
      $s10 = "ext-info-s,kex-strict-s-v00@openssh.com" fullword ascii
      $s11 = "ping@openssh.com" fullword ascii
      $s12 = "sk-ecdsa-sha2-nistp256-cert-v01@openssh.com" fullword ascii
      $s13 = "rsa-sha2-256,rsa-sha2-256-cert-v01@openssh.com" fullword ascii
      $s14 = "ssh-ed25519-cert-v01@openssh.com" fullword ascii
      $s15 = "sntrup761x25519-sha512@openssh.com" fullword ascii
      $s16 = "sk-ecdsa-sha2-nistp256@openssh.com" fullword ascii
      $s17 = "ext-info-c,kex-strict-c-v00@openssh.com" fullword ascii
      $s18 = "chacha20-poly1305@openssh.com" fullword ascii
      $s19 = "sk-ssh-ed25519@openssh.com" fullword ascii
      $s20 = "rsa-sha2-512-cert-v01@openssh.com" fullword ascii
      $s21 = "kex-strict-s-v00@openssh.com" fullword ascii
      $s22 = "%s command \"%s\" running as %s (flags 0x%x)" fullword ascii
      $s23 = "sk-ssh-ed25519-cert-v01@openssh.com" fullword ascii
      $s24 = "kex-strict-c-v00@openssh.com" fullword ascii
      $s25 = "rsa-sha2-512,rsa-sha2-512-cert-v01@openssh.com" fullword ascii
      $s26 = "rsa-sha2-256-cert-v01@openssh.com" fullword ascii
      $s27 = "reverse mapping checking getaddrinfo for %.700s [%s] failed." fullword ascii
      $s28 = "chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com" fullword ascii
      $s29 = "ssh-xmss@openssh.com" fullword ascii
      $s30 = "rsa-sha2-512-cert-v01@openssh.com,rsa-sha2-256-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com" fullword ascii
      $s31 = "ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp384-cert-v01@openssh.com,ecdsa-sha2-nistp521-cert-v01@openssh.com" fullword ascii
      $s32 = "ssh-xmss-cert-v01@openssh.com" fullword ascii
      $s33 = "%s: ssh_selinux_getctxbyname: security_getenforce() failed" fullword ascii
      $s34 = "%s:%ld: parse error in hostkeys file" fullword ascii
      $s35 = "%s: Failed to get default SELinux security context for %s" fullword ascii
      $s36 = "sshkey_dump_ec_point" fullword ascii
      $s37 = "incorrect passphrase supplied to decrypt private key" fullword ascii
      $s38 = "agent refused operation" fullword ascii
      $s39 = "setexeccon" fullword ascii
      $s40 = "getseuserbyname" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 9c 00 00 00 00 00 00 40 00 00 00 00 00 00 00 60 32 08 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 76 00 00 00 00 00 00 08 76 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 6d 51 04 00 00 00 00 00 6d 51 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 04 00 00 00 00 00 00 e0 04 00 00 00 00 00 00 e0 04 00 00 00 00 00 cc 21 03 00 00 00 00 00 cc 21 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 0e 08 00 00 00 00 00 70 1e 08 00 00 00 00 00 70 1e 08 00 00 00 00 00 40 22 00 00 00 00 00 00 a0 31 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a0 23 08 00 00 00 00 00 a0 33 08 00 00 00 00 00 a0 33 08 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 00 23 07 00 00 00 00 00 00 23 07 00 00 00 00 00 00 23 07 00 00 00 00 00 d4 1a 00 00 00 00 00 00 d4 1a 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 0e 08 00 00 00 00 00 70 1e 08 00 00 00 00 00 70 1e 08 00 00 00 00 00 90 21 00 00 00 00 00 00 90 21 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 0e 58 1f 06 a0 55 42 c1 25 bb 7a 4f 15 2b 66 46 28 07 3f 51 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 4d 01 00 00 02 00 00 00 07 00 00 00 00 00 00 12 12 81 00 16 26 0e 81 04 e2 04 00 00 4d 01 00 00 52 01 00 00 58 01 00 00 28 1d 8c 1c 56 61 36 cb d0 65 ce 6d e6 d0 45 cc 41 4d 9d 7c 50 b5 a8 10 66 55 61 10 bc 50 76 9e 38 f2 8b 1c e4 62 41 f5 2f 32 21 1e 18 ee ff 54 cb 44 77 12}
condition:
      filesize < 2000KB and
      8 of them and $magic
}

rule gtfobins_binaries_ssh_agent {
   strings:
      $s1 = "publickey-hostbound-v00@openssh.com" fullword ascii
      $s2 = "usage: ssh-agent [-c | -s] [-Dd] [-a bind_address] [-E fingerprint_hash]" fullword ascii
      $s3 = "unable to make the process undumpable: %s" fullword ascii
      $s4 = "unexpected session ID (%zu listed) on signature request for target user %s with key %s %s" fullword ascii
      $s5 = "webauthn-sk-ecdsa-sha2-nistp256@openssh.com" fullword ascii
      $s6 = "session-bind@openssh.com" fullword ascii
      $s7 = "process_ext_session_bind" fullword ascii
      $s8 = "socketentry fd=%d, entry %zu %s, from hostkey %s %s to user %s hostkey %s %s" fullword ascii
      $s9 = "process_lock_agent" fullword ascii
      $s10 = "subprocess" fullword ascii
      $s11 = "sk-ecdsa-sha2-nistp256-cert-v01@openssh.com" fullword ascii
      $s12 = "restrict-destination-v00@openssh.com" fullword ascii
      $s13 = "ssh-ed25519-cert-v01@openssh.com" fullword ascii
      $s14 = "sk-ecdsa-sha2-nistp256@openssh.com" fullword ascii
      $s15 = "chacha20-poly1305@openssh.com" fullword ascii
      $s16 = "sk-ssh-ed25519@openssh.com" fullword ascii
      $s17 = "sk-provider@openssh.com" fullword ascii
      $s18 = "rsa-sha2-512-cert-v01@openssh.com" fullword ascii
      $s19 = "%s command \"%s\" running as %s (flags 0x%x)" fullword ascii
      $s20 = "sk-ssh-ed25519-cert-v01@openssh.com" fullword ascii
      $s21 = "associated-certs-v00@openssh.com" fullword ascii
      $s22 = "rsa-sha2-256-cert-v01@openssh.com" fullword ascii
      $s23 = "%s: entering hostname %s, requested key %s %s, %u keys avail" fullword ascii
      $s24 = "sshkey_dump_ec_point" fullword ascii
      $s25 = "incorrect passphrase supplied to decrypt private key" fullword ascii
      $s26 = "Confirm user presence for key %s %s%s%s" fullword ascii
      $s27 = "public key authentication request for user \"%s\" to listed host" fullword ascii
      $s28 = "empty password not supported" fullword ascii
      $s29 = "%s%s%s: adding %skey %s %s" fullword ascii
      $s30 = "agent refused operation" fullword ascii
      $s31 = "%s: failed to configure tunnel (mode %d): %s" fullword ascii
      $s32 = "exec(%s): %s" fullword ascii
      $s33 = "{\"type\":\"webauthn.get\",\"challenge\":\"" fullword ascii
      $s34 = "process_extension" fullword ascii
      $s35 = "previous session bind failed on socket" fullword ascii
      $s36 = "process_request_identities" fullword ascii
      $s37 = "process_sign_request2" fullword ascii
      $s38 = "process_remove_all_identities" fullword ascii
      $s39 = "process_remove_identity" fullword ascii
      $s40 = "refusing use of destination-constrained key: mismatch between hostkey in request and most recently bound session" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 96 00 00 00 00 00 00 40 00 00 00 00 00 00 00 00 62 06 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 6a 00 00 00 00 00 00 10 6a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 ad 10 03 00 00 00 00 00 ad 10 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 ac a8 02 00 00 00 00 00 ac a8 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 45 06 00 00 00 00 00 70 45 06 00 00 00 00 00 70 45 06 00 00 00 00 00 e0 1a 00 00 00 00 00 00 98 3e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 60 54 06 00 00 00 00 00 60 54 06 00 00 00 00 00 60 54 06 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 80 9c 05 00 00 00 00 00 80 9c 05 00 00 00 00 00 80 9c 05 00 00 00 00 00 2c 12 00 00 00 00 00 00 2c 12 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 45 06 00 00 00 00 00 70 45 06 00 00 00 00 00 70 45 06 00 00 00 00 00 90 1a 00 00 00 00 00 00 90 1a 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 fc 9c 3f 63 2c 8f 43 30 4e d3 81 e1 a0 a9 dc fa ab da 03 61 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 39 01 00 00 02 00 00 00 07 00 00 00 00 00 00 12 12 81 00 16 26 0e 81 04 62 04 00 00 39 01 00 00 3e 01 00 00 43 01 00 00 28 1d 8c 1c 56 61 36 cb d0 65 ce 6d e6 d0 45 cc 41 4d 9d 7c 50 b5 a8 10 bc 50 76 9e 38 f2 8b 1c e4 62 41 f5 2f 32 21 1e 18 ee ff 54 cb 44 77 12 00 00 00 00}
condition:
      filesize < 1000KB and
      8 of them and $magic
}

rule gtfobins_binaries_redis_cli {
   strings:
      $s1 = "  -r <repeat>        Execute specified command N times." fullword ascii
      $s2 = "*** Found %d key(s) in both source node and target node having different values." fullword ascii
      $s3 = "  redis-cli -D \"\" --raw dump key > key.dump && redis-cli -X dump_tag restore key2 0 dump_tag replace < key.dump" fullword ascii
      $s4 = "  -e                 Return exit error code when command execution fails." fullword ascii
      $s5 = "Execute all commands issued after MULTI" fullword ascii
      $s6 = "*** Target key exists" fullword ascii
      $s7 = "  --no-auth-warning  Don't show warning message when using password on command" fullword ascii
      $s8 = "[ERR] Invalid --cluster-from host. You need to pass a valid address (ie. 120.0.0.1:7000)." fullword ascii
      $s9 = "total_commands_processed" fullword ascii
      $s10 = "Marks a pending message as correctly processed, effectively removing it from the pending entries list of the consumer group. Ret" ascii
      $s11 = "Stop processing commands from clients for some time" fullword ascii
      $s12 = "*** Configuring %s:%d as the slot owner" fullword ascii
      $s13 = "*** It is not possible to use the target node as source node." fullword ascii
      $s14 = "Execute a Lua script server side" fullword ascii
      $s15 = "Returns whether the user can execute the given command without executing the command." fullword ascii
      $s16 = "Dump all functions into a serialized binary payload" fullword ascii
      $s17 = "Execute a read-only Lua script server side" fullword ascii
      $s18 = "help    -- Show Lua script debugging commands." fullword ascii
      $s19 = ">>> Failed retrieving Functions from the cluster, skip this step as Redis version do not support function command (error = '%s')" ascii
      $s20 = "Error getting freq for key '%s' (%d: %s)" fullword ascii
      $s21 = "Error getting size for key '%s' (%d: %s)" fullword ascii
      $s22 = "*** Found keys about slot %d in node %s:%d!" fullword ascii
      $s23 = "Error getting type for key '%s' (%d: %s)" fullword ascii
      $s24 = "*** Found keys about slot %d in non-owner node %s:%d!" fullword ascii
      $s25 = "  redis-cli --eval myscript.lua key1 key2 , arg1 arg2 arg3" fullword ascii
      $s26 = "<host:port> or <host> <port> - separated by either colon or space" fullword ascii
      $s27 = "Warning: Using a password with '-a' or '-u' option on the command line interface may not be safe." fullword ascii
      $s28 = "*** Replacing target keys..." fullword ascii
      $s29 = "  --pass <password>  Alias of -a for consistency with the new --user option." fullword ascii
      $s30 = "  -s <socket>        Server socket (overrides hostname and port)." fullword ascii
      $s31 = "Error reading RDB payload while SYNCing" fullword ascii
      $s32 = "rehashing target" fullword ascii
      $s33 = "I/O Error reading RDB payload from socket" fullword ascii
      $s34 = "Please input import source node password: " fullword ascii
      $s35 = "*** Importing %d keys from DB 0" fullword ascii
      $s36 = "restart -- Restart the script in debug mode again." fullword ascii
      $s37 = " - The port %d of node %s may be unreachable from:" fullword ascii
      $s38 = "*** ERROR: Invalid configuration for cluster creation." fullword ascii
      $s39 = "A container for Lua scripts management commands" fullword ascii
      $s40 = "                     when getting the RDB dump file." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 44 01 00 00 00 00 00 40 00 00 00 00 00 00 00 90 c1 05 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b0 07 01 00 00 00 00 00 b0 07 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 01 00 00 00 00 00 00 10 01 00 00 00 00 00 00 10 01 00 00 00 00 00 49 d1 02 00 00 00 00 00 49 d1 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 f0 03 00 00 00 00 00 00 f0 03 00 00 00 00 00 00 f0 03 00 00 00 00 00 b0 7f 01 00 00 00 00 00 b0 7f 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 77 05 00 00 00 00 00 f0 77 05 00 00 00 00 00 f0 77 05 00 00 00 00 00 f8 47 00 00 00 00 00 00 28 97 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 78 05 00 00 00 00 00 e0 78 05 00 00 00 00 00 e0 78 05 00 00 00 00 00 60 02 00 00 00 00 00 00 60 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 94 ff 04 00 00 00 00 00 94 ff 04 00 00 00 00 00 94 ff 04 00 00 00 00 00 74 10 00 00 00 00 00 00 74 10 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 77 05 00 00 00 00 00 f0 77 05 00 00 00 00 00 f0 77 05 00 00 00 00 00 10 08 00 00 00 00 00 00 10 08 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 55 44 f2 7e 43 44 52 e7 d2 26 0f d4 a4 98 9d fa 46 e9 51 52 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 07 01 00 00 8d 00 00 00 20 00 00 00 0b 00 00 00 61 40 10 00 1c 30 28 21 0f 09 00 c2 30 81 91 00 80 00 00 40 08 07 00 00 04 90 64 98 11 25 44 00 07 46 0e 18 04 87 69 08 1c 24 6a 80 f2 44 1a 2a b7 87 33 4c 0e 85 01 00 b5 d1 90 c9 e8 c0 03 00 05 1f 27 70 da 59 0f d2 5c 2f 00 62 c2 21 04 48}
condition:
      filesize < 1000KB and
      8 of them and $magic
}

rule gtfobins_binaries_mosquitto {
   strings:
      $s1 = " -v : verbose mode - enable all logging types. This overrides" fullword ascii
      $s2 = "Invalid QoS in subscription command from %s, disconnecting." fullword ascii
      $s3 = "Protocol error from %s: password without username, closing connection." fullword ascii
      $s4 = "Error: Unable to decode password salt for user %s, removing entry." fullword ascii
      $s5 = "Error: Unable to decode password for user %s, removing entry." fullword ascii
      $s6 = "Error: Missing password hash for user %s, removing entry." fullword ascii
      $s7 = "Error: Invalid password hash for user %s, removing entry." fullword ascii
      $s8 = "Error: Invalid password hash type for user %s, removing entry." fullword ascii
      $s9 = "Failed to associate persisted user %s with ACLs, likely due to changed ports while using a per_listener_settings configuration." fullword ascii
      $s10 = "Error: Unsupported auth plugin version (got %d, expected %d)." fullword ascii
      $s11 = "Error setting gid whilst dropping privileges: %s." fullword ascii
      $s12 = "Error setting groups whilst dropping privileges: %s." fullword ascii
      $s13 = "Error: Unable to load auth plugin function mosquitto_auth_psk_key_get()." fullword ascii
      $s14 = "Error: -p argument given, but no port specified." fullword ascii
      $s15 = "Error opening password file \"%s\"." fullword ascii
      $s16 = "Error: -c argument given, but no config file specified." fullword ascii
      $s17 = "Error setting uid whilst dropping privileges: %s." fullword ascii
      $s18 = "Error: Only %d ports can be specified on the command line." fullword ascii
      $s19 = "Subscription identifiers not supported" fullword ascii
      $s20 = "Client %s connected with too large Will payload" fullword ascii
      $s21 = "Client %s disconnected due to oversize payload." fullword ascii
      $s22 = "Error: Unable to load engine private key file \"%s\"." fullword ascii
      $s23 = "Error: Unable to use engine private key file \"%s\"." fullword ascii
      $s24 = "Empty unsubscription string from %s, disconnecting." fullword ascii
      $s25 = "Error: Invalid hash iterations for user %s, removing entry." fullword ascii
      $s26 = "Invalid unsubscription string from %s, disconnecting." fullword ascii
      $s27 = "Empty subscription string from %s, disconnecting." fullword ascii
      $s28 = "Invalid subscription string from %s, disconnecting." fullword ascii
      $s29 = "subs__shared_process" fullword ascii
      $s30 = "property__process_connect" fullword ascii
      $s31 = "Error: Invalid log_facility value (%d)." fullword ascii
      $s32 = "Error: Invalid log_dest value (%s)." fullword ascii
      $s33 = "Warning: Invalid line in password file '%s', username too long." fullword ascii
      $s34 = "Error: Invalid log_type value (%s)." fullword ascii
      $s35 = "Warning: Invalid line in password file '%s': %s" fullword ascii
      $s36 = "Warning: Invalid line in password file '%s', password too long." fullword ascii
      $s37 = "property__process_disconnect" fullword ascii
      $s38 = "Error: Config file %s is a directory." fullword ascii
      $s39 = "Error: Empty log_type value in configuration." fullword ascii
      $s40 = "Error: Empty log_dest value in configuration." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 10 ba 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f8 b1 04 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 9b 00 00 00 00 00 00 80 9b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 95 0f 03 00 00 00 00 00 95 0f 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 b0 03 00 00 00 00 00 00 b0 03 00 00 00 00 00 00 b0 03 00 00 00 00 00 c4 eb 00 00 00 00 00 00 c4 eb 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 c8 a4 04 00 00 00 00 00 c8 a4 04 00 00 00 00 00 c8 a4 04 00 00 00 00 00 f0 0b 00 00 00 00 00 00 48 5e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 a4 04 00 00 00 00 00 d8 a4 04 00 00 00 00 00 d8 a4 04 00 00 00 00 00 60 02 00 00 00 00 00 00 60 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 88 34 04 00 00 00 00 00 88 34 04 00 00 00 00 00 88 34 04 00 00 00 00 00 f4 0c 00 00 00 00 00 00 f4 0c 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 c8 a4 04 00 00 00 00 00 c8 a4 04 00 00 00 00 00 c8 a4 04 00 00 00 00 00 38 0b 00 00 00 00 00 00 38 0b 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 38 5b 8b f6 8b 57 56 6a 39 7c bd 04 fc af d2 f2 40 a3 34 91 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 07 01 00 00 16 01 00 00 20 00 00 00 0b 00 00 00 01 18 80 1c 45 01 81 dc 00 29 12 c0 04 84 9b 41 09 88 05 86 81 08 40 e8 00 00 10 88 00 04 03 00 82 4d 02 08 de 78 16 80 12 f2 01 07 03 07 c1 15 28 01 00 a0 62 02 25 40 20 5a e3 0b 1a 40 60 f2 b5 51 1e 40 d0 11 04 76 62 ca 24 21 82 c5 24 00}
condition:
      filesize < 900KB and
      8 of them and $magic
}

rule gtfobins_binaries_run_parts {
   strings:
      $s1 = "failed to exec %s: %s" fullword ascii
      $s2 = "      --new-session   run each script in a separate process session" fullword ascii
      $s3 = "run-parts: component %s is not an executable plain file" fullword ascii
      $s4 = "run-parts: failed to rewind temporary file: %s" fullword ascii
      $s5 = "run-parts: failed to write to temporary file" fullword ascii
      $s6 = "  -a, --arg=ARGUMENT  pass ARGUMENT to scripts, use once for each argument." fullword ascii
      $s7 = "failed to read from error pipe: %s" fullword ascii
      $s8 = "      --stdin         multiplex stdin to scripts being run, using temporary file" fullword ascii
      $s9 = "failed to read from stdout pipe: %s" fullword ascii
      $s10 = "failed to stat component %s: %s" fullword ascii
      $s11 = "run-parts: failed to copy content of stdin" fullword ascii
      $s12 = "      --reverse       reverse execution order of scripts." fullword ascii
      $s13 = "run-parts: component %s is a broken symbolic link" fullword ascii
      $s14 = "failed to open directory %s: %s" fullword ascii
      $s15 = "run-parts: executing %s" fullword ascii
      $s16 = "      --report        print script names if they produce output." fullword ascii
      $s17 = "      --exit-on-error exit as soon as a script returns with a non-zero exit" fullword ascii
      $s18 = "Try `run-parts --help' for more information." fullword ascii
      $s19 = "This is free software; see the GNU General Public License version 2" fullword ascii
      $s20 = "\"%s\": hierre pass, excsre %s" fullword ascii
      $s21 = "run-parts: failed to read from stdin" fullword ascii
      $s22 = "Debian run-parts program, version 5.20" fullword ascii
      $s23 = "  -v, --verbose       print script names before running them." fullword ascii
      $s24 = "  -d, --debug         print script names while checking them." fullword ascii
      $s25 = "      --test          print script names which would run, but don't run them." fullword ascii
      $s26 = "--list and --test can not be used together" fullword ascii
      $s27 = "lsbsysinit" fullword ascii
      $s28 = "exit-on-error" fullword ascii
      $s29 = "new-session" fullword ascii
      $s30 = "run-parts: " fullword ascii
      $s31 = "^[a-z0-9-].*\\.dpkg-(old|dist|new|tmp)$" fullword ascii
      $s32 = "\"%s\": tradre %s" fullword ascii
      $s33 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/debianutils.debug" fullword ascii
      $s34 = "\"%s\": customre %s" fullword ascii
      $s35 = "Usage: run-parts [OPTION]... DIRECTORY" fullword ascii
      $s36 = "  -V, --version       output version information and exit." fullword ascii
      $s37 = "Copyright (C) 1994 Ian Jackson, Copyright (C) 1996 Jeff Noxon." fullword ascii
      $s38 = "bad umask value" fullword ascii
      $s39 = "Virtual memory exhausted" fullword ascii /* Goodware String - occured 1 times */
      $s40 = "failed to fork: %s" fullword ascii /* Goodware String - occured 1 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 26 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c0 63 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f8 14 00 00 00 00 00 00 f8 14 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 09 19 00 00 00 00 00 00 09 19 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 a0 0e 00 00 00 00 00 00 a0 0e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 38 5c 00 00 00 00 00 00 38 5c 00 00 00 00 00 00 38 5c 00 00 00 00 00 00 e8 05 00 00 00 00 00 00 d0 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 48 5c 00 00 00 00 00 00 48 5c 00 00 00 00 00 00 48 5c 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 54 4b 00 00 00 00 00 00 54 4b 00 00 00 00 00 00 54 4b 00 00 00 00 00 00 84 00 00 00 00 00 00 00 84 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 38 5c 00 00 00 00 00 00 38 5c 00 00 00 00 00 00 38 5c 00 00 00 00 00 00 c8 03 00 00 00 00 00 00 c8 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 a2 1e 6c a6 45 66 14 05 a5 c9 cb 70 79 ca db 1c 21 97 09 ec 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 36 00 00 00 01 00 00 00 06 00 00 00 80 05 81 00 00 81 1c 02 36 00 00 00 38 00 00 00 39 00 00 00 28 1d 8c 1c d1 65 ce 6d 39 f2 8b 1c ee 21 63 0f 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0f 01 00 00 12 00 00 00}
condition:
      filesize < 80KB and
      8 of them and $magic
}

rule gtfobins_binaries_hping3 {
   strings:
      $s1 = "wrong --rand-dest target host, correct examples:" fullword ascii
      $s2 = "  -j  --dump       dump packets in hex" fullword ascii
      $s3 = "you must specify a target host if you require safe protocol" fullword ascii
      $s4 = "[datafiller.c INTERNAL ERROR] readed = %d - opt_end == %d" fullword ascii
      $s5 = "HPING %s (%s %s): %s set, %d headers + %d data bytes" fullword ascii
      $s6 = "hping3: you must specify only one target host at a time" fullword ascii
      $s7 = "check -d option, don't specify -d to let hping compute it" fullword ascii
      $s8 = "--- %s hping statistic ---" fullword ascii
      $s9 = "  -J  --print      dump printable characters" fullword ascii
      $s10 = "                   Example: hping --scan 1-30,70-90 -S www.target.host" fullword ascii
      $s11 = "  -a  --spoof      spoof source address" fullword ascii
      $s12 = "Option error: sorry, safe protocol require you sign your packets, see --sign | -e option" fullword ascii
      $s13 = "Scanning %s (%s), port %s" fullword ascii
      $s14 = "usage: hping3 host [options]" fullword ascii
      $s15 = "  -z  --bind      bind ctrl+z to ttl           (default to dst port)" fullword ascii
      $s16 = "- get_usec() = %ld" fullword ascii
      $s17 = "because hping needs a target for HCMP packets" fullword ascii
      $s18 = "DEBUG: [get_output_if] connect" fullword ascii
      $s19 = "  -r  --rel        relativize id field          (to estimate host traffic)" fullword ascii
      $s20 = "hping in flood mode, no replies will be shown" fullword ascii
      $s21 = "%d ports to scan, use -V to see all the replies" fullword ascii
      $s22 = "  -i  --interval  wait (uX for X microseconds, for example -i u1000)" fullword ascii
      $s23 = "      --icmp-gw    set gateway address for ICMP redirect (default 0.0.0.0)" fullword ascii
      $s24 = "Ports syntax error for scan mode" fullword ascii
      $s25 = "baseport" fullword ascii
      $s26 = "Option error: -E option useless without -d" fullword ascii
      $s27 = "%d packets transmitted, %d packets received, %d%% packet loss" fullword ascii
      $s28 = "destport" fullword ascii
      $s29 = "- delaytable.sec = %ld" fullword ascii
      $s30 = "Option error: you need to specify an interface when the --rand-dest option is enabled" fullword ascii
      $s31 = "  -p  --destport   [+][+]<port> destination port(default 0) ctrl+z inc/dec" fullword ascii
      $s32 = "ifname ?script?" fullword ascii
      $s33 = "Invalid field for TCP.MSS layer: '%s'" fullword ascii
      $s34 = "ARS packet description (new, unstable)" fullword ascii
      $s35 = "Unknown keyword: '%s'" fullword ascii
      $s36 = "sport=%d flags=%s seq=%d win=%d rtt=%.1f ms" fullword ascii
      $s37 = "  -f  --frag       split packets in more frag.  (may pass weak acl)" fullword ascii
      $s38 = "status=%d port=%d seq=%d" fullword ascii
      $s39 = "Option error: signature (%d bytes) is larger than data size" fullword ascii
      $s40 = "Invalid hex value for ip.sec hex: '%s'" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 52 00 00 00 00 00 00 40 00 00 00 00 00 00 00 78 7d 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c8 3a 00 00 00 00 00 00 c8 3a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 cd 70 01 00 00 00 00 00 cd 70 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 c0 01 00 00 00 00 00 00 c0 01 00 00 00 00 00 00 c0 01 00 00 00 00 00 d8 8e 00 00 00 00 00 00 d8 8e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 59 02 00 00 00 00 00 50 59 02 00 00 00 00 00 50 59 02 00 00 00 00 00 e0 22 00 00 00 00 00 00 10 e4 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 59 02 00 00 00 00 00 e0 59 02 00 00 00 00 00 e0 59 02 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 60 0b 02 00 00 00 00 00 60 0b 02 00 00 00 00 00 60 0b 02 00 00 00 00 00 74 09 00 00 00 00 00 00 74 09 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 59 02 00 00 00 00 00 50 59 02 00 00 00 00 00 50 59 02 00 00 00 00 00 b0 06 00 00 00 00 00 00 b0 06 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 18 cc 4d 6f b7 d6 7a 34 9c ed 90 5a 4c de e3 7d 6c a1 04 99 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 7f 00 00 00 01 00 00 00 06 00 00 00 00 01 81 20 00 01 50 02 7f 00 00 00 81 00 00 00 00 00 00 00 d0 65 ce 6d 29 1d 8c 1c 76 27 0b af 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 43 02 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_wc {
   strings:
      $s1 = "                           If F is - then read names from standard input" fullword ascii
      $s2 = "  -L, --max-line-length  print the maximum display width" fullword ascii
      $s3 = "using avx2 hardware support" fullword ascii
      $s4 = "3fbed5c1475f9da1b5c0de0377592814a84f27.debug" fullword ascii
      $s5 = "avx2 support not detected" fullword ascii
      $s6 = "total words" fullword ascii
      $s7 = "      --files0-from=F    read input from the files specified by" fullword ascii
      $s8 = "  or:  %s [OPTION]... --files0-from=F" fullword ascii
      $s9 = "total bytes" fullword ascii
      $s10 = "total characters" fullword ascii
      $s11 = "total lines" fullword ascii
      $s12 = "obstack_alloc_failed_handler" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "more than one FILE is specified.  A word is a non-zero-length sequence of" fullword ascii
      $s14 = "The options below may be used to select which counts are printed, always in" fullword ascii /* Goodware String - occured 1 times */
      $s15 = "the following order: newline, word, character, byte, maximum line length." fullword ascii /* Goodware String - occured 1 times */
      $s16 = "_obstack_allocated_p" fullword ascii /* Goodware String - occured 1 times */
      $s17 = "_obstack_memory_used" fullword ascii /* Goodware String - occured 1 times */
      $s18 = "printable characters delimited by white space." fullword ascii
      $s19 = "3fbed5c1475f9da1b5c0de0377592814a84f27" ascii
      $s20 = "_obstack_begin_1" fullword ascii /* Goodware String - occured 1 times */
      $s21 = "  -l, --lines            print the newline counts" fullword ascii
      $s22 = "  -m, --chars            print the character counts" fullword ascii
      $s23 = "Print newline, word, and byte counts for each FILE, and a total line if" fullword ascii /* Goodware String - occured 2 times */
      $s24 = "  -c, --bytes            print the byte counts" fullword ascii
      $s25 = "!\"unexpected error code from argv_iter\"" fullword ascii /* Goodware String - occured 2 times */
      $s26 = "      --total=WHEN       when to print a line with total counts;" fullword ascii
      $s27 = "max-line-length" fullword ascii /* Goodware String - occured 2 times */
      $s28 = "  -w, --words            print the word counts" fullword ascii
      $s29 = "%s:%lu: %s" fullword ascii /* Goodware String - occured 3 times */
      $s30 = "file operands cannot be combined with --files0-from" fullword ascii /* Goodware String - occured 3 times */
      $s31 = "when reading file names from stdin, no file name of %s allowed" fullword ascii /* Goodware String - occured 3 times */
      $s32 = "invalid zero-length file name" fullword ascii /* Goodware String - occured 3 times */
      $s33 = "cannot read file names from %s" fullword ascii /* Goodware String - occured 3 times */
      $s34 = "files0-from" fullword ascii /* Goodware String - occured 4 times */
      $s35 = "t?H9E8u" fullword ascii
      $s36 = "--total" fullword ascii
      $s37 = "L9&s4H" fullword ascii
      $s38 = "_obstack_free" fullword ascii /* Goodware String - occured 4 times */
      $s39 = "src/wc.c" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 41 00 00 00 00 00 00 40 00 00 00 00 00 00 00 78 f4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c8 1c 00 00 00 00 00 00 c8 1c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 b9 80 00 00 00 00 00 00 b9 80 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 10 30 00 00 00 00 00 00 10 30 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 a8 eb 00 00 00 00 00 00 a8 fb 00 00 00 00 00 00 a8 fb 00 00 00 00 00 00 20 07 00 00 00 00 00 00 98 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 b8 ed 00 00 00 00 00 00 b8 fd 00 00 00 00 00 00 b8 fd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 b4 c6 00 00 00 00 00 00 b4 c6 00 00 00 00 00 00 b4 c6 00 00 00 00 00 00 34 04 00 00 00 00 00 00 34 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 a8 eb 00 00 00 00 00 00 a8 fb 00 00 00 00 00 00 a8 fb 00 00 00 00 00 00 58 04 00 00 00 00 00 00 58 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 0e 3f be d5 c1 47 5f 9d a1 b5 c0 de 03 77 59 28 14 a8 4f 27 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 47 00 00 00 02 00 00 00 07 00 00 00 a6 a1 48 04 12 01 ae 36 20 d8 11 12 a0 04 00 90 47 00 00 00 00 00 00 00 48 00 00 00 49 00 00 00 4b 00 00 00 4c 00 00 00 4d 00 00 00 4f 00 00 00 50 00 00 00 00 00 00 00 52 00 00 00 54 00 00 00 55 00 00 00 00 00 00 00 57 00 00 00 58 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_find {
   strings:
      $s1 = "DebugExec: launching process (argc=%lu):" fullword ascii
      $s2 = "DebugExec: process (PID=%ld) terminated with exit status: %d" fullword ascii
      $s3 = "      -execdir COMMAND ; -execdir COMMAND {} + -okdir COMMAND ;" fullword ascii
      $s4 = "      -exec COMMAND ; -exec COMMAND {} + -ok COMMAND ;" fullword ascii
      $s5 = "File descriptor %d will leak; please report this as a bug, remembering to include a detailed description of the simplest way to " ascii
      $s6 = "fallback_getfilecon(): getfilecon(%s) failed; falling back on lgetfilecon()" fullword ascii
      $s7 = "process_all_startpoints" fullword ascii
      $s8 = "fgetfilecon" fullword ascii
      $s9 = "lgetfilecon" fullword ascii
      $s10 = "Failed to initialize shared-file hash table" fullword ascii
      $s11 = "Operators (decreasing precedence; -and is implicit where no others are given):" fullword ascii
      $s12 = "failed to compile regular expression '%s': %s" fullword ascii
      $s13 = "slash - dir < 4096" fullword ascii
      $s14 = "file operands cannot be combined with -files0-from" fullword ascii
      $s15 = "option -files0-from: standard input must not refer to the same file when combined with -ok, -okdir: %s" fullword ascii
      $s16 = "Failed to change directory%s%s" fullword ascii
      $s17 = "warning: you have specified a mode pattern %s (which is equivalent to /000). The meaning of -perm /000 has now been changed to b" ascii
      $s18 = "Failed to restore initial working directory%s%s" fullword ascii
      $s19 = "Failed to write prompt for -ok" fullword ascii
      $s20 = "      -readable -writable -executable" fullword ascii
      $s21 = "Failed to save initial working directory%s%s" fullword ascii
      $s22 = "invalid user name or UID argument to -user: %s" fullword ascii
      $s23 = "https://savannah.gnu.org/bugs/?group=findutils" fullword ascii
      $s24 = "program via the %s bug-reporting page at" fullword ascii
      $s25 = "https://www.gnu.org/software/findutils/" fullword ascii
      $s26 = "failed to read file names from file system at or below %s" fullword ascii
      $s27 = "The current directory is included in the PATH environment variable, which is insecure in combination with the %s action of find." ascii
      $s28 = "Use '-D help' for a description of the options, or see find(1)" fullword ascii
      $s29 = "The relative path %s is included in the PATH environment variable, which is insecure in combination with the %s action of find. " ascii
      $s30 = "fuse.portal" fullword ascii
      $s31 = "option -files0-from reading from standard input cannot be combined with -ok, -okdir" fullword ascii
      $s32 = "Failed to write output (at stage %d)" fullword ascii
      $s33 = "%s %c is not supported because Solaris doors are not supported on the platform find was compiled on." fullword ascii
      $s34 = "warning: you have specified the global option %s after the argument %s, but global options are not positional, i.e., %s affects " ascii
      $s35 = "warning: you have specified the global option %s after the argument %s, but global options are not positional, i.e., %s affects " ascii
      $s36 = "non-numeric argument to %s: %s" fullword ascii
      $s37 = "Unknown argument to %s: %c" fullword ascii
      $s38 = "fgetfilecon_raw" fullword ascii
      $s39 = "Expression may consist of: operators, options, tests, and actions." fullword ascii
      $s40 = "lgetfilecon_raw" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 6b 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d0 86 03 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 88 5e 00 00 00 00 00 00 88 5e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 e9 24 02 00 00 00 00 00 e9 24 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 90 02 00 00 00 00 00 00 90 02 00 00 00 00 00 00 90 02 00 00 00 00 00 30 c7 00 00 00 00 00 00 30 c7 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 60 03 00 00 00 00 00 30 60 03 00 00 00 00 00 30 60 03 00 00 00 00 00 f8 24 00 00 00 00 00 00 f8 2f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 60 78 03 00 00 00 00 00 60 78 03 00 00 00 00 00 60 78 03 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 a0 ea 02 00 00 00 00 00 a0 ea 02 00 00 00 00 00 a0 ea 02 00 00 00 00 00 ec 10 00 00 00 00 00 00 ec 10 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 60 03 00 00 00 00 00 30 60 03 00 00 00 00 00 30 60 03 00 00 00 00 00 d0 1f 00 00 00 00 00 00 d0 1f 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 1d 88 1d 4e d2 57 e6 45 95 c4 04 88 69 a3 f3 b6 f6 d1 8a 87 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 99 00 00 00 02 00 00 00 07 00 00 00 82 00 40 00 52 01 00 1e 30 48 09 02 a0 04 08 20 99 00 00 00 9d 00 00 00 a5 00 00 00 a6 dd a3 6b d0 65 ce 6d c4 89 05 90 29 1d 8c 1c e4 62 41 f5 ce 2c 63 72 c4 b9 9c 40 86 f0 96 7c 66 55 61 10 bc 50 76 9e 96 a0 89 97 39 f2 8b 1c e5 de 93 1c}
condition:
      filesize < 700KB and
      8 of them and $magic
}

rule gtfobins_binaries_distcc {
   strings:
      $s1 = "Adding '-target %s' to support clang cross-compilation." fullword ascii
      $s2 = "INCLUDE_SERVER_PORT not set - did you forget to run under 'distcc-pump'?" fullword ascii
      $s3 = "cc -dumpversion" fullword ascii
      $s4 = "failed to resolve host %s port %d: %s" fullword ascii
      $s5 = "failed to exec %s: %s" fullword ascii
      $s6 = "failed to get includes from include server, preprocessing locally" fullword ascii
      $s7 = "Failed to look up host by address \"%s\": %s." fullword ascii
      $s8 = "cc -dumpmachine" fullword ascii
      $s9 = "distcc should be used with make's -jN option to execute in parallel on" fullword ascii
      $s10 = "exec on %s: %s" fullword ascii
      $s11 = "failed to open logfile %s: %s" fullword ascii
      $s12 = "entered process group" fullword ascii
      $s13 = "gcc's -x handling is complex; running locally for %s" fullword ascii
      $s14 = "Failed to get host list" fullword ascii
      $s15 = "input is already preprocessed" fullword ascii
      $s16 = "getrusage(RUSAGE_SELF) failed: %s" fullword ascii
      $s17 = "getrusage(RUSAGE_CHILDREN) failed: %s" fullword ascii
      $s18 = "already a process group leader" fullword ascii
      $s19 = "signal(SIGPIPE, %s) failed: %s" fullword ascii
      $s20 = "read failed while waiting for token \"%s\"" fullword ascii
      $s21 = "forking to execute" fullword ascii
      $s22 = "remote compilation of '%s' failed" fullword ascii
      $s23 = "failed to read %s: %s" fullword ascii
      $s24 = "strdup failed - out of memory?" fullword ascii
      $s25 = "malloc failed - too many cleanups" fullword ascii
      $s26 = "   DISTCC_SSH                 Command to run to open SSH connections." fullword ascii
      $s27 = "read failed while waiting for some token" fullword ascii
      $s28 = "Successfully looked up host %s using IP address %s." fullword ascii
      $s29 = "failed to close pipes" fullword ascii
      $s30 = "%s/%s_localhost_%d" fullword ascii
      $s31 = "failed to find -c or -S" fullword ascii
      $s32 = "dcc_expand_preprocessor_options" fullword ascii
      $s33 = "strdup failed - too many cleanups" fullword ascii
      $s34 = "   HOSTSPEC,cpp,lzo           Use pump mode (remote preprocessing)." fullword ascii
      $s35 = "note state %d, file \"%s\", host \"%s\"" fullword ascii
      $s36 = "failed to distribute %s to %s, running locally instead" fullword ascii
      $s37 = "gettimeofday failed" fullword ascii
      $s38 = "decompressed %ld bytes to %ld bytes: %d%%" fullword ascii
      $s39 = "deleted %d temporary files" fullword ascii
      $s40 = "command after" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 40 4f 00 00 00 00 00 00 40 00 00 00 00 00 00 00 30 28 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c8 30 00 00 00 00 00 00 c8 30 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 f9 3a 01 00 00 00 00 00 f9 3a 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 01 00 00 00 00 00 00 80 01 00 00 00 00 00 00 80 01 00 00 00 00 00 08 95 00 00 00 00 00 00 08 95 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 1d 02 00 00 00 00 00 50 2d 02 00 00 00 00 00 50 2d 02 00 00 00 00 00 30 09 00 00 00 00 00 00 30 65 06 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a0 1d 02 00 00 00 00 00 a0 2d 02 00 00 00 00 00 a0 2d 02 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 e0 d9 01 00 00 00 00 00 e0 d9 01 00 00 00 00 00 e0 d9 01 00 00 00 00 00 ec 07 00 00 00 00 00 00 ec 07 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 1d 02 00 00 00 00 00 50 2d 02 00 00 00 00 00 50 2d 02 00 00 00 00 00 b0 02 00 00 00 00 00 00 b0 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 bd 37 b1 21 94 af dd 9c 9c 2d f2 a3 3f d3 b5 8f 43 21 c8 b7 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 ac 00 00 00 01 00 00 00 06 00 00 00 42 03 81 00 00 00 08 02 ac 00 00 00 ad 00 00 00 00 00 00 00 d1 65 ce 6d 80 61 c3 21 38 f2 8b 1c 73 62 03 7f 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e5 02 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 400KB and
      8 of them and $magic
}

rule gtfobins_binaries_minicom {
   strings:
      $s1 = "minicom.log" fullword ascii
      $s2 = " A - Command key is         :" fullword ascii
      $s3 = "# Machine-generated file - use setup menu in minicom to change parameters." fullword ascii
      $s4 = "# Machine-generated file - use \"minicom -s\" to change parameters." fullword ascii
      $s5 = "** Line %d of the %s config file is unparsable." fullword ascii
      $s6 = " A - Download directory :" fullword ascii
      $s7 = " F - Logging options" fullword ascii
      $s8 = " B - Log connects and hangups  :" fullword ascii
      $s9 = " Press new command key: " fullword ascii
      $s10 = " Press the new command key. If you want to use" fullword ascii
      $s11 = " B -   Password        :" fullword ascii
      $s12 = " G -  Password            :" fullword ascii
      $s13 = "%.30s %s - Press CTRL-C to quit" fullword ascii
      $s14 = "Program new command key" fullword ascii
      $s15 = "minicom: argument to -p must be a pty" fullword ascii
      $s16 = " I -  Backspace key sends :" fullword ascii
      $s17 = " J - Background Color (stat):" fullword ascii
      $s18 = "Commands can be called by %s<key>" fullword ascii
      $s19 = "Minicom Command Summary" fullword ascii
      $s20 = " E - Foreground Color (menu):" fullword ascii
      $s21 = " F - Hardware Flow Control :" fullword ascii
      $s22 = "scriptdir" fullword ascii
      $s23 = " F - Background Color (menu):" fullword ascii
      $s24 = "  -M, --metakey8         : use 8bit meta key for commands" fullword ascii
      $s25 = " P - DTR drop time (0=no)." fullword ascii
      $s26 = " G - Software Flow Control :" fullword ascii
      $s27 = " I - Foreground Color (stat):" fullword ascii
      $s28 = " G - Foreground Color (term):" fullword ascii
      $s29 = "scriptprog" fullword ascii
      $s30 = " H - Background Color (term):" fullword ascii
      $s31 = "  -m, --metakey          : use meta or alt key for commands" fullword ascii
      $s32 = "runscript" fullword ascii
      $s33 = "logfname" fullword ascii
      $s34 = " Failure executing protocol. Press any key to continue..." fullword ascii
      $s35 = "colusage" fullword ascii
      $s36 = " E -  Script              :" fullword ascii
      $s37 = "logxfer" fullword ascii
      $s38 = "logconn" fullword ascii
      $s39 = " C -   Name of script  :" fullword ascii
      $s40 = "Report bugs to <minicom-devel@lists.alioth.debian.org>." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 82 00 00 00 00 00 00 40 00 00 00 00 00 00 00 90 79 03 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 43 00 00 00 00 00 00 08 43 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 09 f2 01 00 00 00 00 00 09 f2 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 02 00 00 00 00 00 00 50 02 00 00 00 00 00 00 50 02 00 00 00 00 00 d8 92 00 00 00 00 00 00 d8 92 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 e9 02 00 00 00 00 00 30 f9 02 00 00 00 00 00 30 f9 02 00 00 00 00 00 08 8f 00 00 00 00 00 00 70 2a 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d0 ed 02 00 00 00 00 00 d0 fd 02 00 00 00 00 00 d0 fd 02 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 ec a8 02 00 00 00 00 00 ec a8 02 00 00 00 00 00 ec a8 02 00 00 00 00 00 e4 06 00 00 00 00 00 00 e4 06 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 e9 02 00 00 00 00 00 30 f9 02 00 00 00 00 00 30 f9 02 00 00 00 00 00 d0 06 00 00 00 00 00 00 d0 06 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 93 7b 2e e4 d0 71 66 ef d2 b4 b0 e9 9b ac 7a ea dc 2e c3 49 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 88 00 00 00 01 00 00 00 06 00 00 00 10 15 c1 10 c1 01 5c 02 88 00 00 00 8b 00 00 00 90 00 00 00 28 1d 8c 1c a6 dd a3 6b d1 65 ce 6d 16 27 83 7c 20 a3 87 0d c4 b9 9c 40 0a 73 59 00 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 700KB and
      8 of them and $magic
}

rule gtfobins_binaries_ftp {
   strings:
      $s1 = "ftp_login: user `%s' pass `%s' host `%s'" fullword ascii
      $s2 = "for the NetBSD project.  Execute `man ftp' for more details." fullword ascii
      $s3 = "Can't connect or login to host `%s:%s'" fullword ascii
      $s4 = "%s: user `%s' pass `%s' host %s port %s(%d) path `%s'" fullword ascii
      $s5 = "%s: user `%s' pass `%s' host %s port %s path `%s' dir `%s' file `%s'" fullword ascii
      $s6 = "User-Agent: %s/%s" fullword ascii
      $s7 = "toggle gate-ftp; specify host[:port] to change proxy" fullword ascii
      $s8 = "           [ftp://[USER[:PASSWORD]@]HOST[:PORT]/PATH[/][;type=TYPE]]" fullword ascii
      $s9 = "usage: %s [command [args]]" fullword ascii
      $s10 = "usage: %s command [options]" fullword ascii
      $s11 = "usage: %s [password]" fullword ascii
      $s12 = "  -r RETRY      Retry failed connection attempts after RETRY seconds" fullword ascii
      $s13 = "usage: %s username [password [account]]" fullword ascii
      $s14 = "%s: target `%s'" fullword ascii
      $s15 = "show command usage" fullword ascii
      $s16 = "  -a            Use anonymous login" fullword ascii
      $s17 = "           [https://[USER[:PASSWORD]@]HOST[:PORT]/PATH]" fullword ascii
      $s18 = "  -n            Disable auto-login" fullword ascii
      $s19 = "           [http://[USER[:PASSWORD]@]HOST[:PORT]/PATH]" fullword ascii
      $s20 = "Gate ftp: %s, server %s, port %s." fullword ascii
      $s21 = "usage: %s (all|get|put),maximum-bytes[,increment-bytes]]" fullword ascii
      $s22 = "show or set options for remote commands" fullword ascii
      $s23 = "usage: %s (all|get|put) [maximum-bytes [increment-bytes]]" fullword ascii
      $s24 = "Disabling gate-ftp mode - no gate-ftp server defined." fullword ascii
      $s25 = "FTPSERVER" fullword ascii
      $s26 = "Received unexpected Content-Range header" fullword ascii
      $s27 = "getoptionvalue: invoked with unknown option `%s'" fullword ascii
      $s28 = "%s: skipping unknown auth scheme `%s'" fullword ascii
      $s29 = "usage: %s [command ...]" fullword ascii
      $s30 = "Command line editing: %s." fullword ascii
      $s31 = "?Invalid proxy command." fullword ascii
      $s32 = "  -e            Disable command-line editing" fullword ascii
      $s33 = "usage: %s mode remote-file" fullword ascii
      $s34 = "user interrupt. Connection closed" fullword ascii
      $s35 = "Remove password or make file unreadable by others" fullword ascii
      $s36 = "usage: %s [remote-path]" fullword ascii
      $s37 = "Error aborting proxy command" fullword ascii
      $s38 = "?Ambiguous %s command `%s'" fullword ascii
      $s39 = "?Invalid %s command `%s'" fullword ascii
      $s40 = "usage: %s [ on | off | gateserver [port] ]" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 7a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d0 b3 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 90 5b 00 00 00 00 00 00 90 5b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 ad 9e 01 00 00 00 00 00 ad 9e 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 8d 00 00 00 00 00 00 00 8d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 98 02 00 00 00 00 00 10 98 02 00 00 00 00 00 10 98 02 00 00 00 00 00 78 1a 00 00 00 00 00 00 c0 1a 02 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 58 98 02 00 00 00 00 00 58 98 02 00 00 00 00 00 58 98 02 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 10 59 02 00 00 00 00 00 10 59 02 00 00 00 00 00 10 59 02 00 00 00 00 00 cc 06 00 00 00 00 00 00 cc 06 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 98 02 00 00 00 00 00 10 98 02 00 00 00 00 00 10 98 02 00 00 00 00 00 f0 07 00 00 00 00 00 00 f0 07 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 5b c7 86 80 d3 fb 62 a4 b1 18 27 9e 17 79 e0 aa a1 e5 36 2f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 ab 00 00 00 02 00 00 00 07 00 00 00 24 09 80 40 12 01 4c 16 10 4a 01 40 b4 34 48 84 ab 00 00 00 00 00 00 00 ac 00 00 00 ae 00 00 00 af 00 00 00 b0 00 00 00 00 00 00 00 b1 00 00 00 b2 00 00 00 b3 00 00 00 b5 00 00 00 00 00 00 00 b6 00 00 00 b9 00 00 00 ba 00 00 00 bb 00 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_rlogin {
   strings:
      $s1 = "Usage: rlogin [-46v] [-l user] [-p port] [user@]host" fullword ascii
      $s2 = "%s: pipe() failed: %s" fullword ascii
      $s3 = " Could not bind to privileged port: %s" fullword ascii
      $s4 = "%s: Could not lookup username: %s" fullword ascii
      $s5 = "%s: Error looking up host: %s" fullword ascii
      $s6 = "%s: Error resolving address: %s" fullword ascii
      $s7 = " Connection failed: %s" fullword ascii
      $s8 = "%s: No host specified!" fullword ascii
      $s9 = "%s: Unable to get terminal attributes: %s" fullword ascii
      $s10 = "%s: Could not make a connection." fullword ascii
      $s11 = "%s: Unable to drop privileges: %s" fullword ascii
      $s12 = " Error looking up localhost: %s" fullword ascii
      $s13 = "%s: signal() failed: %s" fullword ascii
      $s14 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/rsh-redone-client.debug" fullword ascii
      $s15 = "c51ad1b19c69d311edfd51b35767ec3dbd327c.debug" fullword ascii
      $s16 = "%s: Arguments too long!" fullword ascii
      $s17 = "%s: Unable to send required information: %s" fullword ascii
      $s18 = "%s: Unknown option!" fullword ascii
      $s19 = "%s: Didn't receive NULL byte from server: %s" fullword ascii
      $s20 = "%s: Too many arguments!" fullword ascii
      $s21 = " Could not open socket: %s" fullword ascii
      $s22 = " Connected." fullword ascii
      $s23 = "Trying %s port %s..." fullword ascii
      $s24 = "2500000" ascii /* Goodware String - occured 1 times */
      $s25 = "921600" ascii /* Goodware String - occured 1 times */
      $s26 = "576000" ascii /* Goodware String - occured 1 times */
      $s27 = "c51ad1b19c69d311edfd51b35767ec3dbd327c" ascii
      $s28 = "3000000" ascii /* Goodware String - occured 1 times */
      $s29 = "1152000" ascii /* Goodware String - occured 1 times */
      $s30 = "1500000" ascii /* Goodware String - occured 1 times */
      $s31 = "2000000" ascii /* Goodware String - occured 2 times */
      $s32 = "460800" ascii /* Goodware String - occured 2 times */
      $s33 = "4000000" ascii
      $s34 = "3500000" ascii
      $s35 = "l:p:46v" fullword ascii
      $s36 = "cfgetispeed" fullword ascii /* Goodware String - occured 5 times */
      $s37 = "1000000" ascii /* Goodware String - occured 5 times */
      $s38 = "230400" ascii /* Goodware String - occured 5 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 23 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 41 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 78 0e 00 00 00 00 00 00 78 0e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 21 16 00 00 00 00 00 00 21 16 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 c0 05 00 00 00 00 00 00 c0 05 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b8 3c 00 00 00 00 00 00 b8 4c 00 00 00 00 00 00 b8 4c 00 00 00 00 00 00 58 03 00 00 00 00 00 00 c0 03 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c8 3c 00 00 00 00 00 00 c8 4c 00 00 00 00 00 00 c8 4c 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 18 34 00 00 00 00 00 00 18 34 00 00 00 00 00 00 18 34 00 00 00 00 00 00 4c 00 00 00 00 00 00 00 4c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 07 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b8 3c 00 00 00 00 00 00 b8 4c 00 00 00 00 00 00 b8 4c 00 00 00 00 00 00 48 03 00 00 00 00 00 00 48 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 ad c5 1a d1 b1 9c 69 d3 11 ed fd 51 b3 57 67 ec 3d bd 32 7c 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 26 00 00 00 01 00 00 00 06 00 00 00 00 05 81 00 00 00 0c 02 26 00 00 00 27 00 00 00 28 00 00 00 d1 65 ce 6d 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e0 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 50KB and
      8 of them and $magic
}

rule gtfobins_binaries_ld_so {
   strings:
      $s1 = "x86.processor[0x%x].cpuid.eax[0x%x].%s=0x%x" fullword ascii
      $s2 = "x86.processor[0x%x].cpuid.subleaf_eax[0x%x].ecx[0x%x].%s=0x%x" fullword ascii
      $s3 = "%s: IFUNC symbol '%s' referenced in '%s' is defined in the executable and creates an unsatisfiable circular dependency." fullword ascii
      $s4 = "glibc.pthread.mutex_spin_count" fullword ascii
      $s5 = "x86.processor[0x%x].cpuid.subleaf_eax[0x%x].ecx[0x%x].ecx_query_mask=0xff" fullword ascii
      $s6 = "x86.processor[0x%x].cpuid.subleaf_eax[0x%x].ecx[0x%x].until_ecx=0x%x" fullword ascii
      $s7 = "glibc.cpu.prefer_map_32bit_exec" fullword ascii
      $s8 = "relocation processing: %s%s" fullword ascii
      $s9 = "x86.processor[0x%x].observed=0x%x" fullword ascii
      $s10 = "x86.processor[0x%x]." fullword ascii
      $s11 = "x86.processor[0x%x].observed_node=0x%x" fullword ascii
      $s12 = "x86.processor[0x%x].ecx_limit=0x%x" fullword ascii
      $s13 = "x86.processor[0x%x].cpuid_leaves=0x%x" fullword ascii
      $s14 = "x86.processor[0x%x].requested=0x%x" fullword ascii
      $s15 = "glibc.cpu.x86_non_temporal_threshold" fullword ascii
      $s16 = "glibc.cpu.x86_memset_non_temporal_threshold" fullword ascii
      $s17 = "display symbol table processing" fullword ascii
      $s18 = "EHWPOISON" fullword ascii
      $s19 = "Inconsistency detected by ld.so: %s: %u: %s%sAssertion `%s' failed!" fullword ascii
      $s20 = "Inconsistency detected by ld.so: %s: %u: %s%sUnexpected error: %s." fullword ascii
      $s21 = "  total startup time in dynamic loader: %s cycles" fullword ascii
      $s22 = "%s: cannot execute %s: %s" fullword ascii
      $s23 = "%s: cannot execute %s: %d" fullword ascii
      $s24 = "glibc.pthread.stack_hugetlb" fullword ascii
      $s25 = "ELF load command address/offset not page-aligned" fullword ascii
      $s26 = "Usage: %s [OPTION]... EXECUTABLE-FILE [ARGS-FOR-PROGRAM...]" fullword ascii
      $s27 = "setting environment variables (which would be inherited by subprocesses)." fullword ascii
      $s28 = "xgetbv.ecx[0x0]" fullword ascii
      $s29 = "__rtld_mutex_init" fullword ascii
      $s30 = "EKEYEXPIRED" fullword ascii
      $s31 = "invalid target namespace in dlmopen()" fullword ascii
      $s32 = "target_seg_index1 == 0" fullword ascii
      $s33 = "path.system_dirs[0x%x]=" fullword ascii
      $s34 = "instead of the program interpreter specified in the executable file you" fullword ascii
      $s35 = "%s: %s cycles (%s%%)" fullword ascii
      $s36 = "TLS generation counter wrapped!  Please report as described in <http://www.debian.org/Bugs/>." fullword ascii
      $s37 = "unsupported version %s of Verdef record" fullword ascii
      $s38 = "DYNAMIC LINKER BUG!!!" fullword ascii
      $s39 = "unsupported version %s of Verneed record" fullword ascii
      $s40 = "ERROR: audit interface '%s' requires version %d (maximum supported version %d); ignored." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 bb 01 00 00 00 00 00 40 00 00 00 00 00 00 00 f8 61 03 00 00 00 00 00 00 00 00 00 40 00 38 00 09 00 40 00 14 00 13 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 0d 00 00 00 00 00 00 08 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 11 6f 02 00 00 00 00 00 11 6f 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 02 00 00 00 00 00 00 80 02 00 00 00 00 00 00 80 02 00 00 00 00 00 1c a5 00 00 00 00 00 00 1c a5 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 e0 32 03 00 00 00 00 00 e0 32 03 00 00 00 00 00 e0 32 03 00 00 00 00 00 24 2e 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 80 4e 03 00 00 00 00 00 80 4e 03 00 00 00 00 00 80 4e 03 00 00 00 00 00 80 01 00 00 00 00 00 00 80 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 02 00 00 00 00 00 00 38 02 00 00 00 00 00 00 38 02 00 00 00 00 00 00 24 00 00 00 00 00 00 00 24 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d8 e4 02 00 00 00 00 00 d8 e4 02 00 00 00 00 00 d8 e4 02 00 00 00 00 00 7c 09 00 00 00 00 00 00 7c 09 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 e0 32 03 00 00 00 00 00 e0 32 03 00 00 00 00 00 e0 32 03 00 00 00 00 00 20 1d 00 00 00 00 00 00 20 1d 00 00 00 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 9e 75 70 f0 3e e3 2b 31 ce 7a b6 0d f7 2e 19 39 06 57 a7 e2 00 00 00 00 25 00 00 00 28 00 00 00 00 00 00 00 04 00 00 00 1c 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 06 00 00 00 00 00 00 00 26 00 00 00 27 00 00 00 25 00 00 00 13 00 00 00 1e 00 00 00 23 00 00 00 11 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 20 00 00 00 00 00 00 00 05 00 00 00 0c 00 00 00 09 00 00 00 1f 00 00 00 21 00 00 00 0e 00 00 00 16 00 00 00 0f 00 00 00 10 00 00 00 15 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 1d 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 1a 00 00 00 17 00 00 00 1b 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0d 00 00 00 00 00 00 00 22 00 00 00 00 00 00 00 19 00 00 00 00 00 00 00 00 00 00 00 0a 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 24 00 00 00 00 00 00 00 18 00 00 00 00 00 00 00 07 00 00 00 00 00 00 00 12 00 00 00 0b 00 00 00 00 00 00 00 00 00 00 00 14 00 00 00 00 00 00 00 00 00 00 00 25 00 00 00 01 00 00 00 04 00 00 00 08 00 00 00 20 34 41 08 18 04 80 17 09 c2 20 40 05 07 81 02 58 0c 3a 20 10 0a 24 c4 03 20 a4 a7 10 e4 20 2a 00 00 00 00 01 00 00 00 02 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 07 00 00 00 08 00 00 00 00 00 00 00 09 00 00 00 0a 00 00 00 0b 00 00 00}
condition:
      filesize < 700KB and
      8 of them and $magic
}

rule gtfobins_binaries_gcc {
   strings:
      $x1 = " %{pg:%{fomit-frame-pointer:%e-pg and -fomit-frame-pointer are incompatible}} %{!S:%{!c:%e-c or -S required for Ada}} gnat1 %{I*" ascii
      $x2 = "   %{save-temps*:%b.ii} %{!save-temps*:%g.ii}}  %{!save-temps*:%{!no-integrated-cpp:%(cpp_unique_options)}}  %{fmodules-ts:-fmod" ascii
      $x3 = "../src/configure -v --with-pkgversion='Debian 13.3.0-3' --with-bugurl=file:///usr/share/doc/gcc-13/README.Bugs --enable-language" ascii
      $x4 = " %{!c:%e-c required for gnat2why} gnat1why %{I*} %{k8:-gnatk8} %{!Q:-quiet}    %{nostdinc*} %{nostdlib*}    %{a} %<dumpdir %<dum" ascii
      $x5 = " %{!c:%e-c required for gnat2scil} gnat1scil %{I*} %{k8:-gnatk8} %{!Q:-quiet}    %{nostdinc*} %{nostdlib*}    %{a} %<dumpdir %<d" ascii
      $x6 = "%{!fsyntax-only:%{!c:%{!M:%{!MM:%{!E:%{!S:    %(linker) %{!fno-use-linker-plugin:%{!fno-lto:     -plugin %(linker_plugin_file)  " ascii
      $x7 = "The minimum recommended offset between two concurrently-accessed objects to avoid additional performance degradation due to cont" ascii
      $x8 = "  -dumpmachine             Display the compiler's target processor." fullword ascii
      $x9 = "   %{save-temps*:%b.ii} %{!save-temps*:%g.ii}}  %{!save-temps*:%{!no-integrated-cpp:%(cpp_unique_options)}}  %{fmodules-ts:-fmod" ascii
      $x10 = "%{pg:%{fomit-frame-pointer:%e-pg and -fomit-frame-pointer are incompatible}} %{!iplugindir*:%{fplugin*:%:find-plugindir()}} %1 %" ascii
      $s11 = "The maximum recommended size of contiguous memory occupied by two objects accessed with temporal locality by concurrent threads." ascii
      $s12 = "  (Use '-v --help' to display command line options of sub-processes)." fullword ascii
      $s13 = "ecking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu --with-build-config=bootstrap-lto-lean" ascii
      $s14 = "Dump the dump tool command line options." fullword ascii
      $s15 = "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json" fullword ascii
      $s16 = "4-linux-gnu- --enable-shared --enable-linker-build-id --libexecdir=/usr/libexec --without-included-gettext --enable-threads=posi" ascii
      $s17 = " passed on to the various sub-processes invoked by %s.  In order to pass" fullword ascii
      $s18 = "  -###                     Like -v but options quoted and commands not executed." fullword ascii
      $s19 = "Collect and dump debug information into temporary file if ICE in C/C++ compiler occurred." fullword ascii
      $s20 = "  Typically the L1 cache line size, but can be smaller to accommodate a variety of target processors with different cache line s" ascii
      $s21 = "save temporary preprocessed files" fullword ascii
      $s22 = "--param=threader-debug=[none|all] Enables verbose dumping of the threader solver." fullword ascii
      $s23 = "    cc1obj -fpreprocessed %b.mi %(distro_defaults_cpp) %(cc1_options) %(distro_defaults) %{print-objc-runtime-info} %{gen-decls}" ascii
      $s24 = "%{-target-help:%:print-asm-header()} %{v} %{w:-W} %{I*} %(asm_debug_option) %{gz|gz=zlib:--compress-debug-sections=zlib} %{gz=no" ascii
      $s25 = "Process all modules specified on the command line, but only generate code for the module specified by the argument." fullword ascii
      $s26 = "ule-header=user %{fpreprocessed:-fdirectives-only}}  %(distro_defaults_cpp) %(cc1_options) %(distro_defaults) %2  %{!fsyntax-onl" ascii
      $s27 = "   %{save-temps*:%b.ii} %{!save-temps*:%g.ii}}  %{!save-temps*:%{!no-integrated-cpp:%(cpp_unique_options)}}  %{fmodules-ts:-fmod" ascii
      $s28 = "%{!E:%{!M:%{!MM:  cc1plus -fpreprocessed %i %(distro_defaults_cpp) %(cc1_options) %(distro_defaults) %2  %{!fsyntax-only:    %{f" ascii
      $s29 = "%{!M:%{!MM:%{!E:cc1obj -fpreprocessed %i %(distro_defaults_cpp) %(cc1_options) %(distro_defaults) %{print-objc-runtime-info} %{g" ascii
      $s30 = "}  cc1plus %{save-temps*|no-integrated-cpp:-fpreprocessed " fullword ascii
      $s31 = "-directory:-fworking-directory}}} %{O*} %{undef} %{save-temps*:-fpch-preprocess} %(distro_defaults_cpp) %(distro_defaults)" fullword ascii
      $s32 = "%(cpp_unique_options) %1 %{m*} %{std*&ansi&trigraphs} %{W*&pedantic*} %{w} %{f*} %{g*:%{%:debug-level-gt(0):%{g*} %{!fno-working" ascii
      $s33 = "passed to the preprocessor if -fcpp is used (internal switch)" fullword ascii
      $s34 = "%{!M:%{!MM:%{!E:cc1 -fpreprocessed %i %(distro_defaults_cpp) %(cc1_options) %(distro_defaults) %{!fsyntax-only:%(invoke_as)}}}}" fullword ascii
      $s35 = "%{!M:%{!MM:%{!E:cc1obj -fpreprocessed %i %(distro_defaults_cpp) %(cc1_options) %(distro_defaults) %{print-objc-runtime-info} %{g" ascii
      $s36 = "Warn about code paths in which an operation is attempted in the wrong phase of a file descriptor's lifetime." fullword ascii
      $s37 = "Warn about code paths in which an operation is attempted on the wrong type of file descriptor." fullword ascii
      $s38 = "-enable-default-pie --with-system-zlib --enable-libphobos-checking=release --with-target-system-zlib=auto --enable-objc-gc=auto " ascii
      $s39 = "    cc1obj -fpreprocessed %{save-temps*:%b.mi} %{!save-temps*:%g.mi} %(distro_defaults_cpp) %(cc1_options) %(distro_defaults) %{" ascii
      $s40 = "Dump a textual representation of each diagnostic's exploded path to SRCFILE.IDX.KIND.epath.txt." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 02 00 3e 00 01 00 00 00 60 6b 43 00 00 00 00 00 40 00 00 00 00 00 00 00 30 53 0f 00 00 00 00 00 00 00 00 00 40 00 38 00 0e 00 40 00 22 00 21 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 40 00 00 00 00 00 40 00 40 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 50 03 00 00 00 00 00 00 50 03 40 00 00 00 00 00 50 03 40 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 10 27 00 00 00 00 00 00 10 27 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 40 00 00 00 00 00 00 30 40 00 00 00 00 00 29 e0 05 00 00 00 00 00 29 e0 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 06 00 00 00 00 00 00 20 46 00 00 00 00 00 00 20 46 00 00 00 00 00 9f 01 09 00 00 00 00 00 9f 01 09 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 98 2a 0f 00 00 00 00 00 98 3a 4f 00 00 00 00 00 98 3a 4f 00 00 00 00 00 20 26 00 00 00 00 00 00 30 61 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 3d 0f 00 00 00 00 00 d8 4d 4f 00 00 00 00 00 d8 4d 4f 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 70 03 00 00 00 00 00 00 70 03 40 00 00 00 00 00 70 03 40 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 90 03 00 00 00 00 00 00 90 03 40 00 00 00 00 00 90 03 40 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 98 2a 0f 00 00 00 00 00 98 3a 4f 00 00 00 00 00 98 3a 4f 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 70 03 00 00 00 00 00 00 70 03 40 00 00 00 00 00 70 03 40 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 f4 f4 0d 00 00 00 00 00 f4 f4 4d 00 00 00 00 00 f4 f4 4d 00 00 00 00 00 34 33 00 00 00 00 00 00 34 33 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 98 2a 0f 00 00 00 00 00 98 3a 4f 00 00 00 00 00 98 3a 4f 00 00 00 00 00 68 15 00 00 00 00 00 00 68 15 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 92 5c 7a be bc 06 71 ef 06 d4 33 e1 32 b4 79 a5 4d b1 c8 60 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 5c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 64 65 62 69 61 6e 22 2c}
condition:
      filesize < 3000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_mv {
   strings:
      $s1 = "  -t, --target-directory=DIRECTORY  move all SOURCE arguments into DIRECTORY" fullword ascii
      $s2 = "%s: attempt removal of inaccessible directory %s? " fullword ascii
      $s3 = "failed to stat %s: skipping %s" fullword ascii
      $s4 = "target directory %s" fullword ascii
      $s5 = "fgetfilecon" fullword ascii
      $s6 = "getfscreatecon" fullword ascii
      $s7 = "lgetfilecon" fullword ascii
      $s8 = "'all' is the default operation when an --update option is not specified," fullword ascii
      $s9 = "'older' is the default operation when --update is specified, and results" fullword ascii
      $s10 = "  -T, --no-target-directory    treat DEST as a normal file" fullword ascii
      $s11 = "and --preserve-root=all is in effect" fullword ascii
      $s12 = "getcon" fullword ascii
      $s13 = "((status) == RM_OK || (status) == RM_USER_ACCEPTED || (status) == RM_USER_DECLINED || (status) == RM_ERROR)" fullword ascii
      $s14 = "  or:  %s [OPTION]... -t DIRECTORY SOURCE..." fullword ascii
      $s15 = "security.selinux" fullword ascii
      $s16 = "refusing to remove %s or %s directory: skipping %s" fullword ascii
      $s17 = "((s) == RM_OK || (s) == RM_USER_ACCEPTED || (s) == RM_USER_DECLINED || (s) == RM_ERROR)" fullword ascii
      $s18 = "error copying %s to %s" fullword ascii
      $s19 = "copy offload: %s, reflink: %s, sparse detection: %s" fullword ascii
      $s20 = "%s: unwritable %s (mode %04lo, %s); try anyway? " fullword ascii
      $s21 = "%s: replace %s, overriding mode %04lo (%s)? " fullword ascii
      $s22 = "context_type_get" fullword ascii
      $s23 = "setfscreatecon" fullword ascii
      $s24 = "fsetfilecon" fullword ascii
      $s25 = "lsetfilecon" fullword ascii
      $s26 = "The backup suffix is '~', unless set with --suffix or SIMPLE_BACKUP_SUFFIX." fullword ascii
      $s27 = "'none' is similar to the --no-clobber option, in that no files in the" fullword ascii
      $s28 = "SEEK_HOLE + zeros" fullword ascii
      $s29 = "warning: ignoring --context" fullword ascii
      $s30 = "  -S, --suffix=SUFFIX          override the usual backup suffix" fullword ascii
      $s31 = "rpmatch" fullword ascii
      $s32 = "selabel_lookup" fullword ascii
      $s33 = "  -b                           like --backup but does not accept an argument" fullword ascii
      $s34 = "failed to close %s" fullword ascii
      $s35 = "warning: source directory %s specified more than once" fullword ascii
      $s36 = "failed to set the security context of %s" fullword ascii
      $s37 = "security_compute_create" fullword ascii
      $s38 = "backing up %s might destroy source;  %s not copied" fullword ascii
      $s39 = "backing up %s might destroy source;  %s not moved" fullword ascii
      $s40 = " (backup: %s)" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 41 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d0 46 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 90 2f 00 00 00 00 00 00 90 2f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 89 80 01 00 00 00 00 00 89 80 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 c0 01 00 00 00 00 00 00 c0 01 00 00 00 00 00 00 c0 01 00 00 00 00 00 d0 6b 00 00 00 00 00 00 d0 6b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 3a 02 00 00 00 00 00 70 3a 02 00 00 00 00 00 70 3a 02 00 00 00 00 00 b0 0a 00 00 00 00 00 00 c8 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 98 3d 02 00 00 00 00 00 98 3d 02 00 00 00 00 00 98 3d 02 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 00 ee 01 00 00 00 00 00 00 ee 01 00 00 00 00 00 00 ee 01 00 00 00 00 00 bc 09 00 00 00 00 00 00 bc 09 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 3a 02 00 00 00 00 00 70 3a 02 00 00 00 00 00 70 3a 02 00 00 00 00 00 90 05 00 00 00 00 00 00 90 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 11 b4 a4 3b e3 b5 96 94 78 52 90 f2 ae 3c 8e d6 1c bb 1f 3f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 92 00 00 00 01 00 00 00 06 00 00 00 84 4d e1 00 a0 01 1c 12 92 00 00 00 94 00 00 00 9b 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 86 f0 96 7c 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 400KB and
      8 of them and $magic
}

rule gtfobins_binaries_install {
   strings:
      $s1 = "  -T, --no-target-directory  treat DEST as a normal file" fullword ascii
      $s2 = "  -t, --target-directory=DIRECTORY  copy all SOURCE arguments into DIRECTORY" fullword ascii
      $s3 = "                        or all components of --target-directory," fullword ascii
      $s4 = "warning: ignoring --context; it requires an SELinux-enabled kernel" fullword ascii
      $s5 = "warning: %s: context lookup failed" fullword ascii
      $s6 = "  -g, --group=GROUP   set group ownership, instead of process' current group" fullword ascii
      $s7 = "fgetfilecon" fullword ascii
      $s8 = "getfscreatecon" fullword ascii
      $s9 = "lgetfilecon" fullword ascii
      $s10 = "  -S, --suffix=SUFFIX  override the usual backup suffix" fullword ascii
      $s11 = "warning: %s: failed to change context to %s" fullword ascii
      $s12 = "cannot set target context and preserve it" fullword ascii
      $s13 = "  -C, --compare       compare content of source and destination files, and" fullword ascii
      $s14 = "getcon" fullword ascii
      $s15 = "  or:  %s [OPTION]... -t DIRECTORY SOURCE..." fullword ascii
      $s16 = "security.selinux" fullword ascii
      $s17 = "error copying %s to %s" fullword ascii
      $s18 = "  or:  %s [OPTION]... -d DIRECTORY..." fullword ascii
      $s19 = "copy offload: %s, reflink: %s, sparse detection: %s" fullword ascii
      $s20 = "%s: unwritable %s (mode %04lo, %s); try anyway? " fullword ascii
      $s21 = "%s: replace %s, overriding mode %04lo (%s)? " fullword ascii
      $s22 = "context_type_get" fullword ascii
      $s23 = "setfscreatecon" fullword ascii
      $s24 = "fsetfilecon" fullword ascii
      $s25 = "lsetfilecon" fullword ascii
      $s26 = "The backup suffix is '~', unless set with --suffix or SIMPLE_BACKUP_SUFFIX." fullword ascii
      $s27 = "SEEK_HOLE + zeros" fullword ascii
      $s28 = "rpmatch" fullword ascii
      $s29 = "selabel_lookup" fullword ascii
      $s30 = "failed to close %s" fullword ascii
      $s31 = "warning: source directory %s specified more than once" fullword ascii
      $s32 = "failed to set the security context of %s" fullword ascii
      $s33 = "security_compute_create" fullword ascii
      $s34 = "backing up %s might destroy source;  %s not copied" fullword ascii
      $s35 = "backing up %s might destroy source;  %s not moved" fullword ascii
      $s36 = " (backup: %s)" fullword ascii
      $s37 = "overflow reading %s" fullword ascii
      $s38 = "failed to set default file creation context for %s" fullword ascii
      $s39 = "_warning: security labeling handle failed" fullword ascii
      $s40 = "failed to access %s" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 56 00 00 00 00 00 00 40 00 00 00 00 00 00 00 78 67 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e8 33 00 00 00 00 00 00 e8 33 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 59 9a 01 00 00 00 00 00 59 9a 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 40 73 00 00 00 00 00 00 40 73 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 5a 02 00 00 00 00 00 30 6a 02 00 00 00 00 00 30 6a 02 00 00 00 00 00 98 0b 00 00 00 00 00 00 08 32 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 98 5d 02 00 00 00 00 00 98 6d 02 00 00 00 00 00 98 6d 02 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 a0 11 02 00 00 00 00 00 a0 11 02 00 00 00 00 00 a0 11 02 00 00 00 00 00 34 0a 00 00 00 00 00 00 34 0a 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 5a 02 00 00 00 00 00 30 6a 02 00 00 00 00 00 30 6a 02 00 00 00 00 00 d0 05 00 00 00 00 00 00 d0 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 da a9 94 c8 42 0c 68 fb af 3c ab 95 68 67 44 f8 f5 e8 45 73 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 a4 00 00 00 01 00 00 00 06 00 00 00 84 4d e1 00 a0 01 1c 12 a4 00 00 00 a6 00 00 00 ad 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 86 f0 96 7c 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_cp {
   strings:
      $s1 = "  -t, --target-directory=DIRECTORY  copy all SOURCE arguments into DIRECTORY" fullword ascii
      $s2 = "warning: ignoring --context; it requires an SELinux-enabled kernel" fullword ascii
      $s3 = "warning: behavior of -n is non-portable and may change in future; use --update=none instead" fullword ascii
      $s4 = "target directory %s" fullword ascii
      $s5 = "fgetfilecon" fullword ascii
      $s6 = "getfscreatecon" fullword ascii
      $s7 = "lgetfilecon" fullword ascii
      $s8 = "'all' is the default operation when an --update option is not specified," fullword ascii
      $s9 = "'older' is the default operation when --update is specified, and results" fullword ascii
      $s10 = "  -T, --no-target-directory    treat DEST as a normal file" fullword ascii
      $s11 = "cannot set target context and preserve it" fullword ascii
      $s12 = "                                 (overrides a -u or previous -i option). See also" fullword ascii
      $s13 = "  -H                           follow command-line symbolic links in SOURCE" fullword ascii
      $s14 = "getcon" fullword ascii
      $s15 = "  or:  %s [OPTION]... -t DIRECTORY SOURCE..." fullword ascii
      $s16 = "security.selinux" fullword ascii
      $s17 = "error copying %s to %s" fullword ascii
      $s18 = "                                 attempting to open it (contrast with --force)" fullword ascii
      $s19 = "copy offload: %s, reflink: %s, sparse detection: %s" fullword ascii
      $s20 = "%s: unwritable %s (mode %04lo, %s); try anyway? " fullword ascii
      $s21 = "%s: replace %s, overriding mode %04lo (%s)? " fullword ascii
      $s22 = "context_type_get" fullword ascii
      $s23 = "setfscreatecon" fullword ascii
      $s24 = "fsetfilecon" fullword ascii
      $s25 = "lsetfilecon" fullword ascii
      $s26 = "The backup suffix is '~', unless set with --suffix or SIMPLE_BACKUP_SUFFIX." fullword ascii
      $s27 = "'none' is similar to the --no-clobber option, in that no files in the" fullword ascii
      $s28 = "SEEK_HOLE + zeros" fullword ascii
      $s29 = "warning: ignoring --context" fullword ascii
      $s30 = "  -S, --suffix=SUFFIX          override the usual backup suffix" fullword ascii
      $s31 = "rpmatch" fullword ascii
      $s32 = "  -i, --interactive            prompt before overwrite (overrides a previous -n" fullword ascii
      $s33 = "      --copy-contents          copy contents of special files when recursive" fullword ascii
      $s34 = "Use --reflink=never to ensure a standard copy is performed." fullword ascii
      $s35 = "selabel_lookup" fullword ascii
      $s36 = "  -b                           like --backup but does not accept an argument" fullword ascii
      $s37 = "failed to close %s" fullword ascii
      $s38 = "warning: source directory %s specified more than once" fullword ascii
      $s39 = "failed to set the security context of %s" fullword ascii
      $s40 = "security_compute_create" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 52 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d0 56 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 30 32 00 00 00 00 00 00 30 32 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 39 81 01 00 00 00 00 00 39 81 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 d0 01 00 00 00 00 00 00 d0 01 00 00 00 00 00 00 d0 01 00 00 00 00 00 f8 75 00 00 00 00 00 00 f8 75 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 48 02 00 00 00 00 00 10 58 02 00 00 00 00 00 10 58 02 00 00 00 00 00 10 0d 00 00 00 00 00 00 a8 13 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 98 4d 02 00 00 00 00 00 98 5d 02 00 00 00 00 00 98 5d 02 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 00 09 02 00 00 00 00 00 00 09 02 00 00 00 00 00 00 09 02 00 00 00 00 00 9c 09 00 00 00 00 00 00 9c 09 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 48 02 00 00 00 00 00 10 58 02 00 00 00 00 00 10 58 02 00 00 00 00 00 f0 07 00 00 00 00 00 00 f0 07 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 06 d6 31 a3 22 9c 62 89 67 99 c2 88 90 61 60 e5 9b 5f a8 fb 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 92 00 00 00 01 00 00 00 06 00 00 00 84 4d e1 00 a0 01 1c 12 92 00 00 00 94 00 00 00 9b 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 86 f0 96 7c 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_tftp {
   strings:
      $s1 = "tftp-hpa 5.3, without readline" fullword ascii
      $s2 = "       %s file ... target (when already connected)" fullword ascii
      $s3 = "tftp-hpa 5.3" fullword ascii
      $s4 = "siglongjmp" fullword ascii
      $s5 = "connect " fullword ascii /* Goodware String - occured 1 times */
      $s6 = "Mode: %s Verbose: %s Tracing: %s Literal: %s" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "set per-packet transmission timeout" fullword ascii /* Goodware String - occured 1 times */
      $s8 = "Failure to negotiate RFC2347 options" fullword ascii /* Goodware String - occured 1 times */
      $s9 = "Transfer timed out." fullword ascii /* Goodware String - occured 1 times */
      $s10 = "Bad port range: %s" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "tftp: tftp/udp: unknown service, faking it..." fullword ascii /* Goodware String - occured 1 times */
      $s12 = "%s %lu bytes in %.1f seconds" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "rexmt-timeout " fullword ascii /* Goodware String - occured 1 times */
      $s14 = "Literal mode %s." fullword ascii /* Goodware String - occured 1 times */
      $s15 = "toggle literal mode, ignore ':' in file name" fullword ascii /* Goodware String - occured 1 times */
      $s16 = "Usage: %s [-4][-6][-v][-l][-m mode] [host [port]] [-c command]" fullword ascii /* Goodware String - occured 1 times */
      $s17 = "maximum-timeout " fullword ascii /* Goodware String - occured 1 times */
      $s18 = "Connected to %s (%s), port %u" fullword ascii /* Goodware String - occured 1 times */
      $s19 = "tftp> " fullword ascii /* Goodware String - occured 1 times */
      $s20 = "%s: invalid command: %s" fullword ascii /* Goodware String - occured 1 times */
      $s21 = "e433d3790876f20e896211775b2bf6942bb2f1.debug" fullword ascii
      $s22 = "%s: invalid mode: %s" fullword ascii /* Goodware String - occured 1 times */
      $s23 = "<code=%d, msg=%s>" fullword ascii /* Goodware String - occured 2 times */
      $s24 = "discarded %d packets" fullword ascii /* Goodware String - occured 2 times */
      $s25 = "set total retransmission timeout" fullword ascii /* Goodware String - occured 2 times */
      $s26 = "No such user" fullword ascii /* Goodware String - occured 2 times */
      $s27 = "tftp: bind" fullword ascii /* Goodware String - occured 2 times */
      $s28 = "%s: bad port number" fullword ascii /* Goodware String - occured 2 times */
      $s29 = "set mode to octet" fullword ascii /* Goodware String - occured 2 times */
      $s30 = "send file" fullword ascii /* Goodware String - occured 2 times */
      $s31 = "mode set to %s" fullword ascii /* Goodware String - occured 2 times */
      $s32 = "putting %s to %s:%s [%s]" fullword ascii /* Goodware String - occured 2 times */
      $s33 = "set mode to netascii" fullword ascii /* Goodware String - occured 2 times */
      $s34 = "Rexmt-interval: %d seconds, Max-timeout: %d seconds" fullword ascii /* Goodware String - occured 2 times */
      $s35 = "No target machine specified." fullword ascii /* Goodware String - occured 2 times */
      $s36 = "%s: bad value" fullword ascii /* Goodware String - occured 2 times */
      $s37 = "usage: %s value" fullword ascii /* Goodware String - occured 2 times */
      $s38 = "usage: %s file ... host:target, or" fullword ascii /* Goodware String - occured 2 times */
      $s39 = "(file) " fullword ascii /* Goodware String - occured 2 times */
      $s40 = "getting from %s:%s to %s [%s]" fullword ascii /* Goodware String - occured 2 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 29 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f8 82 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 88 19 00 00 00 00 00 00 88 19 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 79 34 00 00 00 00 00 00 79 34 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 50 15 00 00 00 00 00 00 50 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 7a 00 00 00 00 00 00 f0 8a 00 00 00 00 00 00 f0 8a 00 00 00 00 00 00 c0 06 00 00 00 00 00 00 f8 0c 02 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 30 7c 00 00 00 00 00 00 30 8c 00 00 00 00 00 00 30 8c 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 f0 69 00 00 00 00 00 00 f0 69 00 00 00 00 00 00 f0 69 00 00 00 00 00 00 94 01 00 00 00 00 00 00 94 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 7a 00 00 00 00 00 00 f0 8a 00 00 00 00 00 00 f0 8a 00 00 00 00 00 00 10 05 00 00 00 00 00 00 10 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 c1 e4 33 d3 79 08 76 f2 0e 89 62 11 77 5b 2b f6 94 2b b2 f1 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 39 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 39 00 00 00 3b 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_zathura {
   strings:
      $s1 = "Execute a command" fullword ascii
      $s2 = "Failed to execute command: %s" fullword ascii
      $s3 = "Failed to execute synctex command: %s" fullword ascii
      $s4 = "cmd_exec" fullword ascii
      $s5 = "girara_session_get_template" fullword ascii
      $s6 = "Failed to prepare query: %s - %s" fullword ascii
      $s7 = "zathura_document_get_password" fullword ascii
      $s8 = "Synctex editor (forwarded to the synctex command)" fullword ascii
      $s9 = "Too many arguments or missing filename while running with --synctex-forward" fullword ascii
      $s10 = "Failed to parse argument to --synctex-forward." fullword ascii
      $s11 = "synctex-editor-command" fullword ascii
      $s12 = "girara_template_get_base" fullword ascii
      $s13 = "Lost connection or failed to acquire '%s' on session bus." fullword ascii
      $s14 = "Could not start new process group: %s" fullword ascii
      $s15 = "Highlight given position in the given process" fullword ascii
      $s16 = "Could not find '%s' in plugin %s - is not a plugin or needs to be rebuilt." fullword ascii
      $s17 = "content type '%s' not supported, trying again" fullword ascii
      $s18 = "girara_command_run" fullword ascii
      $s19 = "content type '%s' not supported" fullword ascii
      $s20 = "Error parsing command line arguments: %s" fullword ascii
      $s21 = "zathura_link_get_target" fullword ascii
      $s22 = "Could not read file from stdin and write it to a temporary file." fullword ascii
      $s23 = "Could not read file from GIO and copy it to a temporary file." fullword ascii
      $s24 = "Align link target to the left" fullword ascii
      $s25 = "INSERT INTO fileinfo SELECT * FROM tmp;DROP TABLE tmp;COMMIT;" fullword ascii
      $s26 = "Failed to run SynctexView on '%s': %s" fullword ascii
      $s27 = "bisecting between %d and %d, jumping to %d" fullword ascii
      $s28 = "plugin %s: version %u.%u.%u" fullword ascii
      $s29 = "new guess: %s uncertain: %d, read: %zu" fullword ascii
      $s30 = ":export image-p%d-%d " fullword ascii
      $s31 = "Invalid or no password." fullword ascii
      $s32 = "json_builder_get_root" fullword ascii
      $s33 = "zathura_document_get_viewport_size" fullword ascii
      $s34 = "failed to convert mime type to content type: %s" fullword ascii
      $s35 = "cb_unknown_command" fullword ascii
      $s36 = "Document password" fullword ascii
      $s37 = "g_content_type failed" fullword ascii
      $s38 = "Raise window on certain D-Bus commands" fullword ascii
      $s39 = "girara_sc_exec" fullword ascii
      $s40 = "girara_special_command_add" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 ef 00 00 00 00 00 00 40 00 00 00 00 00 00 00 08 72 04 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d8 b6 00 00 00 00 00 00 d8 b6 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 ed 76 02 00 00 00 00 00 ed 76 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 03 00 00 00 00 00 00 40 03 00 00 00 00 00 00 40 03 00 00 00 00 00 50 19 01 00 00 00 00 00 50 19 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 20 5a 04 00 00 00 00 00 20 6a 04 00 00 00 00 00 20 6a 04 00 00 00 00 00 28 16 00 00 00 00 00 00 40 17 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 f8 5b 04 00 00 00 00 00 f8 6b 04 00 00 00 00 00 f8 6b 04 00 00 00 00 00 d0 02 00 00 00 00 00 00 d0 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 e0 db 03 00 00 00 00 00 e0 db 03 00 00 00 00 00 e0 db 03 00 00 00 00 00 c4 0f 00 00 00 00 00 00 c4 0f 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 20 5a 04 00 00 00 00 00 20 6a 04 00 00 00 00 00 20 6a 04 00 00 00 00 00 e0 15 00 00 00 00 00 00 e0 15 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 b0 de 1c 47 b6 4e 51 2a 98 9f 39 20 83 80 e1 ca e0 32 4e 94 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 43 00 00 00 1d 02 00 00 08 00 00 00 09 00 00 00 01 18 02 27 7c 11 46 54 40 48 10 33 08 a9 9c 04 89 04 88 13 0b 14 a0 1e 40 35 40 c3 48 00 00 20 13 74 07 28 26 03 11 40 9a 9e 11 08 1f 06 05 8e 60 83 09 10 32 a0 0a 49 10 21 13 a3 40 40 64 b7 00 00 00 00 1d 02 00 00 1e 02 00 00 00 00 00 00}
condition:
      filesize < 900KB and
      8 of them and $magic
}

rule gtfobins_binaries_scrot {
   strings:
      $s1 = "execute command on saved image" fullword ascii
      $s2 = "--script is deprecated. See: https://github.com/resurrecting-open-source-projects/scrot/pull/231" fullword ascii
      $s3 = "`%s` already exists, attempting `%s` instead" fullword ascii
      $s4 = "option --stack: Failed XGetWindowAttributes" fullword ascii
      $s5 = "option --stack: Composite Manager is not running, some windows may overlap." fullword ascii
      $s6 = "option --stack: Failed XGetWindowProperty: %s" fullword ascii
      $s7 = "option --stack: Failed XGetImage: Window id 0x%lx" fullword ascii
      $s8 = "The child process could not be created" fullword ascii
      $s9 = "failed to save image: %s%s%s" fullword ascii
      $s10 = "option --compression: '%s' is %s" fullword ascii
      $s11 = "%Y-%m-%d-%H%M%S_$wx$h_scrot.$F" fullword ascii
      $s12 = "option --line: suboption %s: '%s' is %s" fullword ascii
      $s13 = "--note is deprecated. See: https://github.com/resurrecting-open-source-projects/scrot/discussions/207" fullword ascii
      $s14 = "imlib_get_error" fullword ascii
      $s15 = "freeze the screen when -s is used" fullword ascii
      $s16 = "failed to grab keyboard" fullword ascii
      $s17 = "option --note: font size '%s' is %s" fullword ascii
      $s18 = "Error --note option : Malformed syntax for -f, required number." fullword ascii
      $s19 = "option --stack: Unknown value for suboption '%s'" fullword ascii
      $s20 = "option --window: '%s' is %s" fullword ascii
      $s21 = "The last attempt is %s" fullword ascii
      $s22 = "Error --note option : Malformed syntax." fullword ascii
      $s23 = "option --thumb: resolution height '%s' is %s" fullword ascii
      $s24 = "option --select: Failed to load image:%s" fullword ascii
      $s25 = "option --autoselect: '%s' is %s" fullword ascii
      $s26 = "option --select: '%s' is %s" fullword ascii
      $s27 = "option --select: Unknown value for suboption '%s'" fullword ascii
      $s28 = "option --monitor: '%s' is %s" fullword ascii
      $s29 = "Error --note option : Malformed syntax for -f" fullword ascii
      $s30 = "option --note: color '%s' is %s" fullword ascii
      $s31 = "unknown argument for --list-options: `%s`" fullword ascii
      $s32 = "option --thumb: percentage '%s' is %s" fullword ascii
      $s33 = "Error --note option : Malformed syntax for -y" fullword ascii
      $s34 = "ignorekeyboard" fullword ascii
      $s35 = "option --line: suboption '%s': '%s' is %s" fullword ascii
      $s36 = "Error --note option : Malformed syntax for -a" fullword ascii
      $s37 = "Error --note option : Failed to load fontname: %s" fullword ascii
      $s38 = "Error --note option : Malformed syntax for -t" fullword ascii
      $s39 = "Error --note option : Malformed syntax for -x" fullword ascii
      $s40 = "option --quality: '%s' is %s" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 56 00 00 00 00 00 00 40 00 00 00 00 00 00 00 50 e2 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f8 33 00 00 00 00 00 00 f8 33 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 59 58 00 00 00 00 00 00 59 58 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 18 28 00 00 00 00 00 00 18 28 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 d3 00 00 00 00 00 00 30 d3 00 00 00 00 00 00 30 d3 00 00 00 00 00 00 d8 0d 00 00 00 00 00 00 58 0f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 00 d9 00 00 00 00 00 00 00 d9 00 00 00 00 00 00 00 d9 00 00 00 00 00 00 50 02 00 00 00 00 00 00 50 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 f8 b7 00 00 00 00 00 00 f8 b7 00 00 00 00 00 00 f8 b7 00 00 00 00 00 00 4c 02 00 00 00 00 00 00 4c 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 d3 00 00 00 00 00 00 30 d3 00 00 00 00 00 00 30 d3 00 00 00 00 00 00 d0 0c 00 00 00 00 00 00 d0 0c 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 fb 3b fc 9b 25 40 21 9f 8e 1a e5 59 d2 7e 4f f2 f3 35 ce 94 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 8a 00 00 00 01 00 00 00 06 00 00 00 88 45 a1 01 00 01 1c 0a 8a 00 00 00 8e 00 00 00 90 00 00 00 d0 65 ce 6d ba e3 92 7c 42 45 d5 ec 29 1d 8c 1c d8 71 58 1c 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_sg {
   strings:
      $s1 = "configuration error - unknown item '%s' (notify administrator)" fullword ascii
      $s2 = "user '%s' (login '%s' on %s) returned to group '%lu'" fullword ascii
      $s3 = "Failed to crypt password with previous salt of group '%s'" fullword ascii
      $s4 = "user '%s' (login '%s' on %s) switched to group '%s'" fullword ascii
      $s5 = "user '%s' (login '%s' on %s) returned to group '%s'" fullword ascii
      $s6 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/login.debug" fullword ascii
      $s7 = "%s: failed to crypt password with previous salt: %s" fullword ascii
      $s8 = "configuration error - cannot parse %s value: '%s'" fullword ascii
      $s9 = "Usage: sg group [[-c] command]" fullword ascii
      $s10 = "HUSHLOGIN_FILE" fullword ascii
      $s11 = "LOGIN_PLAIN_PROMPT" fullword ascii
      $s12 = "/etc/login.defs" fullword ascii
      $s13 = "NOLOGINS_FILE" fullword ascii
      $s14 = "LOGIN_KEEP_USERNAME" fullword ascii
      $s15 = "LOGIN_STRING" fullword ascii
      $s16 = "LOGIN_RETRIES" fullword ascii
      $s17 = "Invalid password for group '%s' from '%s'" fullword ascii
      $s18 = "FAKE_SHELL" fullword ascii
      $s19 = "cannot open login definitions %s [%s]" fullword ascii
      $s20 = "cannot read login definitions %s [%s]" fullword ascii
      $s21 = "readpassphrase" fullword ascii
      $s22 = "xgetgrnam" fullword ascii
      $s23 = "xgetpwnam" fullword ascii
      $s24 = "xgetpwuid" fullword ascii
      $s25 = "getsgnam" fullword ascii
      $s26 = "xgetgrgid" fullword ascii
      $s27 = "xgetspnam" fullword ascii
      $s28 = "LOG_UNKFAIL_ENAB" fullword ascii
      $s29 = "FAILLOG_ENAB" fullword ascii
      $s30 = "LOG_OK_LOGINS" fullword ascii
      $s31 = "audit_log_user_message" fullword ascii
      $s32 = "USERDEL_CMD" fullword ascii
      $s33 = "shadow: unknown configuration item '%s' in '%s'" fullword ascii
      $s34 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"shadow\",\"version\":\"1:4.15.3-2\",\"architecture\":\"amd64\",\"debugInfoUrl\":" ascii
      $s35 = "unknown GID '%lu' used by user '%s'" fullword ascii
      $s36 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"shadow\",\"version\":\"1:4.15.3-2\",\"architecture\":\"amd64\",\"debugInfoUrl\":" ascii
      $s37 = "Cannot execute %s" fullword ascii
      $s38 = "crypt method not supported by libcrypt? (%s)" fullword ascii
      $s39 = "%s: failure forking: %s" fullword ascii
      $s40 = "%s: group '%s' does not exist" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 49 00 00 00 00 00 00 40 00 00 00 00 00 00 00 68 a7 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e8 25 00 00 00 00 00 00 e8 25 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 b5 44 00 00 00 00 00 00 b5 44 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 4c 1a 00 00 00 00 00 00 4c 1a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 9a 00 00 00 00 00 00 50 aa 00 00 00 00 00 00 50 aa 00 00 00 00 00 00 68 0b 00 00 00 00 00 00 d0 0c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 f0 9a 00 00 00 00 00 00 f0 aa 00 00 00 00 00 00 f0 aa 00 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 74 8b 00 00 00 00 00 00 74 8b 00 00 00 00 00 00 74 8b 00 00 00 00 00 00 2c 02 00 00 00 00 00 00 2c 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 9a 00 00 00 00 00 00 50 aa 00 00 00 00 00 00 50 aa 00 00 00 00 00 00 b0 05 00 00 00 00 00 00 b0 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 a5 73 e2 89 b3 c2 ae 83 7a e5 7a 30 d8 2c 55 2c ca 36 a0 e6 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 73 68 61 64 6f 77 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 31 3a 34 2e 31 35 2e 33 2d 32 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a 22 61}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_ab {
   strings:
      $s1 = "<tr %s><th %s>Processing:</th><td %s>%5ld</td><td %s>%5ld</td><td %s>%5ld</td></tr>" fullword ascii
      $s2 = " Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/<br>" fullword ascii
      $s3 = "Processing: %5ld %5ld%5ld" fullword ascii
      $s4 = "    -T content-type Content-type header to use for POST/PUT data, eg." fullword ascii
      $s5 = "Processing: %5ld %4ld %5.1f %6ld %7ld" fullword ascii
      $s6 = "%s%s%sContent-length: %lu" fullword ascii
      $s7 = "    -h              Display usage information (this message)" fullword ascii
      $s8 = "X509_get_version" fullword ascii
      $s9 = "EVP_PKEY_get_utf8_string_param" fullword ascii
      $s10 = "EVP_PKEY_get_id" fullword ascii
      $s11 = "    -p postfile     File containing data to POST. Remember also to set -T" fullword ascii
      $s12 = "    -i              Use HEAD instead of GET" fullword ascii
      $s13 = "EVP_PKEY_get_bits" fullword ascii
      $s14 = "error setting ciphersuite list [%s]" fullword ascii
      $s15 = " This is ApacheBench, Version %s <i>&lt;%s&gt;</i><br>" fullword ascii
      $s16 = "<tr %s><th %s colspan=4>Connection Times (ms)</th></tr>" fullword ascii
      $s17 = "    -k              Use HTTP KeepAlive feature" fullword ascii
      $s18 = "    -r              Don't exit on socket receive errors." fullword ascii
      $s19 = " Licensed to The Apache Software Foundation, http://www.apache.org/<br>" fullword ascii
      $s20 = "X509_getm_notBefore" fullword ascii
      $s21 = "X509_getm_notAfter" fullword ascii
      $s22 = "private key does not match the certificate public key in %s" fullword ascii
      $s23 = "    -B address      Address to bind to when making outgoing connections" fullword ascii
      $s24 = "Server Temp Key:        %s" fullword ascii
      $s25 = "    -X proxy:port   Proxyserver and port number to use" fullword ascii
      $s26 = "  %d%%  %5ld" fullword ascii
      $s27 = "    -H attribute    Add Arbitrary header line, eg. 'Accept-Encoding: gzip'" fullword ascii
      $s28 = "    -b windowsize   Size of TCP send/receive buffer, in bytes" fullword ascii
      $s29 = "    -y attributes   String to insert as tr attributes" fullword ascii
      $s30 = "    -w              Print out results in HTML tables" fullword ascii
      $s31 = "    -l              Accept variable document length (use this for dynamic pages)" fullword ascii
      $s32 = "    -t timelimit    Seconds to max. to spend on benchmarking" fullword ascii
      $s33 = "<tr %s><th colspan=2 %s>HTML transferred:</th><td colspan=2 %s>%ld bytes</td></tr>" fullword ascii
      $s34 = "                    are a colon separated username and password." fullword ascii
      $s35 = "<tr %s><th colspan=2 %s>Total transferred:</th><td colspan=2 %s>%ld bytes</td></tr>" fullword ascii
      $s36 = "    -x attributes   String to insert as table attributes" fullword ascii
      $s37 = "    -u putfile      File containing data to PUT. Remember also to set -T" fullword ascii
      $s38 = "    -z attributes   String to insert as td or th attributes" fullword ascii
      $s39 = "    -g filename     Output collected data to gnuplot format file." fullword ascii
      $s40 = "    -f protocol     Specify SSL/TLS protocol" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 55 00 00 00 00 00 00 40 00 00 00 00 00 00 00 70 e2 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 2a 00 00 00 00 00 00 00 2a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 19 60 00 00 00 00 00 00 19 60 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 f0 32 00 00 00 00 00 00 f0 32 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 48 d9 00 00 00 00 00 00 48 e9 00 00 00 00 00 00 48 e9 00 00 00 00 00 00 88 07 00 00 00 00 00 00 d8 4d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 58 d9 00 00 00 00 00 00 58 e9 00 00 00 00 00 00 58 e9 00 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 60 cb 00 00 00 00 00 00 60 cb 00 00 00 00 00 00 60 cb 00 00 00 00 00 00 fc 00 00 00 00 00 00 00 fc 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 48 d9 00 00 00 00 00 00 48 e9 00 00 00 00 00 00 48 e9 00 00 00 00 00 00 b8 06 00 00 00 00 00 00 b8 06 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 58 ef 14 49 81 9d 83 bc f7 c5 77 d4 58 57 1f 20 21 3f 65 fa 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 8a 00 00 00 01 00 00 00 06 00 00 00 00 01 81 00 00 01 10 02 8a 00 00 00 8c 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 46 07 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_pax {
   strings:
      $s1 = "Forward positioning operation on archive failed" fullword ascii
      $s2 = "Attempting to recover from an archive read failure." fullword ascii
      $s3 = "usage: cpio -o [-0AaBcJjLVvZz] [-C bytes] [-F archive] [-H format]" fullword ascii
      $s4 = "input compressed with %s; use the -%c option to decompress it" fullword ascii
      $s5 = "Failed to set the close-on-exec flag" fullword ascii
      $s6 = "Processing continues, name changed to: %s" fullword ascii
      $s7 = "Processing continues, name unchanged." fullword ascii
      $s8 = "Unknown tar format -o option/value pair %s=%s" fullword ascii
      $s9 = "exec(%s)" fullword ascii
      $s10 = "temp file name" fullword ascii
      $s11 = "Archive read error limit (%d) reached" fullword ascii
      $s12 = "Write block size %d larger than POSIX max %d, archive may not be portable" fullword ascii
      $s13 = "%s: %s vol %d, %lu files, %lu bytes read, %lu bytes written." fullword ascii
      $s14 = "Invalid -p string: %c" fullword ascii
      $s15 = "cpio link name read error" fullword ascii
      $s16 = "       cpio -p [-0adLlmuVv] destination-directory <name-list" fullword ascii
      $s17 = "@(#)rcsid: $MirOS: src/bin/pax/getoldopt.c,v 1.7 2019/02/10 22:00:06 tg Exp $" fullword ascii
      $s18 = "%s unknown command, try again" fullword ascii
      $s19 = "ATTENTION: %s interactive file rename operation." fullword ascii
      $s20 = "debug: -M 0x%08X -x %s" fullword ascii
      $s21 = "need -i or -o or -p option first" fullword ascii
      $s22 = "the sv4crc format with 512 bytes blocksize and -M root" fullword ascii
      $s23 = "Unable to create temporary file %s" fullword ascii
      $s24 = "cpio file name in header is corrupted" fullword ascii
      $s25 = "%s: Known -%c formats are:" fullword ascii
      $s26 = "%s on list file descriptor" fullword ascii
      $s27 = "Unable to close file descriptor on %s" fullword ascii
      $s28 = "writing mode %8lo user %ld:%ld mtime %08lX name '%s'" fullword ascii
      $s29 = "Filesystem traversal error" fullword ascii
      $s30 = "Unable to recover from an archive read failure." fullword ascii
      $s31 = "%s=%s is the only supported tar format option" fullword ascii
      $s32 = "Failed %s on %s" fullword ascii
      $s33 = "Failed write during copy of %s to %s" fullword ascii
      $s34 = "Failed open to read on %s" fullword ascii
      $s35 = "File %s was modified during read" fullword ascii
      $s36 = "Unable to append when there are archive read errors." fullword ascii
      $s37 = "%s=%s is only supported when writing." fullword ascii
      $s38 = "Failed read on archive volume %d" fullword ascii
      $s39 = "Reverse positioning on pipes is not supported." fullword ascii
      $s40 = "Skipping pathname with dotdot components: %s" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 3d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 90 d1 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 2f 00 00 00 00 00 00 08 2f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 b9 47 01 00 00 00 00 00 b9 47 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 01 00 00 00 00 00 00 80 01 00 00 00 00 00 00 80 01 00 00 00 00 00 00 3d 00 00 00 00 00 00 00 3d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 c3 01 00 00 00 00 00 70 c3 01 00 00 00 00 00 70 c3 01 00 00 00 00 00 d4 0c 00 00 00 00 00 00 d0 11 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 10 ca 01 00 00 00 00 00 10 ca 01 00 00 00 00 00 10 ca 01 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 50 bc 01 00 00 00 00 00 50 bc 01 00 00 00 00 00 50 bc 01 00 00 00 00 00 24 00 00 00 00 00 00 00 24 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 c3 01 00 00 00 00 00 70 c3 01 00 00 00 00 00 70 c3 01 00 00 00 00 00 90 0c 00 00 00 00 00 00 90 0c 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 48 5c 16 1d 5b 6a 26 08 51 6c f5 21 2c 16 1d 77 ef 26 40 56 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 7d 00 00 00 01 00 00 00 06 00 00 00 02 85 a1 00 80 01 1c 02 7d 00 00 00 7f 00 00 00 82 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 c0 b3 f7 12 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f6 02 00 00 12 00 00 00}
condition:
      filesize < 400KB and
      8 of them and $magic
}

rule gtfobins_binaries_vipw {
   strings:
      $s1 = "%s: can not get previous SELinux process context: %s" fullword ascii
      $s2 = "configuration error - unknown item '%s' (notify administrator)" fullword ascii
      $s3 = "can not get previous SELinux process context: %s" fullword ascii
      $s4 = "%s: failed to drop privileges (%s)" fullword ascii
      $s5 = "configuration error - cannot parse %s value: '%s'" fullword ascii
      $s6 = "Could not open proc directory for target %u: %s" fullword ascii
      $s7 = "%s: cannot execute %s: %s" fullword ascii
      $s8 = "%s: invalid chroot path '%s', only absolute paths are supported." fullword ascii
      $s9 = "HUSHLOGIN_FILE" fullword ascii
      $s10 = "LOGIN_PLAIN_PROMPT" fullword ascii
      $s11 = "/etc/login.defs" fullword ascii
      $s12 = "Please use the command '%s' to do so." fullword ascii
      $s13 = "NOLOGINS_FILE" fullword ascii
      $s14 = "LOGIN_KEEP_USERNAME" fullword ascii
      $s15 = "LOGIN_STRING" fullword ascii
      $s16 = "LOGIN_RETRIES" fullword ascii
      $s17 = "FAKE_SHELL" fullword ascii
      $s18 = "cannot open login definitions %s [%s]" fullword ascii
      $s19 = "cannot read login definitions %s [%s]" fullword ascii
      $s20 = "%s: multiple --root options" fullword ascii
      $s21 = "sgetsgent" fullword ascii
      $s22 = "sgetspent" fullword ascii
      $s23 = "%s: %s file write error: %s" fullword ascii
      $s24 = "%s: unable to chroot to directory %s: %s" fullword ascii
      $s25 = "%s: %s file stat error: %s" fullword ascii
      $s26 = "%s: %s: lock file already used (nlink: %ju)" fullword ascii
      $s27 = "%s: lock %s already used by PID %lu" fullword ascii
      $s28 = "%s: %s file sync error: %s" fullword ascii
      $s29 = "audit_log_user_avc_message" fullword ascii
      $s30 = "LOG_UNKFAIL_ENAB" fullword ascii
      $s31 = "FAILLOG_ENAB" fullword ascii
      $s32 = "LOG_OK_LOGINS" fullword ascii
      $s33 = "%s: cannot get lock %s: %s" fullword ascii
      $s34 = "USERDEL_CMD" fullword ascii
      $s35 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"shadow\",\"version\":\"1:4.16.0-4\",\"architecture\":\"amd64\",\"debugInfoUrl\":" ascii
      $s36 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/passwd.debug" fullword ascii
      $s37 = "shadow: unknown configuration item '%s' in '%s'" fullword ascii
      $s38 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"shadow\",\"version\":\"1:4.16.0-4\",\"architecture\":\"amd64\",\"debugInfoUrl\":" ascii
      $s39 = "%s: Too long passwd entry encountered, file corruption?" fullword ascii
      $s40 = "%s: %s killed by signal %d" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 4b 00 00 00 00 00 00 40 00 00 00 00 00 00 00 58 1b 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e0 31 00 00 00 00 00 00 e0 31 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 79 76 00 00 00 00 00 00 79 76 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 70 2e 00 00 00 00 00 00 70 2e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 f9 00 00 00 00 00 00 90 f9 00 00 00 00 00 00 90 f9 00 00 00 00 00 00 14 20 00 00 00 00 00 00 78 a1 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a8 f9 00 00 00 00 00 00 a8 f9 00 00 00 00 00 00 a8 f9 00 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 9c d0 00 00 00 00 00 00 9c d0 00 00 00 00 00 00 9c d0 00 00 00 00 00 00 6c 05 00 00 00 00 00 00 6c 05 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 f9 00 00 00 00 00 00 90 f9 00 00 00 00 00 00 90 f9 00 00 00 00 00 00 70 06 00 00 00 00 00 00 70 06 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 98 6f e7 9c c2 1e 22 c4 29 01 dd 9f 65 bd 43 9a a7 19 a9 f9 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 73 68 61 64 6f 77 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 31 3a 34 2e 31 36 2e 30 2d 34 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a 22 61}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_bconsole {
   strings:
      $s1 = "execute an external command" fullword ascii
      $s2 = "       -u <nn>     set command execution timeout to <nn> seconds" fullword ascii
      $s3 = "Passphrase for Console \"%s\" TLS private key: " fullword ascii
      $s4 = "Command logic problem" fullword ascii
      $s5 = "       -t          test - read configuration and exit" fullword ascii
      $s6 = "Bad response to Hello command: ERR=%s" fullword ascii
      $s7 = "Director rejected Hello command" fullword ascii
      $s8 = "Passphrase for Director \"%s\" TLS private key: " fullword ascii
      $s9 = "Syntax error in @putfile command" fullword ascii
      $s10 = "@exec error: ERR=%s" fullword ascii
      $s11 = "echo command string" fullword ascii
      $s12 = "_Z15init_stack_dumpv" fullword ascii
      $s13 = "_Z13dump_resourceiP3RESPFvPvPKczES1_" fullword ascii
      $s14 = "encode command string" fullword ascii
      $s15 = "set command separator" fullword ascii
      $s16 = "Error reading user input!" fullword ascii
      $s17 = "Usage: bconsole [-s] [-c config_file] [-d debug_level]" fullword ascii
      $s18 = "Failed to initialize TLS PSK context for Console \"%s\"." fullword ascii
      $s19 = "Most likely the passwords do not agree." fullword ascii
      $s20 = "_Z18crypto_get_versionv" fullword ascii
      $s21 = "*UserAgent*" fullword ascii
      $s22 = "_ZN6CONFIG4initEPKcPFvS1_iP13s_lex_contextS1_zEiPviiiP9RES_TABLEPPP8RES_HEAD" fullword ascii
      $s23 = "Too many arguments on output/tee command." fullword ascii
      $s24 = "Usage: @putfile key file" fullword ascii
      $s25 = "_Z14store_passwordP13s_lex_contextP8RES_ITEMii" fullword ascii
      $s26 = "First argument to input command must be a filename." fullword ascii
      $s27 = ": is an invalid command" fullword ascii
      $s28 = "Too many arguments. Enclose command in double quotes." fullword ascii
      $s29 = "Too many arguments on input command." fullword ascii
      $s30 = "Failed to initialize TLS context for Console \"%s\"." fullword ascii
      $s31 = "Failed to initialize TLS PSK context for Director \"%s\"." fullword ascii
      $s32 = "       -c <file>   set configuration file to file" fullword ascii
      $s33 = "_Z10open_bpipePciPKcPS_" fullword ascii
      $s34 = "Failed to initialize TLS context for Director \"%s\"." fullword ascii
      $s35 = "Version: 13.0.4 (12 February 2024) %s %s %s" fullword ascii
      $s36 = "Receive auth confirmation failed. ERR=%s" fullword ascii
      $s37 = ".putfile key=\"%s\"" fullword ascii
      $s38 = "_Z11close_bpipeP5BPIPE" fullword ascii
      $s39 = "Authorization problem: Remote server did not advertise required TLS support." fullword ascii
      $s40 = "For help, please see http://www.bacula.org/rel-manual/en/problems/Bacula_Frequently_Asked_Que.html" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 6b 00 00 00 00 00 00 40 00 00 00 00 00 00 00 90 d9 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 44 00 00 00 00 00 00 10 44 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 89 49 00 00 00 00 00 00 89 49 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 0c 20 00 00 00 00 00 00 0c 20 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 a8 c7 00 00 00 00 00 00 a8 d7 00 00 00 00 00 00 a8 d7 00 00 00 00 00 00 37 10 00 00 00 00 00 00 b0 14 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 50 c9 00 00 00 00 00 00 50 d9 00 00 00 00 00 00 50 d9 00 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 40 b4 00 00 00 00 00 00 40 b4 00 00 00 00 00 00 40 b4 00 00 00 00 00 00 d4 01 00 00 00 00 00 00 d4 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 a8 c7 00 00 00 00 00 00 a8 d7 00 00 00 00 00 00 a8 d7 00 00 00 00 00 00 58 08 00 00 00 00 00 00 58 08 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 a2 e3 a9 4d 26 66 80 a7 93 4d 04 2d 0c ab f8 e0 79 29 95 3c 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 92 00 00 00 04 00 00 00 08 00 00 00 18 00 80 22 49 0d 0c 06 4c 04 25 20 81 11 24 40 e1 00 00 01 04 01 04 00 a2 00 01 08 20 00 82 00 92 00 00 00 93 00 00 00 95 00 00 00 96 00 00 00 98 00 00 00 9b 00 00 00 00 00 00 00 9c 00 00 00 00 00 00 00 9e 00 00 00 9f 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_fish {
   strings:
      $x1 = "Failed to execute process '%s': The file specified the interpreter '%s', which is not an executable command." fullword ascii
      $x2 = "Failed to execute process: '%s' the file could not be run by the operating system." fullword ascii
      $x3 = "Failed to execute process '%s': the total size of the argument list and exported variables (%s) exceeds the operating system lim" ascii
      $x4 = "Failed to execute process '%s': the total size of the argument list and exported variables (%s) exceeds the operating system lim" ascii
      $x5 = "Failed to execute process '%s': A path component is not a directory." fullword ascii
      $s6 = "Failed to execute process '%s': File is a directory." fullword ascii
      $s7 = "Failed to execute process '%s': the total size of the argument list and exported variables (%s) exceeds the OS limit of %s." fullword ascii
      $s8 = "Failed to execute process '%s':  The file uses Windows line endings (\\r\\n). Run dos2unix or similar to fix it." fullword ascii
      $s9 = "Failed to execute process '%s', unknown error number %s" fullword ascii
      $s10 = "Failed to execute process '%s': Too many open files on the system." fullword ascii
      $s11 = "Failed to execute process '%s': Unsupported format." fullword ascii
      $s12 = "*ZL21exec_external_commandR8parser_tRKSt10shared_ptrI5job_tEP9process_tRK10io_chain_tEUlvE_" fullword ascii
      $s13 = "Failed to execute process '%s': The file specified the interpreter '%s', which is a directory." fullword ascii
      $s14 = "Failed to execute process '%s': The file exists and is executable. Check the interpreter or linker?" fullword ascii
      $s15 = "Failed to execute process '%s': Too many layers of symbolic links. Maybe a loop?" fullword ascii
      $s16 = "Failed to execute process '%s': Too many open files in this process." fullword ascii
      $s17 = "Failed to execute process '%s': The file could not be accessed." fullword ascii
      $s18 = "Failed to execute process '%s': The file does not exist or could not be executed." fullword ascii
      $s19 = "Failed to execute process '%s': Name is too long." fullword ascii
      $s20 = "Failed to execute process '%s': An argument or exported variable exceeds the OS argument length limit." fullword ascii
      $s21 = "Failed to execute process '%s': File is currently open for writing." fullword ascii
      $s22 = "Failed to execute process '%s': No permission. Either suid/sgid is forbidden or you lack capabilities." fullword ascii
      $s23 = "process_type_t::exec process found in pipeline, where it should never be. Aborting." fullword ascii
      $s24 = "setpgid: Process %s has already exec'd" fullword ascii
      $s25 = "*ZL19exec_process_in_jobR8parser_tP9process_tRKSt10shared_ptrI5job_tERK10io_chain_t17autoclose_pipes_tRKSB_bEUlvE_" fullword ascii
      $s26 = "https://github.com/fish-shell/fish-shell/issues" fullword ascii
      $s27 = "failed to set up file descriptors in child_setup_process" fullword ascii
      $s28 = "setpgid: Process %s is a session leader or pgid %s does not match" fullword ascii
      $s29 = "!(flags.get(expand_flag::special_for_cd)) || ((flags.get(expand_flag::directories_only)) && (flags.get(expand_flag::for_completi" ascii
      $s30 = "External process '%ls' (pid %d, %s)" fullword ascii
      $s31 = "Reaped external process '%ls' (pid %d, status %d)" fullword ascii
      $s32 = "*ZL25get_performer_for_processP9process_tP5job_tRK10io_chain_tEUlR8parser_tE_" fullword ascii
      $s33 = "*ZN25parse_execution_context_t20populate_job_processEP5job_tP9process_tRKN3ast11statement_tERKNS4_26variable_assignment_list_tEE" ascii
      $s34 = "*ZL25get_performer_for_builtinP9process_tP5job_tRK10io_chain_tRKSt10shared_ptrI15output_stream_tESA_EUlR8parser_tE_" fullword ascii
      $s35 = "cmdsub_end - cmdsub_start - 1 == cmdsub_contents.size()" fullword ascii
      $s36 = "target_fd.has_value() && \"fd redirection should have been validated already\"" fullword ascii
      $s37 = "*ZN25parse_execution_context_t20populate_job_processEP5job_tP9process_tRKN3ast11statement_tERKNS4_26variable_assignment_list_tEE" ascii
      $s38 = "*ZL25get_performer_for_processP9process_tP5job_tRK10io_chain_tEUlR8parser_tE0_" fullword ascii
      $s39 = "pipes.has_value() && \"Failed to make pubsub pipes\"" fullword ascii
      $s40 = "ctx.parser && \"Must have a parser to expand command substitutions\"" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 40 5a 01 00 00 00 00 00 40 00 00 00 00 00 00 00 f8 d2 1c 00 00 00 00 00 00 00 00 00 40 00 38 00 0e 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 50 0b 01 00 00 00 00 00 50 0b 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 01 00 00 00 00 00 00 10 01 00 00 00 00 00 00 10 01 00 00 00 00 00 95 5d 15 00 00 00 00 00 95 5d 15 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 16 00 00 00 00 00 00 70 16 00 00 00 00 00 00 70 16 00 00 00 00 00 a8 f7 05 00 00 00 00 00 a8 f7 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 38 74 1c 00 00 00 00 00 38 74 1c 00 00 00 00 00 38 74 1c 00 00 00 00 00 18 5d 00 00 00 00 00 00 40 74 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 58 c3 1c 00 00 00 00 00 58 c3 1c 00 00 00 00 00 58 c3 1c 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 38 74 1c 00 00 00 00 00 38 74 1c 00 00 00 00 00 38 74 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 54 cd 19 00 00 00 00 00 54 cd 19 00 00 00 00 00 54 cd 19 00 00 00 00 00 ec 51 00 00 00 00 00 00 ec 51 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 38 74 1c 00 00 00 00 00 38 74 1c 00 00 00 00 00 38 74 1c 00 00 00 00 00 c8 5b 00 00 00 00 00 00 c8 5b 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 c3 8c c4 05 64 c7 0b 79 88 77 fe 2f a9 a3 53 c4 88 9a 0a 9e 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 5d 01 00 00 02 00 00 00 07 00 00 00 70 03 48 08 55 2d 8e 1e 1d 18 41 02 20 00 08 50 5d 01 00 00 00 00 00 00}
condition:
      filesize < 6000KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_dmidecode {
   strings:
      $s1 = "Ampere System Control Processor (SCP - PMPro+SMPro)" fullword ascii
      $s2 = "Targeted content distribution is supported" fullword ascii
      $s3 = "Options --from-dump and --dump-bin are mutually exclusive" fullword ascii
      $s4 = "Options --string, --type, --handle and --dump-bin are mutually exclusive" fullword ascii
      $s5 = "     --dump-bin FILE    Dump the DMI data to a binary file" fullword ascii
      $s6 = "     --from-dump FILE   Read the DMI data from a binary file" fullword ascii
      $s7 = "processor-version" fullword ascii
      $s8 = "Execute Protection" fullword ascii
      $s9 = "Supported Log Type Descriptors" fullword ascii
      $s10 = "dump-bin" fullword ascii
      $s11 = "Processor Module" fullword ascii
      $s12 = "Central Processor" fullword ascii
      $s13 = "Processor Information" fullword ascii
      $s14 = "Math Processor" fullword ascii
      $s15 = "processor-family" fullword ascii
      $s16 = " -u, --dump             Do not decode the entries" fullword ascii
      $s17 = "processor-manufacturer" fullword ascii
      $s18 = "NVDIMM Processor" fullword ascii
      $s19 = "Operating system-detected hardware failure" fullword ascii
      $s20 = "Processor+Memory Module" fullword ascii
      $s21 = "%s Processor Specific Information" fullword ascii
      $s22 = "processor-frequency" fullword ascii
      $s23 = "DSP Processor" fullword ascii
      $s24 = "Video Processor" fullword ascii
      $s25 = "PSN (Processor serial number present and enabled)" fullword ascii
      $s26 = "Processor+I/O Module" fullword ascii
      $s27 = "Processor Identity 0x%08x" fullword ascii
      $s28 = "Keyboard Password Status" fullword ascii
      $s29 = "Power Management Controller Firmware Bootloader" fullword ascii
      $s30 = "Operating system failed to load" fullword ascii
      $s31 = "SCSI command set not reported" fullword ascii
      $s32 = "Wrong DMI structures count: %d announced, only %d decoded." fullword ascii
      $s33 = "from-dump" fullword ascii
      $s34 = "SMBIOS version fixup (2.%d -> 2.%d)." fullword ascii
      $s35 = "SL Chassis Firmware Bootloader" fullword ascii
      $s36 = "     --no-sysfs         Do not attempt to read DMI data from sysfs files" fullword ascii
      $s37 = "SPI Descriptor Version" fullword ascii
      $s38 = "MMX (MMX technology supported)" fullword ascii
      $s39 = "Host IP Address Format" fullword ascii
      $s40 = "Serial Port XT/AT Compatible" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 f0 a8 00 00 00 00 00 00 40 00 00 00 00 00 00 00 98 25 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 98 00 00 00 00 00 00 00 98 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 ed ae 00 00 00 00 00 00 ed ae 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 7c 8f 00 00 00 00 00 00 7c 8f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 e4 01 00 00 00 00 00 50 e4 01 00 00 00 00 00 50 e4 01 00 00 00 00 00 a0 3f 00 00 00 00 00 00 d8 40 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 70 1c 02 00 00 00 00 00 70 1c 02 00 00 00 00 00 70 1c 02 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 bc cd 01 00 00 00 00 00 bc cd 01 00 00 00 00 00 bc cd 01 00 00 00 00 00 dc 02 00 00 00 00 00 00 dc 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 e4 01 00 00 00 00 00 50 e4 01 00 00 00 00 00 50 e4 01 00 00 00 00 00 b0 3b 00 00 00 00 00 00 b0 3b 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 fb 9c c5 20 54 62 7e 19 3a 0c f4 34 85 55 e6 f3 2d b5 77 2a 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 30 00 00 00 01 00 00 00 06 00 00 00 00 0d 81 00 00 01 14 03 30 00 00 00 33 00 00 00 34 00 00 00 28 1d 8c 1c 0a de f7 12 d1 65 ce 6d 39 f2 8b 1c b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0c 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 400KB and
      8 of them and $magic
}

rule gtfobins_binaries_readelf {
   strings:
      $s1 = "  -z --decompress        Decompress section before dumping it" fullword ascii
      $s2 = "This is a GO binary file - try using 'go tool objdump' or 'go tool nm'" fullword ascii
      $s3 = "  -w --debug-dump[a/=abbrev, A/=addr, r/=aranges, c/=cu_index, L/=decodedline," fullword ascii
      $s4 = "Hex dump of section '%s' in linked file %s:" fullword ascii
      $s5 = "String dump of section '%s' in linked file %s:" fullword ascii
      $s6 = "  -p --string-dump=<number|name>" fullword ascii
      $s7 = " <Target Specific macro op: %#x - UNHANDLED" fullword ascii
      $s8 = "Encoded size of %d is too large to read" fullword ascii
      $s9 = "  -x --hex-dump=<number|name>" fullword ascii
      $s10 = "Raw dump of debug contents of section %s (loaded from %s):" fullword ascii
      $s11 = "  -C --demangle[=STYLE]  Decode mangled/processed symbol names" fullword ascii
      $s12 = "Unable to determine how to dump section %d (type %#x)" fullword ascii
      $s13 = "Unable to display section %d - it has no contents" fullword ascii
      $s14 = "NT_GDB_TDESC (GDB XML target description)" fullword ascii
      $s15 = "internal error: attempt to read %d byte of data in to %d sized variable" fullword ascii
      $s16 = "internal error: attempt to read %d bytes of data in to %d sized variable" fullword ascii
      $s17 = "Dump of CTF section '%s' in linked file %s:" fullword ascii
      $s18 = "Encoded size of 0 is too small to read" fullword ascii
      $s19 = " DW_MACRO_start_file - lineno: %d filenum: %d filename: %s%s%s" fullword ascii
      $s20 = "  -P --process-links     Display the contents of non-debug sections in separate" fullword ascii
      $s21 = "  -wK --debug-dump=follow-links" fullword ascii
      $s22 = "Unknown attributes version '%c'(%d) - expecting 'A'" fullword ascii
      $s23 = "Broadcom VideoCore V processor" fullword ascii
      $s24 = "  -wN --debug-dump=no-follow-links" fullword ascii
      $s25 = "  -wk --debug-dump=links Display the contents of sections that link to separate" fullword ascii
      $s26 = "Contents of the SFrame section %s:" fullword ascii
      $s27 = "No processor specific unwind information to decode" fullword ascii
      $s28 = "Section '%s' was not dumped because it does not exist" fullword ascii
      $s29 = "KIPO-KAIST Core-A 1st generation processor family" fullword ascii
      $s30 = "Atmel Corporation 32-bit microprocessor" fullword ascii
      $s31 = "The length field (%#lx) in the debug_rnglists header is wrong - the section is too small" fullword ascii
      $s32 = "dump_sframe" fullword ascii
      $s33 = "KIPO-KAIST Core-A 2nd generation processor family" fullword ascii
      $s34 = "filedata->dump.num_dump_sects >= cmdline.num_dump_sects" fullword ascii
      $s35 = "The length field (%#lx) in the debug_line header is wrong - the section is too small" fullword ascii
      $s36 = "Dump of CTF section '%s':" fullword ascii
      $s37 = "Compiled with branch target enforcement" fullword ascii
      $s38 = " NOTE: This section is compressed, but its contents have NOT been expanded for this dump." fullword ascii
      $s39 = "Too many program headers - %#x - the file is not that big" fullword ascii
      $s40 = "Compiled without branch target enforcement" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 40 53 05 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 d6 0b 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 30 a5 00 00 00 00 00 00 30 a5 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 7d a9 06 00 00 00 00 00 7d a9 06 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 60 07 00 00 00 00 00 00 60 07 00 00 00 00 00 00 60 07 00 00 00 00 00 54 11 04 00 00 00 00 00 54 11 04 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 78 0b 00 00 00 00 00 b0 88 0b 00 00 00 00 00 b0 88 0b 00 00 00 00 00 90 5c 00 00 00 00 00 00 c0 98 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 60 ad 0b 00 00 00 00 00 60 bd 0b 00 00 00 00 00 60 bd 0b 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 bc 00 00 00 00 00 00 00 bc 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 f0 f4 0a 00 00 00 00 00 f0 f4 0a 00 00 00 00 00 f0 f4 0a 00 00 00 00 00 2c 10 00 00 00 00 00 00 2c 10 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 78 0b 00 00 00 00 00 b0 88 0b 00 00 00 00 00 b0 88 0b 00 00 00 00 00 50 37 00 00 00 00 00 00 50 37 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 1d 22 ff e8 1a dd 6c a9 d6 1b 43 ba f5 76 ac 90 a5 ad d0 4e 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 68 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 64 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 62 69 6e 75 74 69 6c 73 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 32 2e 39 30 2e 32 30 32 34 30 37 32 30 2d 32 22 2c 22 61 72 63 68 69 74}
condition:
      filesize < 2000KB and
      8 of them and $magic
}

rule gtfobins_binaries_jq {
   strings:
      $x1 = "jq - commandline JSON processor [version %s]" fullword ascii
      $s2 = "For listing the command options, use %s --help." fullword ascii
      $s3 = "Use %s --help for help with command-line options," fullword ascii
      $s4 = "  --                        terminates argument processing;" fullword ascii
      $s5 = "Cannot dump a string containing NUL with --raw-output0 option" fullword ascii
      $s6 = "jq is a tool for processing JSON inputs, applying the given filter to" fullword ascii
      $s7 = "debug-dump-disasm" fullword ascii
      $s8 = "jv_dump_string" fullword ascii
      $s9 = "%s: invalid JSON text passed to --jsonargs" fullword ascii
      $s10 = "%s: invalid JSON text passed to --argjson" fullword ascii
      $s11 = "%s: Bad JSON in --%s %s %s: %s" fullword ascii
      $s12 = "%s: --%s takes two parameters (e.g. --%s varname filename)" fullword ascii
      $s13 = "--build=x86_64-linux-gnu --prefix=/usr '--includedir=${prefix}/include' '--mandir=${prefix}/share/man' '--infodir=${prefix}/shar" ascii
      $s14 = "Command options:" fullword ascii
      $s15 = "jq_get_error_message" fullword ascii
      $s16 = "--build=x86_64-linux-gnu --prefix=/usr '--includedir=${prefix}/include' '--mandir=${prefix}/share/man' '--infodir=${prefix}/shar" ascii
      $s17 = "strong -fstack-clash-protection -Wformat -Werror=format-security -fcf-protection' 'LDFLAGS=-Wl,-z,relro -Wl,-z,now' 'CPPFLAGS=-W" ascii
      $s18 = "nu 'CFLAGS=-g -O2 -Werror=implicit-function-declaration -ffile-prefix-map=/build/reproducible-path/jq-1.7.1=. -fstack-protector-" ascii
      $s19 = "jv_dumpf" fullword ascii
      $s20 = "inux-gnu' --runstatedir=/run --disable-maintainer-mode --disable-dependency-tracking --disable-static build_alias=x86_64-linux-g" ascii
      $s21 = "jv_dump" fullword ascii
      $s22 = "%s: --indent takes one parameter" fullword ascii
      $s23 = "%s: --arg takes two parameters (e.g. --arg varname value)" fullword ascii
      $s24 = "%s: --indent takes a number between -1 and 7" fullword ascii
      $s25 = "%s: --argjson takes two parameters (e.g. --argjson varname text)" fullword ascii
      $s26 = "jq: error (at %s): %s" fullword ascii
      $s27 = "jq_dump_disassembly" fullword ascii
      $s28 = "jq: error (at %s) (not a string): %s" fullword ascii
      $s29 = "      --stream-errors       implies --stream and report parse error as" fullword ascii
      $s30 = "jq_get_exit_code" fullword ascii
      $s31 = "jv_invalid_get_msg" fullword ascii
      $s32 = "jq_util_input_get_position" fullword ascii
      $s33 = "jsonargs" fullword ascii
      $s34 = "-L takes a parameter: (e.g. -L /search/path or -L/search/path)" fullword ascii
      $s35 = "slurpfile" fullword ascii
      $s36 = "date-time -D_FORTIFY_SOURCE=2'" fullword ascii
      $s37 = "argjson" fullword ascii
      $s38 = "      --rawfile name file   set $name to string contents of file;" fullword ascii
      $s39 = "e/info' --sysconfdir=/etc --localstatedir=/var --disable-option-checking --disable-silent-rules '--libdir=${prefix}/lib/x86_64-l" ascii
      $s40 = "Failed to set $JQ_COLORS" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 3e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 50 71 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 50 18 00 00 00 00 00 00 50 18 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 dd 26 00 00 00 00 00 00 dd 26 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 c4 16 00 00 00 00 00 00 c4 16 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 6b 00 00 00 00 00 00 70 7b 00 00 00 00 00 00 70 7b 00 00 00 00 00 00 a0 04 00 00 00 00 00 00 e8 04 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 80 6b 00 00 00 00 00 00 80 7b 00 00 00 00 00 00 80 7b 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 20 64 00 00 00 00 00 00 20 64 00 00 00 00 00 00 20 64 00 00 00 00 00 00 64 00 00 00 00 00 00 00 64 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 6b 00 00 00 00 00 00 70 7b 00 00 00 00 00 00 70 7b 00 00 00 00 00 00 90 04 00 00 00 00 00 00 90 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 87 c9 53 bf 14 1e 13 4a 67 5c fc 80 d0 82 db 97 e0 5a 85 c3 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 4d 00 00 00 01 00 00 00 06 00 00 00 00 01 81 00 00 01 10 02 4d 00 00 00 4f 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c2 03 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 90KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_hexdump {
   strings:
      $s1 = "hexdump" fullword ascii
      $s2 = "hexdump(1)" fullword ascii
      $s3 = "lightmagenta" fullword ascii
      $s4 = "terminal is ready (supports %d colors)" fullword ascii
      $s5 = "setting '%s' from %d -to-> %d" fullword ascii
      $s6 = "reading dir: '%s'" fullword ascii
      $s7 = "reading file '%s'" fullword ascii
      $s8 = "item '%s': score=%d [cur: %d, name(%zu): %s, term(%zu): %s]" fullword ascii
      $s9 = "unsupported color mode" fullword ascii
      $s10 = "all input file arguments failed" fullword ascii
      $s11 = "failed to parse length" fullword ascii
      $s12 = "Display file contents in hexadecimal, decimal, octal, or ascii." fullword ascii
      $s13 = "(out - *seq) <= len" fullword ascii
      $s14 = "byte count with multiple conversion characters" fullword ascii
      $s15 = "failed to parse offset" fullword ascii
      $s16 = " -f, --format-file <file>  file that contains format strings" fullword ascii
      $s17 = "halfbright" fullword ascii
      $s18 = "lightred" fullword ascii
      $s19 = "termcolors" fullword ascii
      $s20 = "search '%s'" fullword ascii
      $s21 = "cs configured = %d" fullword ascii
      $s22 = "%s/.config/terminal-colors.d" fullword ascii
      $s23 = "score %s = %d" fullword ascii
      $s24 = "configured = %d" fullword ascii
      $s25 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/bsdextrautils.debug" fullword ascii
      $s26 = "bad format {%s}" fullword ascii
      $s27 = "utilname = '%s'" fullword ascii
      $s28 = "bad byte count for conversion character %s" fullword ascii
      $s29 = "scheme file = '%s'" fullword ascii
      $s30 = "terminal is NOT ready (no colors)" fullword ascii
      $s31 = "termname = '%s'" fullword ascii
      $s32 = "unknown type '%s'" fullword ascii
      $s33 = "%%s requires a precision or a byte count" fullword ascii
      $s34 = " %s arguments may be followed by the suffixes for" fullword ascii
      $s35 = "bad conversion character %%%s" fullword ascii
      $s36 = "free scheme" fullword ascii
      $s37 = "colors are enabled by default" fullword ascii
      $s38 = "sort scheme" fullword ascii
      $s39 = ".#-+ 0123456789" fullword ascii
      $s40 = "canonical" fullword ascii /* Goodware String - occured 1 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 3a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 f1 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 70 25 00 00 00 00 00 00 70 25 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 09 79 00 00 00 00 00 00 09 79 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 e8 28 00 00 00 00 00 00 e8 28 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 e6 00 00 00 00 00 00 70 e6 00 00 00 00 00 00 70 e6 00 00 00 00 00 00 ac 09 00 00 00 00 00 00 a0 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 00 eb 00 00 00 00 00 00 00 eb 00 00 00 00 00 00 00 eb 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 08 c2 00 00 00 00 00 00 08 c2 00 00 00 00 00 00 08 c2 00 00 00 00 00 00 3c 03 00 00 00 00 00 00 3c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 e6 00 00 00 00 00 00 70 e6 00 00 00 00 00 00 70 e6 00 00 00 00 00 00 90 09 00 00 00 00 00 00 90 09 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 40 0d 18 1a 49 70 8f 04 50 9c dd 57 e4 f3 c4 d9 9a f8 cd 25 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_jtag {
   strings:
      $s1 = "Execute svf commands from FILE." fullword ascii
      $s2 = "Usage: %s dump [FILE]" fullword ascii
      $s3 = "bfin-%3$s-as --version >/dev/null 2>&1 || exit $?;echo '%1$s' | bfin-%3$s-as - -o \"%2$s\" && bfin-%3$s-objcopy -O binary \"%2$s" ascii
      $s4 = "Versaloon Link -- http://www.versaloon.com." fullword ascii
      $s5 = "execute svf commands from file" fullword ascii
      $s6 = "CMD OS Shell Command" fullword ascii
      $s7 = "run a shell command" fullword ascii
      $s8 = "Error %s: SIR command length inconsistent." fullword ascii
      $s9 = "Error %s: TRST ABSENT must not be issued after a STATE command" fullword ascii
      $s10 = "Error %s: no further TRST command allowed after mode ABSENT" fullword ascii
      $s11 = "Error occurred for SVF command, line %d, column %d-%d:" fullword ascii
      $s12 = "Error %s: first %s command after length change must have a TDI value." fullword ascii
      $s13 = "Error %s: TRST ABSENT must not be issued after an SIR or SDR command" fullword ascii
      $s14 = "tap execute failure (%d)" fullword ascii
      $s15 = "Usage: %s [COMMAND]" fullword ascii
      $s16 = "jlink_tap_execute, wrong result %d, expected %d" fullword ascii
      $s17 = "Executing '%s'" fullword ascii
      $s18 = "Error %s: only TCK is supported for RUNTEST" fullword ascii
      $s19 = "status failure: needs a reset command to return back to read arrhardware failurecfi_array or busCFI not detecteddevice detection" ascii
      $s20 = "J-Link command 0x%02x failed (%d)" fullword ascii
      $s21 = "status failure: needs a reset command to return back to read arrhardware failurecfi_array or busCFI not detecteddevice detection" ascii
      $s22 = "Error: could not set BYPASS instruction" fullword ascii
      $s23 = "J-Link command 0x07 (get status) failed (%d)" fullword ascii
      $s24 = "Please use the 'include' command instead of 'script'" fullword ascii
      $s25 = "Can't execute commands without part" fullword ascii
      $s26 = "%s: invalid bit type for command '%s'" fullword ascii
      $s27 = "%s: invalid control value length for command '%s'" fullword ascii
      $s28 = "%s: invalid bit type length for command '%s'" fullword ascii
      $s29 = "%s: invalid default value length for command '%s'" fullword ascii
      $s30 = "%s: unable to get control bit number for command '%s'" fullword ascii
      $s31 = "%s: unknown command '%s'" fullword ascii
      $s32 = "%s: invalid default value '%s' for command '%s'" fullword ascii
      $s33 = "%s: unable to get boundary bit number for command '%s'" fullword ascii
      $s34 = "Primary Algorithm Command Set and Control Interface ID Code: 0x%04X (%s)" fullword ascii
      $s35 = "run command sequence from external file" fullword ascii
      $s36 = "Alternate Algorithm Command Set and Control Interface ID Code: 0x%04X (%s)" fullword ascii
      $s37 = "Usage: %s CMD" fullword ascii
      $s38 = "Shell out to the OS for a command." fullword ascii
      $s39 = "Vref too low. Possibly the target isn't powered or disconnected?mapping name should be a string" fullword ascii
      $s40 = "  [FILE]              file containing commands to execute" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 02 01 00 00 00 00 00 40 00 00 00 00 00 00 00 18 a7 0a 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b0 e9 00 00 00 00 00 00 b0 e9 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 b9 c4 05 00 00 00 00 00 b9 c4 05 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 c0 06 00 00 00 00 00 00 c0 06 00 00 00 00 00 00 c0 06 00 00 00 00 00 0c 6f 03 00 00 00 00 00 0c 6f 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 c8 38 0a 00 00 00 00 00 c8 38 0a 00 00 00 00 00 c8 38 0a 00 00 00 00 00 f8 6c 00 00 00 00 00 00 30 77 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 88 9d 0a 00 00 00 00 00 88 9d 0a 00 00 00 00 00 88 9d 0a 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 90 0b 09 00 00 00 00 00 90 0b 09 00 00 00 00 00 90 0b 09 00 00 00 00 00 4c 26 00 00 00 00 00 00 4c 26 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 c8 38 0a 00 00 00 00 00 c8 38 0a 00 00 00 00 00 c8 38 0a 00 00 00 00 00 38 67 00 00 00 00 00 00 38 67 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 4e 2c 28 61 bf bd 0e 13 3f ad de e1 0e 39 60 4f 5e 85 f6 f3 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 8e 00 00 00 02 00 00 00 07 00 00 00 80 01 00 48 02 10 08 0a 48 0c 01 0b d9 84 04 00 8e 00 00 00 92 00 00 00 99 00 00 00 42 45 d5 ec ba e3 92 7c da b1 0a e6 d1 65 ce 6d 86 f0 96 7c 66 55 61 10 42 d0 3f c2 72 b2 46 98 d8 71 58 1c 2c 2f 59 10 6f c3 4f 75 b8 8d ee 02 32 c4 f7 12}
condition:
      filesize < 2000KB and
      8 of them and $magic
}

rule gtfobins_binaries_softlimit {
   strings:
      $s1 = "softlimit: usage: softlimit [-a allbytes] [-c corebytes] [-d databytes] [-f filebytes] [-l lockbytes] [-m membytes] [-o openfile" ascii
      $s2 = "temporary failure" fullword ascii
      $s3 = "s] [-p processes] [-r residentbytes] [-s stackbytes] [-t cpusecs] child" fullword ascii
      $s4 = "device does not support operation" fullword ascii
      $s5 = "process cannot open more files" fullword ascii
      $s6 = "multihop attempted" fullword ascii
      $s7 = "unseekable descriptor" fullword ascii
      $s8 = "file descriptor not open" fullword ascii
      $s9 = ": option requires an argument -- " fullword ascii
      $s10 = ": illegal option -- " fullword ascii
      $s11 = "address already used" fullword ascii
      $s12 = "getrlimit failed: " fullword ascii
      $s13 = "too many levels of remote in path" fullword ascii
      $s14 = "srmount error" fullword ascii
      $s15 = "unable to run " fullword ascii
      $s16 = "remote address changed" fullword ascii
      $s17 = "softlimit: usage: softlimit [-a allbytes] [-c corebytes] [-d databytes] [-f filebytes] [-l lockbytes] [-m membytes] [-o openfile" ascii
      $s18 = "advertise error" fullword ascii
      $s19 = "device not configured" fullword ascii
      $s20 = "communication error" fullword ascii
      $s21 = "input/output error" fullword ascii
      $s22 = "operation would cause deadlock" fullword ascii
      $s23 = "setrlimit failed: " fullword ascii
      $s24 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/daemontools.debug" fullword ascii
      $s25 = "file too big" fullword ascii
      $s26 = "device busy" fullword ascii
      $s27 = "protocol not available" fullword ascii
      $s28 = "incorrect protocol type" fullword ascii
      $s29 = "machine not on network" fullword ascii
      $s30 = "too many references" fullword ascii
      $s31 = "socket shut down" fullword ascii
      $s32 = "not a block device" fullword ascii
      $s33 = "link severed" fullword ascii
      $s34 = "input out of range" fullword ascii
      $s35 = "output out of range" fullword ascii
      $s36 = "system cannot open more files" fullword ascii
      $s37 = "system call not available" fullword ascii
      $s38 = "network reset" fullword ascii /* Goodware String - occured 567 times */
      $s39 = "network down" fullword ascii /* Goodware String - occured 567 times */
      $s40 = "protocol not supported" fullword ascii /* Goodware String - occured 568 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 13 00 00 00 00 00 00 40 00 00 00 00 00 00 00 48 52 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d8 08 00 00 00 00 00 00 d8 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 69 1a 00 00 00 00 00 00 69 1a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 a8 13 00 00 00 00 00 00 a8 13 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 78 4d 00 00 00 00 00 00 78 5d 00 00 00 00 00 00 78 5d 00 00 00 00 00 00 34 03 00 00 00 00 00 00 c8 0c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 88 4d 00 00 00 00 00 00 88 5d 00 00 00 00 00 00 88 5d 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 14 3b 00 00 00 00 00 00 14 3b 00 00 00 00 00 00 14 3b 00 00 00 00 00 00 34 01 00 00 00 00 00 00 34 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 78 4d 00 00 00 00 00 00 78 5d 00 00 00 00 00 00 78 5d 00 00 00 00 00 00 88 02 00 00 00 00 00 00 88 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 31 74 4c 3c a6 4e 5c 2f 77 45 e5 42 7c a1 45 7d 36 4f a7 4e 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 0e 00 00 00 01 00 00 00 06 00 00 00 30 00 81 00 c0 00 40 00 0e 00 00 00 11 00 00 00 00 00 00 00 c4 89 05 90 a6 dd a3 6b d1 65 ce 6d c5 b9 9c 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 2f 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 70KB and
      8 of them and $magic
}

rule gtfobins_binaries_setlock {
   strings:
      $s1 = "temporary failure" fullword ascii
      $s2 = "device does not support operation" fullword ascii
      $s3 = "process cannot open more files" fullword ascii
      $s4 = "multihop attempted" fullword ascii
      $s5 = "unseekable descriptor" fullword ascii
      $s6 = "file descriptor not open" fullword ascii
      $s7 = ": option requires an argument -- " fullword ascii
      $s8 = ": illegal option -- " fullword ascii
      $s9 = "address already used" fullword ascii
      $s10 = "too many levels of remote in path" fullword ascii
      $s11 = "srmount error" fullword ascii
      $s12 = "unable to run " fullword ascii
      $s13 = "remote address changed" fullword ascii
      $s14 = "advertise error" fullword ascii
      $s15 = "device not configured" fullword ascii
      $s16 = "communication error" fullword ascii
      $s17 = "setlock: usage: setlock [ -nNxX ] file program [ arg ... ]" fullword ascii
      $s18 = "input/output error" fullword ascii
      $s19 = "operation would cause deadlock" fullword ascii
      $s20 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/daemontools.debug" fullword ascii
      $s21 = "d2853cd267dadc21832029e675da1a7e19f417.debug" fullword ascii
      $s22 = "file too big" fullword ascii
      $s23 = "device busy" fullword ascii
      $s24 = "protocol not available" fullword ascii
      $s25 = "incorrect protocol type" fullword ascii
      $s26 = "machine not on network" fullword ascii
      $s27 = "too many references" fullword ascii
      $s28 = "socket shut down" fullword ascii
      $s29 = "not a block device" fullword ascii
      $s30 = "link severed" fullword ascii
      $s31 = "input out of range" fullword ascii
      $s32 = "output out of range" fullword ascii
      $s33 = "unable to open " fullword ascii
      $s34 = "unable to lock " fullword ascii
      $s35 = "system cannot open more files" fullword ascii
      $s36 = "system call not available" fullword ascii
      $s37 = "network reset" fullword ascii /* Goodware String - occured 567 times */
      $s38 = "network down" fullword ascii /* Goodware String - occured 567 times */
      $s39 = "protocol not supported" fullword ascii /* Goodware String - occured 568 times */
      $s40 = "connection aborted" fullword ascii /* Goodware String - occured 568 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 f0 12 00 00 00 00 00 00 40 00 00 00 00 00 00 00 48 52 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d0 08 00 00 00 00 00 00 d0 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 49 18 00 00 00 00 00 00 49 18 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 12 00 00 00 00 00 00 00 12 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 78 4d 00 00 00 00 00 00 78 5d 00 00 00 00 00 00 78 5d 00 00 00 00 00 00 34 03 00 00 00 00 00 00 c8 0c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 88 4d 00 00 00 00 00 00 88 5d 00 00 00 00 00 00 88 5d 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 98 39 00 00 00 00 00 00 98 39 00 00 00 00 00 00 98 39 00 00 00 00 00 00 34 01 00 00 00 00 00 00 34 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 78 4d 00 00 00 00 00 00 78 5d 00 00 00 00 00 00 78 5d 00 00 00 00 00 00 88 02 00 00 00 00 00 00 88 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 2b d2 85 3c d2 67 da dc 21 83 20 29 e6 75 da 1a 7e 19 f4 17 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 0e 00 00 00 01 00 00 00 06 00 00 00 30 00 81 00 c0 00 40 00 0e 00 00 00 11 00 00 00 00 00 00 00 c4 89 05 90 a6 dd a3 6b d1 65 ce 6d c5 b9 9c 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 2f 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 70KB and
      8 of them and $magic
}

rule gtfobins_binaries_ldconfig {
   strings:
      $s1 = "e != EDEADLK || (kind != PTHREAD_MUTEX_ERRORCHECK_NP && kind != PTHREAD_MUTEX_RECURSIVE_NP)" fullword ascii
      $s2 = "%s: IFUNC symbol '%s' referenced in '%s' is defined in the executable and creates an unsatisfiable circular dependency." fullword ascii
      $s3 = "cy == 0 || p.tmp[p.tmpsize - 1] < 20" fullword ascii
      $s4 = "__pthread_mutex_unlock_usercnt" fullword ascii
      $s5 = "type == PTHREAD_MUTEX_ERRORCHECK_NP" fullword ascii
      $s6 = "glibc.pthread.mutex_spin_count" fullword ascii
      $s7 = "PTHREAD_MUTEX_TYPE (mutex) == PTHREAD_MUTEX_ERRORCHECK_NP" fullword ascii
      $s8 = "?33333333" fullword ascii /* reversed goodware string '33333333?' */ /* hex encoded string '3333' */
      $s9 = "getsecretkey" fullword ascii
      $s10 = "getpublickey" fullword ascii
      $s11 = "Unexpected error %d on netlink descriptor %d (address family %d)." fullword ascii
      $s12 = "Only process directories specified on the command line.  Don't build cache." fullword ascii
      $s13 = "pthread_mutex_unlock.c" fullword ascii
      $s14 = "pthread_mutex_lock.c" fullword ascii
      $s15 = "glibc.cpu.prefer_map_32bit_exec" fullword ascii
      $s16 = "___pthread_mutex_lock" fullword ascii
      $s17 = "relocation processing: %s%s" fullword ascii
      $s18 = "__pthread_mutex_lock_full" fullword ascii
      $s19 = "%s: line %d: bad command `%s'" fullword ascii
      $s20 = "glibc.cpu.x86_non_temporal_threshold" fullword ascii
      $s21 = "glibc.cpu.x86_memset_non_temporal_threshold" fullword ascii
      $s22 = "EHWPOISON" fullword ascii
      $s23 = "%s%s%s:%u: %s%sAssertion `%s' failed." fullword ascii
      $s24 = "Unexpected error %d on netlink descriptor %d." fullword ascii
      $s25 = "Unexpected netlink response of size %zd on descriptor %d (address family %d)" fullword ascii
      $s26 = "cy == 1 || (p.frac[p.fracsize - 2] == 0 && p.frac[0] == 0)" fullword ascii
      $s27 = "__nss_database_fork_subprocess" fullword ascii
      $s28 = "glibc.pthread.stack_hugetlb" fullword ascii
      $s29 = "mutex->__data.__owner == 0" fullword ascii
      $s30 = "*** %s ***: terminated" fullword ascii
      $s31 = "headmap.len == archive_stat.st_size" fullword ascii
      $s32 = "ELF load command address/offset not page-aligned" fullword ascii
      $s33 = "(old_top == initial_top (av) && old_size == 0) || ((unsigned long) (old_size) >= MINSIZE && prev_inuse (old_top) && ((unsigned l" ascii
      $s34 = "/proc/self/loginuid" fullword ascii
      $s35 = "EKEYEXPIRED" fullword ascii
      $s36 = "gethostbyname_r" fullword ascii
      $s37 = "gethostbyaddr_r" fullword ascii
      $s38 = "invalid target namespace in dlmopen()" fullword ascii
      $s39 = "gethostbyname4_r" fullword ascii
      $s40 = "target_seg_index1 == 0" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 21 00 00 00 00 00 00 40 00 00 00 00 00 00 00 08 ec 0e 00 00 00 00 00 00 00 00 00 40 00 38 00 0c 00 40 00 20 00 1f 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 30 08 00 00 00 00 00 00 30 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 99 28 0b 00 00 00 00 00 99 28 0b 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 0b 00 00 00 00 00 00 40 0b 00 00 00 00 00 00 40 0b 00 00 00 00 00 36 3e 03 00 00 00 00 00 36 3e 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 a0 7f 0e 00 00 00 00 00 a0 8f 0e 00 00 00 00 00 a0 8f 0e 00 00 00 00 00 0c 6b 00 00 00 00 00 00 a8 c7 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 08 cc 0e 00 00 00 00 00 08 dc 0e 00 00 00 00 00 08 dc 0e 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 e0 02 00 00 00 00 00 00 e0 02 00 00 00 00 00 00 e0 02 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 00 03 00 00 00 00 00 00 00 03 00 00 00 00 00 00 00 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 07 00 00 00 04 00 00 00 a0 7f 0e 00 00 00 00 00 a0 8f 0e 00 00 00 00 00 a0 8f 0e 00 00 00 00 00 28 00 00 00 00 00 00 00 74 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 e0 02 00 00 00 00 00 00 e0 02 00 00 00 00 00 00 e0 02 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 60 32 0d 00 00 00 00 00 60 32 0d 00 00 00 00 00 60 32 0d 00 00 00 00 00 8c 30 00 00 00 00 00 00 8c 30 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 a0 7f 0e 00 00 00 00 00 a0 8f 0e 00 00 00 00 00 a0 8f 0e 00 00 00 00 00 60 50 00 00 00 00 00 00 60 50 00 00 00 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 bc 46 0b f8 ea 9d 85 05 01 35 93 cc 64 d7 d1 e6 e3 13 d3 0f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 df 0e 00 00 00 00 00 25 00 00 00 00 00 00 00 a0 66 02 00 00 00 00 00 08 df 0e 00 00 00 00 00 25 00 00 00 00 00 00 00 60 63 02 00 00 00 00 00 f0 de 0e 00 00 00 00 00 25 00 00 00 00 00 00 00 c0 57 07 00 00 00 00 00 e8 de 0e 00 00 00 00 00 25 00 00 00 00 00 00 00 60 64 02 00 00 00 00 00 d0 de 0e 00 00 00 00 00}
condition:
      filesize < 3000KB and
      8 of them and $magic
}

rule gtfobins_binaries_tshark {
   strings:
      $s1 = "Child dumpcap process died: %s%s" fullword ascii
      $s2 = "  -G ftypes                dump field type basic and descriptive names" fullword ascii
      $s3 = "  -G fieldcount            dump count of header fields and exit" fullword ascii
      $s4 = " - core dumped" fullword ascii
      $s5 = "  -x                       add output of hex and ASCII dump (Packet Bytes)" fullword ascii
      $s6 = "Child dumpcap process stopped: %s" fullword ascii
      $s7 = "tshark: \"%s\" is an invalid value for --hexdump <hexoption>" fullword ascii
      $s8 = "          including only raw hex decoded fields (same as -T json -x but" fullword ascii
      $s9 = "Couldn't run dumpcap in child process: %s" fullword ascii
      $s10 = "tshark: invalid -t operand. io,stat only supports -t <r|a|ad|adoy|u|ud|udoy>" fullword ascii
      $s11 = "  -G [report]              dump one of several available reports and exit" fullword ascii
      $s12 = "  -G services              dump transport service (port) names" fullword ascii
      $s13 = "  -G elastic-mapping       dump ElasticSearch mapping file" fullword ascii
      $s14 = "  -G enterprises           dump IANA Private Enterprise Number (PEN) table" fullword ascii
      $s15 = "  -G decodes               dump \"layer type\"/\"decode as\" associations and exit" fullword ascii
      $s16 = "Invalid -o flag \"%s\"%s%s" fullword ascii
      $s17 = "  -G heuristic-decodes     dump heuristic dissector tables" fullword ascii
      $s18 = "hexdump" fullword ascii
      $s19 = "tshark: Valid --hexdump <hexoption> values include:" fullword ascii
      $s20 = "sync_pipe_run_command_actual" fullword ascii
      $s21 = "process_packet_single_pass" fullword ascii
      $s22 = "     frames                dump only frame data source" fullword ascii
      $s23 = "For valid <hexoption> values enter: tshark --hexdump help" fullword ascii
      $s24 = "Unknown message from dumpcap reading header, try to show it as a string: %s" fullword ascii
      $s25 = "  -G protocols             dump protocols in registration database and exit" fullword ascii
      $s26 = "  -G dissectors            dump registered dissector names" fullword ascii
      $s27 = "  -G currentprefs          dump current preferences and exit" fullword ascii
      $s28 = "proto_registrar_dump_field_completions" fullword ascii
      $s29 = "  -G defaultprefs          dump default preferences and exit" fullword ascii
      $s30 = "  -G column-formats        dump column format codes and exit" fullword ascii
      $s31 = "https://gitlab.com/wireshark/wireshark/-/wikis/KnownBugs/OutOfMemory" fullword ascii
      $s32 = "global_services_dump" fullword ascii
      $s33 = "  -G fields [prefix]       dump fields glossary and exit" fullword ascii
      $s34 = "  -G values                dump value, range, true/false strings and exit" fullword ascii
      $s35 = "  -G dissector-tables      dump dissector table names, types, and properties" fullword ascii
      $s36 = "  -G folders               dump about:folders" fullword ascii
      $s37 = "  -G plugins               dump installed plugins and exit" fullword ascii
      $s38 = "get_executable_path" fullword ascii
      $s39 = "  -G manuf                 dump ethernet manufacturer tables" fullword ascii
      $s40 = "  frames                   add hexdump, dump only frame data source" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 52 01 00 00 00 00 00 40 00 00 00 00 00 00 00 50 19 05 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 38 db 00 00 00 00 00 00 38 db 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 4d a0 02 00 00 00 00 00 4d a0 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 2c 34 01 00 00 00 00 00 2c 34 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 c8 04 00 00 00 00 00 b0 d8 04 00 00 00 00 00 b0 d8 04 00 00 00 00 00 58 4f 00 00 00 00 00 00 18 83 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 50 f8 04 00 00 00 00 00 50 08 05 00 00 00 00 00 50 08 05 00 00 00 00 00 60 02 00 00 00 00 00 00 60 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 60 59 04 00 00 00 00 00 60 59 04 00 00 00 00 00 60 59 04 00 00 00 00 00 0c 0f 00 00 00 00 00 00 0c 0f 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 c8 04 00 00 00 00 00 b0 d8 04 00 00 00 00 00 b0 d8 04 00 00 00 00 00 50 47 00 00 00 00 00 00 50 47 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 40 a4 ef 34 ea dd 91 57 09 3f d3 eb a2 08 4b d7 5a e4 18 8d 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 a1 02 00 00 04 00 00 00 08 00 00 00 a1 60 90 a1 0c 01 e6 d7 41 40 40 08 02 28 92 48 40 11 80 10 14 51 80 08 41 8c 01 10 22 33 02 08 a1 02 00 00 a2 02 00 00 00 00 00 00 a7 02 00 00 00 00 00 00 aa 02 00 00 ae 02 00 00 af 02 00 00 b2 02 00 00 00 00 00 00 b4 02 00 00 b6 02 00 00}
condition:
      filesize < 1000KB and
      8 of them and $magic
}

rule gtfobins_binaries_zip {
   strings:
      $s1 = "  -sc       show command line arguments as processed and exit" fullword ascii
      $s2 = "ignoring FIFO (Named Pipe) - use -FI to read: " fullword ascii
      $s3 = "total bytes=%s, compressed=%s -> %d%% savings" fullword ascii
      $s4 = "  -e        use standard (weak) PKZip 2.0 encryption, prompt for password" fullword ascii
      $s5 = "Illegal host system mapping in local header:  %d" fullword ascii
      $s6 = "invalid date entered for -t option - use mmddyyyy or yyyy-mm-dd" fullword ascii
      $s7 = "[encryption, version %d.%d%s of %s] (modified for Zip 3)" fullword ascii
      $s8 = "Try -F to attempt to read anyway" fullword ascii
      $s9 = "user ended reading - closing archive" fullword ascii
      $s10 = "bad archive - error reading central directory" fullword ascii
      $s11 = "encrypt entries, option value is password" fullword ascii
      $s12 = "  -sf       show files to operate on and exit (-sf- logfile only)" fullword ascii
      $s13 = "Attempt to read unsupported Zip64 archive" fullword ascii
      $s14 = "encrypt entries, ask for password" fullword ascii
      $s15 = "display dots as process each file" fullword ascii
      $s16 = "  from stopping unexpectedly on unfed pipe, use -FI to enable:" fullword ascii
      $s17 = "sd: Command line read" fullword ascii
      $s18 = "unzip-command" fullword ascii
      $s19 = "  zip when either no input files on command line or -U (--copy) used." fullword ascii
      $s20 = "show-command" fullword ascii
      $s21 = "  -P pswd   use standard encryption, password is pswd" fullword ascii
      $s22 = "-l used on binary file - corrupted?" fullword ascii
      $s23 = "  -J        Junk sfx - removes prepended extractor executable from" fullword ascii
      $s24 = "  -q   quiet operation              -v   verbose operation/print version info" fullword ascii
      $s25 = "Unicode Path Extra Field version > 1 - skipping" fullword ascii
      $s26 = "unzip pipe error" fullword ascii
      $s27 = "Copyright (c) 1990-2008 Info-ZIP - Type '%s \"-L\"' for software license." fullword ascii
      $s28 = "Zip64 EOCDR not found where expected - compensating" fullword ascii
      $s29 = "(try -F to attempt recovery)" fullword ascii
      $s30 = "has binary so -l ignored" fullword ascii
      $s31 = "Large entry support disabled with -fz- but entry needs" fullword ascii
      $s32 = "invalid date entered for -tt option - use mmddyyyy or yyyy-mm-dd" fullword ascii
      $s33 = "seek failed reading descriptor" fullword ascii
      $s34 = "(try -F to attempt to fix)" fullword ascii
      $s35 = "  -e   encrypt                      -n   don't compress these suffixes" fullword ascii
      $s36 = "Poor compression resulted in unexpectedly large entry - try -fz" fullword ascii
      $s37 = "Large entry support disabled with -fz- but needed" fullword ascii
      $s38 = "  -v        verbose operation (just \"zip -v\" shows version information)" fullword ascii
      $s39 = "Large entry support disabled using -fz- but needed" fullword ascii
      $s40 = "-ll used on binary file - corrupted?" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 d8 00 00 00 00 00 00 40 00 00 00 00 00 00 00 50 49 03 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a8 62 00 00 00 00 00 00 a8 62 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 cd c5 01 00 00 00 00 00 cd c5 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 1c d8 00 00 00 00 00 00 1c d8 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 22 03 00 00 00 00 00 70 22 03 00 00 00 00 00 70 22 03 00 00 00 00 00 38 25 00 00 00 00 00 00 08 0e 05 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c8 2d 03 00 00 00 00 00 c8 2d 03 00 00 00 00 00 c8 2d 03 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 e8 ef 02 00 00 00 00 00 e8 ef 02 00 00 00 00 00 e8 ef 02 00 00 00 00 00 4c 05 00 00 00 00 00 00 4c 05 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 22 03 00 00 00 00 00 70 22 03 00 00 00 00 00 70 22 03 00 00 00 00 00 90 0d 00 00 00 00 00 00 90 0d 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 9e 6e bc 46 09 4a 61 a8 a7 fd ba f6 71 dd c4 fc 84 15 06 a4 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 68 00 00 00 01 00 00 00 06 00 00 00 80 01 a1 00 80 81 10 02 68 00 00 00 6a 00 00 00 6c 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c ef 21 63 0f 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 eb 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 600KB and
      8 of them and $magic
}

rule gtfobins_binaries_runscript {
   strings:
      $s1 = "script \"%s\" line %d: unknown command \"%s\"%s" fullword ascii
      $s2 = "script \"%s\": syntax error in line %d %s%s" fullword ascii
      $s3 = "Usage: runscript <scriptfile> [logfile [homedir]]%s" fullword ascii
      $s4 = "runscript, part of minicom version %s" fullword ascii
      $s5 = "script \"%s\" line %d: unknown variable \"%s\"%s" fullword ascii
      $s6 = "script \"%s\" line %d: nested expect%s" fullword ascii
      $s7 = "script \"%s\" line %d: break outside of expect%s" fullword ascii
      $s8 = "script \"%s\" line %d: label \"%s\" not found%s" fullword ascii
      $s9 = "script \"%s\": unexpected end of file%s" fullword ascii
      $s10 = "script \"%s\": global timeout%s" fullword ascii
      $s11 = "script \"%s\": out of memory%s" fullword ascii
      $s12 = "script \"%s\": no return from gosub%s" fullword ascii
      $s13 = "runscript: couldn't open \"%s\"%s" fullword ascii
      $s14 = "LOGIN=" fullword ascii
      $s15 = "(expected command after if)" fullword ascii
      $s16 = "script \"%s\" line %d: call inside expect%s" fullword ascii
      $s17 = "minicom" fullword ascii
      $s18 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/minicom.debug" fullword ascii
      $s19 = "(unknown operator)" fullword ascii
      $s20 = "mbswidth" fullword ascii
      $s21 = "mbstowcs(wcs, s, _ml + 1) != (size_t)-1" fullword ascii
      $s22 = "expfound" fullword ascii
      $s23 = "NULL paramenter to %s!" fullword ascii
      $s24 = "29d217eb8bcb3f9141fbcf99211ba710df6a50.debug" fullword ascii
      $s25 = "|$0LOGI" fullword ascii
      $s26 = "password" fullword ascii /* Goodware String - occured 519 times */
      $s27 = "%04d%02d%02d %02d:%02d:%02d " fullword ascii
      $s28 = "(missing var name)" fullword ascii
      $s29 = "(word contains ESC or quote)" fullword ascii
      $s30 = "29d217eb8bcb3f9141fbcf99211ba710df6a50" ascii
      $s31 = "(in goto/gosub label)" fullword ascii
      $s32 = "(argument expected)" fullword ascii
      $s33 = "(invalid argument)" fullword ascii
      $s34 = "(too many arguments)" fullword ascii
      $s35 = "(expected variable)" fullword ascii
      $s36 = "Input line %u too long, aborting (and fix me!)!" fullword ascii
      $s37 = "(garbage after {)" fullword ascii
      $s38 = "(garbage after })" fullword ascii
      $s39 = "|$0PASS" fullword ascii
      $s40 = "(unexpected argument)" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 25 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d0 74 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 17 00 00 00 00 00 00 80 17 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 2d 2d 00 00 00 00 00 00 2d 2d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 1c 0f 00 00 00 00 00 00 1c 0f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 6d 00 00 00 00 00 00 d0 6d 00 00 00 00 00 00 d0 6d 00 00 00 00 00 00 60 05 00 00 00 00 00 00 d0 19 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 6d 00 00 00 00 00 00 e0 6d 00 00 00 00 00 00 e0 6d 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 44 55 00 00 00 00 00 00 44 55 00 00 00 00 00 00 44 55 00 00 00 00 00 00 8c 01 00 00 00 00 00 00 8c 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 6d 00 00 00 00 00 00 d0 6d 00 00 00 00 00 00 d0 6d 00 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 cd 29 d2 17 eb 8b cb 3f 91 41 fb cf 99 21 1b a7 10 df 6a 50 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 3c 00 00 00 01 00 00 00 06 00 00 00 10 01 81 00 c0 01 50 02 3c 00 00 00 3f 00 00 00 00 00 00 00 28 1d 8c 1c a6 dd a3 6b d1 65 ce 6d c4 b9 9c 40 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 28 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 90KB and
      8 of them and $magic
}

rule gtfobins_binaries_nc {
   strings:
      $s1 = "-c shell commands" fullword ascii
      $s2 = "Warning: inverse host lookup failed for %s: " fullword ascii
      $s3 = "Warning: forward host lookup failed for %s: " fullword ascii
      $s4 = "hex dump of traffic" fullword ascii
      $s5 = "nc -l -p port [-options] [hostname] [port]" fullword ascii
      $s6 = "as `-e'; use /bin/sh to exec [dangerous!!]" fullword ascii
      $s7 = "exec %s failed" fullword ascii
      $s8 = "%s: inverse host lookup failed: " fullword ascii
      $s9 = "%s: forward host lookup failed: " fullword ascii
      $s10 = "gethostpoop fuxored" fullword ascii
      $s11 = "UDP listen needs -p arg" fullword ascii
      $s12 = "local getsockname failed" fullword ascii
      $s13 = "loadports: bogus values %d, %d" fullword ascii
      $s14 = "delay interval for lines sent, ports scanned" fullword ascii
      $s15 = "too many -g hops" fullword ascii
      $s16 = "program to exec after connect [dangerous!!]" fullword ascii
      $s17 = "post-rcv getsockname failed" fullword ascii
      $s18 = "nnetfd reuseport failed" fullword ascii
      $s19 = "Warning: port-bynum mismatch, %d != %d" fullword ascii
      $s20 = "invalid connection to [%s] from %s [%s] %d" fullword ascii
      $s21 = "Hmalloc %d failed" fullword ascii
      $s22 = "invalid hop pointer %d, must be multiple of 4 <= 28" fullword ascii
      $s23 = " sent %d, rcvd %d" fullword ascii
      $s24 = "Bogus buffers: %d, %d" fullword ascii
      $s25 = "nnetfd set keepalive failed" fullword ascii
      $s26 = "Preposterous fd value %d" fullword ascii
      $s27 = "nc -h for help" fullword ascii
      $s28 = "timeout for connects and final net reads" fullword ascii
      $s29 = "preposterous h_errno: %d" fullword ascii
      $s30 = "nnetfd reuseaddr failed" fullword ascii
      $s31 = "zero-I/O mode [used for scanning]" fullword ascii
      $s32 = "nnetfd tos failed" fullword ascii
      $s33 = "retrying local %s:%d" fullword ascii
      $s34 = "Can't grab %s:%d with bind" fullword ascii
      $s35 = "hyphens in port names must be backslash escaped (e.g. 'ftp\\-data')." fullword ascii
      $s36 = "udptest first write failed?! errno %d" fullword ascii
      $s37 = "        -k                      set keepalive option on socket" fullword ascii
      $s38 = "set Type Of Service" fullword ascii
      $s39 = "invalid port %s" fullword ascii
      $s40 = "quit after EOF on stdin and delay of secs" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 c0 30 00 00 00 00 00 00 40 00 00 00 00 00 00 00 98 81 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 58 15 00 00 00 00 00 00 58 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 09 35 00 00 00 00 00 00 09 35 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 dc 12 00 00 00 00 00 00 dc 12 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 7b 00 00 00 00 00 00 b0 8b 00 00 00 00 00 00 b0 8b 00 00 00 00 00 00 a0 04 00 00 00 00 00 00 a0 06 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e8 7b 00 00 00 00 00 00 e8 8b 00 00 00 00 00 00 e8 8b 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c8 6b 00 00 00 00 00 00 c8 6b 00 00 00 00 00 00 c8 6b 00 00 00 00 00 00 f4 00 00 00 00 00 00 00 f4 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 7b 00 00 00 00 00 00 b0 8b 00 00 00 00 00 00 b0 8b 00 00 00 00 00 00 50 04 00 00 00 00 00 00 50 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 f8 9c ab 91 e8 49 b0 3a 8a b1 4b 45 f2 57 2c ac 43 20 bc bc 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 41 00 00 00 01 00 00 00 06 00 00 00 00 05 81 00 00 00 0c 02 41 00 00 00 42 00 00 00 43 00 00 00 d1 65 ce 6d 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ed 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_iftop {
   strings:
      $s1 = " p - toggle port display                ! - shell command" fullword ascii
      $s2 = "Error getting hardware address for interface: %s" fullword ascii
      $s3 = "   -n                  don't do hostname lookups" fullword ascii
      $s4 = "iftop: display bandwidth usage on an interface by host" fullword ascii
      $s5 = "Please email pdw@ex-parrot.com, quoting the datalink type and what you were" fullword ascii
      $s6 = "Showing ports:%s%s%s%s." fullword ascii
      $s7 = "copyright (c) 2002 Paul Warren <pdw@ex-parrot.com> and contributors" fullword ascii
      $s8 = "Synopsis: iftop -h | [-npblNBP] [-i interface] [-f filter code]" fullword ascii
      $s9 = " 1/2/3 - sort by 1st/2nd/3rd column" fullword ascii
      $s10 = "*** some options have changed names since v0.9 ***" fullword ascii
      $s11 = "Port display OFFPort display DESPort display SOUDNS resolution oPort resolution Bars show 2s aveBars show 10s avBars show 40s av" ascii
      $s12 = " n - toggle DNS host resolution         P - pause display" fullword ascii
      $s13 = "Unable to get IP address for interface: %s" fullword ascii
      $s14 = " d - toggle show destination host       b - toggle bar graph display" fullword ascii
      $s15 = " < - sort by source name" fullword ascii
      $s16 = "Host name (port/service if enabled)" fullword ascii
      $s17 = " o - freeze current order" fullword ascii
      $s18 = " > - sort by dest name" fullword ascii
      $s19 = " s - toggle show source host            h - toggle this help display" fullword ascii
      $s20 = "   -P                  show ports as well as hosts" fullword ascii
      $s21 = " D - toggle show destination port       L - lin/log scales" fullword ascii
      $s22 = "Error reading rate: %s" fullword ascii
      $s23 = "Port resolution is %s." fullword ascii
      $s24 = "Port display:                           j/k - scroll display" fullword ascii
      $s25 = "   -p                  run in promiscuous mode (show traffic between other" fullword ascii
      $s26 = " N - toggle service resolution          f - edit filter code" fullword ascii
      $s27 = "   -o source            Sort by source address" fullword ascii
      $s28 = " S - toggle show source port            l - set screen filter" fullword ascii
      $s29 = "   -o destination       Sort by destination address" fullword ascii
      $s30 = "   -i interface        listen on named interface" fullword ascii
      $s31 = "   -c config file      specifies an alternative configuration file" fullword ascii
      $s32 = "%s:%d: warning: repeated directive \"%s\"" fullword ascii
      $s33 = "%s:%d: warning: unknown directive \"%s\"" fullword ascii
      $s34 = "%s destination host" fullword ascii
      $s35 = "Sorry, subshells have been disabShow cumulative Hide cumulative Press H or ? for" fullword ascii
      $s36 = "%s source host" fullword ascii
      $s37 = "Show source hostHide source hostShow dest host" fullword ascii
      $s38 = "Hide dest host" fullword ascii
      $s39 = "getifaddrs()" fullword ascii
      $s40 = "iftop: option -%c requires an argument" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 38 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f0 03 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 27 00 00 00 00 00 00 80 27 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 05 89 00 00 00 00 00 00 05 89 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 18 36 00 00 00 00 00 00 18 36 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 fa 00 00 00 00 00 00 30 0a 01 00 00 00 00 00 30 0a 01 00 00 00 00 00 80 08 00 00 00 00 00 00 68 12 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 40 fa 00 00 00 00 00 00 40 0a 01 00 00 00 00 00 40 0a 01 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 44 dc 00 00 00 00 00 00 44 dc 00 00 00 00 00 00 44 dc 00 00 00 00 00 00 2c 04 00 00 00 00 00 00 2c 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 fa 00 00 00 00 00 00 30 0a 01 00 00 00 00 00 30 0a 01 00 00 00 00 00 d0 05 00 00 00 00 00 00 d0 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 b7 07 fd 4f bd 59 4e 0b e1 9c 49 89 00 4c dd a8 5a 3e 7b 92 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 6f 00 00 00 02 00 00 00 07 00 00 00 60 c9 c0 00 11 01 0c 16 02 08 81 43 80 04 00 00 6f 00 00 00 73 00 00 00 79 00 00 00 0a de f7 12 d0 65 ce 6d 58 4f d6 1d 29 1d 8c 1c 20 a3 87 0d c0 b3 f7 12 16 27 83 7c 66 55 61 10 d8 2b 8c 1c 39 f2 8b 1c 96 67 53 f7 32 c4 f7 12 b3 a2 f7 12}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_aspell {
   strings:
      $s1 = "_ZN7acommon6Decode7get_newERKNS_7ConvKeyEPKNS_6ConfigE" fullword ascii
      $s2 = "_ZN7acommon6Encode7get_newERKNS_7ConvKeyEPKNS_6ConfigE" fullword ascii
      $s3 = "_ZN7acommon6Filter7processERPNS_10FilterCharES3_" fullword ascii
      $s4 = "_ZN7acommon15DocumentChecker7processEPKci" fullword ascii
      $s5 = "Usage: aspell [options] <command>" fullword ascii
      $s6 = "_ZN7acommon20internal_new_convertERKNS_6ConfigENS_7ConvKeyES3_bNS_9NormalizeE" fullword ascii
      $s7 = "\"%s\" is not a valid flag for the \"munch-list\" command." fullword ascii
      $s8 = "_ZN7acommon4Conv5setupERKNS_6ConfigERKNS_7ConvKeyES6_NS_9NormalizeE" fullword ascii
      $s9 = "  dump|create|merge master|personal|repl [<name>]" fullword ascii
      $s10 = "  [dump] dicts | filters | modes" fullword ascii
      $s11 = "  [dump] config    dumps the current configuration to stdout" fullword ascii
      $s12 = "_ZNK8aspeller8Language11fake_expandERKN7acommon10ParmStringES4_RNS1_8ObjStackE" fullword ascii
      $s13 = "q - tmp == s" fullword ascii
      $s14 = "dont-run-together" fullword ascii
      $s15 = "_ZN7acommon18get_dict_info_listEPNS_6ConfigE" fullword ascii
      $s16 = "<command> is one of:" fullword ascii
      $s17 = "keymapping" fullword ascii
      $s18 = "Could not open the file \"%s\" for reading" fullword ascii
      $s19 = "_ZN7acommon15DocumentChecker14set_status_funEPFvPvNS_5TokenEiES1_" fullword ascii
      $s20 = "./common/objstack.hpp" fullword ascii
      $s21 = "Error: You must specify at least %d parameters for \"%s\"." fullword ascii
      $s22 = "void add_affix(acommon::HashTable<CML_Parms>::iterator, char, bool)" fullword ascii
      $s23 = "Error: Stdin not a terminal." fullword ascii
      $s24 = "Error: bind_textdomain_codeset != nl_langinfo(CODESET)" fullword ascii
      $s25 = "_ZNK7acommon6Config7keyinfoERKNS_10ParmStringE" fullword ascii
      $s26 = "_ZN7acommon6Config16read_in_settingsEPKS0_" fullword ascii
      $s27 = "_ZN7acommon5ErrorD1Ev" fullword ascii
      $s28 = "./common/stack_ptr.hpp" fullword ascii
      $s29 = "@(#) International Ispell Version 3.1.20 (but really Aspell %s)" fullword ascii
      $s30 = "_ZN8aspeller28create_default_readonly_dictEPN7acommon17StringEnumerationERNS0_6ConfigE" fullword ascii
      $s31 = "_ZN7acommon9HashTableINS_9StringMap5ParmsEE6insertERKNS_10StringPairE" fullword ascii
      $s32 = "Aspell %s.  Copyright 2000-2023 by Kevin Atkinson." fullword ascii
      $s33 = "  -a|pipe          \"ispell -a\" compatibility mode" fullword ascii
      $s34 = "Move Forward one space" fullword ascii
      $s35 = "aspell_gettext_init" fullword ascii
      $s36 = "Abort This Operation" fullword ascii
      $s37 = "    dumps, creates or merges a master, personal, or replacement dictionary." fullword ascii
      $s38 = "aspeller" fullword ascii
      $s39 = "soundslike" fullword ascii
      $s40 = "  -?|usage         display a brief usage message" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 91 00 00 00 00 00 00 40 00 00 00 00 00 00 00 70 82 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 60 00 00 00 00 00 00 08 60 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 d9 a6 01 00 00 00 00 00 d9 a6 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 e0 44 00 00 00 00 00 00 e0 44 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b8 6f 02 00 00 00 00 00 b8 7f 02 00 00 00 00 00 b8 7f 02 00 00 00 00 00 6d 11 00 00 00 00 00 00 f8 14 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 90 77 02 00 00 00 00 00 90 87 02 00 00 00 00 00 90 87 02 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 08 3a 02 00 00 00 00 00 08 3a 02 00 00 00 00 00 08 3a 02 00 00 00 00 00 0c 05 00 00 00 00 00 00 0c 05 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b8 6f 02 00 00 00 00 00 b8 7f 02 00 00 00 00 00 b8 7f 02 00 00 00 00 00 48 10 00 00 00 00 00 00 48 10 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 ed d5 b8 0a 6c c5 af 01 38 a5 3a cf cd ed ac 71 a6 93 5b 36 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 25 00 00 00 c4 00 00 00 08 00 00 00 09 00 00 00 00 44 01 f0 00 48 38 33 00 0a 84 80 02 1d 10 04 00 00 44 40 0c 24 00 00 62 08 30 c0 88 12 00 26 24 44 49 46 02 01 04 81 88 01 20 a0 83 04 00 40 02 00 00 00 09 64 80 08 70 52 21 35 40 44 35 4d c4 00 00 00 00 00 00 00 c6 00 00 00 ca 00 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_fping {
   strings:
      $s1 = "fping error: not enough sequence numbers available! (expire_timeout=%ld, host_nr=%d, ping_count=%d, seqmap_next_id=%d)" fullword ascii
      $s2 = "   -f, --file=FILE    read list of targets from a file ( - means stdin)" fullword ascii
      $s3 = "%s: -g parameter generates too many addresses" fullword ascii
      $s4 = "%s: -g works only with IPv4 addresses" fullword ascii
      $s5 = "   -g, --generate     generate target list (only if no -f specified)" fullword ascii
      $s6 = "Usage: %s [options] [targets...]" fullword ascii
      $s7 = "   -d, --rdns         show targets by name (force reverse-DNS lookup)" fullword ascii
      $s8 = "   -n, --name         show targets by name (reverse-DNS lookup for target IPs)" fullword ascii
      $s9 = "   -p, --period=MSEC  interval between ping packets to one target (in ms)" fullword ascii
      $s10 = "   -q, --quiet        quiet (don't show per-target/per-ping results)" fullword ascii
      $s11 = "see 'fping -h' for usage information" fullword ascii
      $s12 = "   -A, --addr         show targets by address" fullword ascii
      $s13 = "CHART fping.%s_latency '' 'FPing Latency for host %s' ms '%s' fping.latency area 110000 %.0f" fullword ascii
      $s14 = "CHART fping.%s_packets '' 'FPing Packets for host %s' packets '%s' fping.packets line 110020 %.0f" fullword ascii
      $s15 = "CHART fping.%s_quality '' 'FPing Quality for host %s' percentage '%s' fping.quality area 110010 %.0f" fullword ascii
      $s16 = "%s: use either one of -d or -n" fullword ascii
      $s17 = "Not enough hosts reachable (required: %d, reachable: %d)" fullword ascii
      $s18 = "Enough hosts reachable (required: %d, reachable: %d)" fullword ascii
      $s19 = " %7d targets" fullword ascii
      $s20 = "%s: can't forward-lookup address (%s)" fullword ascii
      $s21 = "   -t, --timeout=MSEC individual target initial timeout (default: %.0f ms," fullword ascii
      $s22 = "   -a, --alive        show targets that are alive" fullword ascii
      $s23 = "   -u, --unreach      show targets that are unreachable" fullword ascii
      $s24 = "   -c, --count=N      count mode: send N pings to each target" fullword ascii
      $s25 = "fatal: failed to permanently drop privileges" fullword ascii
      $s26 = "                      (give start and end IP in the target list, or a CIDR address)" fullword ascii
      $s27 = "                      (ex. %s -g 192.168.1.0 192.168.1.255 or %s -g 192.168.1.0/24)" fullword ascii
      $s28 = "ICMP Unreachable (Host Unreachable For Type Of Service)" fullword ascii
      $s29 = "fatal error: could not drop privileges after setsockopt" fullword ascii
      $s30 = " xmt/rcv/%%loss = %d/%d/%d%%" fullword ascii
      $s31 = " xmt/rcv/%%return = %d/%d/%d%%" fullword ascii
      $s32 = "cannot elevate privileges for setsockopt" fullword ascii
      $s33 = "fping internal error: seqmap not initialized." fullword ascii
      $s34 = "%s: error while sending ping: %s" fullword ascii
      $s35 = "%s: netmask must be between 1 and 32 (is: %s)" fullword ascii
      $s36 = "%s: Version %s" fullword ascii
      $s37 = "ICMP Unreachable (Destination Host Unknown)" fullword ascii
      $s38 = "failure to set signal handler" fullword ascii
      $s39 = "ICMP Unreachable (Invalid Code) from %s for ICMP Echo sent to %s" fullword ascii
      $s40 = "ICMP Unreachable (Source Host Isolated)" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 50 34 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 c5 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e0 1b 00 00 00 00 00 00 e0 1b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 62 5a 00 00 00 00 00 00 62 5a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 e8 2a 00 00 00 00 00 00 e8 2a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 d8 13 00 00 00 00 00 00 a0 16 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 20 b0 00 00 00 00 00 00 20 b0 00 00 00 00 00 00 20 b0 00 00 00 00 00 00 b0 01 00 00 00 00 00 00 b0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 3c 9e 00 00 00 00 00 00 3c 9e 00 00 00 00 00 00 3c 9e 00 00 00 00 00 00 dc 01 00 00 00 00 00 00 dc 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 7c 0e 8f a4 4a 17 88 bf c4 0c 0c f9 24 8f c8 a9 f3 1f fb e5 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 43 00 00 00 01 00 00 00 06 00 00 00 02 81 81 00 00 01 10 02 43 00 00 00 45 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d c0 b3 f7 12 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 57 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_dialog {
   strings:
      $s1 = "* Display dialog boxes from shell scripts *" fullword ascii
      $s2 = "# process_common_options, offset %d:%d" fullword ascii
      $s3 = "Usage: %s <options> { --and-widget <options> }" fullword ascii
      $s4 = "# execute %s" fullword ascii
      $s5 = "passwordbox" fullword ascii
      $s6 = "passwordform" fullword ascii
      $s7 = "cdialog (ComeOn Dialog!) version %s" fullword ascii
      $s8 = "Unexpected widget with --separate-output %.*s" fullword ascii
      $s9 = "# widget returns %d" fullword ascii
      $s10 = "Expected --and-widget, not %.*s" fullword ascii
      $s11 = "dialog_version" fullword ascii
      $s12 = "<text> <command> <height> <width>" fullword ascii
      $s13 = "# ignore extra --trace option" fullword ascii
      $s14 = "# finished --file" fullword ascii
      $s15 = "DIALOGOPTS" fullword ascii
      $s16 = "Expected a number for token %d of %.*s" fullword ascii
      $s17 = "# opened --file %s .." fullword ascii
      $s18 = "Expected no more than %d tokens for %.*s, have %d" fullword ascii
      $s19 = "Expected at least %d tokens for %.*s, have %d" fullword ascii
      $s20 = "MaxSize: %d, %d" fullword ascii
      $s21 = "dialog_tailbox" fullword ascii
      $s22 = "dialog_mixedgauge" fullword ascii
      $s23 = "dialog_timebox" fullword ascii
      $s24 = "dialog_editbox" fullword ascii
      $s25 = "dialog_vars" fullword ascii
      $s26 = "dialog_pause" fullword ascii
      $s27 = "separate-widget" fullword ascii
      $s28 = "libdialog.so.15" fullword ascii
      $s29 = "dialog_rangebox" fullword ascii
      $s30 = "dialog_inputbox" fullword ascii
      $s31 = "dialog_menu" fullword ascii
      $s32 = "dialog: dlg_parse_rc" fullword ascii
      $s33 = "dialog_yesno" fullword ascii
      $s34 = "dialog_prgbox" fullword ascii
      $s35 = "dialog_dselect" fullword ascii
      $s36 = "dialog_gauge" fullword ascii
      $s37 = "dialog_textbox" fullword ascii
      $s38 = "dialog_state" fullword ascii
      $s39 = "dialog_fselect" fullword ascii
      $s40 = "dialog_buildlist" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 56 00 00 00 00 00 00 40 00 00 00 00 00 00 00 00 d4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 37 00 00 00 00 00 00 20 37 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 dd 44 00 00 00 00 00 00 dd 44 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 b5 00 00 00 00 00 00 10 b5 00 00 00 00 00 00 10 b5 00 00 00 00 00 00 98 1d 00 00 00 00 00 00 c0 1d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 58 cd 00 00 00 00 00 00 58 cd 00 00 00 00 00 00 58 cd 00 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 38 a3 00 00 00 00 00 00 38 a3 00 00 00 00 00 00 38 a3 00 00 00 00 00 00 8c 01 00 00 00 00 00 00 8c 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 b5 00 00 00 00 00 00 10 b5 00 00 00 00 00 00 10 b5 00 00 00 00 00 00 f0 1a 00 00 00 00 00 00 f0 1a 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 f6 c4 70 52 8d 90 9b a9 0f a9 50 cc 4c 0f 55 61 12 08 b5 73 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 5e 00 00 00 01 00 00 00 06 00 00 00 00 00 81 00 00 00 00 00 5e 00 00 00 00 00 00 00 d1 65 ce 6d 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 db 02 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 3b 04 00 00 12 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_lp {
   strings:
      $s1 = "Make_passthrough: pid %ld, execve '%s' failed - '%s'" fullword ascii
      $s2 = "*** Dump_pinfo %s - count %d ***" fullword ascii
      $s3 = "%s client_krb5_auth failed - when parsing service/host '%s'/'%s' - %s" fullword ascii
      $s4 = "%s client_krb5_auth failed - while getting initial credentials - %s" fullword ascii
      $s5 = "send_to_logger: write to send_to_status_fd %d failed - %s" fullword ascii
      $s6 = "send_to_logger: write to send_to_mail_fd %d failed - %s" fullword ascii
      $s7 = "*** Dump_unfreed_mem: %s, pid %ld" fullword ascii
      $s8 = "Dump_line_list: %s - 0x%lx, count %d, max %d, list 0x%lx" fullword ascii
      $s9 = "%s client_krb5_auth failed - getting time of day - '%s'" fullword ascii
      $s10 = "send_to_logger: Logger_fd fd %d, send_to_status_fd %d, send_to_mail fd %d, header '%s', body '%s'" fullword ascii
      $s11 = "%s server_krb5_auth failed - krb5_sname_to_principal failed - service %s '%s'" fullword ascii
      $s12 = "%s client_krb5_auth failed - client_krb5_auth: file read failed '%s' - '%s'" fullword ascii
      $s13 = "%s client_krb5_auth failed - resolving keytab '%s' '%s' - " fullword ascii
      $s14 = "%s client_krb5_auth failed - dup2(%d,%d) failed - '%s'" fullword ascii
      $s15 = "cannot open '%s' - '%s', attempt %d, sleeping %d" fullword ascii
      $s16 = "Set_linger: getsockopt linger failed - '%s'" fullword ascii
      $s17 = "Send_request: no remote support for %c - '%s' operation" fullword ascii
      $s18 = "Set_job_ticket_file: LOGIC ERROR- no HF_NAME in job information - %s" fullword ascii
      $s19 = "%s client_krb5_auth failed - while storing credentials - %s" fullword ascii
      $s20 = "getconnection: START host %s, port %s, timeout %d, connection_type %d" fullword ascii
      $s21 = "Scan_queue: p %d, m %d, e %d, dn %d, only_queue_process %d" fullword ascii
      $s22 = "Link_send: ack read from '%s' failed - %s" fullword ascii
      $s23 = "md5_receive: read '%s' failed - %s" fullword ascii
      $s24 = "Link_file_read: end marker read from '%s' failed - %s" fullword ascii
      $s25 = "md5_send: open '%s' for read failed - %s" fullword ascii
      $s26 = "Test_send: read from '%s' failed - %s" fullword ascii
      $s27 = "%s server_krb5_auth failed - no server keytab file" fullword ascii
      $s28 = "%s server_krb5_auth failed - krb5_kt_resolve failed - file %s '%s'" fullword ascii
      $s29 = "md5_receive: error reading challenge - '%s'" fullword ascii
      $s30 = "%s server_krb5_auth failed - when parsing name '%s' - %s" fullword ascii
      $s31 = "Krb5_send_work: client_krb5_auth returned '%d' - error '%s'" fullword ascii
      $s32 = "Link_file_read: write %d to fd %d failed - %s" fullword ascii
      $s33 = "md5_send: decoded challenge '%s'" fullword ascii
      $s34 = "md5_receive: open '%s' for read failed - %s" fullword ascii
      $s35 = "%s server_krb5_auth failed - krb5_recvauth '%s' failed '%s'" fullword ascii
      $s36 = "%s client_krb5_auth failed - when parsing name '%s' - %s" fullword ascii
      $s37 = "Send_auth_transfer: '%s' write failed - %s" fullword ascii
      $s38 = "%s client_krb5_auth failed - shutdown failed '%s'" fullword ascii
      $s39 = " -d printer[@host]  - printer on host" fullword ascii
      $s40 = "%s server_krb5_auth failed - krb5_init_context failed - '%s' " fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 0d 01 00 00 00 00 00 40 00 00 00 00 00 00 00 98 1d 06 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 60 d7 00 00 00 00 00 00 60 d7 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 85 0b 03 00 00 00 00 00 85 0b 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 f0 03 00 00 00 00 00 00 f0 03 00 00 00 00 00 00 f0 03 00 00 00 00 00 38 bd 01 00 00 00 00 00 38 bd 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 ad 05 00 00 00 00 00 70 bd 05 00 00 00 00 00 70 bd 05 00 00 00 00 00 78 6e 00 00 00 00 00 00 d0 7e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 b0 bd 05 00 00 00 00 00 b0 cd 05 00 00 00 00 00 b0 cd 05 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 20 4c 05 00 00 00 00 00 20 4c 05 00 00 00 00 00 20 4c 05 00 00 00 00 00 ac 0a 00 00 00 00 00 00 ac 0a 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 ad 05 00 00 00 00 00 70 bd 05 00 00 00 00 00 70 bd 05 00 00 00 00 00 90 12 00 00 00 00 00 00 90 12 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 6c 14 bf bf f6 f4 09 94 d1 c3 68 88 2b 85 d6 24 0d 85 fa 79 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 ab 00 00 00 01 00 00 00 06 00 00 00 10 00 81 00 c0 00 40 00 ab 00 00 00 ad 00 00 00 00 00 00 00 a6 dd a3 6b d1 65 ce 6d c5 b9 9c 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ae 06 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 1000KB and
      8 of them and $magic
}

rule gtfobins_binaries_cpio {
   strings:
      $s1 = "%s not dumped: not a regular file" fullword ascii
      $s2 = "Try '%s --help' or '%s --usage' for more information." fullword ascii
      $s3 = "internal error: tape descriptor changed from %d to %d" fullword ascii
      $s4 = "Read error at byte %lld in file %s, padding with zeros" fullword ascii
      $s5 = "Print a \".\" for each file processed" fullword ascii
      $s6 = "Verbosely list the files processed" fullword ascii
      $s7 = "%s: unrecognized option '%s%s'" fullword ascii
      $s8 = "%s: option '%s%s' is ambiguous" fullword ascii
      $s9 = "%s: option '%s%s' requires an argument" fullword ascii
      $s10 = "%s: option '%s%s' is ambiguous; possibilities:" fullword ascii
      $s11 = "%s: option '%s%s' doesn't allow an argument" fullword ascii
      $s12 = "%s: Warning: Read error at byte %jd, while reading %zu byte" fullword ascii
      $s13 = "%s: Warning: Read error at byte %jd, while reading %zu bytes" fullword ascii
      $s14 = "%s: Read error at byte %jd, while reading %zu bytes" fullword ascii
      $s15 = "%s: Read error at byte %jd, while reading %zu byte" fullword ascii
      $s16 = "Operation modifiers valid in copy-in and copy-pass modes:" fullword ascii
      $s17 = "[[USER@]HOST:]FILE-NAME" fullword ascii
      $s18 = "/usr/libexec/rmt" fullword ascii
      $s19 = "  cpio -p destination-directory < name-list" fullword ascii
      $s20 = "invalid header: checksum error" fullword ascii
      $s21 = "  cpio -i [< archive]" fullword ascii
      $s22 = "Operation modifiers valid only in copy-pass mode:" fullword ascii
      $s23 = "Use COMMAND instead of rsh" fullword ascii
      $s24 = "Operation modifiers valid in copy-out and copy-pass modes:" fullword ascii
      $s25 = "  cpio -o < name-list [> archive]" fullword ascii
      $s26 = "Archive filename to use instead of standard output. Optional USER and HOST specify the user and host names in case of a remote a" ascii
      $s27 = "Archive filename to use instead of standard input. Optional USER and HOST specify the user and host names in case of a remote ar" ascii
      $s28 = "Archive format is not specified in copy-pass mode (use --format option)" fullword ascii
      $s29 = "Archive filename to use instead of standard input. Optional USER and HOST specify the user and host names in case of a remote ar" ascii
      $s30 = "Cannot redirect files for remote shell" fullword ascii
      $s31 = "rename %s -> " fullword ascii
      $s32 = "Use this FILE-NAME instead of standard input or output. Optional USER and HOST specify the user and host names in case of a remo" ascii
      $s33 = "Archive filename to use instead of standard output. Optional USER and HOST specify the user and host names in case of a remote a" ascii
      $s34 = "Do not strip file system prefix components from the file names" fullword ascii
      $s35 = "File %s shrunk by %s bytes, padding with zeros" fullword ascii
      $s36 = "Run in copy-pass mode" fullword ascii
      $s37 = "File %s shrunk by %s byte, padding with zeros" fullword ascii
      $s38 = "http://www.gnu.org/software/cpio" fullword ascii
      $s39 = "%s: checksum error (0x%x, should be 0x%x)" fullword ascii
      $s40 = "Operation modifiers valid only in copy-out mode:" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 49 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 73 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 35 00 00 00 00 00 00 20 35 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 45 9b 01 00 00 00 00 00 45 9b 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 10 78 00 00 00 00 00 00 10 78 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 5b 02 00 00 00 00 00 50 6b 02 00 00 00 00 00 50 6b 02 00 00 00 00 00 c0 16 00 00 00 00 00 00 b0 1e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 b8 5d 02 00 00 00 00 00 b8 6d 02 00 00 00 00 00 b8 6d 02 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 b0 12 02 00 00 00 00 00 b0 12 02 00 00 00 00 00 b0 12 02 00 00 00 00 00 d4 0a 00 00 00 00 00 00 d4 0a 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 5b 02 00 00 00 00 00 50 6b 02 00 00 00 00 00 50 6b 02 00 00 00 00 00 b0 04 00 00 00 00 00 00 b0 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 d7 04 41 00 3f fd 8d 17 e7 c1 9e 06 73 bf 71 9f 92 ac 0d 43 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 79 00 00 00 02 00 00 00 07 00 00 00 82 20 c0 00 12 01 88 97 20 5b 09 0a a8 04 c0 21 79 00 00 00 00 00 00 00 7a 00 00 00 7b 00 00 00 7e 00 00 00 81 00 00 00 00 00 00 00 82 00 00 00 83 00 00 00 00 00 00 00 00 00 00 00 85 00 00 00 88 00 00 00 00 00 00 00 8a 00 00 00 00 00 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_tic {
   strings:
      $s1 = "  -Q[n]      dump compiled description" fullword ascii
      $s2 = "# WARNING: this entry, %d bytes long, may core-dump %s libraries!" fullword ascii
      $s3 = "  -U         suppress post-processing of entries" fullword ascii
      $s4 = "%s=!!! %s WILL NOT CONVERT !!!" fullword ascii
      $s5 = "copy_input (target)" fullword ascii
      $s6 = "  -f         format complex strings for readability" fullword ascii
      $s7 = "%s: width = %d, tversion = %d, outform = %d" fullword ascii
      $s8 = "  -T         remove size-restrictions on compiled description" fullword ascii
      $s9 = "get_fkey_list" fullword ascii
      $s10 = "  -q    brief listing, removes headers" fullword ascii
      $s11 = "%s: File name needed.  Usage:" fullword ascii
      $s12 = "%s: Too many file names.  Usage:" fullword ascii
      $s13 = "# (%s removed to fit entry within %d bytes)" fullword ascii
      $s14 = "# (acsc removed to fit entry within %d bytes)" fullword ascii
      $s15 = "# (sgr removed to fit entry within %d bytes)" fullword ascii
      $s16 = "  -e<names>  translate/compile only entries named by comma-separated list" fullword ascii
      $s17 = "exit_subscript_mode but no enter_subscript_mode" fullword ascii
      $s18 = "tic-conversion of %s failed" fullword ascii
      $s19 = "# (some function-key capabilities suppressed to fit entry within %d bytes)" fullword ascii
      $s20 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/ncurses-bin.debug" fullword ascii
      $s21 = "vt100 keypad map incomplete:%s" fullword ascii
      $s22 = "  -c         check only, validate input without compiling or translating" fullword ascii
      $s23 = "enter_superscript_mode but no exit_superscript_mode" fullword ascii
      $s24 = "tic-expansion of %s failed" fullword ascii
      $s25 = "syntax error in %s delay '%.*s'" fullword ascii
      $s26 = "tic-conversion of %s changed value" fullword ascii
      $s27 = "exit_superscript_mode but no enter_superscript_mode" fullword ascii
      $s28 = "tparm-conversion of %s(%d) differs between" fullword ascii
      $s29 = "function-key %s has delay" fullword ascii
      $s30 = "tparam error in sgr(%d): %s" fullword ascii
      $s31 = "enter_subscript_mode but no exit_subscript_mode" fullword ascii
      $s32 = "%s: value for %s is too long" fullword ascii
      $s33 = "%s: %s (no permission)" fullword ascii
      $s34 = "tparm will use %d parameters for %s, expected %d" fullword ascii
      $s35 = "expected %s to be %s, but actually %s" fullword ascii
      $s36 = "%s: %s is not a text-file" fullword ascii
      $s37 = "inconsistent suffix for %s, expected %c, have %c" fullword ascii
      $s38 = "%s: %s entry is %d bytes long" fullword ascii
      $s39 = "inconsistent length for %s, expected %d" fullword ascii
      $s40 = "%s: resolved %s entry is %d bytes long" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 47 00 00 00 00 00 00 40 00 00 00 00 00 00 00 e0 61 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 28 27 00 00 00 00 00 00 28 27 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 99 b9 00 00 00 00 00 00 99 b9 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 e8 5f 00 00 00 00 00 00 e8 5f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 58 01 00 00 00 00 00 90 58 01 00 00 00 00 00 90 58 01 00 00 00 00 00 a8 07 00 00 00 00 00 00 c0 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 20 5a 01 00 00 00 00 00 20 5a 01 00 00 00 00 00 20 5a 01 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 90 3e 01 00 00 00 00 00 90 3e 01 00 00 00 00 00 90 3e 01 00 00 00 00 00 34 02 00 00 00 00 00 00 34 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 58 01 00 00 00 00 00 90 58 01 00 00 00 00 00 90 58 01 00 00 00 00 00 70 07 00 00 00 00 00 00 70 07 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 fd 3a af 7f 0f a9 3a f4 66 64 ca 7e 08 25 d0 f3 6f 70 ae 2c 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 75 00 00 00 01 00 00 00 06 00 00 00 00 00 81 00 00 00 00 00 75 00 00 00 00 00 00 00 d1 65 ce 6d 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0c 04 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 49 04 00 00 12 00 00 00}
condition:
      filesize < 300KB and
      8 of them and $magic
}

rule gtfobins_binaries_soelim {
   strings:
      $s1 = "usage: %s {-v | --version}" fullword ascii
      $s2 = "usage: %s --help" fullword ascii
      $s3 = "0 == \"unsupported argument conversion (not in [%123])\"" fullword ascii
      $s4 = "FILE* search_path::open_file(const char*, char**)" fullword ascii
      $s5 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/groff-base.debug" fullword ascii
      $s6 = "7c7cf04f0aad537914199d97e35aeab5596a67.debug" fullword ascii
      $s7 = "usage: %s [-Crt] [-I dir] [file ...]" fullword ascii
      $s8 = "format != 0" fullword ascii /* Goodware String - occured 1 times */
      $s9 = "!arg3.empty()" fullword ascii
      $s10 = "ATUSHcV" fullword ascii
      $s11 = "ATUSHco" fullword ascii
      $s12 = "string::string(const char*, int, const char*, int)" fullword ascii
      $s13 = "!arg2.empty()" fullword ascii
      $s14 = "void errprint(const char*, const errarg&, const errarg&, const errarg&)" fullword ascii
      $s15 = "string::string(const char*, int)" fullword ascii
      $s16 = "n1 >= 0 && n2 >= 0" fullword ascii
      $s17 = "!arg1.empty()" fullword ascii
      $s18 = "HcD$8;D$<" fullword ascii /* Goodware String - occured 1 times */
      $s19 = "void string::set_length(int)" fullword ascii
      $s20 = "int main(int, char**)" fullword ascii /* Goodware String - occured 1 times */
      $s21 = "CI:rtv" fullword ascii /* Goodware String - occured 1 times */
      $s22 = "%% file %s, line %d" fullword ascii /* Goodware String - occured 1 times */
      $s23 = "GNU soelim (groff) version %s" fullword ascii /* Goodware String - occured 1 times */
      $s24 = "7c7cf04f0aad537914199d97e35aeab5596a67" ascii
      $s25 = "name != 0" fullword ascii /* Goodware String - occured 2 times */
      $s26 = ".lf %d %s" fullword ascii /* Goodware String - occured 3 times */
      $s27 = "../../src/libs/libgroff/string.cpp" fullword ascii
      $s28 = "../../src/libs/libgroff/errarg.cpp" fullword ascii
      $s29 = "../../src/libs/libgroff/searchpath.cpp" fullword ascii
      $s30 = "../../src/preproc/soelim/soelim.cpp" fullword ascii
      $s31 = "1.23.0" fullword ascii
      $s32 = "~HAUATI" fullword ascii
      $s33 = "u4[]A\\" fullword ascii
      $s34 = "]4;]0}" fullword ascii
      $s35 = "can't open '%1': %2" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 25 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f8 c1 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 11 00 00 00 00 00 00 20 11 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 e1 61 00 00 00 00 00 00 e1 61 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 f4 1b 00 00 00 00 00 00 f4 1b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 bb 00 00 00 00 00 00 f0 bb 00 00 00 00 00 00 f0 bb 00 00 00 00 00 00 50 04 00 00 00 00 00 00 d0 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 80 bc 00 00 00 00 00 00 80 bc 00 00 00 00 00 00 80 bc 00 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 74 98 00 00 00 00 00 00 74 98 00 00 00 00 00 00 74 98 00 00 00 00 00 00 0c 03 00 00 00 00 00 00 0c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 bb 00 00 00 00 00 00 f0 bb 00 00 00 00 00 00 f0 bb 00 00 00 00 00 00 10 04 00 00 00 00 00 00 10 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 54 7c 7c f0 4f 0a ad 53 79 14 19 9d 97 e3 5a ea b5 59 6a 67 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 2b 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 2b 00 00 00 2d 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 86 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_tbl {
   strings:
      $s1 = "usage: %s {-v | --version}" fullword ascii
      $s2 = "usage: %s --help" fullword ascii
      $s3 = "e->start_row <= r && r <= e->end_row && e->start_col <= c && c <= e->end_col && e->end_row - e->start_row > 0 && e->end_col - e-" ascii
      $s4 = "e->start_row <= r && r <= e->end_row && e->start_col <= c && c <= e->end_col && e->end_row - e->start_row > 0 && e->end_col - e-" ascii
      $s5 = "c >= 0 && c < ncolumns - 1" fullword ascii
      $s6 = "end of input while processing table format specification" fullword ascii
      $s7 = "(e->end_col - e->start_col) > 0" fullword ascii
      $s8 = "(e->end_row - e->start_row) > 0" fullword ascii
      $s9 = "r >= 0 && r < nrows && c >= 0 && c < ncolumns + 1" fullword ascii
      $s10 = "0 == \"unsupported argument conversion (not in [%123])\"" fullword ascii
      $s11 = "char& string::operator[](int)" fullword ascii
      $s12 = "0 == \"unhandled getopt_long return value\"" fullword ascii
      $s13 = "void table_input::unget(char)" fullword ascii
      $s14 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/groff-base.debug" fullword ascii
      $s15 = ".tmc \\n[.F]:\\n[.c]: warning:" fullword ascii
      $s16 = ".  if \\n[3passed]>=0 .nr 3top \\n[#T]-2p" fullword ascii
      $s17 = ".nr 3hyphspace \\n[.hys]" fullword ascii
      $s18 = ".nr 3hyphmaxlines (\\n[.hlm])" fullword ascii
      $s19 = ".nr 3hyphmargin \\n[.hym]" fullword ascii
      $s20 = "r >= 0 && c >= 0 && r < nrows && c < ncolumns" fullword ascii
      $s21 = ".\\\" compute column separation factor" fullword ascii
      $s22 = "str.empty()" fullword ascii
      $s23 = ".  if %1<=\\n[3passed] .nr %2 \\n[#T]" fullword ascii
      $s24 = "c >= 0 && c < ncolumns" fullword ascii
      $s25 = ".\\\" compute column widths" fullword ascii
      $s26 = ".\\\" compute column positions" fullword ascii
      $s27 = ".\\\" compute overall width" fullword ascii
      $s28 = ".      nr 3previous-page (\\n% - 1)" fullword ascii
      $s29 = "usage: %s [-C] [file ...]" fullword ascii
      $s30 = ".ds 3hyphlang \\n[.hla]" fullword ascii
      $s31 = "more than 2 vertical lines at beginning of row description" fullword ascii
      $s32 = "delim off" fullword ascii
      $s33 = "delim on" fullword ascii
      $s34 = "more than 2 vertical lines after column descriptor" fullword ascii
      $s35 = "giving up on this table region" fullword ascii
      $s36 = ".if n .ll -%1n" fullword ascii
      $s37 = ".  sp -1" fullword ascii
      $s38 = "\\n[3expansion-amount]u" fullword ascii
      $s39 = "i >= 0 && i < len" fullword ascii
      $s40 = "format != 0" fullword ascii /* Goodware String - occured 1 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 5c 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f8 51 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 18 3a 00 00 00 00 00 00 18 3a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 51 5e 01 00 00 00 00 00 51 5e 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 01 00 00 00 00 00 00 a0 01 00 00 00 00 00 00 a0 01 00 00 00 00 00 9d 96 00 00 00 00 00 00 9d 96 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 c0 3d 02 00 00 00 00 00 c0 4d 02 00 00 00 00 00 c0 4d 02 00 00 00 00 00 80 12 00 00 00 00 00 00 c8 43 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 50 4c 02 00 00 00 00 00 50 5c 02 00 00 00 00 00 50 5c 02 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 54 e1 01 00 00 00 00 00 54 e1 01 00 00 00 00 00 54 e1 01 00 00 00 00 00 c4 0b 00 00 00 00 00 00 c4 0b 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 c0 3d 02 00 00 00 00 00 c0 4d 02 00 00 00 00 00 c0 4d 02 00 00 00 00 00 40 12 00 00 00 00 00 00 40 12 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 fc 24 85 e7 43 4e 9a 4e ed 37 3c bd 28 72 f2 02 01 33 65 e8 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 34 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 34 00 00 00 36 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 09 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_cancel {
   strings:
      $s1 = "Make_passthrough: pid %ld, execve '%s' failed - '%s'" fullword ascii
      $s2 = "*** Dump_pinfo %s - count %d ***" fullword ascii
      $s3 = "%s client_krb5_auth failed - when parsing service/host '%s'/'%s' - %s" fullword ascii
      $s4 = "%s client_krb5_auth failed - while getting initial credentials - %s" fullword ascii
      $s5 = "send_to_logger: write to send_to_status_fd %d failed - %s" fullword ascii
      $s6 = "send_to_logger: write to send_to_mail_fd %d failed - %s" fullword ascii
      $s7 = "*** Dump_unfreed_mem: %s, pid %ld" fullword ascii
      $s8 = "Dump_line_list: %s - 0x%lx, count %d, max %d, list 0x%lx" fullword ascii
      $s9 = "%s client_krb5_auth failed - getting time of day - '%s'" fullword ascii
      $s10 = "send_to_logger: Logger_fd fd %d, send_to_status_fd %d, send_to_mail fd %d, header '%s', body '%s'" fullword ascii
      $s11 = "%s server_krb5_auth failed - krb5_sname_to_principal failed - service %s '%s'" fullword ascii
      $s12 = "%s client_krb5_auth failed - client_krb5_auth: file read failed '%s' - '%s'" fullword ascii
      $s13 = "%s client_krb5_auth failed - resolving keytab '%s' '%s' - " fullword ascii
      $s14 = "%s client_krb5_auth failed - dup2(%d,%d) failed - '%s'" fullword ascii
      $s15 = "Set_linger: getsockopt linger failed - '%s'" fullword ascii
      $s16 = "Send_request: no remote support for %c - '%s' operation" fullword ascii
      $s17 = "Set_job_ticket_file: LOGIC ERROR- no HF_NAME in job information - %s" fullword ascii
      $s18 = "%s client_krb5_auth failed - while storing credentials - %s" fullword ascii
      $s19 = "getconnection: START host %s, port %s, timeout %d, connection_type %d" fullword ascii
      $s20 = "Scan_queue: p %d, m %d, e %d, dn %d, only_queue_process %d" fullword ascii
      $s21 = "Link_send: ack read from '%s' failed - %s" fullword ascii
      $s22 = "md5_receive: read '%s' failed - %s" fullword ascii
      $s23 = "Link_file_read: end marker read from '%s' failed - %s" fullword ascii
      $s24 = "md5_send: open '%s' for read failed - %s" fullword ascii
      $s25 = "Test_send: read from '%s' failed - %s" fullword ascii
      $s26 = "%s server_krb5_auth failed - no server keytab file" fullword ascii
      $s27 = "%s server_krb5_auth failed - krb5_kt_resolve failed - file %s '%s'" fullword ascii
      $s28 = "md5_receive: error reading challenge - '%s'" fullword ascii
      $s29 = "%s server_krb5_auth failed - when parsing name '%s' - %s" fullword ascii
      $s30 = "Krb5_send_work: client_krb5_auth returned '%d' - error '%s'" fullword ascii
      $s31 = "Link_file_read: write %d to fd %d failed - %s" fullword ascii
      $s32 = "md5_send: decoded challenge '%s'" fullword ascii
      $s33 = "md5_receive: open '%s' for read failed - %s" fullword ascii
      $s34 = "%s server_krb5_auth failed - krb5_recvauth '%s' failed '%s'" fullword ascii
      $s35 = "%s client_krb5_auth failed - when parsing name '%s' - %s" fullword ascii
      $s36 = "Send_auth_transfer: '%s' write failed - %s" fullword ascii
      $s37 = "%s client_krb5_auth failed - shutdown failed '%s'" fullword ascii
      $s38 = "%s server_krb5_auth failed - krb5_init_context failed - '%s' " fullword ascii
      $s39 = "md5_send: error reading challenge - '%s'" fullword ascii
      $s40 = "%s client_krb5_auth failed - bad lifetime value '%s' '%s' - " fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 e1 00 00 00 00 00 00 40 00 00 00 00 00 00 00 38 ba 05 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 78 c1 00 00 00 00 00 00 78 c1 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 89 d1 02 00 00 00 00 00 89 d1 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 b0 03 00 00 00 00 00 00 b0 03 00 00 00 00 00 00 b0 03 00 00 00 00 00 b0 a0 01 00 00 00 00 00 b0 a0 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 59 05 00 00 00 00 00 70 69 05 00 00 00 00 00 70 69 05 00 00 00 00 00 18 5f 00 00 00 00 00 00 90 6e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a0 5d 05 00 00 00 00 00 a0 6d 05 00 00 00 00 00 a0 6d 05 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d0 f1 04 00 00 00 00 00 d0 f1 04 00 00 00 00 00 d0 f1 04 00 00 00 00 00 84 0a 00 00 00 00 00 00 84 0a 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 59 05 00 00 00 00 00 70 69 05 00 00 00 00 00 70 69 05 00 00 00 00 00 90 06 00 00 00 00 00 00 90 06 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 71 ba c6 19 6a 6a 44 f5 d0 32 28 ce 01 c5 fd 37 45 3e e6 ce 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 a6 00 00 00 01 00 00 00 06 00 00 00 10 00 81 00 c0 00 40 00 a6 00 00 00 a8 00 00 00 00 00 00 00 a6 dd a3 6b d1 65 ce 6d c5 b9 9c 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 8b 06 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 1000KB and
      8 of them and $magic
}

rule gtfobins_binaries_ptx {
   strings:
      $s1 = "error: regular expression has a match of length zero: %s" fullword ascii
      $s2 = "  -t, --typeset-mode               - not implemented -" fullword ascii
      $s3 = "  -W, --word-regexp=REGEXP       use REGEXP to match each keyword" fullword ascii
      $s4 = "  or:  %s -G [OPTION]... [INPUT [OUTPUT]]" fullword ascii
      $s5 = "  -o, --only-file=FILE           read only word list from this FILE" fullword ascii
      $s6 = "  -i, --ignore-file=FILE         read ignore word list from FILE" fullword ascii
      $s7 = "  -G, --traditional              behave more like System V 'ptx'" fullword ascii
      $s8 = "re_compile_fastmap" fullword ascii /* Goodware String - occured 1 times */
      $s9 = "AF:GM:ORS:TW:b:i:fg:o:trw:" fullword ascii /* Goodware String - occured 1 times */
      $s10 = "ois Pinard" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "gap-size" fullword ascii /* Goodware String - occured 2 times */
      $s12 = "  -R, --right-side-refs          put references at right, not counted in -w" fullword ascii
      $s13 = "  -g, --gap-size=NUMBER          gap size in columns between output fields" fullword ascii
      $s14 = "typeset-mode" fullword ascii /* Goodware String - occured 2 times */
      $s15 = "flag-truncation" fullword ascii /* Goodware String - occured 2 times */
      $s16 = "[.?!][]\"')}]*\\($\\|" fullword ascii /* Goodware String - occured 2 times */
      $s17 = "  -r, --references               first field of each line is a reference" fullword ascii
      $s18 = "break-file" fullword ascii /* Goodware String - occured 2 times */
      $s19 = "  -S, --sentence-regexp=REGEXP   for end of lines or end of sentences" fullword ascii
      $s20 = "  -M, --macro-name=STRING        macro name to use instead of 'xx'" fullword ascii
      $s21 = "  -O, --format=roff              generate output as roff directives" fullword ascii
      $s22 = "\\|  \\)[ " fullword ascii /* Goodware String - occured 2 times */
      $s23 = "\\backslash{}" fullword ascii /* Goodware String - occured 2 times */
      $s24 = "sentence-regexp" fullword ascii /* Goodware String - occured 2 times */
      $s25 = "F. Pinard" fullword ascii /* Goodware String - occured 2 times */
      $s26 = "Output a permuted index, including context, of the words in the input files." fullword ascii /* Goodware String - occured 2 times */
      $s27 = "  -T, --format=tex               generate output as TeX directives" fullword ascii
      $s28 = "  -w, --width=NUMBER             output width in columns, reference excluded" fullword ascii
      $s29 = "  -b, --break-file=FILE          word break characters in this FILE" fullword ascii
      $s30 = "auto-reference" fullword ascii /* Goodware String - occured 2 times */
      $s31 = "$%&#_{}\\" fullword ascii /* Goodware String - occured 2 times */
      $s32 = "right-side-refs" fullword ascii /* Goodware String - occured 2 times */
      $s33 = "%s (for regexp %s)" fullword ascii /* Goodware String - occured 2 times */
      $s34 = "Usage: %s [OPTION]... [INPUT]...   (without -G)" fullword ascii /* Goodware String - occured 2 times */
      $s35 = "invalid gap width: %s" fullword ascii /* Goodware String - occured 2 times */
      $s36 = "only-file" fullword ascii /* Goodware String - occured 3 times */
      $s37 = "ignore-file" fullword ascii /* Goodware String - occured 3 times */
      $s38 = "macro-name" fullword ascii /* Goodware String - occured 3 times */
      $s39 = "  -F, --flag-truncation=STRING   use STRING for flagging line truncations." fullword ascii
      $s40 = "re_match" fullword ascii /* Goodware String - occured 4 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 4d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 90 f4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f8 1b 00 00 00 00 00 00 f8 1b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 29 83 00 00 00 00 00 00 29 83 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 50 2d 00 00 00 00 00 00 50 2d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 ea 00 00 00 00 00 00 f0 ea 00 00 00 00 00 00 f0 ea 00 00 00 00 00 00 f0 07 00 00 00 00 00 00 30 11 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ed 00 00 00 00 00 00 d8 ed 00 00 00 00 00 00 d8 ed 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 f4 c6 00 00 00 00 00 00 f4 c6 00 00 00 00 00 00 f4 c6 00 00 00 00 00 00 a4 03 00 00 00 00 00 00 a4 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 ea 00 00 00 00 00 00 f0 ea 00 00 00 00 00 00 f0 ea 00 00 00 00 00 00 10 05 00 00 00 00 00 00 10 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 d5 11 0b 13 4a 0a 1f ec 0c c1 de c4 8c ac 01 3f 55 51 40 4e 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 49 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 49 00 00 00 4b 00 00 00 51 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_sshpass {
   strings:
      $s1 = "   -d number     Use number as file descriptor for getting password." fullword ascii
      $s2 = "Usage: sshpass [-f|-d|-p|-e[env_var]] [-hV] command parameters" fullword ascii
      $s3 = "SSHPASS: Failed to create child process" fullword ascii
      $s4 = "SSHPASS: Failed to run command" fullword ascii
      $s5 = "sshpass: -e option given but \"%s\" environment variable is not set." fullword ascii
      $s6 = "SSHPASS: Failed to open password file \"%s\": %s" fullword ascii
      $s7 = "   With no parameters - password will be taken from stdin." fullword ascii
      $s8 = "Use \"sshpass -h\" to get help" fullword ascii
      $s9 = "   -p password   Provide password as argument (security unwise)." fullword ascii
      $s10 = "SSHPASS: searching for password prompt using match \"%s\"" fullword ascii
      $s11 = "   -f filename   Take password to use from file." fullword ascii
      $s12 = "args.pwsrc.password==NULL" fullword ascii
      $s13 = "Failed to get a pseudo terminal" fullword ascii
      $s14 = "At most one of -f, -d, -p or -e should be used." fullword ascii
      $s15 = "SSHPASS: detected prompt. Sending password." fullword ascii
      $s16 = "Conflicting password source" fullword ascii
      $s17 = "hide_password" fullword ascii
      $s18 = "The authenticity of host " fullword ascii
      $s19 = "SSHPASS: detected prompt, again. Wrong password. Terminating." fullword ascii
      $s20 = "   -e[env_var]   Password is passed as env-var \"env_var\" if given, \"SSHPASS\" otherwise." fullword ascii
      $s21 = "   -P prompt     Which string should sshpass search for to detect a password prompt." fullword ascii
      $s22 = "Using \"%s\" as the default password prompt indicator." fullword ascii
      $s23 = "SSHPASS: read: %s" fullword ascii
      $s24 = "sshpass: Failed to set controlling terminal in child (TIOCSCTTY)" fullword ascii
      $s25 = "SSHPASS: write failed" fullword ascii
      $s26 = "SSHPASS" fullword ascii
      $s27 = "assword" fullword ascii
      $s28 = "SSHPASS: detected host authentication prompt. Exiting." fullword ascii
      $s29 = "510f336f549f7cccdad245dd9b9c4dd955f3e4.debug" fullword ascii
      $s30 = "Failed to change pseudo terminal's permission" fullword ascii
      $s31 = "   -v            Be verbose about what you're doing." fullword ascii
      $s32 = "Failed to unlock pseudo terminal" fullword ascii
      $s33 = "SSHPASS: Short write. Tried to write %lu, only wrote %ld" fullword ascii
      $s34 = "sshpass 1.10" fullword ascii
      $s35 = "   -h            Show help (this screen)." fullword ascii
      $s36 = "differs from the key for the IP address" fullword ascii
      $s37 = "(C) 2006-2011 Lingnu Open Source Consulting Ltd." fullword ascii
      $s38 = "   -V            Print version information." fullword ascii
      $s39 = "See the COPYING file for more information." fullword ascii
      $s40 = "(C) 2015-2016, 2021-2022 Shachar Shemesh" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 25 00 00 00 00 00 00 40 00 00 00 00 00 00 00 60 51 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 70 10 00 00 00 00 00 00 70 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 3d 14 00 00 00 00 00 00 3d 14 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 30 0c 00 00 00 00 00 00 30 0c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 80 4c 00 00 00 00 00 00 80 5c 00 00 00 00 00 00 80 5c 00 00 00 00 00 00 a0 03 00 00 00 00 00 00 60 04 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 90 4c 00 00 00 00 00 00 90 5c 00 00 00 00 00 00 90 5c 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 80 48 00 00 00 00 00 00 80 48 00 00 00 00 00 00 80 48 00 00 00 00 00 00 84 00 00 00 00 00 00 00 84 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 80 4c 00 00 00 00 00 00 80 5c 00 00 00 00 00 00 80 5c 00 00 00 00 00 00 80 03 00 00 00 00 00 00 80 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 a4 51 0f 33 6f 54 9f 7c cc da d2 45 dd 9b 9c 4d d9 55 f3 e4 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 2d 00 00 00 01 00 00 00 06 00 00 00 00 05 81 00 00 01 1c 02 2d 00 00 00 2f 00 00 00 30 00 00 00 28 1d 8c 1c d1 65 ce 6d 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 2d 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 70KB and
      8 of them and $magic
}

rule gtfobins_binaries_tail {
   strings:
      $s1 = "      --pid=PID            with -f, terminate after process ID, PID dies" fullword ascii
      $s2 = "  -f, --follow[={name|descriptor}]" fullword ascii
      $s3 = "                             with inotify and --pid=P, check process P at" fullword ascii
      $s4 = "error reading inotify event" fullword ascii
      $s5 = "error waiting for inotify and output events" fullword ascii
      $s6 = "  -n, --lines=[+]NUM       output the last NUM lines, instead of the last %d;" fullword ascii
      $s7 = "  -q, --quiet, --silent    never output headers giving file names" fullword ascii
      $s8 = "  -v, --verbose            always output headers giving file names" fullword ascii
      $s9 = "fdin != -1 || fdout != -1" fullword ascii
      $s10 = "warning: --retry only effective for the initial open" fullword ascii
      $s11 = "warning: --retry ignored; --retry is useful only when following" fullword ascii
      $s12 = "%s has been replaced with an untailable remote file" fullword ascii
      $s13 = "                             or use -n +NUM to skip NUM-1 lines at the start" fullword ascii
      $s14 = "_write error" fullword ascii
      $s15 = "  -c, --bytes=[+]NUM       output the last NUM bytes; or use -c +NUM to" fullword ascii
      $s16 = "ac1eb6fe0cdec948fcee65418e449360cfabfa.debug" fullword ascii
      $s17 = "inotify resources exhausted" fullword ascii
      $s18 = "directory containing watched file was removed" fullword ascii
      $s19 = "invalid maximum number of unchanged stats between opens" fullword ascii
      $s20 = "                             an absent option argument means 'descriptor'" fullword ascii
      $s21 = "bkKmMGTPEZYRQ0" fullword ascii
      $s22 = "inotify_add_watch" fullword ascii
      $s23 = "inotify_rm_watch" fullword ascii
      $s24 = "strtod_l" fullword ascii
      $s25 = "c:n:fFqs:vz0123456789" fullword ascii
      $s26 = "tail_forever" fullword ascii
      $s27 = "%s was replaced" fullword ascii
      $s28 = "; giving up on this name" fullword ascii
      $s29 = "src/iopoll.c" fullword ascii
      $s30 = "its end.  This default behavior is not desirable when you really want to" fullword ascii /* Goodware String - occured 1 times */
      $s31 = "option used in invalid context -- %c" fullword ascii /* Goodware String - occured 1 times */
      $s32 = "Afwrite_wait" fullword ascii
      $s33 = "H=JFS1tfH=1SFBt^H=" fullword ascii
      $s34 = "invalid number of seconds: %s" fullword ascii
      $s35 = "invalid PID" fullword ascii
      $s36 = "-disable-inotify" fullword ascii /* Goodware String - occured 1 times */
      $s37 = "%s has been replaced;  following new file" fullword ascii
      $s38 = "%s has been replaced with an untailable file%s" fullword ascii
      $s39 = "ac1eb6fe0cdec948fcee65418e449360cfabfa" ascii
      $s40 = "iopoll_internal" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 4e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d0 24 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d8 1c 00 00 00 00 00 00 d8 1c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 a9 af 00 00 00 00 00 00 a9 af 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 b8 41 00 00 00 00 00 00 b8 41 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 1b 01 00 00 00 00 00 50 2b 01 00 00 00 00 00 50 2b 01 00 00 00 00 00 d0 07 00 00 00 00 00 00 98 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 1d 01 00 00 00 00 00 d8 2d 01 00 00 00 00 00 d8 2d 01 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 54 ef 00 00 00 00 00 00 54 ef 00 00 00 00 00 00 54 ef 00 00 00 00 00 00 9c 05 00 00 00 00 00 00 9c 05 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 1b 01 00 00 00 00 00 50 2b 01 00 00 00 00 00 50 2b 01 00 00 00 00 00 b0 04 00 00 00 00 00 00 b0 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 3f ac 1e b6 fe 0c de c9 48 fc ee 65 41 8e 44 93 60 cf ab fa 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 50 00 00 00 01 00 00 00 06 00 00 00 04 4d c1 00 20 01 1c 12 50 00 00 00 52 00 00 00 57 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_unzip {
   strings:
      $s1 = "  unzip -p foo | more  => send contents of foo.zip via pipe into program more" fullword ascii
      $s2 = "  contradiction.  Attempting to process anyway." fullword ascii
      $s3 = "  (attempting to process anyway)" fullword ascii
      $s4 = "  -c, -p - Output to pipe.  (See above for unzip.)" fullword ascii
      $s5 = "  portable across different operating systems than unzip executables." fullword ascii
      $s6 = "  -M  Pipe all output through internal pager similar to Unix more(1) command." fullword ascii
      $s7 = "  -1  List names only, one per line.  No headers/trailers.  Good for scripts." fullword ascii
      $s8 = "  -P p Use password p to decrypt files.  THIS IS INSECURE!  Some OS show" fullword ascii
      $s9 = "error:  command line parameter #%d exceeds internal size limit" fullword ascii
      $s10 = "  attempting to process anyway, assuming all parts have been concatenated" fullword ascii
      $s11 = "  -h  List header line.  Includes archive name, actual size, total files." fullword ascii
      $s12 = "%lu file%s, %s bytes uncompressed, %s bytes compressed:  %s%d.%d%%" fullword ascii
      $s13 = "  -q     - Quiet operation." fullword ascii
      $s14 = "  -2  List names only as -1, but include headers, trailers, and comments." fullword ascii
      $s15 = "  -d exd - Extract to directory exd." fullword ascii
      $s16 = "  -f, -u - Freshen and Update, as for unzip." fullword ascii
      $s17 = "  -t  List totals for files listed or for all files.  Includes uncompressed" fullword ascii
      $s18 = "  - A subfield with ID 0x%04x (%s) and %u data bytes" fullword ascii
      $s19 = "  -m  List in long Unix ls -l format.  As -s, but includes compression %." fullword ascii
      $s20 = "If unzipsfx compiled with SFX_EXDIR defined, -d option also available:" fullword ascii
      $s21 = "  used to process the first entry in a stream." fullword ascii
      $s22 = "         command line to other users." fullword ascii
      $s23 = "  -z  Include archive comment if any in listing." fullword ascii
      $s24 = "See \"unzip -hh\" or unzip.txt for more help.  Examples:" fullword ascii
      $s25 = "  funzip [-password] [input[.zip|.gz]]" fullword ascii
      $s26 = "  -l  List in long Unix ls -l format.  As -m, but compression in bytes." fullword ascii
      $s27 = "  unzip -l foo.zip        - list files in short format in archive foo.zip" fullword ascii
      $s28 = "  -z     - Print archive comment.  (See unzip above.)" fullword ascii
      $s29 = "  error:  %s%s %s" fullword ascii
      $s30 = "  error:  %s%s" fullword ascii
      $s31 = "UnZip %d.%d%d%s of %s, by Debian. Original by Info-ZIP." fullword ascii
      $s32 = "  This can be modified using -q for quieter operation, and -qq for even" fullword ascii
      $s33 = "  -p   Extract files to pipe (stdout).  Only file data is output and all" fullword ascii
      $s34 = "  -p  extract files to pipe, no messages     -l  list files (short format)" fullword ascii
      $s35 = "  -a     - Convert text files." fullword ascii
      $s36 = "  -s     - Convert spaces to underscores." fullword ascii
      $s37 = "                 unable to process %s." fullword ascii
      $s38 = "%s  %s:  %s bytes required to uncompress to %s bytes;" fullword ascii
      $s39 = "Basic zipinfo command line:" fullword ascii
      $s40 = "  -t        test contents of archive" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 40 45 00 00 00 00 00 00 40 00 00 00 00 00 00 00 70 b4 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 88 35 00 00 00 00 00 00 88 35 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 f5 95 01 00 00 00 00 00 f5 95 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 38 b7 00 00 00 00 00 00 38 b7 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 a3 02 00 00 00 00 00 b0 a3 02 00 00 00 00 00 b0 a3 02 00 00 00 00 00 10 0f 00 00 00 00 00 00 78 34 0f 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a0 ad 02 00 00 00 00 00 a0 ad 02 00 00 00 00 00 a0 ad 02 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 64 74 02 00 00 00 00 00 64 74 02 00 00 00 00 00 64 74 02 00 00 00 00 00 6c 03 00 00 00 00 00 00 6c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 a3 02 00 00 00 00 00 b0 a3 02 00 00 00 00 00 b0 a3 02 00 00 00 00 00 50 0c 00 00 00 00 00 00 50 0c 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 fe 81 4a f5 31 67 a7 3f 0e ef 60 43 42 c3 3b f9 05 02 80 a3 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 53 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 41 10 62 53 00 00 00 57 00 00 00 00 00 00 00 6e cf e9 95 28 1d 8c 1c 90 6f d5 21 d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 20 02 00 00 12 00 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_octave {
   strings:
      $s1 = "echo-commands" fullword ascii
      $s2 = ": failed to exec '" fullword ascii
      $s3 = "exec-path" fullword ascii
      $s4 = "libexec/octave/9.2.0/exec/x86_64-pc-linux-gnu" fullword ascii
      $s5 = "OCTAVE_EXEC_HOME" fullword ascii
      $s6 = "experimental-terminal-widget" fullword ascii
      $s7 = "octave: conflicting options: --server and --gui" fullword ascii
      $s8 = "octave: conflicting options: --no-gui-libs and --gui" fullword ascii
      $s9 = "no-window-system" fullword ascii
      $s10 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/octave.debug" fullword ascii
      $s11 = "OCTAVE_BINDIR" fullword ascii
      $s12 = "3fe06279f550672b222c8e955546906eaac70f.debug" fullword ascii
      $s13 = "octave: fork failed!" fullword ascii
      $s14 = "octave exited with signal " fullword ascii
      $s15 = "server" fullword ascii /* Goodware String - occured 401 times */
      $s16 = "HcD$<1" fullword ascii /* Goodware String - occured 1 times */
      $s17 = "_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEED1Ev" fullword ascii
      $s18 = "_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE13_S_copy_charsEPcPKcS7_" fullword ascii
      $s19 = "_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE6appendEPKc" fullword ascii
      $s20 = "_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEC1EOS4_" fullword ascii
      $s21 = "_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEC1ERKS4_" fullword ascii
      $s22 = "libX11.so.6" fullword ascii
      $s23 = "_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE6appendEPKcm" fullword ascii
      $s24 = "__cxa_throw_bad_array_new_length" fullword ascii
      $s25 = "CXXABI_1.3.8" fullword ascii
      $s26 = "X11 DISPLAY environment variable not set" fullword ascii
      $s27 = "info-program" fullword ascii
      $s28 = "+HWVdfhip:qvx" fullword ascii
      $s29 = "octave-cli" fullword ascii
      $s30 = "unable to open X11 DISPLAY" fullword ascii
      $s31 = "no-history" fullword ascii
      $s32 = "octave-gui" fullword ascii
      $s33 = "octave: disabling GUI features" fullword ascii
      $s34 = "no-line-editing" fullword ascii
      $s35 = "braindead" fullword ascii /* Goodware String - occured 1 times */
      $s36 = "image-path" fullword ascii
      $s37 = "octave: " fullword ascii
      $s38 = "texi-macros-file" fullword ascii
      $s39 = "no-site-file" fullword ascii
      $s40 = "force-gui" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 33 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 57 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 38 1b 00 00 00 00 00 00 38 1b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 cd 1e 00 00 00 00 00 00 cd 1e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 98 09 00 00 00 00 00 00 98 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 78 4d 00 00 00 00 00 00 78 5d 00 00 00 00 00 00 78 5d 00 00 00 00 00 00 b0 08 00 00 00 00 00 00 e0 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 90 4d 00 00 00 00 00 00 90 5d 00 00 00 00 00 00 90 5d 00 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 a0 44 00 00 00 00 00 00 a0 44 00 00 00 00 00 00 a0 44 00 00 00 00 00 00 a4 00 00 00 00 00 00 00 a4 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 78 4d 00 00 00 00 00 00 78 5d 00 00 00 00 00 00 78 5d 00 00 00 00 00 00 88 02 00 00 00 00 00 00 88 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 06 3f e0 62 79 f5 50 67 2b 22 2c 8e 95 55 46 90 6e aa c7 0f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 3c 00 00 00 01 00 00 00 06 00 00 00 88 40 a1 01 00 00 00 08 3c 00 00 00 3f 00 00 00 00 00 00 00 42 45 d5 ec d0 65 ce 6d bb e3 92 7c d9 71 58 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 03 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 70KB and
      8 of them and $magic
}

rule gtfobins_binaries_cobc {
   strings:
      $s1 = "/* cob_dump_file (\"%s %s\", %s%s); */" fullword ascii
      $s2 = "cob_dump_output (\"END OF DUMP - %s\");" fullword ascii
      $s3 = "/* cob_dump_output (\"END OF DUMP - %s\"); */" fullword ascii
      $s4 = "  -###                  like -v but commands not executed" fullword ascii
      $s5 = "dumpversion" fullword ascii
      $s6 = "cob_dump_file (\"%s %s\", %s%s);" fullword ascii
      $s7 = "/* cob_dump_output (\"REPORT\"); */" fullword ascii
      $s8 = "/* Dump REPORT SECTION (informational) */" fullword ascii
      $s9 = "/* Dump %s (informational) */" fullword ascii
      $s10 = "/* Dump REPORT SECTION */" fullword ascii
      $s11 = "subscript missing for '%s' - defaulting to 1" fullword ascii
      $s12 = "/* Dump %s */" fullword ascii
      $s13 = "frame_ptr->return_address_num = %d; /* %s%d */" fullword ascii
      $s14 = "(%s%s + %d)->count_components = %d;" fullword ascii
      $s15 = "DEBUGGING target already specified with ALL PROCEDURES: '%s'" fullword ascii
      $s16 = "SET target '%s' is not a POINTER for FCD-KEYDEF" fullword ascii
      $s17 = "  -fno-dump=<scope>     exclude data fields from dumping on abort, <scope> may" fullword ascii
      $s18 = "module->flag_dump_ready = %u;" fullword ascii
      $s19 = "  -dumpversion          display compiler version and exit" fullword ascii
      $s20 = "/* ALTER processing */" fullword ascii
      $s21 = "cob_field_attr content_%s%u;" fullword ascii
      $s22 = "cob_check_fence (%s%d_fence_pre, %s%d_fence_post, %s, \"%s\");" fullword ascii
      $s23 = "%s%d_fence_post[8]%s;" fullword ascii
      $s24 = "content_fb_%u = { %u, NULL, &%s%d };" fullword ascii
      $s25 = "/* Dump SCREEN SECTION (informational) */" fullword ascii
      $s26 = "/* Dump WORKING-STORAGE (informational) */" fullword ascii
      $s27 = "/* cob_dump_output (\"SCREEN\"); */" fullword ascii
      $s28 = "/* Dump WORKING-STORAGE */" fullword ascii
      $s29 = "external process \"%s\" ended with signal %s (%d)" fullword ascii
      $s30 = "/* Dump LINKAGE SECTION */" fullword ascii
      $s31 = "/* Dump SCREEN SECTION */" fullword ascii
      $s32 = "'%s' COMP-6 with sign - changing to COMP-3" fullword ascii
      $s33 = "frame_overflow = frame_ptr + %d - 1;" fullword ascii
      $s34 = "/* Dump LINKAGE SECTION (informational) */" fullword ascii
      $s35 = "(%s%s + %d)->component[%d] = " fullword ascii
      $s36 = "/* cob_dump_output (\"LINKAGE\"); */" fullword ascii
      $s37 = "invalid symbol '%s' - skipping word" fullword ascii
      $s38 = "/* cob_dump_output (\"WORKING-STORAGE\"); */" fullword ascii
      $s39 = "vvvvvvvvvvv" fullword wide /* reversed goodware string 'vvvvvvvvvvv' */
      $s40 = "expected argument #%d, %s, to be passed BY REFERENCE/CONTENT" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 6d 02 00 00 00 00 00 40 00 00 00 00 00 00 00 68 43 15 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b0 38 02 00 00 00 00 00 b0 38 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 95 c1 09 00 00 00 00 00 95 c1 09 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 10 0c 00 00 00 00 00 00 10 0c 00 00 00 00 00 00 10 0c 00 00 00 00 00 04 d9 07 00 00 00 00 00 04 d9 07 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 f2 13 00 00 00 00 00 70 f2 13 00 00 00 00 00 70 f2 13 00 00 00 00 00 50 4f 01 00 00 00 00 00 f8 a6 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c0 8a 14 00 00 00 00 00 c0 8a 14 00 00 00 00 00 c0 8a 14 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c4 e5 12 00 00 00 00 00 c4 e5 12 00 00 00 00 00 c4 e5 12 00 00 00 00 00 2c 1b 00 00 00 00 00 00 2c 1b 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 f2 13 00 00 00 00 00 70 f2 13 00 00 00 00 00 70 f2 13 00 00 00 00 00 90 9d 00 00 00 00 00 00 90 9d 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 f1 40 13 b2 fa 3c 01 6b a1 8a b1 36 2e cd 1a 60 ba 7a 29 d9 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 62 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 53 e0 01 10 06 62 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 63 00 00 00 64 00 00 00 65 00 00 00 66 00 00 00 67 00 00 00 68 00 00 00 69 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 6a 00 00 00 00 00 00 00 d1 65 ce 6d 35 b7 e1 54}
condition:
      filesize < 4000KB and
      8 of them and $magic
}

rule gtfobins_binaries_clamscan {
   strings:
      $x1 = "Execute a command when an infected message is processed." fullword ascii
      $s2 = "PE stands for Portable Executable - it's an executable file format used" fullword ascii
      $s3 = "Execute a command when virus is found." fullword ascii
      $s4 = "ERROR: Failed to convert the open log file descriptor for %s to a FILE* handle: %s" fullword ascii
      $s5 = "Only scanning files from --file-list (files passed at cmdline are ignored)" fullword ascii
      $s6 = "PCRE - reports PCRE execution statistics" fullword ascii
      $s7 = "traverse_unlink: Failed to open file descriptor for target directory!" fullword ascii
      $s8 = "When using prevention, if this option is turned on, any errors that occur during scanning will result in the event attempt being" ascii
      $s9 = "be replaced with the file name, due to command injection security concerns." fullword ascii
      $s10 = "command directly, but should use it carefully from your executed script." fullword ascii
      $s11 = "Run a command when freshclam reports an outdated version." fullword ascii
      $s12 = "OnErrorExecute" fullword ascii
      $s13 = "mirror2.mynetwork.com" fullword ascii
      $s14 = "mirror1.mynetwork.com" fullword ascii
      $s15 = "Test - run with both JIT and interpreter and compare results. Make all failures fatal." fullword ascii
      $s16 = "of certain files to lock up the scanning process/threads resulting in a Denial of Service." fullword ascii
      $s17 = "Max number of scanning threads to allocate to the OnAccess thread pool at startup--these threads are the ones responsible for cr" ascii
      $s18 = "traverse_to: Failed to get copy of directory path to be tokenized!" fullword ascii
      $s19 = "If you turn off this option, the original files will still be scanned, but without additional processing." fullword ascii
      $s20 = "\"X-Virus-Status\" headers will be attached to each processed message, possibly" fullword ascii
      $s21 = "(PE, ELF, & Mach-O) and alert on them with a Broken.Executable heuristic signature." fullword ascii
      $s22 = "LogInfected" fullword ascii
      $s23 = "This option affects the behaviour of LogInfected, LogClean and VirusAction" fullword ascii
      $s24 = "Files exceeding this limit will not have PCRE subsigs executed unless a subsig is encompassed to a smaller buffer." fullword ascii
      $s25 = "Note #1: this requires MTA macroes to be available (see LogInfected below)" fullword ascii
      $s26 = "eating a connection with the daemon and kicking off scanning after an event has been processed. To prevent clamonacc from consum" ascii
      $s27 = "inet6:port@[hostname|ip-address] - to specify an ipv6 socket." fullword ascii
      $s28 = "If your servers are behind a firewall/proxy which does a User-Agent" fullword ascii
      $s29 = "inet:port@[hostname|ip-address] - to specify an ipv4 socket;" fullword ascii
      $s30 = "When using prevention, if this option is turned on, any errors that occur during scanning will result in the event attempt being" ascii
      $s31 = "/tmp/clamav.log" fullword ascii
      $s32 = "in all 32- and 64-bit versions of Windows operating systems. This option" fullword ascii
      $s33 = "Note #2: the process is invoked in the context of clamav-milter" fullword ascii
      $s34 = "traverse_to: Failed to open file descriptor for '/' directory." fullword ascii
      $s35 = "dumpcerts" fullword ascii
      $s36 = "lchown to user '%s' failed on log file '%s'.  Error was '%s'" fullword ascii
      $s37 = "traverse_rename: Failed to open file descriptor for source directory!" fullword ascii
      $s38 = "Use the system logger (can work together with LogFile)." fullword ascii
      $s39 = "Run a command when a database update error occurs." fullword ascii
      $s40 = "will temporarily load a second scanning engine while scanning continues using " fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 bf 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 b1 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 18 aa 00 00 00 00 00 00 18 aa 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 39 a2 00 00 00 00 00 00 39 a2 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 60 01 00 00 00 00 00 00 60 01 00 00 00 00 00 00 60 01 00 00 00 00 00 48 e5 00 00 00 00 00 00 48 e5 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 49 02 00 00 00 00 00 10 59 02 00 00 00 00 00 10 59 02 00 00 00 00 00 20 67 00 00 00 00 00 00 c8 6c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 60 a9 02 00 00 00 00 00 60 b9 02 00 00 00 00 00 60 b9 02 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d0 35 02 00 00 00 00 00 d0 35 02 00 00 00 00 00 d0 35 02 00 00 00 00 00 ec 01 00 00 00 00 00 00 ec 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 49 02 00 00 00 00 00 10 59 02 00 00 00 00 00 10 59 02 00 00 00 00 00 f0 66 00 00 00 00 00 00 f0 66 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 38 93 79 d7 6a 49 77 84 da fe 17 cb 2b 46 b5 ee 41 ff 19 af 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 89 00 00 00 01 00 00 00 06 00 00 00 02 8d a1 00 80 01 1c 03 89 00 00 00 8c 00 00 00 8f 00 00 00 d0 65 ce 6d 28 1d 8c 1c 0b de f7 12 38 f2 8b 1c c0 b3 f7 12 67 55 61 10 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 500KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_iconv {
   strings:
      $s1 = "the FROM and TO command line parameters.  One coded character set can be" fullword ascii
      $s2 = "failed to start conversion processing" fullword ascii
      $s3 = "list all known coded character sets" fullword ascii
      $s4 = "The following list contains all the coded character sets known.  This does" fullword ascii
      $s5 = "conversion from `%s' to `%s' is not supported" fullword ascii
      $s6 = "conversion from `%s' is not supported" fullword ascii
      $s7 = "internal error (illegal descriptor)" fullword ascii
      $s8 = "conversions from `%s' and to `%s' are not supported" fullword ascii
      $s9 = "conversion to `%s' is not supported" fullword ascii
      $s10 = "error while reading the input" fullword ascii
      $s11 = "syntax error in prolog: %s" fullword ascii
      $s12 = "iconv %s%s" fullword ascii
      $s13 = "<http://www.debian.org/Bugs/>" fullword ascii
      $s14 = "syntax error in %s definition: %s" fullword ascii
      $s15 = "error while closing input `%s'" fullword ascii
      $s16 = "conversion stopped due to problem in writing the output" fullword ascii
      $s17 = "character map `%s' is not ASCII compatible, locale not ISO C compliant [--no-warnings=ascii]" fullword ascii
      $s18 = "failed to restore %s locale!" fullword ascii
      $s19 = "__gconv_get_modules_db" fullword ascii
      $s20 = "failed to read locale!" fullword ascii
      $s21 = "character sets with locking states are not supported" fullword ascii
      $s22 = "incomplete character or shift sequence at end of buffer" fullword ascii
      $s23 = "__gconv_get_alias_db" fullword ascii
      $s24 = "__dcgettext" fullword ascii
      $s25 = "(char *) outbuf + outlen == outptr" fullword ascii
      $s26 = "posix_spawn_file_actions_adddup2" fullword ascii
      $s27 = "__read_chk" fullword ascii
      $s28 = "posix_spawn_file_actions_addclose" fullword ascii
      $s29 = "comment_char" fullword ascii
      $s30 = "argp_program_version_hook" fullword ascii
      $s31 = ".relr.dyn" fullword ascii
      $s32 = "number of bytes for byte sequence of beginning and end of range not the same: %d vs %d" fullword ascii
      $s33 = "charmap_conversion" fullword ascii
      $s34 = "value for <%s> must be 1 or greater" fullword ascii
      $s35 = "GLIBC_PRIVATE" fullword ascii
      $s36 = "argument to <%s> must be a single character" fullword ascii
      $s37 = "unknown iconv() error %d" fullword ascii
      $s38 = "[error] %s" fullword ascii
      $s39 = "<%s> and <%s> are invalid names for range" fullword ascii
      $s40 = "unknown character `%s'" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 40 00 00 00 00 00 00 40 00 00 00 00 00 00 00 00 02 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 25 00 00 00 00 00 00 40 25 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 11 87 00 00 00 00 00 00 11 87 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 9c 23 00 00 00 00 00 00 9c 23 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 f3 00 00 00 00 00 00 70 f3 00 00 00 00 00 00 70 f3 00 00 00 00 00 00 36 0d 00 00 00 00 00 00 f8 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 48 fa 00 00 00 00 00 00 48 fa 00 00 00 00 00 00 48 fa 00 00 00 00 00 00 60 02 00 00 00 00 00 00 60 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c0 d2 00 00 00 00 00 00 c0 d2 00 00 00 00 00 00 c0 d2 00 00 00 00 00 00 64 02 00 00 00 00 00 00 64 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 f3 00 00 00 00 00 00 70 f3 00 00 00 00 00 00 70 f3 00 00 00 00 00 00 90 0c 00 00 00 00 00 00 90 0c 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 40 b5 f4 b1 58 4a ec 29 58 07 01 8e ed 0a 8f 87 d1 d4 14 67 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 ce 00 00 00 6f 00 00 00 4f 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 37 00 00 00 1c 00 00 00 0c 00 00 00 00 00 00 00 00 00 00 00 47 00 00 00 00 00 00 00 5f 00 00 00 16 00 00 00 00 00 00 00 00 00 00 00 53 00 00 00 4a 00 00 00 44 00 00 00 00 00 00 00 00 00 00 00 4b 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_od {
   strings:
      $s1 = "  -N, --read-bytes=BYTES      limit dump to BYTES input bytes" fullword ascii
      $s2 = "this system doesn't provide a %d-byte floating point type" fullword ascii
      $s3 = "this system doesn't provide a %d-byte integral type" fullword ascii
      $s4 = "  -w[BYTES], --width[=BYTES]  output BYTES bytes per output line;" fullword ascii
      $s5 = "  -S BYTES, --strings[=BYTES]  show only NUL terminated strings" fullword ascii
      $s6 = "  -a   same as -t a,  select named characters, ignoring high-order bit" fullword ascii
      $s7 = "warning: invalid width %td; using %d instead" fullword ascii
      $s8 = "  -l   same as -t dL, select decimal longs" fullword ascii
      $s9 = "  -i   same as -t dI, select decimal ints" fullword ascii
      $s10 = "  -d   same as -t u2, select unsigned decimal 2-byte units" fullword ascii
      $s11 = "invalid output address radix '%c'; it must be one character from [doxn]" fullword ascii
      $s12 = "  -b   same as -t o1, select octal bytes" fullword ascii
      $s13 = "  -s   same as -t d2, select decimal 2-byte units" fullword ascii
      $s14 = "  -o   same as -t o2, select octal 2-byte units" fullword ascii
      $s15 = "  -f   same as -t fF, select floats" fullword ascii
      $s16 = "__fread_unlocked_chk" fullword ascii
      $s17 = "  -x   same as -t x2, select hexadecimal 2-byte units" fullword ascii
      $s18 = "  or:  %s --traditional [OPTION]... [FILE] [[+]OFFSET[.][b] [+][LABEL][.][b]]" fullword ascii
      $s19 = "  -A, --address-radix=RADIX   output format for file offsets; RADIX is one" fullword ascii
      $s20 = "bEGKkMmPQRTYZ0" fullword ascii
      $s21 = "A(H;A0" fullword ascii /* Goodware String - occured 1 times */
      $s22 = "read_block" fullword ascii /* Goodware String - occured 1 times */
      $s23 = "%%*.%d%s" fullword ascii /* Goodware String - occured 1 times */
      $s24 = "Adding a z suffix to any type displays printable characters at the end of" fullword ascii
      $s25 = "invalid character '%c' in type string %s" fullword ascii
      $s26 = "decode_one_format" fullword ascii /* Goodware String - occured 1 times */
      $s27 = "each output line." fullword ascii
      $s28 = "c88a1777d574b0e05abc05ab89f2b531b45303.debug" fullword ascii
      $s29 = "BYTES is hex with 0x or 0X prefix, and may have a multiplier suffix:" fullword ascii
      $s30 = "decode_format_string" fullword ascii /* Goodware String - occured 1 times */
      $s31 = "SIZE is a number.  For TYPE in [doux], SIZE may also be C for" fullword ascii
      $s32 = "compatibility mode supports at most one file" fullword ascii /* Goodware String - occured 1 times */
      $s33 = "Binary prefixes can be used, too: KiB=K, MiB=M, and so on." fullword ascii
      $s34 = "skip-bytes" fullword ascii /* Goodware String - occured 2 times */
      $s35 = "for sizeof(double) or L for sizeof(long double)." fullword ascii /* Goodware String - occured 2 times */
      $s36 = "skip-bytes + read-bytes is too large" fullword ascii /* Goodware String - occured 2 times */
      $s37 = "read-bytes" fullword ascii /* Goodware String - occured 2 times */
      $s38 = "concatenate them in the listed order to form the input." fullword ascii /* Goodware String - occured 2 times */
      $s39 = "0 < n && n <= bytes_per_block" fullword ascii /* Goodware String - occured 2 times */
      $s40 = "n_bytes_read == bytes_per_block" fullword ascii /* Goodware String - occured 2 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 40 35 00 00 00 00 00 00 40 00 00 00 00 00 00 00 70 34 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 50 1b 00 00 00 00 00 00 50 1b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 c9 b2 00 00 00 00 00 00 c9 b2 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 40 44 00 00 00 00 00 00 40 44 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 2b 01 00 00 00 00 00 b0 3b 01 00 00 00 00 00 b0 3b 01 00 00 00 00 00 10 07 00 00 00 00 00 00 f0 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 2d 01 00 00 00 00 00 d8 3d 01 00 00 00 00 00 d8 3d 01 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 90 05 01 00 00 00 00 00 90 05 01 00 00 00 00 00 90 05 01 00 00 00 00 00 94 04 00 00 00 00 00 00 94 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 2b 01 00 00 00 00 00 b0 3b 01 00 00 00 00 00 b0 3b 01 00 00 00 00 00 50 04 00 00 00 00 00 00 50 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 e8 c8 8a 17 77 d5 74 b0 e0 5a bc 05 ab 89 f2 b5 31 b4 53 03 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 49 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 49 00 00 00 4b 00 00 00 51 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_efax {
   strings:
      $s1 = "Iexec'ing /bin/sh -c \"%s\"" fullword ascii
      $s2 = "  -g cmd  exec \"/bin/sh -c cmd\" for data calls" fullword ascii
      $s3 = "  -e cmd  exec \"/bin/sh -c cmd\" for voice calls" fullword ascii
      $s4 = "  -h hdr  use page header hdr (use %%d's for current page/total pages)" fullword ascii
      $s5 = "CRP - repeat command" fullword ascii
      $s6 = "  -k str  send modem command ATstr when done" fullword ascii
      $s7 = "  -i str  send modem command ATstr at start" fullword ascii
      $s8 = "  -a str  use command ATstr to answer" fullword ascii
      $s9 = "  -j str  send modem command ATstr after set fax mode" fullword ascii
      $s10 = "C- command  \"%s\"" fullword ascii
      $s11 = "E3modem command (%s) failed" fullword ascii
      $s12 = "I- received TCF - channel check (%sOK: run of %d in %d)" fullword ascii
      $s13 = "X+ read binary pid %d from %s" fullword ascii
      $s14 = "  -f fnt  use (PBM) font file fnt for headers" fullword ascii
      $s15 = "F read %dx%d PBM header" fullword ascii
      $s16 = "F page %d : %s + %ld : %dx%d @ %.fx%.f dpi %s/%s" fullword ascii
      $s17 = "ES2exec failed:" fullword ascii
      $s18 = "DCS - session format" fullword ascii
      $s19 = "ES2tcgetattr on fd=%d failed:" fullword ascii
      $s20 = "E2dial command failed" fullword ascii
      $s21 = "E3receive (+FDR) command failed" fullword ascii
      $s22 = "E3wrong response to receive-frame command" fullword ascii
      $s23 = "I- remote ID -> %s" fullword ascii
      $s24 = "W Postscript input file will be treated as text" fullword ascii
      $s25 = "I- remote ID -> %*.*s" fullword ascii
      $s26 = "F+ wrote %s as %dx%d pixel %.fx%.f dpi %s page" fullword ascii
      $s27 = "I- sent TCF - channel check of %d bytes" fullword ascii
      $s28 = "E3 no command/response from remote" fullword ascii
      $s29 = "E modem command \"%s\" too long" fullword ascii
      $s30 = "W- %d reception errors" fullword ascii
      $s31 = "I- received %d lines, %d errors" fullword ascii
      $s32 = "E2 read %d bytes of font data for %dx%d bitmap" fullword ascii
      $s33 = "Iread %dx%d font %s (%d bytes)" fullword ascii
      $s34 = "X+ read HDB pid %d [" fullword ascii
      $s35 = "PRI-MPS - not done, call operator" fullword ascii
      $s36 = "PRI-EOP - done, call operator" fullword ascii
      $s37 = "PIP - page OK, call operator" fullword ascii
      $s38 = "PIN - page not OK, call operator" fullword ascii
      $s39 = "PRI-EOM - not done, new format, call operator" fullword ascii
      $s40 = "ES2fax device fcntl failed %s:" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 3f 00 00 00 00 00 00 40 00 00 00 00 00 00 00 88 b1 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c8 2c 00 00 00 00 00 00 c8 2c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 8d d6 00 00 00 00 00 00 8d d6 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 10 01 00 00 00 00 00 00 10 01 00 00 00 00 00 00 10 01 00 00 00 00 00 8c 5e 00 00 00 00 00 00 8c 5e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 a0 7d 01 00 00 00 00 00 a0 7d 01 00 00 00 00 00 a0 7d 01 00 00 00 00 00 40 32 00 00 00 00 00 00 e8 1c 02 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 7d 01 00 00 00 00 00 e0 7d 01 00 00 00 00 00 e0 7d 01 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 14 4c 01 00 00 00 00 00 14 4c 01 00 00 00 00 00 14 4c 01 00 00 00 00 00 3c 04 00 00 00 00 00 00 3c 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 a0 7d 01 00 00 00 00 00 a0 7d 01 00 00 00 00 00 a0 7d 01 00 00 00 00 00 60 02 00 00 00 00 00 00 60 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 3c e1 b4 00 66 47 a9 23 e1 a8 3a 7c 70 e1 17 c2 17 8e 0e ac 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 40 00 00 00 01 00 00 00 06 00 00 00 00 01 81 00 00 01 10 02 40 00 00 00 42 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 1a 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 300KB and
      8 of them and $magic
}

rule gtfobins_binaries_pr {
   strings:
      $s1 = "  -h, --header=HEADER" fullword ascii
      $s2 = "  -t, --omit-header  omit page headers and trailers;" fullword ascii
      $s3 = "  -o, --indent=MARGIN" fullword ascii
      $s4 = "  -w, --width=PAGE_WIDTH" fullword ascii
      $s5 = "  -l, --length=PAGE_LENGTH" fullword ascii
      $s6 = "                    (by a 3-line page header with -F or a 5-line header" fullword ascii
      $s7 = "  -d, --double-space" fullword ascii
      $s8 = "  -i[CHAR[WIDTH]], --output-tabs[=CHAR[WIDTH]]" fullword ascii
      $s9 = "  -a, --across      print columns across rather than down, used together" fullword ascii
      $s10 = "  -r, --no-file-warnings" fullword ascii
      $s11 = "  -T, --omit-pagination" fullword ascii
      $s12 = "  -N, --first-line-number=NUMBER" fullword ascii
      $s13 = "  -v, --show-nonprinting" fullword ascii
      $s14 = "  -COLUMN, --columns=COLUMN" fullword ascii
      $s15 = "  -D, --date-format=FORMAT" fullword ascii
      $s16 = "  -S[STRING], --sep-string[=STRING]" fullword ascii
      $s17 = "  -e[CHAR[WIDTH]], --expand-tabs[=CHAR[WIDTH]]" fullword ascii
      $s18 = "  -s[CHAR], --separator[=CHAR]" fullword ascii
      $s19 = "  -W, --page-width=PAGE_WIDTH" fullword ascii
      $s20 = "  +FIRST_PAGE[:LAST_PAGE], --pages=FIRST_PAGE[:LAST_PAGE]" fullword ascii
      $s21 = "  -n[SEP[DIGITS]], --number-lines[=SEP[DIGITS]]" fullword ascii
      $s22 = "  -c, --show-control-chars" fullword ascii
      $s23 = "  -F, -f, --form-feed" fullword ascii
      $s24 = "                    options (-COLUMN|-a -COLUMN|-m) except -w is set" fullword ascii
      $s25 = "                    affect -w or -W, MARGIN will be added to PAGE_WIDTH" fullword ascii
      $s26 = "                    -h \"\" prints a blank line, don't use -h\"\"" fullword ascii
      $s27 = "  -J, --join-lines  merge full lines, turns off -W line truncation, no column" fullword ascii
      $s28 = "                    implies -t if PAGE_LENGTH <= 10" fullword ascii
      $s29 = "                    is the <TAB> character without -w and 'no char' with -w." fullword ascii
      $s30 = "                    unless -a is used. Balance number of lines in the" fullword ascii
      $s31 = "invalid number of columns" fullword ascii
      $s32 = "Page %lu" fullword ascii
      $s33 = "                    use a centered HEADER instead of filename in page header," fullword ascii
      $s34 = "'--pages=FIRST_PAGE[:LAST_PAGE]' missing argument" fullword ascii
      $s35 = "invalid page range %s" fullword ascii /* Goodware String - occured 1 times */
      $s36 = "                    omit page headers and trailers, eliminate any pagination" fullword ascii
      $s37 = "                    use FORMAT for the header date" fullword ascii
      $s38 = "page number overflow" fullword ascii /* Goodware String - occured 1 times */
      $s39 = "cannot specify number of columns when printing in parallel" fullword ascii /* Goodware String - occured 1 times */
      $s40 = "'-%c' extra characters or invalid number in the argument: %s" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 f0 2d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f0 34 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d0 1d 00 00 00 00 00 00 d0 1d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 59 b2 00 00 00 00 00 00 59 b2 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 43 00 00 00 00 00 00 00 43 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 2a 01 00 00 00 00 00 10 3a 01 00 00 00 00 00 10 3a 01 00 00 00 00 00 30 09 00 00 00 00 00 00 f8 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 2d 01 00 00 00 00 00 d8 3d 01 00 00 00 00 00 d8 3d 01 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 7c 05 01 00 00 00 00 00 7c 05 01 00 00 00 00 00 7c 05 01 00 00 00 00 00 a4 04 00 00 00 00 00 00 a4 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 2a 01 00 00 00 00 00 10 3a 01 00 00 00 00 00 10 3a 01 00 00 00 00 00 f0 05 00 00 00 00 00 00 f0 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 bf a4 80 f4 e7 98 64 18 1f 11 95 98 6d 09 ee 47 68 a3 87 66 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 4f 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 4f 00 00 00 51 00 00 00 57 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_debugfs {
   strings:
      $s1 = "Dumping descriptor block, sequence %u, at block %u:" fullword ascii
      $s2 = "%s: Usage: logdump [-acsOS] [-n<num_trans>] [-b<block>] [-i<filespec>]" fullword ascii
      $s3 = "Dumping revoke block, sequence %u, at block %u:" fullword ascii
      $s4 = "while dumping link destination" fullword ascii
      $s5 = "while opening %s for logdump" fullword ascii
      $s6 = "while dumping %s" fullword ascii
      $s7 = "Recursively dump a directory to the native filesystem" fullword ascii
      $s8 = "Usage: block_dump [-x] [-f inode] block_num" fullword ascii
      $s9 = "Usage: inode_dump [-b]|[-e] <file>" fullword ascii
      $s10 = "Usage: dump_extents [-n] [-l] file" fullword ascii
      $s11 = "Usage: dump_inode [-p] <file> <output_file>" fullword ascii
      $s12 = "((hash_size) != 0 && (((hash_size) & ((hash_size) - 1)) == 0))" fullword ascii
      $s13 = "%s fields supported by the %s command:" fullword ascii
      $s14 = "[ERROR] %s:%d:%s: while getting next inode. ret=%ld" fullword ascii
      $s15 = "Dump a hash-indexed directory" fullword ascii
      $s16 = "you need libarchive to be able to process tarballs" fullword ascii
      $s17 = "while opening %s for dump_inode" fullword ascii
      $s18 = "*** Fast Commit Area ***" fullword ascii
      $s19 = "while closing %s for dump_inode" fullword ascii
      $s20 = "Bad log counts number - %s" fullword ascii
      $s21 = "Root node dump:" fullword ascii
      $s22 = "[ERROR] %s:%d:%s: Inserting already present quota entry (block %u)." fullword ascii
      $s23 = "[ERROR] %s:%d:%s: ex2fs_read_inode failed" fullword ascii
      $s24 = "[ERROR] %s:%d:%s: ext2fs_file_read failed: %ld" fullword ascii
      $s25 = "JBD2: IO error %d recovering block %lu in log" fullword ascii
      $s26 = "JBD2: error %d scanning journal" fullword ascii
      $s27 = "Usage: %s [-b blocksize] [-s superblock] [-f cmd_file] [-R request] [-d data_source_device] [-i] [-n] [-D] [-V] [[-w] [-z undo_f" ascii
      $s28 = "JBD2: IO error %d recovering block %ld in log" fullword ascii
      $s29 = "Invalid inode number - '%s'" fullword ascii
      $s30 = "The -d option is only valid when reading an e2image file" fullword ascii
      $s31 = "Usage: %s [-b blocksize] [-s superblock] [-f cmd_file] [-R request] [-d data_source_device] [-i] [-n] [-D] [-V] [[-w] [-z undo_f" ascii
      $s32 = "%s: Usage: %s <file>" fullword ascii
      $s33 = "%s: Usage: %s [-f outfile]|[-xVC] [-r] <file> <attr>" fullword ascii
      $s34 = "Dump contents of a block" fullword ascii
      $s35 = "block_dump" fullword ascii
      $s36 = "dump_unused" fullword ascii
      $s37 = "htree_dump_int_block" fullword ascii
      $s38 = "Dump the inode structure in hex" fullword ascii
      $s39 = "htree_dump" fullword ascii
      $s40 = "dump_mmp" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 c4 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d0 cf 03 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a8 a6 00 00 00 00 00 00 a8 a6 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 f5 fd 01 00 00 00 00 00 f5 fd 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 b0 02 00 00 00 00 00 00 b0 02 00 00 00 00 00 00 b0 02 00 00 00 00 00 24 d0 00 00 00 00 00 00 24 d0 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 8d 03 00 00 00 00 00 b0 9d 03 00 00 00 00 00 b0 9d 03 00 00 00 00 00 78 40 00 00 00 00 00 00 80 4b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 60 a5 03 00 00 00 00 00 60 b5 03 00 00 00 00 00 60 b5 03 00 00 00 00 00 50 02 00 00 00 00 00 00 50 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 64 21 03 00 00 00 00 00 64 21 03 00 00 00 00 00 64 21 03 00 00 00 00 00 c4 0b 00 00 00 00 00 00 c4 0b 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 8d 03 00 00 00 00 00 b0 9d 03 00 00 00 00 00 b0 9d 03 00 00 00 00 00 50 22 00 00 00 00 00 00 50 22 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 d3 ce 3f ff 86 11 a5 67 43 5d 85 bc 06 5d 0f c1 96 26 1f e3 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 05 01 00 00 01 00 00 00 06 00 00 00 40 15 a1 00 80 01 1d 86 05 01 00 00 09 01 00 00 0b 01 00 00 28 1d 8c 1c cc d9 f5 ed b0 6c bc 20 d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 32 c4 f7 12 d0 df 1d e2 b2 a2 f7 12 bb 51 5f 33 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 700KB and
      8 of them and $magic
}

rule gtfobins_binaries_ginsh {
   strings:
      $s1 = "print(expression) - dumps the internal structure of the given expression (for debugging)" fullword ascii
      $s2 = "ginsh - GiNaC Interactive Shell (GiNaC V" fullword ascii
      $s3 = "content(expression, symbol) - content part of a polynomial" fullword ascii
      $s4 = "integer_content(expression) - integer content of a polynomial" fullword ascii
      $s5 = "nops(expression) - number of operands in expression" fullword ascii
      $s6 = "series_to_poly(series) - convert a series into a polynomial by dropping the Order() term" fullword ascii
      $s7 = "op(expression, number) - extract operand from expression" fullword ascii
      $s8 = "map(expression, pattern) - apply function to each operand; the function to be applied is specified as a pattern with the '$0' wi" ascii
      $s9 = "lcm(expression, expression) - least common multiple" fullword ascii
      $s10 = "lsolve(equation-list, symbol-list) - solve system of linear equations" fullword ascii
      $s11 = "sqrt(expression) - square root" fullword ascii
      $s12 = "sqrfree_parfrac(expression, symbol) - square-free partial fraction decomposition of rational function" fullword ascii
      $s13 = "collect_common_factors(expression) - collects common factors from the terms of sums" fullword ascii
      $s14 = "gcd(expression, expression) - greatest common divisor" fullword ascii
      $s15 = "decomp_rational(expression, symbol) - decompose rational function into polynomial and proper rational function" fullword ascii
      $s16 = "conjugate(expression) - complex conjugation" fullword ascii
      $s17 = "rrrsss" fullword wide /* reversed goodware string 'sssrrr' */
      $s18 = "_ZN5GiNaC23multiple_polylog_kernelD1Ev" fullword ascii
      $s19 = "_ZN5GiNaC23multiple_polylog_kernelC1ERKNS_2exE" fullword ascii
      $s20 = "basic_log_kernel" fullword ascii
      $s21 = "_ZTVN5GiNaC23multiple_polylog_kernelE" fullword ascii
      $s22 = "_ZN5GiNaC34multiple_polylog_kernel_unarchiverC1Ev" fullword ascii
      $s23 = "_ZN5GiNaC23multiple_polylog_kernelD0Ev" fullword ascii
      $s24 = "multiple_polylog_kernel" fullword ascii
      $s25 = "_ZN5GiNaC16basic_log_kernelC1Ev" fullword ascii
      $s26 = "_ZN5GiNaC27basic_log_kernel_unarchiverC1Ev" fullword ascii
      $s27 = "_ZN5GiNaC23multiple_polylog_kernelD2Ev" fullword ascii
      $s28 = "_ZN5GiNaC27basic_log_kernel_unarchiverD1Ev" fullword ascii
      $s29 = "_ZN5GiNaC34multiple_polylog_kernel_unarchiverD1Ev" fullword ascii
      $s30 = "map(expression, pattern) - apply function to each operand; the function to be applied is specified as a pattern with the '$0' wi" ascii
      $s31 = "trilogarithm" fullword ascii
      $s32 = "ldegree(expression, object) - low degree of a polynomial" fullword ascii
      $s33 = "primpart(expression, symbol) - primitive part of a polynomial" fullword ascii
      $s34 = "_ZNSt11logic_errorC1EPKc" fullword ascii
      $s35 = "denom(expression) - denominator of a rational function" fullword ascii
      $s36 = "evalm(expression) - evaluates sums, products and integer powers of matrices" fullword ascii
      $s37 = "numer(expression) - numerator of a rational function" fullword ascii
      $s38 = "lcoeff(expression, object) - leading coefficient of a polynomial" fullword ascii
      $s39 = "_ZN5GiNaC19user_defined_kernelD0Ev" fullword ascii
      $s40 = "divide(expression, expression) - exact polynomial division" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 c0 3e 01 00 00 00 00 00 40 00 00 00 00 00 00 00 28 49 03 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 20 00 1f 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 18 e5 00 00 00 00 00 00 18 e5 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 b1 66 01 00 00 00 00 00 b1 66 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 60 02 00 00 00 00 00 00 60 02 00 00 00 00 00 00 60 02 00 00 00 00 00 e9 9c 00 00 00 00 00 00 e9 9c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 00 07 03 00 00 00 00 00 00 07 03 00 00 00 00 00 00 07 03 00 00 00 00 00 64 40 00 00 00 00 00 00 88 49 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a8 3b 03 00 00 00 00 00 a8 3b 03 00 00 00 00 00 a8 3b 03 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 98 9d 02 00 00 00 00 00 98 9d 02 00 00 00 00 00 98 9d 02 00 00 00 00 00 d4 0a 00 00 00 00 00 00 d4 0a 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 00 07 03 00 00 00 00 00 00 07 03 00 00 00 00 00 00 07 03 00 00 00 00 00 00 39 00 00 00 00 00 00 00 39 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 8c a6 2b 07 53 79 83 07 c4 f5 1d d3 71 5e da f7 e0 6c da 4a 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 c5 00 00 00 65 01 00 00 20 00 00 00 0b 00 00 00 08 10 18 20 00 01 01 00 08 60 04 00 13 11 00 2d 04 08 10 04 46 20 02 80 09 05 01 10 04 02 0f 00 6e 60 02 21 04 45 e8 00 25 01 c0 a5 4c 19 b4 62 08 02 00 18 40 48 00 41 00 20 2a 18 00 03 10 80 00 00 00 00 00 60 00 42 59 c0 04 44 48 15 44 c2}
condition:
      filesize < 600KB and
      8 of them and $magic
}

rule gtfobins_binaries_nl {
   strings:
      $s1 = "Default options are: -bt -d'\\:' -fn -hn -i1 -l1 -n'rn' -s<TAB> -v1 -w6" fullword ascii
      $s2 = "  -h, --header-numbering=STYLE    use STYLE for numbering header lines" fullword ascii
      $s3 = "  -v, --starting-line-number=NUMBER  first line number for each section" fullword ascii
      $s4 = "b0208c1806bd86bdeb10890b2bb5e36da971a0.debug" fullword ascii
      $s5 = "invalid starting line number" fullword ascii
      $s6 = "invalid line number increment" fullword ascii
      $s7 = "invalid line number of blank lines" fullword ascii
      $s8 = "invalid line number field width" fullword ascii
      $s9 = "CC are two delimiter characters used to construct logical page delimiters;" fullword ascii
      $s10 = "re_syntax_options" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "  -d, --section-delimiter=CC      use CC for logical page delimiters" fullword ascii
      $s12 = "disables section matching." fullword ascii
      $s13 = "line-increment" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "more than two characters, and also specifying the empty string (-d '')" fullword ascii
      $s15 = "b0208c1806bd86bdeb10890b2bb5e36da971a0" ascii
      $s16 = "STYLE is one of:" fullword ascii
      $s17 = "body-numbering" fullword ascii /* Goodware String - occured 2 times */
      $s18 = "number-separator" fullword ascii /* Goodware String - occured 2 times */
      $s19 = "Scott Bartram" fullword ascii /* Goodware String - occured 2 times */
      $s20 = "  -n, --number-format=FORMAT      insert line numbers according to FORMAT" fullword ascii
      $s21 = "invalid header numbering style: %s" fullword ascii /* Goodware String - occured 2 times */
      $s22 = "  -l, --join-blank-lines=NUMBER   group of NUMBER empty lines counted as one" fullword ascii
      $s23 = "invalid footer numbering style: %s" fullword ascii /* Goodware String - occured 2 times */
      $s24 = "  -b, --body-numbering=STYLE      use STYLE for numbering body lines" fullword ascii
      $s25 = "number-width" fullword ascii /* Goodware String - occured 2 times */
      $s26 = "no-renumber" fullword ascii /* Goodware String - occured 2 times */
      $s27 = "  -s, --number-separator=STRING   add STRING after (possible) line number" fullword ascii
      $s28 = "  -w, --number-width=NUMBER       use NUMBER columns for line numbers" fullword ascii
      $s29 = "  -p, --no-renumber               do not reset line numbers for each section" fullword ascii
      $s30 = "Write each FILE to standard output, with line numbers added." fullword ascii /* Goodware String - occured 2 times */
      $s31 = "h:b:f:v:i:pl:s:w:n:d:" fullword ascii /* Goodware String - occured 2 times */
      $s32 = "  -f, --footer-numbering=STYLE    use STYLE for numbering footer lines" fullword ascii
      $s33 = "number-format" fullword ascii /* Goodware String - occured 2 times */
      $s34 = "invalid body numbering style: %s" fullword ascii /* Goodware String - occured 2 times */
      $s35 = "footer-numbering" fullword ascii /* Goodware String - occured 2 times */
      $s36 = "starting-line-number" fullword ascii /* Goodware String - occured 2 times */
      $s37 = "join-blank-lines" fullword ascii /* Goodware String - occured 2 times */
      $s38 = "header-numbering" fullword ascii /* Goodware String - occured 2 times */
      $s39 = "section-delimiter" fullword ascii /* Goodware String - occured 2 times */
      $s40 = "  -i, --line-increment=NUMBER     line number increment at each line" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 2a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 70 b4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b0 19 00 00 00 00 00 00 b0 19 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 59 57 00 00 00 00 00 00 59 57 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 a0 28 00 00 00 00 00 00 a0 28 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 ab 00 00 00 00 00 00 b0 bb 00 00 00 00 00 00 b0 bb 00 00 00 00 00 00 10 07 00 00 00 00 00 00 30 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ad 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d4 94 00 00 00 00 00 00 d4 94 00 00 00 00 00 00 d4 94 00 00 00 00 00 00 64 03 00 00 00 00 00 00 64 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 ab 00 00 00 00 00 00 b0 bb 00 00 00 00 00 00 b0 bb 00 00 00 00 00 00 50 04 00 00 00 00 00 00 50 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 1e b0 20 8c 18 06 bd 86 bd eb 10 89 0b 2b b5 e3 6d a9 71 a0 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 40 00 00 00 01 00 00 00 06 00 00 00 04 6d e1 00 a0 41 1c 12 40 00 00 00 42 00 00 00 49 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 8c fb 09 1a 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_nft {
   strings:
      $s1 = "Error: syntax error, options must be specified before commands" fullword ascii
      $s2 = "%s: no command specified" fullword ascii
      $s3 = "Define variable, e.g. --define foo=1.2.3.4" fullword ascii
      $s4 = "Options (command output formatting):" fullword ascii
      $s5 = "Check commands validity without actually applying the changes." fullword ascii
      $s6 = "Translate ports to service names as described in /etc/services." fullword ascii
      $s7 = "Print UID/GID as defined in /etc/passwd and /etc/group." fullword ascii
      $s8 = "Failed to define variable '%s'" fullword ascii
      $s9 = "Failed to add include path '%s'" fullword ascii
      $s10 = "nft_run_cmd_from_filename" fullword ascii
      $s11 = "Error: -i/--interactive and -f/--file options cannot be combined" fullword ascii
      $s12 = "nft_run_cmd_from_buffer" fullword ascii
      $s13 = "Usage: %s [ options ] [ cmds... ]" fullword ascii
      $s14 = "%s: interactive CLI not supported in this build" fullword ascii
      $s15 = "get_optstring" fullword ascii
      $s16 = "Omit contents of sets." fullword ascii
      $s17 = "nft_ctx_output_get_debug" fullword ascii
      $s18 = "reversedns" fullword ascii
      $s19 = "Add <directory> to the paths searched for include files. Default is: /etc" fullword ascii
      $s20 = "nftables" fullword ascii
      $s21 = "segtree" fullword ascii
      $s22 = "editline" fullword ascii
      $s23 = "netlink" fullword ascii
      $s24 = "Translate IP addresses to names." fullword ascii
      $s25 = "Read input from <filename>" fullword ascii
      $s26 = "invalid debug parameter `%s'" fullword ascii
      $s27 = "Commodore Bullmoose" fullword ascii
      $s28 = "Error: -D/--define can only be used with -f/--filename" fullword ascii
      $s29 = "Show version information" fullword ascii
      $s30 = "Show extended version information" fullword ascii
      $s31 = "Read input from interactive CLI" fullword ascii
      $s32 = ".nft.history" fullword ascii
      $s33 = "%s:%u: Memory allocation failure" fullword ascii
      $s34 = "Specify debugging level (scanner, parser, eval, netlink, mnl, proto-ctx, segtree, all)" fullword ascii
      $s35 = ", --%s" fullword ascii
      $s36 = "<name=value>" fullword ascii
      $s37 = "LIBNFTABLES_3" fullword ascii
      $s38 = "Echo what has been added, inserted or replaced." fullword ascii
      $s39 = "Optimize ruleset" fullword ascii
      $s40 = "nft_ctx_output_set_flags" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 2b 00 00 00 00 00 00 40 00 00 00 00 00 00 00 58 61 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 70 18 00 00 00 00 00 00 70 18 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 61 11 00 00 00 00 00 00 61 11 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 3c 0b 00 00 00 00 00 00 3c 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 59 00 00 00 00 00 00 10 59 00 00 00 00 00 00 10 59 00 00 00 00 00 00 00 07 00 00 00 00 00 00 f8 1a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 60 5c 00 00 00 00 00 00 60 5c 00 00 00 00 00 00 60 5c 00 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 08 49 00 00 00 00 00 00 08 49 00 00 00 00 00 00 08 49 00 00 00 00 00 00 4c 00 00 00 00 00 00 00 4c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 59 00 00 00 00 00 00 10 59 00 00 00 00 00 00 10 59 00 00 00 00 00 00 f0 06 00 00 00 00 00 00 f0 06 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 a7 d8 68 57 1e 9a 37 ea bd 02 e1 ac ae d1 fd ec 50 8c 25 e8 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 2e 00 00 00 01 00 00 00 06 00 00 00 00 07 a1 05 f0 81 1c 02 2e 00 00 00 32 00 00 00 34 00 00 00 a6 16 2e 5a 24 a4 b8 1b 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 32 c4 f7 12 b2 a2 f7 12 d8 ac 15 f7 e4 ab 90 4c 67 b2 99 e2 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 80KB and
      8 of them and $magic
}

rule gtfobins_binaries_ruby {
   strings:
      $s1 = "ruby_run_node" fullword ascii
      $s2 = "libgmp.so.10" fullword ascii
      $s3 = "libcrypt.so.1" fullword ascii
      $s4 = "ruby_init_stack" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "ruby_sysinit" fullword ascii
      $s6 = "libruby-3.1.so.3.1" fullword ascii
      $s7 = "ruby_options" fullword ascii
      $s8 = "e19e06f63d135b3d72f11bb60c0d6b47b1b7a9.debug" fullword ascii
      $s9 = "ruby_init" fullword ascii /* Goodware String - occured 1 times */
      $s10 = "e19e06f63d135b3d72f11bb60c0d6b47b1b7a9" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 11 00 00 00 00 00 00 40 00 00 00 00 00 00 00 50 31 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 09 00 00 00 00 00 00 00 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 25 02 00 00 00 00 00 00 25 02 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 38 2d 00 00 00 00 00 00 38 3d 00 00 00 00 00 00 38 3d 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 e0 02 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 48 2d 00 00 00 00 00 00 48 3d 00 00 00 00 00 00 48 3d 00 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 08 20 00 00 00 00 00 00 08 20 00 00 00 00 00 00 08 20 00 00 00 00 00 00 2c 00 00 00 00 00 00 00 2c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 38 2d 00 00 00 00 00 00 38 3d 00 00 00 00 00 00 38 3d 00 00 00 00 00 00 c8 02 00 00 00 00 00 00 c8 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 90 e1 9e 06 f6 3d 13 5b 3d 72 f1 1b b6 0c 0d 6b 47 b1 b7 a9 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 0c 00 00 00 01 00 00 00 06 00 00 00 88 51 a1 01 20 65 04 08 0c 00 00 00 10 00 00 00 00 00 00 00 6a 09 43 d6 d0 65 ce 6d ba e3 92 7c 43 45 d5 ec 0c 3a 97 0b 32 62 db ed ac 4b e3 c0 d9 71 58 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 40KB and
      all of them
}

rule gtfobins_binaries_aa_exec {
   strings:
      $s1 = "[%ld] aa-exec: ERROR: Failed to execute \"%s\": %m" fullword ascii
      $s2 = "[%ld] aa-exec: ERROR: Multiple -n/--namespace parameters given" fullword ascii
      $s3 = "[%ld] aa-exec: ERROR: Multiple -p/--profile parameters given" fullword ascii
      $s4 = "[%ld] aa-exec: ERROR: insufficient permissions to change to the %s '%s'" fullword ascii
      $s5 = "[%ld] aa-exec: ERROR: %s '%s' does not exist" fullword ascii
      $s6 = "[%ld] aa-exec: DEBUG: %d = aa_change_profile(\"%s\")" fullword ascii
      $s7 = "[%ld] aa-exec: ERROR: AppArmor interface not available" fullword ascii
      $s8 = "[%ld] aa-exec: ERROR: %m" fullword ascii
      $s9 = "[%ld] aa_change_onexec(\"%s\")" fullword ascii
      $s10 = "[%ld] aa-exec: ERROR: name too long (%zu > %zu)" fullword ascii
      $s11 = "[%ld] aa-exec: DEBUG: %d = aa_change_onexec(\"%s\")" fullword ascii
      $s12 = "change profile immediately instead of at exec" fullword ascii
      $s13 = "  -p PROFILE, --profile=PROFILE" fullword ascii
      $s14 = "  -n NAMESPACE, --namespace=NAMESPACE" fullword ascii
      $s15 = "USAGE: %s [OPTIONS] <prog> <args>" fullword ascii
      $s16 = "[%ld] exec" fullword ascii
      $s17 = "securityfs" fullword ascii
      $s18 = "  -v, --verbose" fullword ascii
      $s19 = "  -i, --immediate" fullword ascii
      $s20 = "/proc/%d/attr/apparmor/" fullword ascii
      $s21 = "/proc/%d/attr/apparmor/%s" fullword ascii
      $s22 = "/proc/%d/attr/%s" fullword ascii
      $s23 = "/proc/%d/attr/apparmor/unavailable/%s" fullword ascii
      $s24 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/apparmor.debug" fullword ascii
      $s25 = "[%ld] aa_change_profile(\"%s\")" fullword ascii
      $s26 = "show messages with stats" fullword ascii
      $s27 = "show messages with debugging information" fullword ascii
      $s28 = "  -h, --help" fullword ascii
      $s29 = "  -d, --debug" fullword ascii
      $s30 = "/proc/mounts" fullword ascii
      $s31 = "allow 0x%8x" fullword ascii
      $s32 = "deny 0x%8x" fullword ascii
      $s33 = "audit 0x%8x" fullword ascii
      $s34 = "%s/apparmor" fullword ascii
      $s35 = "/sys/module/apparmor/parameters/available" fullword ascii
      $s36 = "/sys/module/apparmor/parameters/enabled" fullword ascii
      $s37 = "PROFILE to confine <prog> with" fullword ascii
      $s38 = "changehat %016lx^%s" fullword ascii
      $s39 = "n4ac4019ea12fc5617769fb233bb2ce5d11a775.debug" fullword ascii
      $s40 = "Confine <prog> with the specified PROFILE." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 18 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b0 41 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d0 0d 00 00 00 00 00 00 d0 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 ad 17 00 00 00 00 00 00 ad 17 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 2c 0a 00 00 00 00 00 00 2c 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 c0 3c 00 00 00 00 00 00 c0 4c 00 00 00 00 00 00 c0 4c 00 00 00 00 00 00 54 03 00 00 00 00 00 00 a8 03 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d0 3c 00 00 00 00 00 00 d0 4c 00 00 00 00 00 00 d0 4c 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 18 36 00 00 00 00 00 00 18 36 00 00 00 00 00 00 18 36 00 00 00 00 00 00 94 00 00 00 00 00 00 00 94 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 c0 3c 00 00 00 00 00 00 c0 4c 00 00 00 00 00 00 c0 4c 00 00 00 00 00 00 40 03 00 00 00 00 00 00 40 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 b0 4a c4 01 9e a1 2f c5 61 77 69 fb 23 3b b2 ce 5d 11 a7 75 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 25 00 00 00 01 00 00 00 06 00 00 00 00 00 81 00 00 00 00 00 25 00 00 00 00 00 00 00 d1 65 ce 6d 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b8 00 00 00 12 00 00 00}
condition:
      filesize < 50KB and
      8 of them and $magic
}

rule gtfobins_binaries_bc {
   strings:
      $s1 = "Runtime error (func=%s, adr=%d): " fullword ascii
      $s2 = "comparison in subscript" fullword ascii
      $s3 = "Array %s subscript out of bounds." fullword ascii
      $s4 = "Runtime warning (func=%s, adr=%d): " fullword ascii
      $s5 = "%s %d: Error: " fullword ascii
      $s6 = "* not allowed here" fullword ascii
      $s7 = "interrupted execution." fullword ascii
      $s8 = "void expression as subscript" fullword ascii
      $s9 = "  -h  --help         print this usage and exit" fullword ascii
      $s10 = "multiple letter name - %s" fullword ascii
      $s11 = "  -i  --interactive  force interactive mode" fullword ascii
      $s12 = "read() in flex scanner failed" fullword ascii
      $s13 = "  -v  --version      print version information and exit" fullword ascii
      $s14 = "  -s  --standard     non-standard bc constructs are errors" fullword ascii
      $s15 = "%s %d: (Warning) " fullword ascii
      $s16 = "comparison in return expression" fullword ascii
      $s17 = "&& operator" fullword ascii
      $s18 = "! operator" fullword ascii
      $s19 = "comparison in expression" fullword ascii
      $s20 = "|| operator" fullword ascii
      $s21 = "comparison in argument" fullword ascii
      $s22 = "read function" fullword ascii
      $s23 = "void expression with comparison" fullword ascii
      $s24 = "ibase too small in --" fullword ascii
      $s25 = "obase too small in --" fullword ascii
      $s26 = "void expression with unary -" fullword ascii
      $s27 = "void expression with -" fullword ascii
      $s28 = "mathlib" fullword ascii
      $s29 = "chilqswv" fullword ascii
      $s30 = "scale can not be negative in -- " fullword ascii
      $s31 = "Error in numeric constant" fullword ascii
      $s32 = "EOF encountered in a comment." fullword ascii
      $s33 = "Comparison in third for expression" fullword ascii
      $s34 = "Comparison in first for expression" fullword ascii
      $s35 = "  -w  --warn         warn about non-standard bc constructs" fullword ascii
      $s36 = "Parameter type mismatch, parameter %s." fullword ascii
      $s37 = "Square root of a negative number" fullword ascii
      $s38 = "  -l  --mathlib      use the predefined math routines" fullword ascii
      $s39 = "Function %s not defined." fullword ascii
      $s40 = "Parameter type mismatch parameter %s." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 25 00 00 00 00 00 00 40 00 00 00 00 00 00 00 18 74 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e0 17 00 00 00 00 00 00 e0 17 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 a5 c5 00 00 00 00 00 00 a5 c5 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 04 6e 00 00 00 00 00 00 04 6e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 40 6c 01 00 00 00 00 00 40 6c 01 00 00 00 00 00 40 6c 01 00 00 00 00 00 9c 06 00 00 00 00 00 00 d0 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 50 6c 01 00 00 00 00 00 50 6c 01 00 00 00 00 00 50 6c 01 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 44 3e 01 00 00 00 00 00 44 3e 01 00 00 00 00 00 44 3e 01 00 00 00 00 00 8c 04 00 00 00 00 00 00 8c 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 40 6c 01 00 00 00 00 00 40 6c 01 00 00 00 00 00 40 6c 01 00 00 00 00 00 c0 03 00 00 00 00 00 00 c0 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 dc f8 f8 af d1 1f 62 b3 9d fd 5a e8 cd 2f 88 c1 0e cf 22 77 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 33 00 00 00 01 00 00 00 06 00 00 00 00 03 a1 00 e0 81 18 02 33 00 00 00 35 00 00 00 37 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 32 c4 f7 12 e4 ab 90 4c 67 b2 99 e2 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 af 01 00 00 12 00 00 00}
condition:
      filesize < 300KB and
      8 of them and $magic
}

rule gtfobins_binaries_pkexec {
   strings:
      $s1 = "Error getting contents of /etc/shells: %s" fullword ascii
      $s2 = "Error executing command as another user: Not authorized" fullword ascii
      $s3 = "Error executing command as another user: Request dismissed" fullword ascii
      $s4 = "Executing command" fullword ascii
      $s5 = "Error executing command as another user: No authentication agent found." fullword ascii
      $s6 = "Error executing %s: %s" fullword ascii
      $s7 = "%s: %s [USER=%s] [TTY=%s] [CWD=%s] [COMMAND=%s]" fullword ascii
      $s8 = "polkit_unix_process_get_pid" fullword ascii
      $s9 = "polkit_unix_process_get_start_time (POLKIT_UNIX_PROCESS (subject)) > 0" fullword ascii
      $s10 = "polkit_unix_process_get_uid (POLKIT_UNIX_PROCESS (subject)) >= 0" fullword ascii
      $s11 = "polkit_unix_process_get_uid" fullword ascii
      $s12 = "polkit_unix_process_get_start_time" fullword ascii
      $s13 = "org.freedesktop.policykit.exec.path" fullword ascii
      $s14 = "org.freedesktop.policykit.exec" fullword ascii
      $s15 = "org.freedesktop.policykit.exec.argv1" fullword ascii
      $s16 = "org.freedesktop.policykit.exec.allow_gui" fullword ascii
      $s17 = "pkexec --version |" fullword ascii
      $s18 = "No shell configured or error retrieving pw_shell" fullword ascii
      $s19 = "Error getting information for user `%s': %s" fullword ascii
      $s20 = "polkit_unix_process_get_pid (POLKIT_UNIX_PROCESS (subject)) == pid_of_caller" fullword ascii
      $s21 = "The value for the SHELL variable was not found in the /etc/shells file" fullword ascii
      $s22 = "Error becoming real+effective uid %d and gid %d: %s" fullword ascii
      $s23 = "Error checking for authorization %s: %s" fullword ascii
      $s24 = "Error setting close-on-exec for file desriptors" fullword ascii
      $s25 = "polkit_unix_process_new_for_owner" fullword ascii
      $s26 = "Error getting user name." fullword ascii
      $s27 = "Error getting authority: %s" fullword ascii
      $s28 = "pkexec version %s" fullword ascii
      $s29 = "polkit_action_description_get_action_id" fullword ascii
      $s30 = "polkit_action_description_get_annotation" fullword ascii
      $s31 = "pkexec must be setuid root" fullword ascii
      $s32 = "Error registering local authentication agent: %s" fullword ascii
      $s33 = "org.freedesktop..policykit.exec" fullword ascii
      $s34 = "Authentication is needed to run `$(cmdline_short)' as user $(user.display)" fullword ascii
      $s35 = "Authentication is needed to run `$(cmdline_short)' as the super user" fullword ascii
      $s36 = "pkexec" fullword ascii
      $s37 = "Error changing to home directory %s: %s" fullword ascii
      $s38 = "Error initializing groups for %s: %s" fullword ascii
      $s39 = "Error accessing %s: %s" fullword ascii
      $s40 = "polkit_authorization_result_get_is_authorized" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 3d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 58 71 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 1d 00 00 00 00 00 00 10 1d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 99 20 00 00 00 00 00 00 99 20 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 10 0e 00 00 00 00 00 00 10 0e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 a0 6a 00 00 00 00 00 00 a0 6a 00 00 00 00 00 00 a0 6a 00 00 00 00 00 00 70 05 00 00 00 00 00 00 a8 05 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c0 6a 00 00 00 00 00 00 c0 6a 00 00 00 00 00 00 c0 6a 00 00 00 00 00 00 50 02 00 00 00 00 00 00 50 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 50 5c 00 00 00 00 00 00 50 5c 00 00 00 00 00 00 50 5c 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 a0 6a 00 00 00 00 00 00 a0 6a 00 00 00 00 00 00 a0 6a 00 00 00 00 00 00 60 05 00 00 00 00 00 00 60 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 8b c8 4a 58 74 f9 3d f3 d3 b5 89 98 3f 02 9d 5c a5 52 b9 ac 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 59 00 00 00 01 00 00 00 06 00 00 00 00 04 81 02 02 20 00 00 59 00 00 00 5b 00 00 00 00 00 00 00 a0 a2 f3 64 d1 65 ce 6d 6d 56 13 ff 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 05 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 90KB and
      8 of them and $magic
}

rule gtfobins_binaries_whiptail {
   strings:
      $s1 = "passwordbox" fullword ascii
      $s2 = "--passwordbox <text> <height> <width> [init] " fullword ascii
      $s3 = "-v, --version" fullword ascii
      $s4 = "newtTextboxGetNumLines" fullword ascii
      $s5 = "newtRadioGetCurrent" fullword ascii
      $s6 = "newtListboxGetCurrent" fullword ascii
      $s7 = "newtFormGetCurrent" fullword ascii
      $s8 = "scrolltext" fullword ascii
      $s9 = "radiolist" fullword ascii
      $s10 = "defaultno" fullword ascii
      $s11 = "infobox" fullword ascii
      $s12 = "backtitle" fullword ascii
      $s13 = "inputbox" fullword ascii
      $s14 = "whiptail" fullword ascii
      $s15 = "--fb, --fullbuttons" fullword ascii
      $s16 = "fullbuttons" fullword ascii
      $s17 = "open /dev/tty" fullword ascii
      $s18 = "newtDrawRootText" fullword ascii
      $s19 = "newtFormAddComponents" fullword ascii
      $s20 = "newtFormAddComponent" fullword ascii
      $s21 = "135cb584557b09047f030afee4c55457597750.debug" fullword ascii
      $s22 = "newtRunForm" fullword ascii
      $s23 = "dup/close stdin" fullword ascii
      $s24 = "newtCompactButton" fullword ascii
      $s25 = "%s: too large to display." fullword ascii
      $s26 = "display backtitle" fullword ascii
      $s27 = "clear screen on exit" fullword ascii
      $s28 = "output one line at a time" fullword ascii
      $s29 = "set text of no button" fullword ascii
      $s30 = "default no button" fullword ascii
      $s31 = "set default string" fullword ascii
      $s32 = "set text of yes button" fullword ascii
      $s33 = "set text of ok button" fullword ascii
      $s34 = "use full buttons" fullword ascii
      $s35 = "display title" fullword ascii
      $s36 = "noitem" fullword ascii
      $s37 = "msgbox" fullword ascii
      $s38 = "notags" fullword ascii
      $s39 = "libpopt.so.0" fullword ascii
      $s40 = "LIBPOPT_0" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 35 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c0 63 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d0 1a 00 00 00 00 00 00 d0 1a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 41 2f 00 00 00 00 00 00 41 2f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 84 0c 00 00 00 00 00 00 84 0c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 5d 00 00 00 00 00 00 90 6d 00 00 00 00 00 00 90 6d 00 00 00 00 00 00 e8 04 00 00 00 00 00 00 50 05 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a0 5d 00 00 00 00 00 00 a0 6d 00 00 00 00 00 00 a0 6d 00 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 48 57 00 00 00 00 00 00 48 57 00 00 00 00 00 00 48 57 00 00 00 00 00 00 b4 00 00 00 00 00 00 00 b4 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 5d 00 00 00 00 00 00 90 6d 00 00 00 00 00 00 90 6d 00 00 00 00 00 00 70 02 00 00 00 00 00 00 70 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 3f 13 5c b5 84 55 7b 09 04 7f 03 0a fe e4 c5 54 57 59 77 50 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 52 00 00 00 01 00 00 00 06 00 00 00 00 01 81 08 00 09 30 02 52 00 00 00 54 00 00 00 00 00 00 00 d0 65 ce 6d 29 1d 8c 1c da ca 6c 6f f4 05 75 6f 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 80KB and
      8 of them and $magic
}

rule gtfobins_binaries_pidstat {
   strings:
      $x1 = "[ -u ] [ -V ] [ -v ] [ -w ] [ -C <command> ] [ -G <process_name> ]" fullword ascii
      $s2 = "Usage: %s [ options ] [ <interval> [ <count> ] ] [ -e <program> <args> ]" fullword ascii
      $s3 = "[ -d ] [ -H ] [ -h ] [ -I ] [ -l ] [ -R ] [ -r ] [ -s ] [ -t ] [ -U [ <username> ] ]" fullword ascii
      $s4 = " StkSize  StkRef  Command" fullword ascii
      $s5 = " prio policy  Command" fullword ascii
      $s6 = " minflt-nr majflt-nr  Command" fullword ascii
      $s7 = "    %%usr %%system  %%guest   %%wait    %%CPU   CPU  Command" fullword ascii
      $s8 = "    usr-ms system-ms  guest-ms  Command" fullword ascii
      $s9 = "/proc/%u/cmdline" fullword ascii
      $s10 = "/proc/%u/task/%u/cmdline" fullword ascii
      $s11 = "     -" fullword ascii /* reversed goodware string '-     ' */
      $s12 = "   cswch/s nvcswch/s  Command" fullword ascii
      $s13 = "  minflt/s  majflt/s     VSZ     RSS   %%MEM  Command" fullword ascii
      $s14 = "S_REPEAT_HEADER" fullword ascii
      $s15 = "   kB_rd/s   kB_wr/s kB_ccwr/s iodelay  Command" fullword ascii
      $s16 = "PageTables:" fullword ascii
      $s17 = "KernelStack:" fullword ascii
      $s18 = "# Time  I" fullword ascii
      $s19 = "[ --dec={ 0 | 1 | 2 } ] [ --human ]" fullword ascii
      $s20 = "sysstat" fullword ascii
      $s21 = "Committed_AS:" fullword ascii
      $s22 = "/sys/devices/system/cpu" fullword ascii
      $s23 = "[ -p { <pid> [,...] | SELF | ALL } ] [ -T { TASK | CHILD | ALL } ]" fullword ascii
      $s24 = "read_bytI" fullword ascii
      $s25 = "read_bytes:" fullword ascii
      $s26 = "sysstat version %s" fullword ascii
      $s27 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/sysstat.debug" fullword ascii
      $s28 = "Threads:I" fullword ascii
      $s29 = " prio policy" fullword ascii
      $s30 = "nonvolunI3" fullword ascii
      $s31 = "MemAvailI9" fullword ascii
      $s32 = "/proc/meminfo" fullword ascii
      $s33 = "/proc/stat" fullword ascii
      $s34 = "MemTotal:" fullword ascii
      $s35 = "MemFree:" fullword ascii
      $s36 = "/proc/uptime" fullword ascii
      $s37 = "  (%s)" fullword ascii
      $s38 = "cc7e7de1fd24783a8ed023e141e8c9fb6f6e08.debug" fullword ascii
      $s39 = "Buffers:" fullword ascii
      $s40 = "%s %s (%s) " fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 3e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 60 c2 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 08 15 00 00 00 00 00 00 08 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 a9 76 00 00 00 00 00 00 a9 76 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 34 14 00 00 00 00 00 00 34 14 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b8 bb 00 00 00 00 00 00 b8 cb 00 00 00 00 00 00 b8 cb 00 00 00 00 00 00 10 05 00 00 00 00 00 00 a0 31 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c8 bb 00 00 00 00 00 00 c8 cb 00 00 00 00 00 00 c8 cb 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 20 ac 00 00 00 00 00 00 20 ac 00 00 00 00 00 00 20 ac 00 00 00 00 00 00 e4 00 00 00 00 00 00 00 e4 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b8 bb 00 00 00 00 00 00 b8 cb 00 00 00 00 00 00 b8 cb 00 00 00 00 00 00 48 04 00 00 00 00 00 00 48 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 c6 cc 7e 7d e1 fd 24 78 3a 8e d0 23 e1 41 e8 c9 fb 6f 6e 08 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 46 00 00 00 01 00 00 00 06 00 00 00 00 00 81 00 00 00 00 00 46 00 00 00 00 00 00 00 d1 65 ce 6d 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 4c 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 34 01 00 00 12 00 00 00}
condition:
      filesize < 200KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_pexec {
   strings:
      $x1 = "Execute commands or shell scripts in parallel on a single host or" fullword ascii
      $x2 = "[-m|--mutex <name> -a|--atomic [-c|--shell-command] [--] command [...]]" fullword ascii
      $x3 = "%s: unable to execute the remote shell command '%s'." fullword ascii
      $x4 = "%s: error: unable to connect or initialize remote shell '%s' and/or pexec daemon '%s' to the host '%s' (reason code=%d)." fullword ascii
      $x5 = "Execute the given command. If ``-m|--mutex'' is given, the exectution is going to be atomic with respect to that mutex." fullword ascii
      $s6 = "Allow multiple individual shell command scripts to be executed in parallel with the variation of the parameters." fullword ascii
      $s7 = "%s: unable to execute the command '%s'." fullword ascii
      $s8 = "Full path (e.g. /bin/sh) of the shell or interpreter to be used for script execution." fullword ascii
      $s9 = "-c, --shell-command" fullword ascii
      $s10 = "Use the specified shell to interpret the command(s) instead of direct execution." fullword ascii
      $s11 = "pexec [options] [-c|-m] [--] command [arguments] | 'compound command'" fullword ascii
      $s12 = "[-m|--mutex <name> {-d|--dump | -s|--save} <filename> ]" fullword ascii
      $s13 = "Execution using remote hosts:" fullword ascii
      $s14 = "Remote control, mutual exclusions and atomic command execution:" fullword ascii
      $s15 = "%s: unable to execute the script '%s'." fullword ascii
      $s16 = "%s: unable to execute the shell '%s'." fullword ascii
      $s17 = "A marker after which the command to execute begins." fullword ascii
      $s18 = "Sets the scheduling priority of pexec and all children (executed processes) to the priority defined by this nice value." fullword ascii
      $s19 = "[-c|--shell-command] [-m|--multiple-command] [-s|--shell <shell>]" fullword ascii
      $s20 = "%s: error: invalid command line argument '%s'." fullword ascii
      $s21 = "%s: error: special command line argument '%s' must be the first in the list." fullword ascii
      $s22 = "Save the content of standard input to the given file, if ``-m|--mutex'' is given, this will be atomic." fullword ascii
      $s23 = "-m, --multiple-command" fullword ascii
      $s24 = "The full path of the pexec program on the remote hosts. If this option is omitted, pexec tries to figure out from the invoking s" ascii
      $s25 = "The full path of the pexec program on the remote hosts. If this option is omitted, pexec tries to figure out from the invoking s" ascii
      $s26 = "on remote hosts using a remote shell." fullword ascii
      $s27 = "[options] -c [--] 'compound command'" fullword ascii
      $s28 = "Dump the content of the given file to standard output, if ``-m|--mutex'' is given, this will be atomic." fullword ascii
      $s29 = "[{-l|--lock|--mutex-lock | -u|--unlock|--mutex-unlock} <name>]" fullword ascii
      $s30 = "-E, --pexec-connection-variable <env>" fullword ascii
      $s31 = "The name or full path of the remote shell to be used for building the tunnel between the local and the peer host(s). Default: ``" ascii
      $s32 = "-u, --unlock <mutex>" fullword ascii
      $s33 = "The maximal number of processes running simultaneously. The <number> itself can even be a complex specification of remote hosts " ascii
      $s34 = "-m, --mutex <mutex>" fullword ascii
      $s35 = "-l, --lock <mutex>" fullword ascii
      $s36 = "The maximal number of processes running simultaneously. The <number> itself can even be a complex specification of remote hosts " ascii
      $s37 = "remote %d mutex \"%s\"" fullword ascii
      $s38 = "error unexpected command '%s'" fullword ascii
      $s39 = "/tmp/pexec.%d.sock" fullword ascii
      $s40 = "remote %d mutex \"%s\" %d" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 62 00 00 00 00 00 00 40 00 00 00 00 00 00 00 08 b5 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 30 22 00 00 00 00 00 00 30 22 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 dd 1a 01 00 00 00 00 00 dd 1a 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 00 50 01 00 00 00 00 00 7c 57 00 00 00 00 00 00 7c 57 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 60 ab 01 00 00 00 00 00 60 bb 01 00 00 00 00 00 60 bb 01 00 00 00 00 00 68 08 00 00 00 00 00 00 c0 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 70 ab 01 00 00 00 00 00 70 bb 01 00 00 00 00 00 70 bb 01 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 40 80 01 00 00 00 00 00 40 80 01 00 00 00 00 00 40 80 01 00 00 00 00 00 fc 04 00 00 00 00 00 00 fc 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 60 ab 01 00 00 00 00 00 60 bb 01 00 00 00 00 00 60 bb 01 00 00 00 00 00 a0 04 00 00 00 00 00 00 a0 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 24 83 25 bf 0d a1 fb 60 3e c2 ca c6 64 78 ec 6a 19 fe d9 34 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 51 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 51 00 00 00 53 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c0 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 300KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_xdotool {
   strings:
      $s1 = "--args N  - how many arguments to expect in the exec command. This is" fullword ascii
      $s2 = "Unless --args OR --terminator is specified, the exec command is assumed" fullword ascii
      $s3 = "--prefix STR - use prefix for shell variables names (max 16 chars) " fullword ascii
      $s4 = "window %ld - failed to get height/width?" fullword ascii
      $s5 = "Usage: %s [options] command [arg1 arg2 ...] [terminator]" fullword ascii
      $s6 = "Exec arg[%d]: %s" fullword ascii
      $s7 = "Run '%s help' if you want a command list" fullword ascii
      $s8 = "execvp failed" fullword ascii
      $s9 = "Usage: %s [window=%1] [--shell] [--prefix <STR>]" fullword ascii
      $s10 = "Usage: %s <cmd> <args>" fullword ascii
      $s11 = "--file <filepath> - specify a file, the contents of which will be" fullword ascii
      $s12 = "Usage: %s [--shell] [--prefix <STR>]" fullword ascii
      $s13 = "--overrideredirect OVERRIDE - set override_redirect." fullword ascii
      $s14 = "window %ld - failed to get location?" fullword ascii
      $s15 = "--delay <milliseconds> - delay between keystrokes" fullword ascii
      $s16 = "Command failed." fullword ascii
      $s17 = "--sync    - only exit when the command given finishes. The default" fullword ascii
      $s18 = "--shell      - output shell variables for use with eval" fullword ascii
      $s19 = "xdo_get_active_window reported an error" fullword ascii
      $s20 = "getwindowname" fullword ascii
      $s21 = "getwindowfocus" fullword ascii
      $s22 = "getwindowgeometry" fullword ascii
      $s23 = "xdo_send_keysequence_window reported an error for string '%s'" fullword ascii
      $s24 = "Failure reading '%s': %s" fullword ascii
      $s25 = "getactivewindow" fullword ascii
      $s26 = "getwindowpid" fullword ascii
      $s27 = "getdisplaygeometry" fullword ascii
      $s28 = "%s: error: `%s' needs at least %d %s; only %d given" fullword ascii
      $s29 = "%s: error: environment variable $%s is not set." fullword ascii
      $s30 = " additional commands after it." fullword ascii
      $s31 = "Usage: %s [--sync] [window=%1]" fullword ascii
      $s32 = "--usehints  - Use window sizing hints (like font size in terminals)" fullword ascii
      $s33 = "Usage: %s [options] [window=%1]" fullword ascii
      $s34 = "--urgency URGENT - set the window's urgency hint." fullword ascii
      $s35 = "Usage: %s [window=%1]" fullword ascii
      $s36 = "--terminator TERM - similar to --args, specifies a terminator that" fullword ascii
      $s37 = "get_desktop_viewport" fullword ascii
      $s38 = "Usage: %s [options] <x> <y>" fullword ascii
      $s39 = "xdo_get_desktop_viewport" fullword ascii
      $s40 = "Usage: %s desktop" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 46 00 00 00 00 00 00 40 00 00 00 00 00 00 00 80 46 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a8 36 00 00 00 00 00 00 a8 36 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 bd 8b 00 00 00 00 00 00 bd 8b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 60 4b 00 00 00 00 00 00 60 4b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 2a 01 00 00 00 00 00 30 2a 01 00 00 00 00 00 30 2a 01 00 00 00 00 00 10 1b 00 00 00 00 00 00 68 1b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 40 2a 01 00 00 00 00 00 40 2a 01 00 00 00 00 00 40 2a 01 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 1c 0a 01 00 00 00 00 00 1c 0a 01 00 00 00 00 00 1c 0a 01 00 00 00 00 00 e4 01 00 00 00 00 00 00 e4 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 2a 01 00 00 00 00 00 30 2a 01 00 00 00 00 00 30 2a 01 00 00 00 00 00 d0 05 00 00 00 00 00 00 d0 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 93 39 73 d1 10 81 f0 1c d1 5f 78 4f 9d 74 27 5c 08 4f a4 dd 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 71 00 00 00 01 00 00 00 06 00 00 00 88 45 a1 01 00 01 1c 0a 71 00 00 00 75 00 00 00 77 00 00 00 d0 65 ce 6d ba e3 92 7c 42 45 d5 ec 29 1d 8c 1c d8 71 58 1c 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_capsh {
   strings:
      $s1 = "[E]UID match between source and target process." fullword ascii
      $s2 = "Allows a process to configure the kernel's syslog" fullword ascii
      $s3 = "Allows a process to perform privileged operations with" fullword ascii
      $s4 = "  - setting arbitrary process, and process group" fullword ascii
      $s5 = "Allows a process to block system suspends - prevent the" fullword ascii
      $s6 = "failed to get IAB for process" fullword ascii
      $s7 = "process - overriding the limitation that there be a" fullword ascii
      $s8 = "  - setting encryption key on loopback filesystem" fullword ascii
      $s9 = "  --no-new-privs set sticky process privilege limiter" fullword ascii
      $s10 = "Allows a process to override Manditory Access Control" fullword ascii
      $s11 = "failed to get process capabilities" fullword ascii
      $s12 = "Allows a process to configure process accounting." fullword ascii
      $s13 = "  - binding to any address for transparent proxying" fullword ascii
      $s14 = "Allows a process to bind to privileged ports:" fullword ascii
      $s15 = "Allows a process to manipulate aspects of the kernel" fullword ascii
      $s16 = "  - allows the forging of GID credentials passed over a" fullword ascii
      $s17 = "  - forged pids on socket credentials passing" fullword ascii
      $s18 = "  - allows the forging of UID credentials passed over a" fullword ascii
      $s19 = "  - sending raw qic-117 commands" fullword ascii
      $s20 = "Allows a process to override IPC ownership checks." fullword ascii
      $s21 = "Allows a process to perform operations on files, even" fullword ascii
      $s22 = "  - override the reserved space on ext2 filesystem" fullword ascii
      $s23 = "Allows a process to maipulate the execution priorities" fullword ascii
      $s24 = "  - override the maximum number of keymaps" fullword ascii
      $s25 = "Allows a process to override all DAC restrictions" fullword ascii
      $s26 = "Allows a process to override of all Discretionary" fullword ascii
      $s27 = "namespace. Also, permits a process to override" fullword ascii
      $s28 = "  - setting readahead and flushing buffers on block" fullword ascii
      $s29 = "  - manufacturer commands in isdn CAPI support driver" fullword ascii
      $s30 = "  - to read/write pci config on alpha" fullword ascii
      $s31 = "execve '%s' failed!" fullword ascii
      $s32 = "  - reading non-standardized portions of PCI" fullword ascii
      $s33 = "Allows a process to configure the Mandatory Access" fullword ascii
      $s34 = "Allows a process to arbitrarily change the user and" fullword ascii
      $s35 = "Allows a process to configure audit logging via a" fullword ascii
      $s36 = "  - configuration of the secure attention key" fullword ascii
      $s37 = "Allows a process to enable observability of privileged" fullword ascii
      $s38 = "Allows a process to perform network configuration" fullword ascii
      $s39 = "  - set and override resource limits" fullword ascii
      $s40 = "  - override the maximum number of consoles for console" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 64 00 00 00 00 00 00 40 00 00 00 00 00 00 00 e8 cd 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a0 33 00 00 00 00 00 00 a0 33 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 09 2c 00 00 00 00 00 00 09 2c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 04 44 00 00 00 00 00 00 04 44 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 40 bb 00 00 00 00 00 00 40 cb 00 00 00 00 00 00 40 cb 00 00 00 00 00 00 08 11 00 00 00 00 00 00 88 11 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 50 bb 00 00 00 00 00 00 50 cb 00 00 00 00 00 00 50 cb 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 08 b1 00 00 00 00 00 00 08 b1 00 00 00 00 00 00 08 b1 00 00 00 00 00 00 6c 00 00 00 00 00 00 00 6c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 40 bb 00 00 00 00 00 00 40 cb 00 00 00 00 00 00 40 cb 00 00 00 00 00 00 c0 04 00 00 00 00 00 00 c0 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 dc 0e 03 01 48 3c 30 17 4d 97 d8 bd 63 4c de 02 aa 8a ae b7 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 51 00 00 00 01 00 00 00 06 00 00 00 00 81 81 00 00 04 80 42 51 00 00 00 53 00 00 00 00 00 00 00 8e da a1 5d d1 65 ce 6d b6 af 83 fa 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 19 03 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_aria2c {
   strings:
      $s1 = "_ZN5aria219MultiUrlRequestInfo7executeEv" fullword ascii
      $s2 = "_ZN5aria26global4cerrEv" fullword ascii
      $s3 = "_ZN5aria26global11initConsoleEb" fullword ascii
      $s4 = "_ZNK5aria29Exception10stackTraceB5cxx11Ev" fullword ascii
      $s5 = "_ZNSt6vectorISt4pairINSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEES6_ESaIS7_EED2Ev" fullword ascii
      $s6 = "_ZNSt6vectorISt4pairINSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEES6_ESaIS7_EED1Ev" fullword ascii
      $s7 = "_ZN5aria27ContextD1Ev" fullword ascii
      $s8 = "_ZTIN5aria29ExceptionE" fullword ascii
      $s9 = "008ebc8780a4255b6d1fd68d5ba968443ff0c4.debug" fullword ascii
      $s10 = "_ZN5aria28PlatformC1Ev" fullword ascii
      $s11 = "libaria2.so.0" fullword ascii
      $s12 = "_ZN5aria210OutputFile6printfEPKcz" fullword ascii
      $s13 = "_ZN5aria27ContextC1EbiPPcRKSt6vectorISt4pairINSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEESA_ESaISB_EE" fullword ascii
      $s14 = "_ZN5aria28PlatformD1Ev" fullword ascii
      $s15 = "8ebc8780a4255b6d1fd68d5ba968443ff0c4" ascii
      $s16 = "008ebc8780a4255b6d1fd68d5ba968443ff0c4" ascii
      $s17 = "Exception caught" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 13 00 00 00 00 00 00 40 00 00 00 00 00 00 00 70 31 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 38 0d 00 00 00 00 00 00 38 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 d1 05 00 00 00 00 00 00 d1 05 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 64 02 00 00 00 00 00 00 64 02 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 18 2d 00 00 00 00 00 00 18 3d 00 00 00 00 00 00 18 3d 00 00 00 00 00 00 08 03 00 00 00 00 00 00 10 03 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 28 2d 00 00 00 00 00 00 28 3d 00 00 00 00 00 00 28 3d 00 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 1c 20 00 00 00 00 00 00 1c 20 00 00 00 00 00 00 1c 20 00 00 00 00 00 00 54 00 00 00 00 00 00 00 54 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 18 2d 00 00 00 00 00 00 18 3d 00 00 00 00 00 00 18 3d 00 00 00 00 00 00 e8 02 00 00 00 00 00 00 e8 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 aa 00 8e bc 87 80 a4 25 5b 6d 1f d6 8d 5b a9 68 44 3f f0 c4 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 16 00 00 00 01 00 00 00 06 00 00 00 60 00 81 00 02 01 04 04 16 00 00 00 18 00 00 00 00 00 00 00 d0 65 ce 6d a9 0e 95 0b 44 b8 38 a6 87 bc 38 a6 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 78 02 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 40KB and
      8 of them and $magic
}

rule gtfobins_binaries_xmore {
   strings:
      $s1 = "sessionShellWidgetClass" fullword ascii
      $s2 = "usage: %s [ x options ] filename" fullword ascii
      $s3 = "*text.baseTranslations: #override \\n\\" fullword ascii
      $s4 = "XtRealizeWidget" fullword ascii
      $s5 = "XtCreateManagedWidget" fullword ascii
      $s6 = "*text.Translations: #override \\n\\" fullword ascii
      $s7 = "textfont" fullword ascii
      $s8 = "commandWidgetClass" fullword ascii
      $s9 = "*textfont: -adobe-courier-medium-r-normal--12-*-*-*-*-*,-*-*-*-*-*-*-12-*-*-*-*-*" fullword ascii
      $s10 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/x11-apps.debug" fullword ascii
      $s11 = "XtWidgetToApplicationContext" fullword ascii
      $s12 = "XtGetApplicationResources" fullword ascii
      $s13 = "formWidgetClass" fullword ascii
      $s14 = "asciiTextWidgetClass" fullword ascii
      $s15 = "scrollHorizontal" fullword ascii
      $s16 = "libXaw.so.7" fullword ascii
      $s17 = "fromVert" fullword ascii
      $s18 = "XtAppMainLoop" fullword ascii
      $s19 = "XtAppAddActions" fullword ascii
      $s20 = "XtStrings" fullword ascii
      $s21 = "*verbose" fullword ascii
      $s22 = "XtAppSetExitFlag" fullword ascii
      $s23 = "-adobe-courier-medium-r-normal--12-*-*-*-*-*,-*-*-*-*-*-*-12-*-*-*-*-*" fullword ascii
      $s24 = "fromHoriz" fullword ascii
      $s25 = "*international: True" fullword ascii
      $s26 = "2770f00a4f602d62bae2e14a7f77677f63cea9.debug" fullword ascii
      $s27 = "XtSetLanguageProc" fullword ascii
      $s28 = "libXt.so.6" fullword ascii
      $s29 = "<Key>E:         scroll-one-line-up()\\n\\" fullword ascii
      $s30 = "<Key>space:     next-page()\\n\\" fullword ascii
      $s31 = "<Key>F:         next-page()\\n\\" fullword ascii
      $s32 = "<Key>q:         quit()\\n" fullword ascii
      $s33 = "<Key>Y:         scroll-one-line-down()\\n\\" fullword ascii
      $s34 = "<Key>B:         previous-page()\\n\\" fullword ascii
      $s35 = "<Key>Return:    scroll-one-line-up()\\n\\" fullword ascii
      $s36 = "Ctrl<Key>S:     no-op(RingBell)\\n\\" fullword ascii
      $s37 = "Ctrl<Key>R:     no-op(RingBell)\\n\\" fullword ascii
      $s38 = "<Key>K:         scroll-one-line-down()\\n\\" fullword ascii
      $s39 = "<Key>J:         scroll-one-line-up()\\n\\" fullword ascii
      $s40 = "Ctrl<Key>B:     previous-page()\\n\\" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 13 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 43 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 68 0d 00 00 00 00 00 00 68 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 d5 04 00 00 00 00 00 00 d5 04 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 dc 05 00 00 00 00 00 00 dc 05 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 33 00 00 00 00 00 00 50 33 00 00 00 00 00 00 50 33 00 00 00 00 00 00 10 0e 00 00 00 00 00 00 a0 0e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c0 3d 00 00 00 00 00 00 c0 3d 00 00 00 00 00 00 c0 3d 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 a0 24 00 00 00 00 00 00 a0 24 00 00 00 00 00 00 a0 24 00 00 00 00 00 00 3c 00 00 00 00 00 00 00 3c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 33 00 00 00 00 00 00 50 33 00 00 00 00 00 00 50 33 00 00 00 00 00 00 b0 0c 00 00 00 00 00 00 b0 0c 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 8d 27 70 f0 0a 4f 60 2d 62 ba e2 e1 4a 7f 77 67 7f 63 ce a9 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 13 00 00 00 01 00 00 00 06 00 00 00 88 61 a9 09 02 20 08 48 13 00 00 00 18 00 00 00 1b 00 00 00 fa 5c 2d 26 42 45 d5 ec ba e3 92 7c fe 60 30 7f d1 65 ce 6d d8 71 58 1c 12 82 9e 84 5b 53 ba 16 6d 88 4e 15 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 60KB and
      8 of them and $magic
}

rule gtfobins_binaries_xargs {
   strings:
      $s1 = "Execution of xargs will continue now, and it will try to read its input and run commands; if this is not what you wanted to happ" ascii
      $s2 = "failed to redirect standard input of the child process" fullword ascii
      $s3 = "  -t, --verbose                print commands before executing them" fullword ascii
      $s4 = "errno-buffer safe_read failed in xargs_do_exec (this is probably a bug, please report it)" fullword ascii
      $s5 = "File descriptor %d will leak; please report this as a bug, remembering to include a detailed description of the simplest way to " ascii
      $s6 = "                                 before executing the command; useful to run an" fullword ascii
      $s7 = "Usage: %s [OPTION]... COMMAND [INITIAL-ARGS]..." fullword ascii
      $s8 = "  -o, --open-tty               Reopen stdin as /dev/tty in the child process" fullword ascii
      $s9 = "  -p, --interactive            prompt before running commands" fullword ascii
      $s10 = "  -P, --max-procs=MAX-PROCS    run at most MAX-PROCS processes at a time" fullword ascii
      $s11 = "      --process-slot-var=VAR   set environment variable VAR in child processes" fullword ascii
      $s12 = "  -r, --no-run-if-empty        if there are no arguments, then do not run COMMAND;" fullword ascii
      $s13 = "%s: invalid number \"%s\" for -%c option" fullword ascii
      $s14 = "%s: value %s for -%c option should be <= %ld" fullword ascii
      $s15 = "%s: value %s for -%c option should be >= %ld" fullword ascii
      $s16 = "warning: the -E option has no effect if -0 or -d is used." fullword ascii
      $s17 = "Maximum length of command we could actually use: %lu" fullword ascii
      $s18 = "                                 disables quote and backslash processing and" fullword ascii
      $s19 = "  -s, --max-chars=MAX-CHARS    limit length of command line to MAX-CHARS" fullword ascii
      $s20 = "  -n, --max-args=MAX-ARGS      use at most MAX-ARGS arguments per command line" fullword ascii
      $s21 = "      --show-limits            show limits on command-line length" fullword ascii
      $s22 = "https://savannah.gnu.org/bugs/?group=findutils" fullword ascii
      $s23 = "program via the %s bug-reporting page at" fullword ascii
      $s24 = "https://www.gnu.org/software/findutils/" fullword ascii
      $s25 = "Failed to read from stdin" fullword ascii
      $s26 = "read returned unexpected value %lu; this is probably a bug, please report it" fullword ascii
      $s27 = "                                 command line" fullword ascii
      $s28 = "buildcmd.c" fullword ascii
      $s29 = "WARNING: a NUL character occurred in the input.  It cannot be passed through in the argument list.  Did you mean to use the --nu" ascii
      $s30 = "you have no web access, by sending email to <%s>." fullword ascii
      $s31 = "                                 (ignored if -0 or -d was specified)" fullword ascii
      $s32 = "The atexit library function failed" fullword ascii
      $s33 = "Please see also the documentation at %s." fullword ascii
      $s34 = "Failed to write to stderr" fullword ascii
      $s35 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/findutils.debug" fullword ascii
      $s36 = "                                 if this option is not given, COMMAND will be" fullword ascii
      $s37 = "en, please type the end-of-file keystroke." fullword ascii
      $s38 = "warning: options %s and %s are mutually exclusive, ignoring previous %s value" fullword ascii
      $s39 = "                                 processing and logical EOF processing" fullword ascii
      $s40 = "  -i, --replace[=R]            replace R in INITIAL-ARGS with names read" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 35 00 00 00 00 00 00 40 00 00 00 00 00 00 00 48 22 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 88 1e 00 00 00 00 00 00 88 1e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 69 a4 00 00 00 00 00 00 69 a4 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 00 d0 00 00 00 00 00 00 90 47 00 00 00 00 00 00 90 47 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 18 01 00 00 00 00 00 70 28 01 00 00 00 00 00 70 28 01 00 00 00 00 00 30 08 00 00 00 00 00 00 90 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 38 1b 01 00 00 00 00 00 38 2b 01 00 00 00 00 00 38 2b 01 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 48 f8 00 00 00 00 00 00 48 f8 00 00 00 00 00 00 48 f8 00 00 00 00 00 00 fc 04 00 00 00 00 00 00 fc 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 18 01 00 00 00 00 00 70 28 01 00 00 00 00 00 70 28 01 00 00 00 00 00 90 07 00 00 00 00 00 00 90 07 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 32 68 6f 11 c3 ed 8e e6 9b 66 b7 ba 4e e2 7b 03 14 2f 74 f6 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 56 00 00 00 02 00 00 00 07 00 00 00 22 01 40 00 52 01 0c 1e 30 48 09 02 a0 04 08 00 56 00 00 00 5a 00 00 00 61 00 00 00 28 1d 8c 1c c4 89 05 90 a6 dd a3 6b d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 c4 b9 9c 40 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_yelp {
   strings:
      $s1 = "yelp.cfg" fullword ascii
      $s2 = "win.yelp-view-go-forward" fullword ascii
      $s3 = "libjavascriptcoregtk-4.1.so.0" fullword ascii
      $s4 = "%s:%d: invalid %s id %u for \"%s\" of type '%s' in '%s'" fullword ascii
      $s5 = "gtk_widget_get_style_context" fullword ascii
      $s6 = "gtk_widget_set_valign" fullword ascii
      $s7 = "gtk_revealer_get_reveal_child" fullword ascii
      $s8 = "yelp_settings_get_default" fullword ascii
      $s9 = "yelp_uri_get_file" fullword ascii
      $s10 = "hdy_header_bar_new" fullword ascii
      $s11 = "hdy_header_bar_pack_start" fullword ascii
      $s12 = "webkit_web_view_get_find_controller" fullword ascii
      $s13 = "yelp_window_get_uri" fullword ascii
      $s14 = "hdy_style_manager_get_default" fullword ascii
      $s15 = "hdy_header_bar_set_show_close_button" fullword ascii
      $s16 = "gdk_x11_get_server_time" fullword ascii
      $s17 = "yelp_uri_get_document_uri" fullword ascii
      $s18 = "gtk_search_bar_get_search_mode" fullword ascii
      $s19 = "yelp_bookmarks_get_type" fullword ascii
      $s20 = "hdy_header_bar_set_title" fullword ascii
      $s21 = "hdy_header_bar_set_subtitle" fullword ascii
      $s22 = "hdy_header_bar_get_custom_title" fullword ascii
      $s23 = "yelp_window_get_type" fullword ascii
      $s24 = "gdk_x11_window_get_type" fullword ascii
      $s25 = "yelp_window_get_geometry" fullword ascii
      $s26 = "hdy_header_bar_set_custom_title" fullword ascii
      $s27 = "hdy_header_bar_pack_end" fullword ascii
      $s28 = "win.yelp-view-go-back" fullword ascii
      $s29 = "e1d18d5790408acbfc4588375c7b97d8cfc70a.debug" fullword ascii
      $s30 = "win.yelp-view-go-next" fullword ascii
      $s31 = "win.yelp-view-go-previous" fullword ascii
      $s32 = "user-bookmarks-symbolic" fullword ascii
      $s33 = "win.yelp-view-print" fullword ascii
      $s34 = "win.yelp-window-go-all" fullword ascii
      $s35 = "win.yelp-window-close" fullword ascii
      $s36 = "win.yelp-window-find" fullword ascii
      $s37 = "win.yelp-window-ctrll" fullword ascii
      $s38 = "org.gnome.yelp.documents" fullword ascii
      $s39 = "win.yelp-window-search" fullword ascii
      $s40 = "org.gnome.Yelp" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 5e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 58 d1 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f0 4d 00 00 00 00 00 00 f0 4d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 09 4d 00 00 00 00 00 00 09 4d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 c8 19 00 00 00 00 00 00 c8 19 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 c4 00 00 00 00 00 00 70 c4 00 00 00 00 00 00 70 c4 00 00 00 00 00 00 a0 0b 00 00 00 00 00 00 e8 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 10 c5 00 00 00 00 00 00 10 c5 00 00 00 00 00 00 10 c5 00 00 00 00 00 00 80 03 00 00 00 00 00 00 80 03 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 70 a9 00 00 00 00 00 00 70 a9 00 00 00 00 00 00 70 a9 00 00 00 00 00 00 64 02 00 00 00 00 00 00 64 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 c4 00 00 00 00 00 00 70 c4 00 00 00 00 00 00 70 c4 00 00 00 00 00 00 90 0b 00 00 00 00 00 00 90 0b 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 85 e1 d1 8d 57 90 40 8a cb fc 45 88 37 5c 7b 97 d8 cf c7 0a 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 31 00 00 00 e9 00 00 00 04 00 00 00 08 00 00 00 82 90 00 80 b4 40 84 34 28 0a 40 08 00 24 10 a0 00 08 04 40 1f 20 00 1a 00 02 55 03 20 00 02 00 00 00 00 00 e9 00 00 00 ea 00 00 00 00 00 00 00 eb 00 00 00 ed 00 00 00 00 00 00 00 ee 00 00 00 ef 00 00 00 f0 00 00 00 f2 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_ar {
   strings:
      $s1 = "  --target=BFDNAME - specify the target object format as BFDNAME" fullword ascii
      $s2 = "  --output=DIRNAME - specify the output directory for extraction operations" fullword ascii
      $s3 = "bfd_set_default_target" fullword ascii
      $s4 = "bfd_find_target" fullword ascii
      $s5 = "bfd_target_list" fullword ascii
      $s6 = "%s: Can't open temporary file (%s)" fullword ascii
      $s7 = "  [l <text> ]  - specify the dependencies of this library" fullword ascii
      $s8 = "  [u]          - only replace files that are newer than current archive contents" fullword ascii
      $s9 = "       %s -M [<mri-script]" fullword ascii
      $s10 = "`u' is not meaningful with the `D' option - replacement will always happen." fullword ascii
      $s11 = "  t[O][v]      - display contents of the archive" fullword ascii
      $s12 = "  r[ab][f][u]  - replace existing or insert new file(s) into the archive" fullword ascii
      $s13 = " commands:" fullword ascii
      $s14 = "  --plugin <p> - load the specified plugin" fullword ascii
      $s15 = "  --record-libdeps=<text> - specify the dependencies of this library" fullword ascii
      $s16 = " command specific modifiers:" fullword ascii
      $s17 = "  [V]          - display the version number" fullword ascii
      $s18 = "<https://sourceware.org/bugzilla/>" fullword ascii
      $s19 = "  @<file>      - read options from <file>" fullword ascii
      $s20 = "  -v --version                 Print version information" fullword ascii
      $s21 = "{\"type\":\"deb\",\"os\":\"debian\",\"name\":\"binutils\",\"version\":\"2.42.90.20240720-2\",\"architecture\":\"amd64\"}" fullword ascii
      $s22 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/binutils-x86-64-linux-gnu.debug" fullword ascii
      $s23 = "%s: error: @-file refers to a directory" fullword ascii
      $s24 = "illegal output pathname for archive member: %s, using '%s' instead" fullword ascii
      $s25 = "bfd_get_error" fullword ascii
      $s26 = "fatal error: libbfd ABI mismatch" fullword ascii
      $s27 = "  d            - delete file(s) from the archive" fullword ascii
      $s28 = "  [D]          - use zero for timestamps and uids/gids (default)" fullword ascii
      $s29 = "libbfd-2.42.90-system.20240720.so" fullword ascii
      $s30 = "  [b]          - put file(s) before [member-name] (same as [i])" fullword ascii
      $s31 = "  q[f]         - quick append file(s) to the archive" fullword ascii
      $s32 = "  [s]          - create an archive index (cf. ranlib)" fullword ascii
      $s33 = "  [o]          - preserve original dates" fullword ascii
      $s34 = "  x[o]         - extract file(s) from the archive" fullword ascii
      $s35 = "  --thin       - make a thin archive" fullword ascii
      $s36 = "  [N]          - use instance [count] of name" fullword ascii
      $s37 = "  m[ab]        - move file(s) in the archive" fullword ascii
      $s38 = "bfd_make_readable" fullword ascii
      $s39 = "  [c]          - do not warn if the library had to be created" fullword ascii
      $s40 = "  [U]          - use actual timestamps and uids/gids" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 50 5d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 80 c5 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 88 1d 00 00 00 00 00 00 88 1d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 4d 5c 00 00 00 00 00 00 4d 5c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 94 39 00 00 00 00 00 00 94 39 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 88 bd 00 00 00 00 00 00 88 cd 00 00 00 00 00 00 88 cd 00 00 00 00 00 00 78 06 00 00 00 00 00 00 d8 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 98 bd 00 00 00 00 00 00 98 cd 00 00 00 00 00 00 98 cd 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 bc 00 00 00 00 00 00 00 bc 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 20 ac 00 00 00 00 00 00 20 ac 00 00 00 00 00 00 20 ac 00 00 00 00 00 00 3c 02 00 00 00 00 00 00 3c 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 88 bd 00 00 00 00 00 00 88 cd 00 00 00 00 00 00 88 cd 00 00 00 00 00 00 78 02 00 00 00 00 00 00 78 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 95 60 db 78 3f 7b 0a 6a e7 b6 cd cb a2 e1 aa 96 3f f1 6c 50 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 68 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 64 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 62 69 6e 75 74 69 6c 73 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 32 2e 39 30 2e 32 30 32 34 30 37 32 30 2d 32 22 2c 22 61 72 63 68 69 74}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_join {
   strings:
      $s1 = "or use \"join -t ''\" if 'sort' has no options." fullword ascii
      $s2 = "E.g., use \"sort -k 1b,1\" if 'join' has no options," fullword ascii
      $s3 = "When FILE1 or FILE2 (not both) is -, read standard input." fullword ascii
      $s4 = "      --header           treat the first line in each file as field headers," fullword ascii
      $s5 = "  -z, --zero-terminated  line delimiter is NUL, not newline" fullword ascii
      $s6 = "  -e STRING              replace missing (empty) input fields with STRING;" fullword ascii
      $s7 = "  -a FILENUM             also print unpairable lines from file FILENUM, where" fullword ascii
      $s8 = "  -o FORMAT              obey FORMAT while constructing output line" fullword ascii
      $s9 = "  -t CHAR                use CHAR as input and output field separator" fullword ascii
      $s10 = "Note, comparisons honor the rules specified by 'LC_COLLATE'." fullword ascii
      $s11 = "  -j FIELD               equivalent to '-1 FIELD -2 FIELD'" fullword ascii
      $s12 = "incompatible join fields %td, %td" fullword ascii
      $s13 = "  -v FILENUM             like -a FILENUM, but suppress joined output lines" fullword ascii
      $s14 = "%s:%lu: is not sorted: %.*s" fullword ascii
      $s15 = "input is not in sorted order" fullword ascii
      $s16 = "b6df84b5f8b1196f345a26e805215755cd301f.debug" fullword ascii
      $s17 = "separated by CHAR.  If FORMAT is the keyword 'auto', then the first" fullword ascii /* Goodware String - occured 1 times */
      $s18 = "standard output.  The default join field is the first, delimited by blanks." fullword ascii
      $s19 = "each being 'FILENUM.FIELD' or '0'.  Default FORMAT outputs the join field," fullword ascii
      $s20 = "If the input is not sorted and some lines cannot be joined, a" fullword ascii /* Goodware String - occured 1 times */
      $s21 = "line of each file determines the number of fields output for each line." fullword ascii /* Goodware String - occured 1 times */
      $s22 = "warning message will be given." fullword ascii /* Goodware String - occured 1 times */
      $s23 = "Unless -t CHAR is given, leading blanks separate fields and are ignored," fullword ascii /* Goodware String - occured 2 times */
      $s24 = "invalid field specifier: %s" fullword ascii /* Goodware String - occured 2 times */
      $s25 = "  -1 FIELD               join on this FIELD of file 1" fullword ascii
      $s26 = "      --check-order      check that the input is correctly sorted, even" fullword ascii
      $s27 = "  -2 FIELD               join on this FIELD of file 2" fullword ascii
      $s28 = "from 1.  FORMAT is one or more comma or blank separated specifications," fullword ascii /* Goodware String - occured 2 times */
      $s29 = "invalid file number in field spec: %s" fullword ascii /* Goodware String - occured 2 times */
      $s30 = "the remaining fields from FILE1, the remaining fields from FILE2, all" fullword ascii /* Goodware String - occured 2 times */
      $s31 = "invalid field number: %s" fullword ascii /* Goodware String - occured 2 times */
      $s32 = "      --nocheck-order    do not check that the input is correctly sorted" fullword ascii
      $s33 = "nocheck-order" fullword ascii /* Goodware String - occured 2 times */
      $s34 = "For each pair of input lines with identical join fields, write a line to" fullword ascii /* Goodware String - occured 2 times */
      $s35 = "Important: FILE1 and FILE2 must be sorted on the join fields." fullword ascii /* Goodware String - occured 2 times */
      $s36 = "conflicting empty-field replacement strings" fullword ascii /* Goodware String - occured 2 times */
      $s37 = "D$0t8H" fullword ascii /* Goodware String - occured 2 times */
      $s38 = "both files cannot be standard input" fullword ascii /* Goodware String - occured 2 times */
      $s39 = "else fields are separated by CHAR.  Any FIELD is a field number counted" fullword ascii /* Goodware String - occured 2 times */
      $s40 = "  -i, --ignore-case      ignore differences in case when comparing fields" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 32 00 00 00 00 00 00 40 00 00 00 00 00 00 00 50 e4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 50 19 00 00 00 00 00 00 50 19 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 79 73 00 00 00 00 00 00 79 73 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 c0 31 00 00 00 00 00 00 c0 31 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 dc 00 00 00 00 00 00 70 ec 00 00 00 00 00 00 70 ec 00 00 00 00 00 00 30 06 00 00 00 00 00 00 d8 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 dd 00 00 00 00 00 00 d8 ed 00 00 00 00 00 00 d8 ed 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 b8 b8 00 00 00 00 00 00 b8 b8 00 00 00 00 00 00 b8 b8 00 00 00 00 00 00 fc 03 00 00 00 00 00 00 fc 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 dc 00 00 00 00 00 00 70 ec 00 00 00 00 00 00 70 ec 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 03 b6 df 84 b5 f8 b1 19 6f 34 5a 26 e8 05 21 57 55 cd 30 1f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 44 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 44 00 00 00 46 00 00 00 4c 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_comm {
   strings:
      $s1 = "When FILE1 or FILE2 (not both) is -, read standard input." fullword ascii
      $s2 = "  %s -12 file1 file2  Print only lines present in both file1 and file2." fullword ascii
      $s3 = "  %s -3 file1 file2  Print lines in file1 not in file2, and vice versa." fullword ascii
      $s4 = "Note, comparisons honor the rules specified by 'LC_COLLATE'." fullword ascii
      $s5 = "input is not in sorted order" fullword ascii
      $s6 = "multiple output delimiters specified" fullword ascii
      $s7 = "%s%s%s%s%s%s%s%c" fullword ascii
      $s8 = "file %d is not in sorted order" fullword ascii /* Goodware String - occured 1 times */
      $s9 = "%s%c%s%c%s%c%s%c" fullword ascii /* Goodware String - occured 1 times */
      $s10 = "c0a616c65b9c3723974b0048e99de93fa2bc78.debug" fullword ascii
      $s11 = "nocheck-order" fullword ascii /* Goodware String - occured 2 times */
      $s12 = "  -z, --zero-terminated   line delimiter is NUL, not newline" fullword ascii
      $s13 = "      --output-delimiter=STR  separate columns with STR" fullword ascii
      $s14 = "  -2                      suppress column 2 (lines unique to FILE2)" fullword ascii
      $s15 = "With no options, produce three-column output.  Column one contains" fullword ascii /* Goodware String - occured 2 times */
      $s16 = "lines unique to FILE1, column two contains lines unique to FILE2," fullword ascii /* Goodware String - occured 2 times */
      $s17 = "Compare sorted files FILE1 and FILE2 line by line." fullword ascii /* Goodware String - occured 2 times */
      $s18 = "      --nocheck-order     do not check that the input is correctly sorted" fullword ascii
      $s19 = "and column three contains lines common to both files." fullword ascii /* Goodware String - occured 2 times */
      $s20 = "  -3                      suppress column 3 (lines that appear in both files)" fullword ascii
      $s21 = "      --check-order       check that the input is correctly sorted, even" fullword ascii
      $s22 = "  -1                      suppress column 1 (lines unique to FILE1)" fullword ascii
      $s23 = "      --total             output a summary" fullword ascii
      $s24 = "output-delimiter" fullword ascii /* Goodware String - occured 3 times */
      $s25 = "D$+A8G" fullword ascii
      $s26 = "                            if all input lines are pairable" fullword ascii
      $s27 = "48e99de93fa2bc78" ascii
      $s28 = "c0a616c65b9c3723974b" ascii
      $s29 = "c0a616c65b9c3723974b0048e99de93fa2bc78" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 10 27 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 b4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 68 17 00 00 00 00 00 00 68 17 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 19 56 00 00 00 00 00 00 19 56 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 d0 26 00 00 00 00 00 00 d0 26 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 ac 00 00 00 00 00 00 70 bc 00 00 00 00 00 00 70 bc 00 00 00 00 00 00 f0 05 00 00 00 00 00 00 b8 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ad 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 b0 90 00 00 00 00 00 00 b0 90 00 00 00 00 00 00 b0 90 00 00 00 00 00 00 ac 03 00 00 00 00 00 00 ac 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 ac 00 00 00 00 00 00 70 bc 00 00 00 00 00 00 70 bc 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 59 c0 a6 16 c6 5b 9c 37 23 97 4b 00 48 e9 9d e9 3f a2 bc 78 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 3c 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 3c 00 00 00 3e 00 00 00 44 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_uniq {
   strings:
      $s1 = "grouping and printing repeat counts is meaningless" fullword ascii
      $s2 = "--group is mutually exclusive with -c/-d/-D/-u" fullword ascii
      $s3 = "You may want to sort the input first, or use 'sort -u' without 'uniq'." fullword ascii
      $s4 = "  -w, --check-chars=N   compare no more than N characters in lines" fullword ascii
      $s5 = "  -s, --skip-chars=N    avoid comparing the first N characters" fullword ascii
      $s6 = "  -f, --skip-fields=N   avoid comparing the first N fields" fullword ascii
      $s7 = "49535ed5c1f3190150bec0ee8fb8d213678e48.debug" fullword ascii
      $s8 = "Note: 'uniq' does not detect repeated lines unless they are adjacent." fullword ascii /* Goodware String - occured 1 times */
      $s9 = "With no options, matching lines are merged to the first occurrence." fullword ascii /* Goodware String - occured 1 times */
      $s10 = "characters.  Fields are skipped before chars." fullword ascii /* Goodware String - occured 1 times */
      $s11 = "A field is a run of blanks (usually spaces and/or TABs), then non-blank" fullword ascii /* Goodware String - occured 1 times */
      $s12 = "Filter adjacent matching lines from INPUT (or standard input)," fullword ascii /* Goodware String - occured 1 times */
      $s13 = "-0123456789Dcdf:is:uw:z" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "writing to OUTPUT (or standard output)." fullword ascii /* Goodware String - occured 1 times */
      $s15 = "  -z, --zero-terminated     line delimiter is NUL, not newline" fullword ascii
      $s16 = "invalid number of bytes to skip" fullword ascii /* Goodware String - occured 2 times */
      $s17 = "invalid number of bytes to compare" fullword ascii /* Goodware String - occured 2 times */
      $s18 = "      --all-repeated[=METHOD]  like -D, but allow separating groups" fullword ascii
      $s19 = "  -c, --count           prefix lines by the number of occurrences" fullword ascii
      $s20 = "      --group[=METHOD]  show all items, separating groups with an empty line;" fullword ascii
      $s21 = "check-chars" fullword ascii /* Goodware String - occured 2 times */
      $s22 = "  -u, --unique          only print unique lines" fullword ascii
      $s23 = "skip-fields" fullword ascii /* Goodware String - occured 2 times */
      $s24 = "invalid number of fields to skip" fullword ascii /* Goodware String - occured 2 times */
      $s25 = "printing all duplicated lines and repeat counts is meaningless" fullword ascii /* Goodware String - occured 2 times */
      $s26 = "Usage: %s [OPTION]... [INPUT [OUTPUT]]" fullword ascii /* Goodware String - occured 2 times */
      $s27 = "--all-repeated" fullword ascii /* Goodware String - occured 2 times */
      $s28 = "skip-chars" fullword ascii /* Goodware String - occured 2 times */
      $s29 = "  -i, --ignore-case     ignore differences in case when comparing" fullword ascii
      $s30 = "D$+A8G" fullword ascii
      $s31 = ")D$pE1" fullword ascii
      $s32 = "--group" fullword ascii
      $s33 = "0123456789Dcdf" ascii
      $s34 = "49535ed5c1f3190150bec0ee8fb8d213678e48" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 2e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 30 b4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 98 19 00 00 00 00 00 00 98 19 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 79 5c 00 00 00 00 00 00 79 5c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 f8 2a 00 00 00 00 00 00 f8 2a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 ab 00 00 00 00 00 00 50 bb 00 00 00 00 00 00 50 bb 00 00 00 00 00 00 30 07 00 00 00 00 00 00 10 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ad 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d4 94 00 00 00 00 00 00 d4 94 00 00 00 00 00 00 d4 94 00 00 00 00 00 00 b4 03 00 00 00 00 00 00 b4 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 ab 00 00 00 00 00 00 50 bb 00 00 00 00 00 00 50 bb 00 00 00 00 00 00 b0 04 00 00 00 00 00 00 b0 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 8c 49 53 5e d5 c1 f3 19 01 50 be c0 ee 8f b8 d2 13 67 8e 48 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 40 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 40 00 00 00 42 00 00 00 48 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_chmod {
   strings:
      $s1 = "  -v, --verbose          output a diagnostic for every file processed" fullword ascii
      $s2 = "      --preserve-root    fail to operate recursively on '/'" fullword ascii
      $s3 = "  -f, --silent, --quiet  suppress most error messages" fullword ascii
      $s4 = "  or:  %s [OPTION]... --reference=RFILE FILE..." fullword ascii
      $s5 = "      --no-preserve-root  do not treat '/' specially (the default)" fullword ascii
      $s6 = "  -c, --changes          like verbose but report only when a change is made" fullword ascii
      $s7 = "lib/cycle-check.c" fullword ascii
      $s8 = "state->magic == 9827862" fullword ascii
      $s9 = "Rcfvr::w::x::X::s::t::u::g::o::a::,::+::=::0::1::2::3::4::5::6::7::" fullword ascii
      $s10 = "cannot operate on dangling symlink %s" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "failed to change mode of %s from %04lo (%s) to %04lo (%s)" fullword ascii /* Goodware String - occured 1 times */
      $s12 = "mode of %s changed from %04lo (%s) to %04lo (%s)" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "%s could not be accessed" fullword ascii
      $s14 = "With --reference, change the mode of each FILE to that of RFILE." fullword ascii /* Goodware String - occured 1 times */
      $s15 = "Each MODE is of the form '[ugoa]*([-+=]([rwxXst]*|[ugo]))+|[-+=][0-7]+'." fullword ascii
      $s16 = "5f82223dc28b4031a0644012f8b5579f9be2a1.debug" fullword ascii
      $s17 = "%s: new permissions are %s, not %s" fullword ascii /* Goodware String - occured 2 times */
      $s18 = "      --reference=RFILE  use RFILE's mode instead of specifying MODE values." fullword ascii
      $s19 = "  -R, --recursive        change files and directories recursively" fullword ascii
      $s20 = "cannot combine mode and --reference options" fullword ascii /* Goodware String - occured 2 times */
      $s21 = "invalid mode: %s" fullword ascii /* Goodware String - occured 2 times */
      $s22 = "changing permissions of %s" fullword ascii /* Goodware String - occured 3 times */
      $s23 = "mode of %s retained as %04lo (%s)" fullword ascii /* Goodware String - occured 3 times */
      $s24 = "getting new attributes of %s" fullword ascii /* Goodware String - occured 3 times */
      $s25 = "  or:  %s [OPTION]... OCTAL-MODE FILE..." fullword ascii
      $s26 = "Usage: %s [OPTION]... MODE[,MODE]... FILE..." fullword ascii /* Goodware String - occured 3 times */
      $s27 = "Change the mode of each FILE to MODE." fullword ascii /* Goodware String - occured 4 times */
      $s28 = "H=OAFSt" fullword ascii
      $s29 = "L$HL9m0tFM" fullword ascii
      $s30 = "lib/xfts.c" fullword ascii
      $s31 = "I9T$8s/H" fullword ascii
      $s32 = "H9Cpu|L" fullword ascii
      $s33 = "5f82223dc28b4031a0644012f8b5579f9be2a1" ascii
      $s34 = "(*__errno_location ()) != 22" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 31 00 00 00 00 00 00 40 00 00 00 00 00 00 00 30 04 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b0 18 00 00 00 00 00 00 b0 18 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 a9 93 00 00 00 00 00 00 a9 93 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 48 34 00 00 00 00 00 00 48 34 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 fc 00 00 00 00 00 00 10 0c 01 00 00 00 00 00 10 0c 01 00 00 00 00 00 70 06 00 00 00 00 00 00 58 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 fd 00 00 00 00 00 00 d8 0d 01 00 00 00 00 00 d8 0d 01 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 ec d3 00 00 00 00 00 00 ec d3 00 00 00 00 00 00 ec d3 00 00 00 00 00 00 84 05 00 00 00 00 00 00 84 05 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 fc 00 00 00 00 00 00 10 0c 01 00 00 00 00 00 10 0c 01 00 00 00 00 00 f0 03 00 00 00 00 00 00 f0 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 4a 5f 82 22 3d c2 8b 40 31 a0 64 40 12 f8 b5 57 9f 9b e2 a1 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 41 00 00 00 01 00 00 00 06 00 00 00 84 4d c1 00 20 01 1c 12 41 00 00 00 43 00 00 00 49 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 86 f0 96 7c 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_cowthink {
   strings:
      $s1 = "## One of these days, we'll get it ported to Windows.  Yeah, right." fullword ascii
      $s2 = "Usage: $progname [-bdgpstwy] [-h] [-e eyes] [-f cowfile] " fullword ascii
      $s3 = "## Get a cow from the specified cowfile; otherwise use the default cow" fullword ascii
      $s4 = "## Yeah, this is rude, I know.  But hopefully it gets around a nasty" fullword ascii
      $s5 = "## little version dependency." fullword ascii
      $s6 = "## Cowsay 3.03" fullword ascii
      $s7 = "print \"Cow files in $d:\\n\";" fullword ascii
      $s8 = "getopts('bde:f:ghlLnNpstT:wW:y', \\%opts);" fullword ascii
      $s9 = "$eyes = \"oo\";" fullword ascii
      $s10 = "&display_usage if $opts{'n'};" fullword ascii
      $s11 = "&display_usage if $opts{'h'};" fullword ascii
      $s12 = "sub display_usage {" fullword ascii
      $s13 = "$eyes = substr($opts{'e'}, 0, 2);" fullword ascii
      $s14 = "##  maxlength patch from Jeronimo Pellegrini (Closes: #165218)" fullword ascii
      $s15 = "## Many perls, eek!" fullword ascii
      $s16 = "# Thanks, perldelta." fullword ascii
      $s17 = "## which was defined above in $the_cow." fullword ascii
      $s18 = "## up-left, up-right, down-left, down-right, left, right" fullword ascii
      $s19 = "## This file is part of cowsay.  (c) 1999-2000 Tony Monroe." fullword ascii
      $s20 = "## border space fudge." fullword ascii
      $s21 = "## no trailing spaces (#276144)" fullword ascii
      $s22 = "# $l = mbswidth $i;" fullword ascii
      $s23 = "$version = \"3.03\";" fullword ascii
      $s24 = "$full = \"$d/$f.cow\";" fullword ascii
      $s25 = "closedir(COWDIR);" fullword ascii
      $s26 = "@message[1 .. $#message - 1])," fullword ascii
      $s27 = "    $str . ' ' x ($columns - mbswidth $str)" fullword ascii
      $s28 = "'default.cow'," fullword ascii
      $s29 = "$cowpath = $ENV{'COWPATH'} || '/usr/share/cowsay/cows';" fullword ascii
      $s30 = "cow{say,think} version $version, (c) 1999 Tony Monroe" fullword ascii
      $s31 = "for my $file (readdir COWDIR) {" fullword ascii
      $s32 = "chomp(@message = <STDIN>);" fullword ascii
      $s33 = "sub get_cow {" fullword ascii
      $s34 = "&get_cow;" fullword ascii
      $s35 = "    binmode STDIN, ':utf8';" fullword ascii
      $s36 = "@dirfiles = ();" fullword ascii
      $s37 = "@border = qw[ ( ) ( ) ( ) ];" fullword ascii
      $s38 = "$thoughts = '\\\\';" fullword ascii
      $s39 = "use Text::Tabs qw(expand);" fullword ascii
      $s40 = "$Text::Wrap::initial_tab = 8;" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 65 72 6c 0a 0a 23 23 0a 23 23 20 43 6f 77 73 61 79 20 33 2e 30 33 0a 23 23 0a 23 23 20 54 68 69 73 20 66 69 6c 65 20 69 73 20 70 61 72 74 20 6f 66 20 63 6f 77 73 61 79 2e 20 20 28 63 29 20 31 39 39 39 2d 32 30 30 30 20 54 6f 6e 79 20 4d 6f 6e 72 6f 65 2e 0a 23 23 0a 0a 75 73 65 20 54 65 78 74 3a 3a 54 61 62 73 20 71 77 28 65 78 70 61 6e 64 29 3b 0a 75 73 65 20 54 65 78 74 3a 3a 57 72 61 70 20 71 77 28 77 72 61 70 20 66 69 6c 6c 20 24 63 6f 6c 75 6d 6e 73 29 3b 0a 75 73 65 20 46 69 6c 65 3a 3a 42 61 73 65 6e 61 6d 65 3b 0a 75 73 65 20 47 65 74 6f 70 74 3a 3a 53 74 64 3b 0a 75 73 65 20 43 77 64 3b 0a 75 73 65 20 54 65 78 74 3a 3a 43 68 61 72 57 69 64 74 68 20 71 77 28 6d 62 73 77 69 64 74 68 29 3b 0a 0a 69 66 20 28 24 7b 5e 55 54 46 38 4c 4f 43 41 4c 45 7d 29 20 7b 0a 20 20 20 20 62 69 6e 6d 6f 64 65 20 53 54 44 49 4e 2c 20 27 3a 75 74 66 38 27 3b 0a 20 20 20 20 62 69 6e 6d 6f 64 65 20 53 54 44 4f 55 54 2c 20 27 3a 75 74 66 38 27 3b 0a 20 20 20 20 72 65 71 75 69 72 65 20 45 6e 63 6f 64 65 3b 0a 20 20 20 20 65 76 61 6c 20 7b 20 24 5f 20 3d 20 45 6e 63 6f 64 65 3a 3a 64 65 63 6f 64 65 5f 75 74 66 38 28 24 5f 2c 31 29 20 7d 20 66 6f 72 20 40 41 52 47 56 3b 0a 7d 0a 0a 24 76 65 72 73 69 6f 6e 20 3d 20 22 33 2e 30 33 22 3b 0a 24 70 72 6f 67 6e 61 6d 65 20 3d 20 62 61 73 65 6e 61 6d 65 28 24 30 29 3b 0a 24 65 79 65 73 20 3d 20 22 6f 6f 22 3b 0a 24 74 6f 6e 67 75 65 20 3d 20 22 20 20 22 3b 0a 24 63 6f 77 70 61 74 68 20 3d 20 24 45 4e 56 7b 27 43 4f 57 50 41 54 48 27 7d 20 7c 7c 20 27 2f 75 73 72 2f 73 68 61 72 65 2f 63 6f 77 73 61 79 2f 63 6f 77 73 27 3b 0a 40 6d 65 73 73 61 67 65 20 3d 20 28 29 3b 0a 24 74 68 6f 75 67 68 74 73 20 3d 20 22 22 3b 0a 0a 23 23 20 59 65 61 68 2c 20 74 68 69 73 20 69 73 20 72 75 64 65 2c 20 49 20 6b 6e 6f 77 2e 20 20 42 75 74 20 68 6f 70 65 66 75 6c 6c 79 20 69 74 20 67 65 74 73 20 61 72 6f 75 6e 64 20 61 20 6e 61 73 74 79 0a 23 23 20 6c 69 74 74 6c 65 20 76 65 72 73 69 6f 6e 20 64 65 70 65 6e 64 65 6e 63 79 2e 0a 0a 24 54 65 78 74 3a 3a 57 72 61 70 3a 3a 69 6e 69 74 69 61 6c 5f 74 61 62 20 3d 20 38 3b 0a 24 54 65 78 74 3a 3a 57 72 61 70 3a 3a 73 75 62 73 65 71 75 65 6e 74 5f 74 61 62 20 3d 20 38 3b 0a 24 54 65 78 74 3a 3a 57 72 61 70 3a 3a 74 61 62 73 74 6f 70 20 3d 20 38 3b 0a 0a 23 23 20 4f 6e 65 20 6f 66 20 74 68 65 73 65 20 64 61 79 73 2c 20 77 65 27 6c 6c 20 67 65 74 20 69 74 20 70 6f 72 74 65 64 20 74 6f 20 57 69 6e 64 6f 77 73 2e 20 20 59 65 61 68 2c 20 72 69 67 68 74 2e 0a 0a 69 66 20 28 28 24 5e 4f 20 65 71 20 22 4d 53 57 69 6e 33 32 22 29 20 6f 72 20 28 24 5e 4f 20 65 71 20 22 57 69 6e 64 6f 77 73 5f 4e 54 22 29 29 20 7b 09 23 23 20 4d 61 6e 79 20 70 65 72 6c 73 2c 20 65 65 6b 21 0a 20 20 20 20 24 70 61 74 68 73 65 70 20 3d 20 27 3b 27 3b 0a 7d 20 65 6c 73 65 20 7b 0a 20 20 20 20 24 70 61 74 68 73 65 70 20 3d 20 27 3a 27 3b 0a 7d 0a 0a 25 6f 70 74 73 20 3d 20 28 0a 20 20 20 20 27 65 27 09 09 3d 3e 09 27 6f 6f 27 2c 0a 20 20 20 20 27 66 27 09 09 3d 3e 09 27 64 65 66 61 75 6c 74 2e 63 6f 77 27 2c 0a 20 20 20 20 27 6e 27 09 09 3d 3e 09 30 2c 0a 20 20 20}
condition:
      filesize < 10KB and
      8 of them and $magic
}

rule gtfobins_binaries_perlbug {
   strings:
      $s1 = "<!-- A clear and concise description of what you expected to happen. -->" fullword ascii
      $s2 = "<!-- A clear and concise description of what the bug is. -->" fullword ascii
      $s3 = "<!-- A one-liner or script to reproduce the issue. -->" fullword ascii
      $s4 = "    # Not OK - provide build failure template by finessing OK report" fullword ascii
      $s5 = "  -b    Body of the report. If not included on the command line, or" fullword ascii
      $s6 = "at https://github.com/Perl/perl5/issues" fullword ascii
      $s7 = "The GitHub issue tracker at https://github.com/Perl/perl5/issues is the" fullword ascii
      $s8 = "L<https://github.com/Perl/perl5/issues>" fullword ascii
      $s9 = "https://github.com/Perl/perl5/issues" fullword ascii
      $s10 = "L<https://github.com/Perl/perl5/issues>. The B<perlbug@perl.org>" fullword ascii
      $s11 = "may be able to use B<perlbug -d> or B<perl -V> to get system" fullword ascii
      $s12 = "  -T    Thank-you mode. The target address defaults to '$thanksaddress'." fullword ascii
      $s13 = "my $config_tag1 = '5.38.2 - Thu May 30 19:24:33 UTC 2024';" fullword ascii
      $s14 = "    print \"\\nReport saved to '$file'. Please submit it to https://github.com/Perl/perl5/issues\\n\";" fullword ascii
      $s15 = "    # Users address, used in message and in From and Reply-To headers" fullword ascii
      $s16 = "Test mode.  Makes it possible to command perlbug from a pipe or file, for" fullword ascii
      $s17 = "<!------------------------------------------------------------------- -->" fullword ascii
      $s18 = "  -nok  Report unsuccessful build on this system to perl porters" fullword ascii
      $s19 = "If you wish to generate a bug report, please run it without the -T flag" fullword ascii
      $s20 = "            $sendmail = \"$_/sendmail.exe\", last if -e \"$_/sendmail.exe\";" fullword ascii
      $s21 = "    eval 'exec /usr/bin/perl -S $0 ${1+\"$@\"}'" fullword ascii
      $s22 = "    if ( open my $sff_fh, '|-:raw', 'MCR TCPIP$SYSTEM:TCPIP$SMTP_SFF.EXE SYS$INPUT:' ) {" fullword ascii
      $s23 = "https://perldoc.perl.org/perlcommunity.html" fullword ascii
      $s24 = "    # OK - send \"OK\" report for build on this system" fullword ascii
      $s25 = "for $entry on https://rt.cpan.org, and report your issue there." fullword ascii
      $s26 = "  -v    Include Verbose configuration data in the report" fullword ascii
      $s27 = "    # -------- Configuration ---------" fullword ascii
      $s28 = "    \"It is being executed now by  Perl $config_tag2.\\n\\n\"" fullword ascii
      $s29 = "Neither is \"perl crashes\" nor is \"HELP!!!\".  These don't help.  A compact" fullword ascii
      $s30 = "this with B<-v> to get more complete data." fullword ascii
      $s31 = "$Getopt::Std::STANDARD_HELP_VERSION = 1;" fullword ascii
      $s32 = "    # read in the report template once so that" fullword ascii
      $s33 = "in a file with B<-f>, you will get a chance to edit the report." fullword ascii
      $s34 = "        qw(PATH LD_LIBRARY_PATH LANG PERL_BADLANG SHELL HOME LOGDIR LANGUAGE);" fullword ascii
      $s35 = "submit or comment on) and the commit logs to development" fullword ascii
      $s36 = "    # Target address" fullword ascii
      $s37 = "if 0; # ^ Run only under a shell" fullword ascii
      $s38 = "        anything. You can use this with -v to get more complete data." fullword ascii
      $s39 = "  -okay As -ok but allow report from old builds." fullword ascii
      $s40 = "- module=$report_about_module" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 65 72 6c 0a 20 20 20 20 65 76 61 6c 20 27 65 78 65 63 20 2f 75 73 72 2f 62 69 6e 2f 70 65 72 6c 20 2d 53 20 24 30 20 24 7b 31 2b 22 24 40 22 7d 27 0a 09 69 66 20 30 3b 20 23 20 5e 20 52 75 6e 20 6f 6e 6c 79 20 75 6e 64 65 72 20 61 20 73 68 65 6c 6c 0a 0a 6d 79 20 24 63 6f 6e 66 69 67 5f 74 61 67 31 20 3d 20 27 35 2e 33 38 2e 32 20 2d 20 54 68 75 20 4d 61 79 20 33 30 20 31 39 3a 32 34 3a 33 33 20 55 54 43 20 32 30 32 34 27 3b 0a 0a 6d 79 20 24 70 61 74 63 68 6c 65 76 65 6c 5f 64 61 74 65 20 3d 20 31 37 31 37 30 39 35 34 35 34 3b 0a 6d 79 20 40 70 61 74 63 68 65 73 20 3d 20 43 6f 6e 66 69 67 3a 3a 6c 6f 63 61 6c 5f 70 61 74 63 68 65 73 28 29 3b 0a 6d 79 20 24 70 61 74 63 68 5f 74 61 67 73 20 3d 20 6a 6f 69 6e 20 22 22 2c 20 6d 61 70 20 2f 28 5c 53 2b 29 2f 20 3f 20 22 2b 24 31 20 22 20 3a 20 28 29 2c 20 40 70 61 74 63 68 65 73 3b 0a 0a 42 45 47 49 4e 20 7b 20 70 6f 70 20 40 49 4e 43 20 69 66 20 24 49 4e 43 5b 2d 31 5d 20 65 71 20 27 2e 27 20 7d 0a 75 73 65 20 77 61 72 6e 69 6e 67 73 3b 0a 75 73 65 20 73 74 72 69 63 74 3b 0a 75 73 65 20 43 6f 6e 66 69 67 3b 0a 75 73 65 20 46 69 6c 65 3a 3a 53 70 65 63 3b 09 09 23 20 6b 65 65 70 20 70 65 72 6c 62 75 67 20 50 65 72 6c 20 35 2e 30 30 35 20 63 6f 6d 70 61 74 69 62 6c 65 0a 75 73 65 20 47 65 74 6f 70 74 3a 3a 53 74 64 3b 0a 75 73 65 20 46 69 6c 65 3a 3a 42 61 73 65 6e 61 6d 65 20 27 62 61 73 65 6e 61 6d 65 27 3b 0a 0a 24 47 65 74 6f 70 74 3a 3a 53 74 64 3a 3a 53 54 41 4e 44 41 52 44 5f 48 45 4c 50 5f 56 45 52 53 49 4f 4e 20 3d 20 31 3b 0a 0a 73 75 62 20 70 61 72 61 70 72 69 6e 74 3b 0a 0a 42 45 47 49 4e 20 7b 0a 20 20 20 20 65 76 61 6c 20 7b 20 72 65 71 75 69 72 65 20 4d 61 69 6c 3a 3a 53 65 6e 64 3b 7d 3b 0a 20 20 20 20 24 3a 3a 48 61 76 65 53 65 6e 64 20 3d 20 28 24 40 20 65 71 20 22 22 29 3b 0a 20 20 20 20 65 76 61 6c 20 7b 20 72 65 71 75 69 72 65 20 4d 61 69 6c 3a 3a 55 74 69 6c 3b 20 7d 20 3b 0a 20 20 20 20 24 3a 3a 48 61 76 65 55 74 69 6c 20 3d 20 28 24 40 20 65 71 20 22 22 29 3b 0a 20 20 20 20 23 20 75 73 65 20 73 65 63 75 72 65 20 74 65 6d 70 66 69 6c 65 73 20 77 68 65 72 65 76 65 72 20 70 6f 73 73 69 62 6c 65 0a 20 20 20 20 65 76 61 6c 20 7b 20 72 65 71 75 69 72 65 20 46 69 6c 65 3a 3a 54 65 6d 70 3b 20 7d 3b 0a 20 20 20 20 24 3a 3a 48 61 76 65 54 65 6d 70 20 3d 20 28 24 40 20 65 71 20 22 22 29 3b 0a 20 20 20 20 65 76 61 6c 20 7b 20 72 65 71 75 69 72 65 20 4d 6f 64 75 6c 65 3a 3a 43 6f 72 65 4c 69 73 74 3b 20 7d 3b 0a 20 20 20 20 24 3a 3a 48 61 76 65 43 6f 72 65 4c 69 73 74 20 3d 20 28 24 40 20 65 71 20 22 22 29 3b 0a 20 20 20 20 65 76 61 6c 20 7b 20 72 65 71 75 69 72 65 20 54 65 78 74 3a 3a 57 72 61 70 3b 20 7d 3b 0a 20 20 20 20 24 3a 3a 48 61 76 65 57 72 61 70 20 3d 20 28 24 40 20 65 71 20 22 22 29 3b 0a 7d 3b 0a 0a 6f 75 72 20 24 56 45 52 53 49 4f 4e 20 3d 20 22 31 2e 34 33 22 3b 0a 0a 23 54 4f 44 4f 3a 0a 23 20 20 20 20 20 20 20 6d 61 6b 65 20 73 75 72 65 20 66 61 69 6c 75 72 65 20 28 74 72 61 6e 73 6d 69 73 73 69 6f 6e 2d 77 69 73 65 29 20 6f 66 20 4d 61 69 6c 3a 3a 53 65 6e 64 20 69 73 20 61 63 63 6f 75 6e 74 65 64 20 66 6f}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_exiftool {
   strings:
      $x1 = "=item exiftool -b -jpgfromraw -w %d%f_%ue.jpg -execute -b -previewimage -w" fullword ascii
      $s2 = "# exit Command loop now if we are all done processing commands" fullword ascii
      $s3 = "=item exiftool -htmldump -w tmp/%f_%e.html t/images" fullword ascii
      $s4 = "%d%f_%ue.jpg -execute -tagsfromfile @ -srcfile %d%f_%ue.jpg" fullword ascii
      $s5 = "Execute command for all arguments up to this point on the command line (plus" fullword ascii
      $s6 = "# loop over sets of command-line arguments separated by \"-execute\"" fullword ascii
      $s7 = "To speed processing when reading XMP, exclusions in XMP groups also bypass" fullword ascii
      $s8 = "  # execute the command now if no more arguments or -execute is used" fullword ascii
      $s9 = "=item curl -s http://a.domain.com/bigfile.jpg | exiftool -fast -" fullword ascii
      $s10 = "  -execute[NUM]                    Execute multiple commands on one line" fullword ascii
      $s11 = "    -w dir2/%d%f.txt  # write to \"dir2\", keeping dir structure" fullword ascii
      $s12 = "=item exiftool -geotag a.log -geotag b.log -r dir" fullword ascii
      $s13 = "=item exiftool -geotag 'tracks/*.log' -r dir" fullword ascii
      $s14 = "performance in multi-pass processing by reducing the overhead required to" fullword ascii
      $s15 = "Note that all files specified on the command line will be processed" fullword ascii
      $s16 = "is output as the command line is parsed, before the processing of any input" fullword ascii
      $s17 = "1) Execute C<exiftool -stay_open True -@ I<ARGFILE>>, where I<ARGFILE> is the" fullword ascii
      $s18 = "=item exiftool -r -w .txt -common pictures" fullword ascii
      $s19 = "commands were executed as separate command lines (with the exception of the" fullword ascii
      $s20 = "buffered output.)  ExifTool will then execute the command with the arguments" fullword ascii
      $s21 = "excessive memory usage when processing a very large number of files with a" fullword ascii
      $s22 = "information is dumped, but the -u option can be used to give a raw hex dump" fullword ascii
      $s23 = "# Notes: blocks until -execute, -stay_open or -@ option is available" fullword ascii
      $s24 = "=item exiftool a.jpg -thumbnailimage -b | exiftool -comment=wow - |" fullword ascii
      $s25 = "commands).  Allows multiple commands to be executed from a single command" fullword ascii
      $s26 = "process immediately after writing C<-execute\\n>.  (There is no associated" fullword ascii
      $s27 = "the commands if B<-execute> was used)." fullword ascii
      $s28 = "executed commands when B<-execute> is used.  This and the B<-config> option" fullword ascii
      $s29 = "command line is broken into three sections (separated by B<-execute>" fullword ascii
      $s30 = "command when B<-execute> was used, and may be used like any other tag in the" fullword ascii
      $s31 = "seconds after writing C<-execute\\n> before exiftool starts processing the" fullword ascii
      $s32 = "options), and each is executed as if it were a separate command.  The" fullword ascii
      $s33 = "=item exiftool -o %d%f.xmp dir" fullword ascii
      $s34 = "must be quoted on the command line of most systems to prevent shell" fullword ascii
      $s35 = "=item exiftool '-JpgFromRawE<lt>=%d%f_JFR.JPG' -ext NEF -r ." fullword ascii
      $s36 = "line and applies to all B<-execute>'d commands.  This file is used to create" fullword ascii
      $s37 = "=item exiftool -r '-FileName<CreateDate' -d %Y-%m-%d/%H%M_%%f.%%e dir" fullword ascii
      $s38 = "        # must process on 2nd pass so -f and -charset options are available" fullword ascii
      $s39 = "                # process new arguments after -execute or -stay_open option" fullword ascii
      $s40 = "    -w %d%f.txt       # same effect as \"-w txt\"" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 65 72 6c 20 2d 77 0a 23 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 0a 23 20 46 69 6c 65 3a 20 20 20 20 20 20 20 20 20 65 78 69 66 74 6f 6f 6c 0a 23 0a 23 20 44 65 73 63 72 69 70 74 69 6f 6e 3a 20 20 52 65 61 64 2f 77 72 69 74 65 20 6d 65 74 61 20 69 6e 66 6f 72 6d 61 74 69 6f 6e 0a 23 0a 23 20 52 65 76 69 73 69 6f 6e 73 3a 20 20 20 20 4e 6f 76 2e 20 31 32 2f 30 33 20 2d 20 50 2e 20 48 61 72 76 65 79 20 43 72 65 61 74 65 64 0a 23 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 28 53 65 65 20 68 74 6d 6c 2f 68 69 73 74 6f 72 79 2e 68 74 6d 6c 20 66 6f 72 20 72 65 76 69 73 69 6f 6e 20 68 69 73 74 6f 72 79 29 0a 23 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 2d 0a 75 73 65 20 73 74 72 69 63 74 3b 0a 75 73 65 20 77 61 72 6e 69 6e 67 73 3b 0a 72 65 71 75 69 72 65 20 35 2e 30 30 34 3b 0a 0a 6d 79 20 24 76 65 72 73 69 6f 6e 20 3d 20 27 31 32 2e 37 36 27 3b 0a 0a 23 20 61 64 64 20 6f 75 72 20 27 6c 69 62 27 20 64 69 72 65 63 74 6f 72 79 20 74 6f 20 74 68 65 20 69 6e 63 6c 75 64 65 20 6c 69 73 74 20 42 45 46 4f 52 45 20 27 75 73 65 20 49 6d 61 67 65 3a 3a 45 78 69 66 54 6f 6f 6c 27 0a 6d 79 20 24 65 78 65 50 61 74 68 3b 0a 42 45 47 49 4e 20 7b 0a 20 20 20 20 23 20 28 75 6e 64 6f 63 75 6d 65 6e 74 65 64 20 2d 78 70 61 74 68 20 6f 70 74 69 6f 6e 20 61 64 64 65 64 20 69 6e 20 31 31 2e 39 31 2c 20 6d 75 73 74 20 63 6f 6d 65 20 62 65 66 6f 72 65 20 6f 74 68 65 72 20 6f 70 74 69 6f 6e 73 29 0a 20 20 20 20 24 65 78 65 50 61 74 68 20 3d 20 40 41 52 47 56 20 26 26 20 6c 63 28 24 41 52 47 56 5b 30 5d 29 20 65 71 20 27 2d 78 70 61 74 68 27 20 26 26 20 73 68 69 66 74 28 29 20 3f 20 24 5e 58 20 3a 20 24 30 3b 0a 20 20 20 20 23 20 67 65 74 20 65 78 65 20 64 69 72 65 63 74 6f 72 79 0a 20 20 20 20 6d 79 20 24 65 78 65 44 69 72 20 3d 20 28 24 65 78 65 50 61 74 68 20 3d 7e 20 2f 28 2e 2a 29 5b 5c 5c 5c 2f 5d 2f 29 20 3f 20 24 31 20 3a 20 27 2e 27 3b 0a 20 20 20 20 6d 79 20 24 69 6e 63 44 69 72 20 3d 20 28 24 30 20 3d 7e 20 2f 28 2e 2a 29 5b 5c 5c 5c 2f 5d 2f 29 20 3f 20 22 24 31 2f 6c 69 62 22 20 3a 20 27 2e 2f 6c 69 62 27 3b 0a 20 20 20 20 69 66 20 28 2d 6c 20 24 30 29 20 7b 0a 20 20 20 20 20 20 20 20 6d 79 20 24 6c 6e 6b 20 3d 20 65 76 61 6c 20 7b 20 72 65 61 64 6c 69 6e 6b 20 24 30 20 7d 3b 0a 20 20 20 20 20 20 20 20 69 66 20 28 64 65 66 69 6e 65 64 20 24 6c 6e 6b 29 20 7b 0a 20 20 20 20 20 20 20 20 20 20 20 20 6d 79 20 24 6c 6e 6b 44 69 72 20 3d 20 28 24 6c 6e 6b 20 3d 7e 20 2f 28 2e 2a 29 5b 5c 5c 5c 2f 5d 2f 29 20 3f 20 24 31 20 3a 20 27 2e 27 3b 0a 20 20 20 20 20 20 20 20 20 20 20 20 24 65 78 65 44 69 72 20 3d 20 28 28 24 6c 6e 6b 20 3d 7e 20 6d 28 5e 2f 29 29 20 3f 20 27 27 20 3a 20 24 65 78 65 44 69 72 20 2e 20 27 2f 27 29 20 2e 20}
condition:
      filesize < 900KB and
      1 of ($x*) and 4 of them and $magic
}

rule gtfobins_binaries_run_mailcap {
   strings:
      $s1 = "    print STDERR \"  norun         just print but don't execute the command (useful with --debug)\\n\";" fullword ascii
      $s2 = "        print STDERR \" - program to execute: $comm\\n\" if $debug;" fullword ascii
      $s3 = "        print STDERR \" - executing: $comm\\n\" if $debug;" fullword ascii
      $s4 = "#  Written by Brian White <bcwhite@pobox.com>" fullword ascii
      $s5 = "                print STDERR \" - filename contains shell meta-characters; aliased to '$tmplink'\\n\" if $debug;" fullword ascii
      $s6 = "        print STDERR \" - file command returned mime-type \\\"$typ\\\"\\n\" if $debug;" fullword ascii
      $s7 = "    ($head,$tail) = split(/%s/,$template,2);" fullword ascii
      $s8 = "    print STDERR \"  \\\"xz\\\", \\\"zstd\\\", and \\\"compress\\\" are supported) -- if not specified,\\n\";" fullword ascii
      $s9 = "                    $comm = \"$xtermprgrm -T '$file ($type)' -e $0 --action=$action '${type}:%s'\";" fullword ascii
      $s10 = "#   chmod 0600,$tmpfile; # done already by TempFile" fullword ascii
      $s11 = "    my $core = ($? & 0x80) ? ' (core dumped)' : '';" fullword ascii
      $s12 = "            $res = system \"bzip2 -d >\\Q$tmpfile\\E\";" fullword ascii
      $s13 = "    return $tmpfile if (($efile ne '-' && ! -e $efile) || $action eq 'compose');" fullword ascii
      $s14 = "            $res = system \"xz -d >\\Q$tmpfile\\E\";" fullword ascii
      $s15 = "    open(TMPFILE,\">$tmpfile\") || die \"Error: could not write \\\"$tmpfile\\\" -- $!\\n\";" fullword ascii
      $s16 = "            $res = system \"gzip -d >\\Q$tmpfile\\E\";" fullword ascii
      $s17 = "        print STDERR \"Error: could not decode \\\"$efile\\\" -- $!\\n\";" fullword ascii
      $s18 = "    $cmd  = \"mktemp --tmpdir\";" fullword ascii
      $s19 = "    print STDERR \"Error: program failed to execute: $!\\n\";" fullword ascii
      $s20 = "    print STDERR \"  how the file (and type) has been encoded (only \\\"gzip\\\", \\\"bzip2,\\\"\\n\";" fullword ascii
      $s21 = "    print STDERR \"Processing file \\\"$file\\\" of type \\\"$type\\\" (encoding=\",$code?$code:\"none\",\")...\\n\" if $debug;" fullword ascii
      $s22 = "# Pass --debug to sub-calls to this program." fullword ascii
      $s23 = "#  This file has been placed in the public domain (the only true \"free\")." fullword ascii
      $s24 = "sub TempFile {" fullword ascii
      $s25 = "            print STDERR \" - running test: $1 \" if $debug;" fullword ascii
      $s26 = "      print STDERR \"   could not read \\\"$file\\\" -- $!\\n\" if $debug;" fullword ascii
      $s27 = "            $res = system \"gzip -c \\Q$dfile\\E >\\Q$efile\\E\";" fullword ascii
      $s28 = "    } elsif (m!^([^/:]+/[^/:]+):(.*)! && ! -e $_) {" fullword ascii
      $s29 = "    print STDERR \" - file \\\"$file\\\" has encoding \\\"$encoding\\\"\\n\" if $debug && $encoding;" fullword ascii
      $s30 = "            $res = system \"zstd -c < \\Q$dfile\\E\";" fullword ascii
      $s31 = "            $res = system \"gzip -c \\Q$dfile\\E\";" fullword ascii
      $s32 = "    print STDERR \" - decoding \\\"$efile\\\" as \\\"$tmpfile\\\"\\n\" if $debug;" fullword ascii
      $s33 = "            $res = system \"zstd -c < \\Q$dfile\\E >\\Q$efile\\E\";" fullword ascii
      $s34 = "sub Usage {" fullword ascii
      $s35 = "            $res = system \"zstd -dc >\\Q$tmpfile\\E\";" fullword ascii
      $s36 = "            $res = system \"gzip -dc \\Q$efile\\E >\\Q$tmpfile\\E\";" fullword ascii
      $s37 = "    my($cmd,$head,$tail,$tmpfile);" fullword ascii
      $s38 = "            $res = system \"bzip2 -dc <\\Q$efile\\E >\\Q$tmpfile\\E\";" fullword ascii
      $s39 = "            $res = system \"xz -dc <\\Q$efile\\E >\\Q$tmpfile\\E\";" fullword ascii
      $s40 = "            $res = system \"zstd -dc <\\Q$efile\\E >\\Q$tmpfile\\E\";" fullword ascii
      $magic = {23 21 20 2f 75 73 72 2f 62 69 6e 2f 70 65 72 6c 0a 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 0a 23 0a 23 20 20 52 75 6e 2d 4d 61 69 6c 63 61 70 3a 20 20 52 75 6e 20 61 20 70 72 6f 67 72 61 6d 20 73 70 65 63 69 66 69 65 64 20 69 6e 20 74 68 65 20 6d 61 69 6c 63 61 70 20 66 69 6c 65 20 62 61 73 65 64 20 6f 6e 20 61 20 6d 69 6d 65 0a 23 20 20 74 79 70 65 2e 0a 23 0a 23 20 20 57 72 69 74 74 65 6e 20 62 79 20 42 72 69 61 6e 20 57 68 69 74 65 20 3c 62 63 77 68 69 74 65 40 70 6f 62 6f 78 2e 63 6f 6d 3e 0a 23 20 20 54 68 69 73 20 66 69 6c 65 20 68 61 73 20 62 65 65 6e 20 70 6c 61 63 65 64 20 69 6e 20 74 68 65 20 70 75 62 6c 69 63 20 64 6f 6d 61 69 6e 20 28 74 68 65 20 6f 6e 6c 79 20 74 72 75 65 20 22 66 72 65 65 22 29 2e 0a 23 0a 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 0a 0a 75 73 65 20 45 6e 63 6f 64 65 20 71 77 28 64 65 63 6f 64 65 29 3b 0a 75 73 65 20 49 31 38 4e 3a 3a 4c 61 6e 67 69 6e 66 6f 20 71 77 28 6c 61 6e 67 69 6e 66 6f 20 43 4f 44 45 53 45 54 29 3b 0a 75 73 65 20 46 69 6c 65 3a 3a 53 70 65 63 3b 0a 0a 24 64 65 62 75 67 3d 28 24 45 4e 56 7b 52 55 4e 5f 4d 41 49 4c 43 41 50 5f 44 45 42 55 47 7d 20 7c 7c 20 30 29 3b 0a 24 6e 6f 72 75 6e 3d 30 3b 0a 24 6e 6f 70 61 67 65 72 3d 30 3b 0a 24 65 74 63 6d 69 6d 65 74 79 70 3d 22 2f 65 74 63 2f 6d 69 6d 65 2e 74 79 70 65 73 22 3b 0a 24 73 68 72 6d 69 6d 65 74 79 70 3d 22 2f 75 73 72 2f 73 68 61 72 65 2f 65 74 63 2f 6d 69 6d 65 2e 74 79 70 65 73 22 3b 0a 24 6c 6f 63 6d 69 6d 65 74 79 70 3d 22 2f 75 73 72 2f 6c 6f 63 61 6c 2f 65 74 63 2f 6d 69 6d 65 2e 74 79 70 65 73 22 3b 0a 24 75 73 72 6d 69 6d 65 74 79 70 3d 22 24 45 4e 56 7b 48 4f 4d 45 7d 2f 2e 6d 69 6d 65 2e 74 79 70 65 73 22 3b 0a 24 78 74 65 72 6d 70 72 67 72 6d 3d 22 2f 75 73 72 2f 62 69 6e 2f 78 2d 74 65 72 6d 69 6e 61 6c 2d 65 6d 75 6c 61 74 6f 72 22 3b 20 23 20 78 74 65 72 6d 3f 0a 24 64 65 66 6d 69 6d 65 74 79 70 3d 22 61 70 70 6c 69 63 61 74 69 6f 6e 2f 6f 63 74 65 74 2d 73 74 72 65 61 6d 22 3b 0a 24 71 75 6f 74 65 64 73 65 6d 69 3d 63 68 72 28 32 35 35 29 3b 0a 24 71 75 6f 74 65 64 70 72 63 74 3d 63 68 72 28 32 35 34 29 3b 0a 24 72 65 74 63 6f 64 65 3d 30 3b 0a 0a 0a 0a 73 75 62 20 55 73 61 67 65 20 7b 0a 20 20 20 20 6d 79 28 24 65 72 72 6f 72 29 20 3d 20 40 5f 3b 0a 20 20 20 20 70 72 69 6e 74 20 53 54 44 45 52 52 20 24 65 72 72 6f 72 2c 22 5c 6e 5c 6e 22 20 69 66 20 24 65 72 72 6f 72 3b 0a 0a 20 20 20 20 70 72 69 6e 74 20 53 54 44 45 52 52 20 22 55 73 65 3a 20 24 30 20 3c 2d 2d 61 63 74 69 6f 6e 3d 56 41 4c 3e 20 5b 2d 2d 64 65 62 75 67 5d 20 5b 4d 49 4d 45 2d 54 59 50 45 3a 5b 45 4e 43 4f 44 49 4e 47 3a 5d 5d 46 49 4c 45 20 5b 2e 2e 2e 5d 5c 6e 5c 6e 22 3b 0a 20 20 20 20 70 72 69 6e 74 20 53 54 44 45 52 52 20 22 4f 70 74 69}
condition:
      filesize < 60KB and
      8 of them and $magic
}

rule gtfobins_binaries_psql {
   strings:
      $s1 = "error \"PostgreSQL version $version is not installed\" unless -d \"$PgCommon::binroot$version\";" fullword ascii
      $s2 = "# /etc/postgresql-common/user_clusters." fullword ascii
      $s3 = "    # --host or -h on command line, drop info from PGCLUSTER" fullword ascii
      $s4 = "postgresql-common tools without root privileges." fullword ascii
      $s5 = "# if we don't have a cluster, and no specific host or port was given, consult postgresqlrc" fullword ascii
      $s6 = "pg_wrapper - wrapper for PostgreSQL client commands" fullword ascii
      $s7 = "pg_wrapper is invoked as any user other than B<postgres> and B<root>." fullword ascii
      $s8 = "    # --port or -p on command line" fullword ascii
      $s9 = "performed. The default PostgreSQL version and port number (from the command" fullword ascii
      $s10 = "port was configured via B<ALTER SYSTEM> in C<postgresql.auto.conf> and" fullword ascii
      $s11 = "($version, $cluster, $db) = user_cluster_map() unless ($cluster or $explicit_host or $explicit_port);" fullword ascii
      $s12 = "Note that B<pg_wrapper> needs to be able to read the server config to get the" fullword ascii
      $s13 = "the newest PostgreSQL version installed, as these are downwards compatible." fullword ascii
      $s14 = "programs in C</usr/lib/postgresql/>I<version>C</bin>. It determines the" fullword ascii
      $s15 = "matching entry in C</etc/postgresql-common/user_clusters> (see" fullword ascii
      $s16 = "error \"pg_wrapper: $cmdname was not found in $PgCommon::binroot$version/bin\" unless $cmd;" fullword ascii
      $s17 = "unless ($version or $explicit_host or $explicit_port or $explicit_service) {" fullword ascii
      $s18 = "=item C</etc/postgresql-common/user_clusters>" fullword ascii
      $s19 = "programs installed in C</usr/lib/postgresql/>I<version>C</bin>)." fullword ascii
      $s20 = "=item B<--cluster> I<version>B</>I<host>B<:>[I<port>]" fullword ascii
      $s21 = "if ($explicit_port and not $version and not $cluster and not $explicit_host and not $explicit_service) {" fullword ascii
      $s22 = "The target cluster is selected by the following means, in descending order of" fullword ascii
      $s23 = "# libreadline is a lot better than libedit, so prefer that on versions that still use it" fullword ascii
      $s24 = "stores the default cluster and database for users and groups as set by" fullword ascii
      $s25 = "# pg_archivecleanup, or pg_isready, always use latest version" fullword ascii
      $s26 = "# Evaluate PGCLUSTER (unless PGHOST is set as well)" fullword ascii
      $s27 = "# get multiarch dir for our architecture" fullword ascii
      $s28 = "# database specified in ~/.postgresqlrc or" fullword ascii
      $s29 = "if (not $version or $cmdname =~ /^(psql|pg_archivecleanup|pg_isready)$/) {" fullword ascii
      $s30 = "configuration (e. g. C<pg_service.conf>, L<user_clusters(5)>). The default is" fullword ascii
      $s31 = "L<user_clusters(5)>, L<postgresqlrc(5)>" fullword ascii
      $s32 = "my ($host, $port);" fullword ascii
      $s33 = "This program is run only as a link to names which correspond to PostgreSQL" fullword ascii
      $s34 = "I<host>:I<port> for a remote cluster. If I<port> is left empty (i. e. you just" fullword ascii
      $s35 = "specified options to that command." fullword ascii
      $s36 = "if a port is given (either via B<-p>, B<--port>, or B<PGPORT>), and no host is" fullword ascii
      $s37 = "$ENV{'PGSYSCONFDIR'} //= '/etc/postgresql-common';" fullword ascii
      $s38 = "        $host = get_cluster_socketdir ($version, $cluster);" fullword ascii
      $s39 = "# Call a PostgreSQL client program with the version, cluster and default" fullword ascii
      $s40 = "# Check for --cluster argument and filter it out" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 65 72 6c 0a 23 20 43 61 6c 6c 20 61 20 50 6f 73 74 67 72 65 53 51 4c 20 63 6c 69 65 6e 74 20 70 72 6f 67 72 61 6d 20 77 69 74 68 20 74 68 65 20 76 65 72 73 69 6f 6e 2c 20 63 6c 75 73 74 65 72 20 61 6e 64 20 64 65 66 61 75 6c 74 0a 23 20 64 61 74 61 62 61 73 65 20 73 70 65 63 69 66 69 65 64 20 69 6e 20 7e 2f 2e 70 6f 73 74 67 72 65 73 71 6c 72 63 20 6f 72 0a 23 20 2f 65 74 63 2f 70 6f 73 74 67 72 65 73 71 6c 2d 63 6f 6d 6d 6f 6e 2f 75 73 65 72 5f 63 6c 75 73 74 65 72 73 2e 0a 23 0a 23 20 28 43 29 20 32 30 30 35 2d 32 30 30 39 20 4d 61 72 74 69 6e 20 50 69 74 74 20 3c 6d 70 69 74 74 40 64 65 62 69 61 6e 2e 6f 72 67 3e 0a 23 20 28 43 29 20 32 30 31 33 2d 32 30 32 32 20 43 68 72 69 73 74 6f 70 68 20 42 65 72 67 20 3c 6d 79 6f 6e 40 64 65 62 69 61 6e 2e 6f 72 67 3e 0a 23 0a 23 20 20 54 68 69 73 20 70 72 6f 67 72 61 6d 20 69 73 20 66 72 65 65 20 73 6f 66 74 77 61 72 65 3b 20 79 6f 75 20 63 61 6e 20 72 65 64 69 73 74 72 69 62 75 74 65 20 69 74 20 61 6e 64 2f 6f 72 20 6d 6f 64 69 66 79 0a 23 20 20 69 74 20 75 6e 64 65 72 20 74 68 65 20 74 65 72 6d 73 20 6f 66 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 61 73 20 70 75 62 6c 69 73 68 65 64 20 62 79 0a 23 20 20 74 68 65 20 46 72 65 65 20 53 6f 66 74 77 61 72 65 20 46 6f 75 6e 64 61 74 69 6f 6e 3b 20 65 69 74 68 65 72 20 76 65 72 73 69 6f 6e 20 32 20 6f 66 20 74 68 65 20 4c 69 63 65 6e 73 65 2c 20 6f 72 0a 23 20 20 28 61 74 20 79 6f 75 72 20 6f 70 74 69 6f 6e 29 20 61 6e 79 20 6c 61 74 65 72 20 76 65 72 73 69 6f 6e 2e 0a 23 0a 23 20 20 54 68 69 73 20 70 72 6f 67 72 61 6d 20 69 73 20 64 69 73 74 72 69 62 75 74 65 64 20 69 6e 20 74 68 65 20 68 6f 70 65 20 74 68 61 74 20 69 74 20 77 69 6c 6c 20 62 65 20 75 73 65 66 75 6c 2c 0a 23 20 20 62 75 74 20 57 49 54 48 4f 55 54 20 41 4e 59 20 57 41 52 52 41 4e 54 59 3b 20 77 69 74 68 6f 75 74 20 65 76 65 6e 20 74 68 65 20 69 6d 70 6c 69 65 64 20 77 61 72 72 61 6e 74 79 20 6f 66 0a 23 20 20 4d 45 52 43 48 41 4e 54 41 42 49 4c 49 54 59 20 6f 72 20 46 49 54 4e 45 53 53 20 46 4f 52 20 41 20 50 41 52 54 49 43 55 4c 41 52 20 50 55 52 50 4f 53 45 2e 20 20 53 65 65 20 74 68 65 0a 23 20 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 66 6f 72 20 6d 6f 72 65 20 64 65 74 61 69 6c 73 2e 0a 0a 75 73 65 20 77 61 72 6e 69 6e 67 73 3b 0a 75 73 65 20 73 74 72 69 63 74 3b 0a 75 73 65 20 50 4f 53 49 58 3b 0a 75 73 65 20 50 67 43 6f 6d 6d 6f 6e 3b 0a 0a 6d 79 20 28 24 76 65 72 73 69 6f 6e 2c 20 24 63 6c 75 73 74 65 72 29 3b 0a 6d 79 20 24 65 78 70 6c 69 63 69 74 5f 68 6f 73 74 20 3d 20 65 78 69 73 74 73 20 24 45 4e 56 7b 50 47 48 4f 53 54 7d 3b 0a 6d 79 20 24 65 78 70 6c 69 63 69 74 5f 70 6f 72 74 20 3d 20 24 45 4e 56 7b 50 47 50 4f 52 54 7d 3b 0a 6d 79 20 24 65 78 70 6c 69 63 69 74 5f 73 65 72 76 69 63 65 20 3d 20 65 78 69 73 74 73 20 24 45 4e 56 7b 50 47 53 45 52 56 49 43 45 7d 3b 0a 0a 23 20 45 76 61 6c 75 61 74 65 20 50 47 43 4c 55 53 54 45 52 20 28 75 6e 6c 65 73 73 20 50 47 48 4f 53 54 20 69 73 20 73 65 74 20 61 73 20 77 65 6c 6c 29}
condition:
      filesize < 30KB and
      8 of them and $magic
}

rule gtfobins_binaries_yarn {
   strings:
      $s1 = "var ver = process.versions.node;" fullword ascii
      $s2 = "  process.exit(1); // eslint-disable-line no-process-exit" fullword ascii
      $s3 = "  console.error('Node version ' + ver + ' is not supported, please use Node.js 4.0 or higher.');" fullword ascii
      $s4 = "      process.exitCode = 1;" fullword ascii
      $s5 = "/* eslint-disable flowtype/require-valid-file-annotation */" fullword ascii
      $s6 = "/* eslint-disable no-var */" fullword ascii
      $s7 = "  if (!cli.autoRun) {" fullword ascii
      $s8 = "  // Just requiring this package will trigger a yarn run since the" fullword ascii
      $s9 = "  // be truthy when built with webpack :(" fullword ascii
      $s10 = "  // `lib/cli` may be `lib/cli/index.js` or `lib/cli.js` depending on the build." fullword ascii
      $s11 = "if (majorVer < 4) {" fullword ascii
      $s12 = "  // `require.main === module` check inside `cli/index.js` will always" fullword ascii
      $s13 = "var majorVer = parseInt(ver.split('.')[0], 10);" fullword ascii
      $s14 = "#!/usr/bin/env node" fullword ascii /* Goodware String - occured 2 times */
      $s15 = "'use strict';" fullword ascii /* Goodware String - occured 2 times */
      $s16 = "  var cli = require(__dirname + '/../lib/cli');" fullword ascii
      $s17 = "      console.error(error.stack || error.message || error);" fullword ascii
      $s18 = "  try {" fullword ascii
      $s19 = "  } catch (err) {" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 65 6e 76 20 6e 6f 64 65 0a 0a 2f 2a 20 65 73 6c 69 6e 74 2d 64 69 73 61 62 6c 65 20 6e 6f 2d 76 61 72 20 2a 2f 0a 2f 2a 20 65 73 6c 69 6e 74 2d 64 69 73 61 62 6c 65 20 66 6c 6f 77 74 79 70 65 2f 72 65 71 75 69 72 65 2d 76 61 6c 69 64 2d 66 69 6c 65 2d 61 6e 6e 6f 74 61 74 69 6f 6e 20 2a 2f 0a 27 75 73 65 20 73 74 72 69 63 74 27 3b 0a 0a 76 61 72 20 76 65 72 20 3d 20 70 72 6f 63 65 73 73 2e 76 65 72 73 69 6f 6e 73 2e 6e 6f 64 65 3b 0a 76 61 72 20 6d 61 6a 6f 72 56 65 72 20 3d 20 70 61 72 73 65 49 6e 74 28 76 65 72 2e 73 70 6c 69 74 28 27 2e 27 29 5b 30 5d 2c 20 31 30 29 3b 0a 0a 69 66 20 28 6d 61 6a 6f 72 56 65 72 20 3c 20 34 29 20 7b 0a 20 20 63 6f 6e 73 6f 6c 65 2e 65 72 72 6f 72 28 27 4e 6f 64 65 20 76 65 72 73 69 6f 6e 20 27 20 2b 20 76 65 72 20 2b 20 27 20 69 73 20 6e 6f 74 20 73 75 70 70 6f 72 74 65 64 2c 20 70 6c 65 61 73 65 20 75 73 65 20 4e 6f 64 65 2e 6a 73 20 34 2e 30 20 6f 72 20 68 69 67 68 65 72 2e 27 29 3b 0a 20 20 70 72 6f 63 65 73 73 2e 65 78 69 74 28 31 29 3b 20 2f 2f 20 65 73 6c 69 6e 74 2d 64 69 73 61 62 6c 65 2d 6c 69 6e 65 20 6e 6f 2d 70 72 6f 63 65 73 73 2d 65 78 69 74 0a 7d 20 65 6c 73 65 20 7b 0a 20 20 74 72 79 20 7b 0a 20 20 20 20 72 65 71 75 69 72 65 28 5f 5f 64 69 72 6e 61 6d 65 20 2b 20 27 2f 2e 2e 2f 6c 69 62 2f 76 38 2d 63 6f 6d 70 69 6c 65 2d 63 61 63 68 65 2e 6a 73 27 29 3b 0a 20 20 7d 20 63 61 74 63 68 20 28 65 72 72 29 20 7b 0a 20 20 20 20 2f 2f 20 57 65 20 64 6f 6e 27 74 20 68 61 76 65 2f 6e 65 65 64 20 74 68 69 73 20 6f 6e 20 6c 65 67 61 63 79 20 62 75 69 6c 64 73 20 61 6e 64 20 64 65 76 20 62 75 69 6c 64 73 0a 20 20 7d 0a 0a 20 20 2f 2f 20 4a 75 73 74 20 72 65 71 75 69 72 69 6e 67 20 74 68 69 73 20 70 61 63 6b 61 67 65 20 77 69 6c 6c 20 74 72 69 67 67 65 72 20 61 20 79 61 72 6e 20 72 75 6e 20 73 69 6e 63 65 20 74 68 65 0a 20 20 2f 2f 20 60 72 65 71 75 69 72 65 2e 6d 61 69 6e 20 3d 3d 3d 20 6d 6f 64 75 6c 65 60 20 63 68 65 63 6b 20 69 6e 73 69 64 65 20 60 63 6c 69 2f 69 6e 64 65 78 2e 6a 73 60 20 77 69 6c 6c 20 61 6c 77 61 79 73 0a 20 20 2f 2f 20 62 65 20 74 72 75 74 68 79 20 77 68 65 6e 20 62 75 69 6c 74 20 77 69 74 68 20 77 65 62 70 61 63 6b 20 3a 28 0a 20 20 2f 2f 20 60 6c 69 62 2f 63 6c 69 60 20 6d 61 79 20 62 65 20 60 6c 69 62 2f 63 6c 69 2f 69 6e 64 65 78 2e 6a 73 60 20 6f 72 20 60 6c 69 62 2f 63 6c 69 2e 6a 73 60 20 64 65 70 65 6e 64 69 6e 67 20 6f 6e 20 74 68 65 20 62 75 69 6c 64 2e 0a 20 20 76 61 72 20 63 6c 69 20 3d 20 72 65 71 75 69 72 65 28 5f 5f 64 69 72 6e 61 6d 65 20 2b 20 27 2f 2e 2e 2f 6c 69 62 2f 63 6c 69 27 29 3b 0a 20 20 69 66 20 28 21 63 6c 69 2e 61 75 74 6f 52 75 6e 29 20 7b 0a 20 20 20 20 63 6c 69 2e 64 65 66 61 75 6c 74 28 29 2e 63 61 74 63 68 28 66 75 6e 63 74 69 6f 6e 28 65 72 72 6f 72 29 20 7b 0a 20 20 20 20 20 20 63 6f 6e 73 6f 6c 65 2e 65 72 72 6f 72 28 65 72 72 6f 72 2e 73 74 61 63 6b 20 7c 7c 20 65 72 72 6f 72 2e 6d 65 73 73 61 67 65 20 7c 7c 20 65 72 72 6f 72 29 3b 0a 20 20 20 20 20 20 70 72 6f 63 65 73 73 2e 65 78 69 74 43 6f 64 65 20 3d 20 31 3b 0a 20 20 20 20 7d 29 3b 0a 20 20 7d 0a 7d 0a}
condition:
      filesize < 2KB and
      8 of them and $magic
}

rule gtfobins_binaries_lwp_request {
   strings:
      $s1 = "    -o <format>   Process HTML content in various ways" fullword ascii
      $s2 = "lwp-request - Simple command line user agent" fullword ascii
      $s3 = "    -c <conttype> use this content-type for POST, PUT, PATCH" fullword ascii
      $s4 = "local file system. The request content for POST, PUT and PATCH" fullword ascii
      $s5 = "The C<html> format will reformat the HTML code and the C<dump> format" fullword ascii
      $s6 = "C<html> and C<dump>." fullword ascii
      $s7 = "    binmode STDIN unless -t or $options{'a'};" fullword ascii
      $s8 = "    -d            Do not display content" fullword ascii
      $s9 = "for my $user_header (@{$options{'H'} || []}) {" fullword ascii
      $s10 = "    -a            Use text mode for content I/O" fullword ascii
      $s11 = "    if (lc($header_name) eq \"user-agent\") {" fullword ascii
      $s12 = "    -i <time>     Set the If-Modified-Since header on the request" fullword ascii
      $s13 = "                $options{'o'} eq 'dump' && do {" fullword ascii
      $s14 = "    -e            Display response headers (implies -s)" fullword ascii
      $s15 = "    -C <username>:<password>" fullword ascii
      $s16 = "            print STDERR \"Password: \";" fullword ascii
      $s17 = "    print STDERR \"Please enter content ($options{'c'}) to be ${method}ed:\\n\"" fullword ascii
      $s18 = "            my $password = <STDIN>;" fullword ascii
      $s19 = "    -p <proxyurl> use this as a proxy" fullword ascii
      $s20 = "    -v            Show program version" fullword ascii
      $s21 = "requests that take a content, i.e. POST, PUT and PATCH.  You can" fullword ascii
      $s22 = "my $ua = RequestAgent->new;" fullword ascii
      $s23 = "    sub get_basic_credentials {" fullword ascii
      $s24 = "                    $html->dump;" fullword ascii
      $s25 = "    $request->$header('Content-Type', $options{'c'});" fullword ascii
      $s26 = "my $method = uc(lc($progname) eq \"lwp-request\" ? \"GET\" : $progname);" fullword ascii
      $s27 = "    $request->header('Content-Length', length $content);    # Not really needed" fullword ascii
      $s28 = "    'c=s',     # content type for POST, PUT and PATCH" fullword ascii
      $s29 = "my $content;" fullword ascii
      $s30 = "    -E            Display whole chain of headers (implies -S and -U)" fullword ascii
      $s31 = "    -U            Display request headers (implies -u)" fullword ascii
      $s32 = "        if ($options{'o'} && $response->content_type eq 'text/html') {" fullword ascii
      $s33 = "    -u            Display method and URL before any response" fullword ascii
      $s34 = "This is lwp-request version $LWP::VERSION ($DISTNAME)" fullword ascii
      $s35 = "            my $netloc = $uri->host_port;" fullword ascii
      $s36 = "    -H <header>   send this HTTP header (you can specify several)" fullword ascii
      $s37 = "    my ($header_name, $header_value) = split /\\s*:\\s*/, $user_header, 2;" fullword ascii
      $s38 = "        die \"$progname: Illegal time syntax for -i option\\n\"" fullword ascii
      $s39 = "    -h            Print this message" fullword ascii
      $s40 = "my $errors = 0;" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 65 72 6c 0a 0a 23 20 53 69 6d 70 6c 65 20 75 73 65 72 20 61 67 65 6e 74 20 75 73 69 6e 67 20 4c 57 50 20 6c 69 62 72 61 72 79 2e 0a 0a 3d 68 65 61 64 31 20 4e 41 4d 45 0a 0a 6c 77 70 2d 72 65 71 75 65 73 74 20 2d 20 53 69 6d 70 6c 65 20 63 6f 6d 6d 61 6e 64 20 6c 69 6e 65 20 75 73 65 72 20 61 67 65 6e 74 0a 0a 3d 68 65 61 64 31 20 53 59 4e 4f 50 53 49 53 0a 0a 42 3c 6c 77 70 2d 72 65 71 75 65 73 74 3e 20 5b 42 3c 2d 61 66 50 75 55 73 53 65 64 76 68 78 3e 5d 20 5b 42 3c 2d 6d 3e 20 49 3c 6d 65 74 68 6f 64 3e 5d 20 5b 42 3c 2d 62 3e 20 49 3c 62 61 73 65 20 55 52 4c 3e 5d 20 5b 42 3c 2d 74 3e 20 49 3c 74 69 6d 65 6f 75 74 3e 5d 0a 20 20 20 20 20 20 20 20 20 20 20 20 5b 42 3c 2d 69 3e 20 49 3c 69 66 2d 6d 6f 64 69 66 69 65 64 2d 73 69 6e 63 65 3e 5d 20 5b 42 3c 2d 63 3e 20 49 3c 63 6f 6e 74 65 6e 74 2d 74 79 70 65 3e 5d 0a 20 20 20 20 20 20 20 20 20 20 20 20 5b 42 3c 2d 43 3e 20 49 3c 63 72 65 64 65 6e 74 69 61 6c 73 3e 5d 20 5b 42 3c 2d 70 3e 20 49 3c 70 72 6f 78 79 2d 75 72 6c 3e 5d 20 5b 42 3c 2d 6f 3e 20 49 3c 66 6f 72 6d 61 74 3e 5d 20 49 3c 75 72 6c 3e 2e 2e 2e 0a 0a 3d 68 65 61 64 31 20 44 45 53 43 52 49 50 54 49 4f 4e 0a 0a 54 68 69 73 20 70 72 6f 67 72 61 6d 20 63 61 6e 20 62 65 20 75 73 65 64 20 74 6f 20 73 65 6e 64 20 72 65 71 75 65 73 74 73 20 74 6f 20 57 57 57 20 73 65 72 76 65 72 73 20 61 6e 64 20 79 6f 75 72 0a 6c 6f 63 61 6c 20 66 69 6c 65 20 73 79 73 74 65 6d 2e 20 54 68 65 20 72 65 71 75 65 73 74 20 63 6f 6e 74 65 6e 74 20 66 6f 72 20 50 4f 53 54 2c 20 50 55 54 20 61 6e 64 20 50 41 54 43 48 0a 6d 65 74 68 6f 64 73 20 69 73 20 72 65 61 64 20 66 72 6f 6d 20 73 74 64 69 6e 2e 20 20 54 68 65 20 63 6f 6e 74 65 6e 74 20 6f 66 20 74 68 65 20 72 65 73 70 6f 6e 73 65 20 69 73 20 70 72 69 6e 74 65 64 20 6f 6e 0a 73 74 64 6f 75 74 2e 20 20 45 72 72 6f 72 20 6d 65 73 73 61 67 65 73 20 61 72 65 20 70 72 69 6e 74 65 64 20 6f 6e 20 73 74 64 65 72 72 2e 20 20 54 68 65 20 70 72 6f 67 72 61 6d 20 72 65 74 75 72 6e 73 20 61 0a 73 74 61 74 75 73 20 76 61 6c 75 65 20 69 6e 64 69 63 61 74 69 6e 67 20 74 68 65 20 6e 75 6d 62 65 72 20 6f 66 20 55 52 4c 73 20 74 68 61 74 20 66 61 69 6c 65 64 2e 0a 0a 54 68 65 20 6f 70 74 69 6f 6e 73 20 61 72 65 3a 0a 0a 3d 6f 76 65 72 20 34 0a 0a 3d 69 74 65 6d 20 2d 6d 20 3c 6d 65 74 68 6f 64 3e 0a 0a 53 65 74 20 77 68 69 63 68 20 6d 65 74 68 6f 64 20 74 6f 20 75 73 65 20 66 6f 72 20 74 68 65 20 72 65 71 75 65 73 74 2e 20 20 49 66 20 74 68 69 73 20 6f 70 74 69 6f 6e 20 69 73 20 6e 6f 74 20 75 73 65 64 2c 0a 74 68 65 6e 20 74 68 65 20 6d 65 74 68 6f 64 20 69 73 20 64 65 72 69 76 65 64 20 66 72 6f 6d 20 74 68 65 20 6e 61 6d 65 20 6f 66 20 74 68 65 20 70 72 6f 67 72 61 6d 2e 0a 0a 3d 69 74 65 6d 20 2d 66 0a 0a 46 6f 72 63 65 20 72 65 71 75 65 73 74 20 74 68 72 6f 75 67 68 2c 20 65 76 65 6e 20 69 66 20 74 68 65 20 70 72 6f 67 72 61 6d 20 62 65 6c 69 65 76 65 73 20 74 68 61 74 20 74 68 65 20 6d 65 74 68 6f 64 20 69 73 0a 69 6c 6c 65 67 61 6c 2e 20 20 54 68 65 20 73 65 72 76 65 72 20 6d 69 67 68 74 20 72 65 6a 65 63 74 20 74 68 65 20 72 65 71 75 65 73 74 20 65 76}
condition:
      filesize < 50KB and
      8 of them and $magic
}

rule gtfobins_binaries_lwp_download {
   strings:
      $s1 = " $ lwp-download http://www.perl.com/CPAN/src/latest.tar.gz" fullword ascii
      $s2 = "    agent      => \"lwp-download/$LWP::UserAgent::VERSION \"," fullword ascii
      $s3 = "   -s   use HTTP headers to guess output filename" fullword ascii
      $s4 = "                        \"Will not save <$url> as \\\"$file\\\".\\nPlease override file name on the command line.\\n\";" fullword ascii
      $s5 = " on the command line.\\n\"" fullword ascii
      $s6 = "                        \"Will not save <$url> to link \\\"$file\\\".\\nPlease override file name on the command line.\\n\";" fullword ascii
      $s7 = "                        \"Will not save <$url> as \\\"$file\\\" without verification.\\nEither run from terminal or override fil" ascii
      $s8 = "            if (defined $argfile && -d $argfile) {" fullword ascii
      $s9 = " lwp-download [-a] [-s] <url> [<local path>]" fullword ascii
      $s10 = "use Getopt::Long qw(HelpMessage :config gnu_getopt no_ignore_case auto_help);" fullword ascii
      $s11 = "                my $secs_left = fduration($dur / $perc - $dur);" fullword ascii
      $s12 = "make a difference on DOSish systems." fullword ascii
      $s13 = "   -a   save the file in ASCII mode" fullword ascii
      $s14 = "            my $dur = time - $start_t;" fullword ascii
      $s15 = "    $secs -= $hours * 60 * 60;" fullword ascii
      $s16 = "        print \"\\r$mess\" . (\" \" x (75 - length $mess));" fullword ascii
      $s17 = "    HTTP::Request->new(GET => $url)," fullword ascii
      $s18 = "HelpMessage() if defined($argfile) && !length($argfile);" fullword ascii
      $s19 = "    my $dur = time - $start_t;" fullword ascii
      $s20 = "            }" fullword ascii /* reversed goodware string '}            ' */
      $s21 = "                }" fullword ascii /* reversed goodware string '}                ' */
      $s22 = "                    }" fullword ascii /* reversed goodware string '}                    ' */
      $s23 = "                        }" fullword ascii /* reversed goodware string '}                        ' */
      $s24 = "                {" fullword ascii /* reversed goodware string '{                ' */
      $s25 = "                print \"Truncated file kept: \", fbytes($length - $size)," fullword ascii
      $s26 = "                    {" fullword ascii /* reversed goodware string '{                    ' */
      $s27 = "my $file;       # name of file we download into" fullword ascii
      $s28 = "my $start_t;    # start time of download" fullword ascii
      $s29 = "my $url = URI->new(decode(locale => shift) || HelpMessage());" fullword ascii
      $s30 = "my $length;     # total number of bytes to download" fullword ascii
      $s31 = "my $progname = $0;" fullword ascii /* Goodware String - occured 1 times */
      $s32 = "The I<lwp-download> program is implemented using the I<libwww-perl>" fullword ascii /* Goodware String - occured 1 times */
      $s33 = "my $argfile = encode(locale_fs => decode(locale => shift));" fullword ascii /* Goodware String - occured 1 times */
      $s34 = "$progname =~ s,.*\\\\,, if $^O eq \"MSWin32\";" fullword ascii /* Goodware String - occured 1 times */
      $s35 = "use LWP::MediaTypes qw(guess_media_type media_suffix);" fullword ascii /* Goodware String - occured 1 times */
      $s36 = "lwp-download - Fetch large files from the web" fullword ascii /* Goodware String - occured 1 times */
      $s37 = ") or HelpMessage();" fullword ascii
      $s38 = "$progname =~ s,.*/,,;    # only basename left in progname" fullword ascii /* Goodware String - occured 1 times */
      $s39 = "                    elsif ($url->scheme eq 'ftp'" fullword ascii
      $s40 = "Use the C<-a> option to save the file in text (ASCII) mode.  Might" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 65 72 6c 0a 0a 3d 68 65 61 64 31 20 4e 41 4d 45 0a 0a 6c 77 70 2d 64 6f 77 6e 6c 6f 61 64 20 2d 20 46 65 74 63 68 20 6c 61 72 67 65 20 66 69 6c 65 73 20 66 72 6f 6d 20 74 68 65 20 77 65 62 0a 0a 3d 68 65 61 64 31 20 53 59 4e 4f 50 53 49 53 0a 0a 20 6c 77 70 2d 64 6f 77 6e 6c 6f 61 64 20 5b 2d 61 5d 20 5b 2d 73 5d 20 3c 75 72 6c 3e 20 5b 3c 6c 6f 63 61 6c 20 70 61 74 68 3e 5d 0a 0a 20 4f 70 74 69 6f 6e 73 3a 0a 0a 20 20 20 2d 61 20 20 20 73 61 76 65 20 74 68 65 20 66 69 6c 65 20 69 6e 20 41 53 43 49 49 20 6d 6f 64 65 0a 20 20 20 2d 73 20 20 20 75 73 65 20 48 54 54 50 20 68 65 61 64 65 72 73 20 74 6f 20 67 75 65 73 73 20 6f 75 74 70 75 74 20 66 69 6c 65 6e 61 6d 65 0a 0a 3d 68 65 61 64 31 20 44 45 53 43 52 49 50 54 49 4f 4e 0a 0a 54 68 65 20 42 3c 6c 77 70 2d 64 6f 77 6e 6c 6f 61 64 3e 20 70 72 6f 67 72 61 6d 20 77 69 6c 6c 20 73 61 76 65 20 74 68 65 20 66 69 6c 65 20 61 74 20 49 3c 75 72 6c 3e 20 74 6f 20 61 20 6c 6f 63 61 6c 0a 66 69 6c 65 2e 0a 0a 49 66 20 49 3c 6c 6f 63 61 6c 20 70 61 74 68 3e 20 69 73 20 6e 6f 74 20 73 70 65 63 69 66 69 65 64 2c 20 74 68 65 6e 20 74 68 65 20 63 75 72 72 65 6e 74 20 64 69 72 65 63 74 6f 72 79 20 69 73 0a 61 73 73 75 6d 65 64 2e 0a 0a 49 66 20 49 3c 6c 6f 63 61 6c 20 70 61 74 68 3e 20 69 73 20 61 20 64 69 72 65 63 74 6f 72 79 2c 20 74 68 65 6e 20 74 68 65 20 6c 61 73 74 20 73 65 67 6d 65 6e 74 20 6f 66 20 74 68 65 20 70 61 74 68 20 6f 66 20 74 68 65 0a 49 3c 75 72 6c 3e 20 69 73 20 61 70 70 65 6e 64 65 64 20 74 6f 20 66 6f 72 6d 20 61 20 6c 6f 63 61 6c 20 66 69 6c 65 6e 61 6d 65 2e 20 20 49 66 20 74 68 65 20 49 3c 75 72 6c 3e 20 70 61 74 68 20 65 6e 64 73 20 77 69 74 68 0a 73 6c 61 73 68 20 74 68 65 20 6e 61 6d 65 20 22 69 6e 64 65 78 22 20 69 73 20 75 73 65 64 2e 20 20 57 69 74 68 20 74 68 65 20 42 3c 2d 73 3e 20 6f 70 74 69 6f 6e 20 70 69 63 6b 20 75 70 20 74 68 65 20 6c 61 73 74 20 73 65 67 6d 65 6e 74 0a 6f 66 20 74 68 65 20 66 69 6c 65 6e 61 6d 65 20 66 72 6f 6d 20 73 65 72 76 65 72 20 70 72 6f 76 69 64 65 64 20 73 6f 75 72 63 65 73 20 6c 69 6b 65 20 74 68 65 20 43 6f 6e 74 65 6e 74 2d 44 69 73 70 6f 73 69 74 69 6f 6e 0a 68 65 61 64 65 72 20 6f 72 20 61 6e 79 20 72 65 64 69 72 65 63 74 20 55 52 4c 73 2e 20 20 41 20 66 69 6c 65 20 65 78 74 65 6e 73 69 6f 6e 20 74 6f 20 6d 61 74 63 68 20 74 68 65 20 73 65 72 76 65 72 20 72 65 70 6f 72 74 65 64 0a 43 6f 6e 74 65 6e 74 2d 54 79 70 65 20 6d 69 67 68 74 20 61 6c 73 6f 20 62 65 20 61 70 70 65 6e 64 65 64 2e 20 20 49 66 20 61 20 66 69 6c 65 20 77 69 74 68 20 74 68 65 20 70 72 6f 64 75 63 65 64 20 66 69 6c 65 6e 61 6d 65 0a 61 6c 72 65 61 64 79 20 65 78 69 73 74 73 2c 20 74 68 65 6e 20 42 3c 6c 77 70 2d 64 6f 77 6e 6c 6f 61 64 3e 20 77 69 6c 6c 20 70 72 6f 6d 70 74 20 62 65 66 6f 72 65 20 69 74 20 6f 76 65 72 77 72 69 74 65 73 20 61 6e 64 20 77 69 6c 6c 0a 66 61 69 6c 20 69 66 20 69 74 73 20 73 74 61 6e 64 61 72 64 20 69 6e 70 75 74 20 69 73 20 6e 6f 74 20 61 20 74 65 72 6d 69 6e 61 6c 2e 20 20 54 68 69 73 20 66 6f 72 6d 20 6f 66 20 69 6e 76 6f 63 61 74 69 6f 6e 20 77 69 6c 6c 0a 61 6c 73 6f 20 66 61}
condition:
      filesize < 30KB and
      8 of them and $magic
}

rule gtfobins_binaries_cpan {
   strings:
      $s1 = "Oslo Consensus: L<https://github.com/Perl-Toolchain-Gang/toolchain-site/blob/master/oslo-consensus.md>" fullword ascii
      $s2 = "https://github.com/andk/cpanpm" fullword ascii
      $s3 = "Drop in the CPAN.pm shell. This command does this automatically if you don't" fullword ascii
      $s4 = "Lancaster Consensus: L<https://github.com/Perl-Toolchain-Gang/toolchain-site/blob/master/lancaster-consensus.md>" fullword ascii
      $s5 = "=item CPANSCRIPT_LOGLEVEL" fullword ascii
      $s6 = "    eval 'exec /usr/bin/perl -S $0 ${1+\"$@\"}'" fullword ascii
      $s7 = "Dump all the namespaces to standard output." fullword ascii
      $s8 = "The log level to use, with either the embedded, minimal logger or" fullword ascii
      $s9 = "# one time mirror override for faster mirrors" fullword ascii
      $s10 = "Ping the configured mirrors and print a report" fullword ascii
      $s11 = "if 0; # ^ Run only under a shell" fullword ascii
      $s12 = "=item GIT_COMMAND" fullword ascii
      $s13 = "add to those you specify on the command line." fullword ascii
      $s14 = "The script exits with zero if it thinks that everything worked, or a" fullword ascii
      $s15 = "A comma-separated list of mirrors to use for just this run. The C<-P>" fullword ascii
      $s16 = "the C<Log::Log4perl> levels: C<TRACE>, C<DEBUG>, C<INFO>, C<WARN>," fullword ascii
      $s17 = "=head2 Environment variables" fullword ascii
      $s18 = "L<Log::Log4perl> if it is installed. Possible values are the same as" fullword ascii
      $s19 = "# install modules but without testing them" fullword ascii
      $s20 = "=item -X" fullword ascii
      $s21 = "=item -w" fullword ascii
      $s22 = "=item -n" fullword ascii
      $s23 = "cpan -Ti CGI::Minimal URI" fullword ascii
      $s24 = "C<ERROR>, and C<FATAL>. The default is C<INFO>." fullword ascii
      $s25 = "The path to the C<git> binary to use for the Git features. The default" fullword ascii
      $s26 = "Do a dry run, but don't actually install anything. (unimplemented)" fullword ascii
      $s27 = "=item -t module [ module ... ]" fullword ascii
      $s28 = "There are several components in CPAN.pm that use environment variables." fullword ascii
      $s29 = "# use local::lib" fullword ascii
      $s30 = "if ( CPAN::Version->vlt($App::Cpan::VERSION, $minver) ) {" fullword ascii
      $s31 = "C<-l> was already taken." fullword ascii
      $s32 = "=item -x module [ module ... ]" fullword ascii
      $s33 = "List all installed modules with their versions" fullword ascii
      $s34 = "Turn off CPAN.pm's attempts to lock anything. You should be careful with" fullword ascii
      $s35 = "that do that correctly. C<cpan(1)> sets this to C<1> unless it already" fullword ascii
      $s36 = "$VERSION = '1.64';" fullword ascii
      $s37 = "cpan -p ..." fullword ascii
      $s38 = "to C<1> unless it already has a value (even if that value is false)." fullword ascii
      $s39 = "=item -i module [ module ... ]" fullword ascii
      $s40 = "same format as the standard F<CPAN/Config.pm> file, which defines" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 65 72 6c 0a 20 20 20 20 65 76 61 6c 20 27 65 78 65 63 20 2f 75 73 72 2f 62 69 6e 2f 70 65 72 6c 20 2d 53 20 24 30 20 24 7b 31 2b 22 24 40 22 7d 27 0a 09 69 66 20 30 3b 20 23 20 5e 20 52 75 6e 20 6f 6e 6c 79 20 75 6e 64 65 72 20 61 20 73 68 65 6c 6c 0a 23 21 2f 75 73 72 2f 6c 6f 63 61 6c 2f 62 69 6e 2f 70 65 72 6c 0a 0a 42 45 47 49 4e 20 7b 20 70 6f 70 20 40 49 4e 43 20 69 66 20 24 49 4e 43 5b 2d 31 5d 20 65 71 20 27 2e 27 20 7d 0a 75 73 65 20 73 74 72 69 63 74 3b 0a 75 73 65 20 76 61 72 73 20 71 77 28 24 56 45 52 53 49 4f 4e 29 3b 0a 0a 75 73 65 20 41 70 70 3a 3a 43 70 61 6e 3b 0a 75 73 65 20 43 50 41 4e 3a 3a 56 65 72 73 69 6f 6e 3b 0a 6d 79 20 24 6d 69 6e 76 65 72 20 3d 20 27 31 2e 36 34 27 3b 0a 69 66 20 28 20 43 50 41 4e 3a 3a 56 65 72 73 69 6f 6e 2d 3e 76 6c 74 28 24 41 70 70 3a 3a 43 70 61 6e 3a 3a 56 45 52 53 49 4f 4e 2c 20 24 6d 69 6e 76 65 72 29 20 29 20 7b 0a 20 20 20 20 77 61 72 6e 20 22 57 41 52 4e 49 4e 47 3a 20 79 6f 75 72 20 76 65 72 73 69 6f 6e 20 6f 66 20 41 70 70 3a 3a 43 70 61 6e 20 69 73 20 24 41 70 70 3a 3a 43 70 61 6e 3a 3a 56 45 52 53 49 4f 4e 20 77 68 69 6c 65 20 77 65 20 77 6f 75 6c 64 20 65 78 70 65 63 74 20 61 74 20 6c 65 61 73 74 20 24 6d 69 6e 76 65 72 22 3b 0a 7d 0a 24 56 45 52 53 49 4f 4e 20 3d 20 27 31 2e 36 34 27 3b 0a 0a 6d 79 20 24 72 63 20 3d 20 41 70 70 3a 3a 43 70 61 6e 2d 3e 72 75 6e 28 20 40 41 52 47 56 20 29 3b 0a 0a 23 20 77 69 6c 6c 20 74 68 69 73 20 77 6f 72 6b 20 75 6e 64 65 72 20 53 74 72 61 77 62 65 72 72 79 20 50 65 72 6c 3f 0a 65 78 69 74 28 20 24 72 63 20 7c 7c 20 30 20 29 3b 0a 0a 3d 68 65 61 64 31 20 4e 41 4d 45 0a 0a 63 70 61 6e 20 2d 20 65 61 73 69 6c 79 20 69 6e 74 65 72 61 63 74 20 77 69 74 68 20 43 50 41 4e 20 66 72 6f 6d 20 74 68 65 20 63 6f 6d 6d 61 6e 64 20 6c 69 6e 65 0a 0a 3d 68 65 61 64 31 20 53 59 4e 4f 50 53 49 53 0a 0a 09 23 20 77 69 74 68 20 61 72 67 75 6d 65 6e 74 73 20 61 6e 64 20 6e 6f 20 73 77 69 74 63 68 65 73 2c 20 69 6e 73 74 61 6c 6c 73 20 73 70 65 63 69 66 69 65 64 20 6d 6f 64 75 6c 65 73 0a 09 63 70 61 6e 20 6d 6f 64 75 6c 65 5f 6e 61 6d 65 20 5b 20 6d 6f 64 75 6c 65 5f 6e 61 6d 65 20 2e 2e 2e 20 5d 0a 0a 09 23 20 77 69 74 68 20 73 77 69 74 63 68 65 73 2c 20 69 6e 73 74 61 6c 6c 73 20 6d 6f 64 75 6c 65 73 20 77 69 74 68 20 65 78 74 72 61 20 62 65 68 61 76 69 6f 72 0a 09 63 70 61 6e 20 5b 2d 63 66 46 69 6d 74 54 77 5d 20 6d 6f 64 75 6c 65 5f 6e 61 6d 65 20 5b 20 6d 6f 64 75 6c 65 5f 6e 61 6d 65 20 2e 2e 2e 20 5d 0a 0a 09 23 20 75 73 65 20 6c 6f 63 61 6c 3a 3a 6c 69 62 0a 09 63 70 61 6e 20 2d 49 20 6d 6f 64 75 6c 65 5f 6e 61 6d 65 20 5b 20 6d 6f 64 75 6c 65 5f 6e 61 6d 65 20 2e 2e 2e 20 5d 0a 0a 09 23 20 6f 6e 65 20 74 69 6d 65 20 6d 69 72 72 6f 72 20 6f 76 65 72 72 69 64 65 20 66 6f 72 20 66 61 73 74 65 72 20 6d 69 72 72 6f 72 73 0a 09 63 70 61 6e 20 2d 70 20 2e 2e 2e 0a 0a 09 23 20 77 69 74 68 20 6a 75 73 74 20 74 68 65 20 64 6f 74 2c 20 69 6e 73 74 61 6c 6c 20 66 72 6f 6d 20 74 68 65 20 64 69 73 74 72 69 62 75 74 69 6f 6e 20 69 6e 20 74 68 65 0a 09 23 20 63 75 72 72 65 6e 74 20 64 69 72 65 63 74 6f 72 79}
condition:
      filesize < 20KB and
      8 of them and $magic
}

rule gtfobins_binaries_composer {
   strings:
      $s1 = "    echo 'Composer 2.3.0 dropped support for PHP <7.2.5 and you are running '.PHP_VERSION.', please upgrade PHP or use Composer " ascii
      $s2 = "// see https://github.com/php/php-src/issues/7896" fullword ascii
      $s3 = "    echo 'Composer 2.3.0 dropped support for PHP <7.2.5 and you are running '.PHP_VERSION.', please upgrade PHP or use Composer " ascii
      $s4 = "if (defined('HHVM_VERSION') && version_compare(HHVM_VERSION, '4.0', '>=')) {" fullword ascii
      $s5 = "use Composer\\Util\\ErrorHandler;" fullword ascii
      $s6 = "2.2 LTS via \"composer self-update --2.2\". Aborting.'.PHP_EOL;" fullword ascii
      $s7 = "    echo 'Warning: Composer should be invoked via the CLI version of PHP, not the '.PHP_SAPI.' SAPI'.PHP_EOL;" fullword ascii
      $s8 = "// run the command application" fullword ascii
      $s9 = "if (PHP_VERSION_ID >= 70113 && (PHP_VERSION_ID < 80016 || (PHP_VERSION_ID >= 80100 && PHP_VERSION_ID < 80103)) && Platform::isWi" ascii
      $s10 = "if (PHP_VERSION_ID >= 70113 && (PHP_VERSION_ID < 80016 || (PHP_VERSION_ID >= 80100 && PHP_VERSION_ID < 80103)) && Platform::isWi" ascii
      $s11 = "        if ($memoryLimit != -1 && $memoryInBytes($memoryLimit) < 1024 * 1024 * 1536) {" fullword ascii
      $s12 = "    echo 'HHVM 4.0 has dropped support for Composer, please use PHP instead. Aborting.'.PHP_EOL;" fullword ascii
      $s13 = "use Composer\\XdebugHandler\\XdebugHandler;" fullword ascii
      $s14 = "use Composer\\Util\\Platform;" fullword ascii
      $s15 = "require __DIR__ . '/../share/php/Composer/autoload.php';" fullword ascii
      $s16 = "if (PHP_VERSION_ID < 70205) {" fullword ascii
      $s17 = "Platform::putEnv('COMPOSER_BINARY', realpath($_SERVER['argv'][0]));" fullword ascii
      $s18 = "    if (0 === strpos(__FILE__, 'phar:') && ini_get('register_argc_argv')) {" fullword ascii
      $s19 = "$xdebug = new XdebugHandler('Composer');" fullword ascii
      $s20 = "if (PHP_SAPI !== 'cli' && PHP_SAPI !== 'phpdbg') {" fullword ascii
      $s21 = "    if ($memoryLimit = getenv('COMPOSER_MEMORY_LIMIT')) {" fullword ascii
      $s22 = "ErrorHandler::register();" fullword ascii
      $s23 = "if (!extension_loaded('iconv') && !extension_loaded('mbstring')) {" fullword ascii
      $s24 = "            }" fullword ascii /* reversed goodware string '}            ' */
      $s25 = "        .PHP_EOL.'Install either of them or recompile php without --disable-iconv.'" fullword ascii
      $s26 = "use Composer\\Console\\Application;" fullword ascii
      $s27 = "// Restart without Xdebug" fullword ascii
      $s28 = "ndows()) {" fullword ascii
      $s29 = "        if (($serverVal = getenv($serverVar)) !== false) {" fullword ascii
      $s30 = "        $memoryLimit = trim(ini_get('memory_limit'));" fullword ascii
      $s31 = "if (function_exists('ini_set')) {" fullword ascii
      $s32 = "unset($xdebug);" fullword ascii
      $s33 = "$xdebug->check();" fullword ascii
      $s34 = "// Workaround PHP bug on Windows where env vars containing Unicode chars are mangled in $_SERVER" fullword ascii
      $s35 = "            $unit = strtolower(substr($value, -1, 1));" fullword ascii
      $s36 = "error_reporting(-1);" fullword ascii /* Goodware String - occured 2 times */
      $s37 = "setlocale(LC_ALL, 'C');" fullword ascii
      $s38 = "$application->run();" fullword ascii
      $s39 = "#!/usr/bin/php" fullword ascii /* Goodware String - occured 3 times */
      $s40 = "    @ini_set('display_errors', '1');" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 68 70 0a 3c 3f 70 68 70 0a 0a 69 66 20 28 50 48 50 5f 53 41 50 49 20 21 3d 3d 20 27 63 6c 69 27 20 26 26 20 50 48 50 5f 53 41 50 49 20 21 3d 3d 20 27 70 68 70 64 62 67 27 29 20 7b 0a 20 20 20 20 69 66 20 28 30 20 3d 3d 3d 20 73 74 72 70 6f 73 28 5f 5f 46 49 4c 45 5f 5f 2c 20 27 70 68 61 72 3a 27 29 20 26 26 20 69 6e 69 5f 67 65 74 28 27 72 65 67 69 73 74 65 72 5f 61 72 67 63 5f 61 72 67 76 27 29 29 20 7b 0a 20 20 20 20 20 20 20 20 65 63 68 6f 20 27 43 6f 6d 70 6f 73 65 72 20 63 61 6e 6e 6f 74 20 62 65 20 72 75 6e 20 73 61 66 65 6c 79 20 6f 6e 20 6e 6f 6e 2d 43 4c 49 20 53 41 50 49 73 20 77 69 74 68 20 72 65 67 69 73 74 65 72 5f 61 72 67 63 5f 61 72 67 76 3d 4f 6e 2e 20 41 62 6f 72 74 69 6e 67 2e 27 2e 50 48 50 5f 45 4f 4c 3b 0a 20 20 20 20 20 20 20 20 65 78 69 74 28 31 29 3b 0a 20 20 20 20 7d 0a 0a 20 20 20 20 65 63 68 6f 20 27 57 61 72 6e 69 6e 67 3a 20 43 6f 6d 70 6f 73 65 72 20 73 68 6f 75 6c 64 20 62 65 20 69 6e 76 6f 6b 65 64 20 76 69 61 20 74 68 65 20 43 4c 49 20 76 65 72 73 69 6f 6e 20 6f 66 20 50 48 50 2c 20 6e 6f 74 20 74 68 65 20 27 2e 50 48 50 5f 53 41 50 49 2e 27 20 53 41 50 49 27 2e 50 48 50 5f 45 4f 4c 3b 0a 7d 0a 0a 69 66 20 28 50 48 50 5f 56 45 52 53 49 4f 4e 5f 49 44 20 3c 20 37 30 32 30 35 29 20 7b 0a 20 20 20 20 65 63 68 6f 20 27 43 6f 6d 70 6f 73 65 72 20 32 2e 33 2e 30 20 64 72 6f 70 70 65 64 20 73 75 70 70 6f 72 74 20 66 6f 72 20 50 48 50 20 3c 37 2e 32 2e 35 20 61 6e 64 20 79 6f 75 20 61 72 65 20 72 75 6e 6e 69 6e 67 20 27 2e 50 48 50 5f 56 45 52 53 49 4f 4e 2e 27 2c 20 70 6c 65 61 73 65 20 75 70 67 72 61 64 65 20 50 48 50 20 6f 72 20 75 73 65 20 43 6f 6d 70 6f 73 65 72 20 32 2e 32 20 4c 54 53 20 76 69 61 20 22 63 6f 6d 70 6f 73 65 72 20 73 65 6c 66 2d 75 70 64 61 74 65 20 2d 2d 32 2e 32 22 2e 20 41 62 6f 72 74 69 6e 67 2e 27 2e 50 48 50 5f 45 4f 4c 3b 0a 20 20 20 20 65 78 69 74 28 31 29 3b 0a 7d 0a 0a 73 65 74 6c 6f 63 61 6c 65 28 4c 43 5f 41 4c 4c 2c 20 27 43 27 29 3b 0a 72 65 71 75 69 72 65 20 5f 5f 44 49 52 5f 5f 20 2e 20 27 2f 2e 2e 2f 73 68 61 72 65 2f 70 68 70 2f 43 6f 6d 70 6f 73 65 72 2f 61 75 74 6f 6c 6f 61 64 2e 70 68 70 27 3b 0a 0a 75 73 65 20 43 6f 6d 70 6f 73 65 72 5c 43 6f 6e 73 6f 6c 65 5c 41 70 70 6c 69 63 61 74 69 6f 6e 3b 0a 75 73 65 20 43 6f 6d 70 6f 73 65 72 5c 58 64 65 62 75 67 48 61 6e 64 6c 65 72 5c 58 64 65 62 75 67 48 61 6e 64 6c 65 72 3b 0a 75 73 65 20 43 6f 6d 70 6f 73 65 72 5c 55 74 69 6c 5c 50 6c 61 74 66 6f 72 6d 3b 0a 75 73 65 20 43 6f 6d 70 6f 73 65 72 5c 55 74 69 6c 5c 45 72 72 6f 72 48 61 6e 64 6c 65 72 3b 0a 0a 65 72 72 6f 72 5f 72 65 70 6f 72 74 69 6e 67 28 2d 31 29 3b 0a 0a 2f 2f 20 52 65 73 74 61 72 74 20 77 69 74 68 6f 75 74 20 58 64 65 62 75 67 0a 24 78 64 65 62 75 67 20 3d 20 6e 65 77 20 58 64 65 62 75 67 48 61 6e 64 6c 65 72 28 27 43 6f 6d 70 6f 73 65 72 27 29 3b 0a 24 78 64 65 62 75 67 2d 3e 63 68 65 63 6b 28 29 3b 0a 75 6e 73 65 74 28 24 78 64 65 62 75 67 29 3b 0a 0a 69 66 20 28 64 65 66 69 6e 65 64 28 27 48 48 56 4d 5f 56 45 52 53 49 4f 4e 27 29 20 26 26 20 76 65 72 73 69 6f 6e 5f 63 6f 6d 70 61 72 65 28 48 48 56}
condition:
      filesize < 9KB and
      8 of them and $magic
}

rule gtfobins_binaries_arj {
   strings:
      $s1 = "Executing the command \"%s\"." fullword ascii
      $s2 = "OK to execute the command \"%s\"? " fullword ascii
      $s3 = "Usage: ARJSFX [-command] [-switch(s)] [directory\\] [file(s)]" fullword ascii
      $s4 = "Usage: ARJSFXV [-command] [-switch(s)] [directory\\] [file(s)]" fullword ascii
      $s5 = "OK to process next volume (%d)? " fullword ascii
      $s6 = "(near=%5u - %d, far=%6lu - %d, stack=%5u) " fullword ascii
      $s7 = "p: match with Pathname       !: execute command option" fullword ascii
      $s8 = "File is password encrypted, " fullword ascii
      $s9 = "k: long extract messages           !: execute command option" fullword ascii
      $s10 = "This EXE file is part of an ARJ multiple volume archive.  Executing" fullword ascii
      $s11 = "Enter garble password: " fullword ascii
      $s12 = "ARJ32 v %s%s, Copyright (c) 1998-2004, ARJ Software Russia." fullword ascii
      $s13 = "ARJSFX 3.10 - ARJ Archive Self-Extractor. %s -? for help." fullword ascii
      $s14 = "Enter system command.  Type EXIT to end." fullword ascii
      $s15 = "Enter system command: " fullword ascii
      $s16 = "ARJSFXV %s - ARJ Archive Self-Extractor. %s -? for help." fullword ascii
      $s17 = "Processing archive: %s" fullword ascii
      $s18 = "(max=%d, hbits=%d, dicsiz=%d, getsiz=%d, window=%d) " fullword ascii
      $s19 = "Copying temp %s to archive %s" fullword ascii
      $s20 = "arjs.txt" fullword ascii
      $s21 = "Yes, No, Quit, Always, Skip, Global, Command? " fullword ascii
      $s22 = "arjl.txt" fullword ascii
      $s23 = "ENVELOPE.KEY" fullword ascii
      $s24 = "Current comment for %s:" fullword ascii
      $s25 = "Unknown version: %d, " fullword ascii
      $s26 = "Invalid command: %s" fullword ascii
      $s27 = "Invalid comment header" fullword ascii
      $s28 = "Bad switch or command: %c" fullword ascii
      $s29 = "COMMAND> " fullword ascii
      $s30 = "Wrong encryption version: %d" fullword ascii
      $s31 = "Password option missing" fullword ascii
      $s32 = "Password missing" fullword ascii
      $s33 = "Bad file data or bad password" fullword ascii
      $s34 = "Passwords did not match!" fullword ascii
      $s35 = "Header data error" fullword ascii
      $s36 = "Bad file data or bad password, " fullword ascii
      $s37 = "*** Detected an OBSOLETE ARJ-SECURITY envelope.  NOT verified!" fullword ascii
      $s38 = "Size - %10ld - %s" fullword ascii
      $s39 = "Must specify only non-wildnames for order command" fullword ascii
      $s40 = "*** Valid ARJ-SECURITY envelope signature:" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 79 00 00 00 00 00 00 40 00 00 00 00 00 00 00 30 72 03 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a8 48 00 00 00 00 00 00 a8 48 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 e9 7a 02 00 00 00 00 00 e9 7a 02 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 d0 02 00 00 00 00 00 00 d0 02 00 00 00 00 00 00 d0 02 00 00 00 00 00 40 53 00 00 00 00 00 00 40 53 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 29 03 00 00 00 00 00 90 39 03 00 00 00 00 00 90 39 03 00 00 00 00 00 96 47 00 00 00 00 00 00 a0 80 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 40 2a 03 00 00 00 00 00 40 3a 03 00 00 00 00 00 40 3a 03 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 68 d7 02 00 00 00 00 00 68 d7 02 00 00 00 00 00 68 d7 02 00 00 00 00 00 d4 0a 00 00 00 00 00 00 d4 0a 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 29 03 00 00 00 00 00 90 39 03 00 00 00 00 00 90 39 03 00 00 00 00 00 70 06 00 00 00 00 00 00 70 06 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 b3 c3 d5 b6 23 f0 b4 ef 13 82 d8 f1 0a c1 7a 0c 1e bb a7 f4 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 76 00 00 00 01 00 00 00 06 00 00 00 08 01 a1 00 80 03 10 02 76 00 00 00 78 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 42 ea 20 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 9a 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 1000KB and
      8 of them and $magic
}

rule gtfobins_binaries_finger {
   strings:
      $s1 = "Last login %s on %s" fullword ascii
      $s2 = "Login: %-15s" fullword ascii
      $s3 = "usage: finger [-lmps] [login ...]" fullword ascii
      $s4 = "  *     *  No logins   " fullword ascii
      $s5 = "finger: %s: no such user." fullword ascii
      $s6 = " Tty      Idle  Login Time   Office     Office Phone" fullword ascii
      $s7 = "finger: %s: %s" fullword ascii
      $s8 = ".forward" fullword ascii
      $s9 = "Shell: %-s" fullword ascii
      $s10 = "Mail forwarded to " fullword ascii
      $s11 = "No one logged on." fullword ascii
      $s12 = "Never logged in." fullword ascii
      $s13 = "finger: unknown host: %s" fullword ascii
      $s14 = "b8ecd787953372a1f351fafde7809a226bd55b.debug" fullword ascii
      $s15 = "finger: tcp/finger: unknown service" fullword ascii
      $s16 = "On since %s on %s" fullword ascii
      $s17 = "Mail last read %s" fullword ascii
      $s18 = "$Id: finger.c,v 1.15 1999/12/18 16:41:51 dholland Exp $" fullword ascii
      $s19 = "Office Phone" fullword ascii
      $s20 = "Directory: %-25s" fullword ascii
      $s21 = "Project:" fullword ascii
      $s22 = "%d hour%s " fullword ascii
      $s23 = " (messages off)" fullword ascii
      $s24 = "finger: out of space." fullword ascii
      $s25 = "$Id: net.c,v 1.9 1999/09/14 10:51:11 dholland Exp $" fullword ascii
      $s26 = "$NetKit: bsd-finger-0.17 $" fullword ascii
      $s27 = "New mail received %s" fullword ascii
      $s28 = "$Id: lprint.c,v 1.11 1999/09/14 10:51:11 dholland Exp $" fullword ascii
      $s29 = ".project" fullword ascii
      $s30 = ".pgpkey" fullword ascii
      $s31 = "finger: connect: %s" fullword ascii
      $s32 = "finger: fdopen: %s" fullword ascii
      $s33 = "PGP key:" fullword ascii
      $s34 = "$Id: util.c,v 1.18 1999/09/28 22:53:58 netbug Exp $" fullword ascii
      $s35 = "b8ecd787953372a1f351fafde7809a226bd55b" ascii
      $s36 = "$Id: sprint.c,v 1.10 1999/12/12 18:59:33 dholland Exp $" fullword ascii
      $s37 = "finger: Out of space." fullword ascii
      $s38 = "%d minute%s " fullword ascii
      $s39 = " from %s" fullword ascii
      $s40 = "%s: %s, %s" fullword ascii /* Goodware String - occured 1 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 29 00 00 00 00 00 00 40 00 00 00 00 00 00 00 20 63 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0b 00 40 00 1b 00 1a 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 68 02 00 00 00 00 00 00 68 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 a8 02 00 00 00 00 00 00 a8 02 00 00 00 00 00 00 a8 02 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b8 14 00 00 00 00 00 00 b8 14 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 8d 2d 00 00 00 00 00 00 8d 2d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 80 0b 00 00 00 00 00 00 80 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 c8 5b 00 00 00 00 00 00 c8 6b 00 00 00 00 00 00 c8 6b 00 00 00 00 00 00 30 06 00 00 00 00 00 00 e0 12 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 5b 00 00 00 00 00 00 d8 6b 00 00 00 00 00 00 d8 6b 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 c4 02 00 00 00 00 00 00 c4 02 00 00 00 00 00 00 c4 02 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 24 54 00 00 00 00 00 00 24 54 00 00 00 00 00 00 24 54 00 00 00 00 00 00 fc 00 00 00 00 00 00 00 fc 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 c8 5b 00 00 00 00 00 00 c8 6b 00 00 00 00 00 00 c8 6b 00 00 00 00 00 00 38 04 00 00 00 00 00 00 38 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 60 b8 ec d7 87 95 33 72 a1 f3 51 fa fd e7 80 9a 22 6b d5 5b 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 03 00 00 00 44 00 00 00 01 00 00 00 06 00 00 00 00 01 81 00 00 01 18 02 44 00 00 00 46 00 00 00 47 00 00 00 28 1d 8c 1c d1 65 ce 6d 39 f2 8b 1c 33 c4 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d1 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 43 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 65 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 58 02 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 2a 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 9d 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 dc 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 80KB and
      8 of them and $magic
}

rule gtfobins_binaries_multitime {
   strings:
      $s1 = "  %s -b <file> [-f <rusage>] [-q] [-s <sleep>] [-n <numruns>]" fullword ascii
      $s2 = "In batch file mode, -I/-i/-o/-q must be specified per-command in the batch file." fullword ascii
      $s3 = "Error when attempting to run %s." fullword ascii
      $s4 = "  %s [-f <liketime|rusage>] [-I <replstr>] [-i <stdincmd>]" fullword ascii
      $s5 = "Error when attempting to run %s" fullword ascii
      $s6 = "===> Executing " fullword ascii
      $s7 = "Error when trying to read from '%s'" fullword ascii
      $s8 = "option requires an argument -- I at line %d" fullword ascii
      $s9 = "option requires an argument -- o at line %d" fullword ascii
      $s10 = "-q and -o are mutually exclusive." fullword ascii
      $s11 = "option requires an argument -- r at line %d" fullword ascii
      $s12 = "option requires an argument -- i at line %d" fullword ascii
      $s13 = "option name not given -- at line %d" fullword ascii
      $s14 = "unknown option -- %c at line %d" fullword ascii
      $s15 = "Missing command." fullword ascii
      $s16 = "Error when trying to fstat '%s'" fullword ascii
      $s17 = "Error when trying to open '%s'" fullword ascii
      $s18 = "    [-n <numruns> [-o <stdoutcmd>] [-q] [-s <sleep>] <command>" fullword ascii
      $s19 = "cmd->input_cmd" fullword ascii
      $s20 = "nsignals" fullword ascii
      $s21 = "inblock" fullword ascii
      $s22 = "oublock" fullword ascii
      $s23 = "liketime" fullword ascii
      $s24 = "Can't use batch file mode with -f liketime." fullword ascii
      $s25 = "Can't create temporary file." fullword ascii
      $s26 = "039c76a6d8ac866dfffc69e617eb8d970658d3.debug" fullword ascii
      $s27 = "'' ambiguous before a newline in strings %d." fullword ascii
      $s28 = "Unterminated string at line %d." fullword ascii
      $s29 = "'num runs' not a valid number." fullword ascii
      $s30 = "conf->num_cmds == 1" fullword ascii
      $s31 = "/tmp/mt.XXXXXXXX" fullword ascii
      $s32 = "===> %s results" fullword ascii
      $s33 = "read_input" fullword ascii
      $s34 = "'num runs' out of range." fullword ascii
      $s35 = "user %9lld.%02lld" fullword ascii
      $s36 = "Exiting because '%s' failed." fullword ascii
      $s37 = "maxrss" fullword ascii
      $s38 = "nivcsw" fullword ascii
      $s39 = "majflt" fullword ascii
      $s40 = "minflt" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 29 00 00 00 00 00 00 40 00 00 00 00 00 00 00 38 81 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0b 00 40 00 1b 00 1a 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 68 02 00 00 00 00 00 00 68 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 a8 02 00 00 00 00 00 00 a8 02 00 00 00 00 00 00 a8 02 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f0 11 00 00 00 00 00 00 f0 11 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 dd 3f 00 00 00 00 00 00 dd 3f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 d8 0e 00 00 00 00 00 00 d8 0e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 7c 00 00 00 00 00 00 30 8c 00 00 00 00 00 00 30 8c 00 00 00 00 00 00 e0 03 00 00 00 00 00 00 40 04 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 40 7c 00 00 00 00 00 00 40 8c 00 00 00 00 00 00 40 8c 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 c4 02 00 00 00 00 00 00 c4 02 00 00 00 00 00 00 c4 02 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 30 68 00 00 00 00 00 00 30 68 00 00 00 00 00 00 30 68 00 00 00 00 00 00 04 01 00 00 00 00 00 00 04 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 7c 00 00 00 00 00 00 30 8c 00 00 00 00 00 00 30 8c 00 00 00 00 00 00 d0 03 00 00 00 00 00 00 d0 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 83 03 9c 76 a6 d8 ac 86 6d ff fc 69 e6 17 eb 8d 97 06 58 d3 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 03 00 00 00 35 00 00 00 01 00 00 00 06 00 00 00 04 0d 81 00 20 01 1c 12 35 00 00 00 37 00 00 00 3a 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 4f 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 fd 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c3 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 20 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f6 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c3 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 9a 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_slsh {
   strings:
      $s1 = "***Warning: Executable compiled against S-Lang %s but linked to %s" fullword ascii
      $s2 = " -e string        Execute 'string' as S-Lang code" fullword ascii
      $s3 = "** Note: This program was compiled against version %s." fullword ascii
      $s4 = "*** Installation Problem?  Unable to find the %s config file." fullword ascii
      $s5 = "  Note: - and -i are mutually exclusive" fullword ascii
      $s6 = " -Dname           Define \"name\" as a preprocessor symbol" fullword ascii
      $s7 = "SLexecute_function" fullword ascii
      $s8 = "slsh version %s; " fullword ascii
      $s9 = "SL_Usage_Error" fullword ascii
      $s10 = "SLang_get_error" fullword ascii
      $s11 = "SLrline_set_update_postread_cb" fullword ascii
      $s12 = "slsh_set_update_postread_cb" fullword ascii
      $s13 = "SLang_getkey_intr_hook" fullword ascii
      $s14 = " -g               Compile with debugging code, tracebacks, etc" fullword ascii
      $s15 = "SL_RunTime_Error" fullword ascii
      $s16 = "Attempt to define an rline update callback without first creating a readline_update_hook" fullword ascii
      $s17 = "SLtt_get_screen_size" fullword ascii
      $s18 = "SLrline_get_update_client_data" fullword ascii
      $s19 = "SLpath_getcwd" fullword ascii
      $s20 = "SLpath_get_load_path" fullword ascii
      $s21 = "Usage: rline_set_update_hook (rli [,&hook [,clientdata]]);" fullword ascii
      $s22 = "SLang_get_fun_from_ref" fullword ascii
      $s23 = "slsh_get_screen_size" fullword ascii
      $s24 = "slsh_get_prompt_hook" fullword ascii
      $s25 = "stty -echo" fullword ascii
      $s26 = "SLang_TT_Read_FD" fullword ascii
      $s27 = " -i               Force interactive input" fullword ascii
      $s28 = "slsh_set_readline_update_hook" fullword ascii
      $s29 = "SLsystem" fullword ascii
      $s30 = "SLang_run_hooks" fullword ascii
      $s31 = " -v               Show verbose loading messages" fullword ascii
      $s32 = "SLang_Version" fullword ascii
      $s33 = "slsh_readline_init" fullword ascii
      $s34 = "slsh_readline_noecho" fullword ascii
      $s35 = "SLKeyBoard_Quit" fullword ascii
      $s36 = "Error initializing terminal." fullword ascii
      $s37 = "SLrline_read_line" fullword ascii
      $s38 = "slsh_set_update_preread_cb" fullword ascii
      $s39 = "slsh_readline" fullword ascii
      $s40 = "slsh_use_readline" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 10 37 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 9b 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 48 2d 00 00 00 00 00 00 48 2d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 99 31 00 00 00 00 00 00 99 31 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 b4 13 00 00 00 00 00 00 b4 13 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 8d 00 00 00 00 00 00 b0 9d 00 00 00 00 00 00 b0 9d 00 00 00 00 00 00 48 0c 00 00 00 00 00 00 48 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c0 8d 00 00 00 00 00 00 c0 9d 00 00 00 00 00 00 c0 9d 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 90 78 00 00 00 00 00 00 90 78 00 00 00 00 00 00 90 78 00 00 00 00 00 00 3c 02 00 00 00 00 00 00 3c 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 8d 00 00 00 00 00 00 b0 9d 00 00 00 00 00 00 b0 9d 00 00 00 00 00 00 50 02 00 00 00 00 00 00 50 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 1b 94 ca 6a 2c 9a 1b 92 ce 3a 47 46 9c 37 1d 04 cd b6 0b d2 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 72 00 00 00 04 00 00 00 08 00 00 00 20 12 28 25 07 01 05 86 28 02 28 10 80 04 08 82 00 08 00 00 08 20 00 08 20 64 83 0d 23 08 22 04 00 00 00 00 72 00 00 00 73 00 00 00 74 00 00 00 76 00 00 00 79 00 00 00 7b 00 00 00 7d 00 00 00 80 00 00 00 81 00 00 00 82 00 00 00 84 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_ispell {
   strings:
      $s1 = "Illegal format hash table %s - expected magic2 0x%x, got 0x%x%s" fullword ascii
      $s2 = "Illegal format hash table %s - expected magic 0x%x, got 0x%x%s" fullword ascii
      $s3 = "Hash table options don't agree with buildhash - 0x%x/%d/%d vs. 0x%x/%d/%d%s" fullword ascii
      $s4 = "Usage: %s [-dfile | -pfile | -wchars | -Wn | -t | -n | -H | -x | -b | -S | -B | -C | -P | -m | -Lcontext | -M | -N | -Ttype | -k" ascii
      $s5 = "temporary file disappeared or is unreadable (%s)%s" fullword ascii
      $s6 = "@(#) Report bugs to ispell-bugs@itcorp.com.  Report Emacs-related bugs" fullword ascii
      $s7 = "Truncated hash table %s:  got %d bytes, expected %d%s" fullword ascii
      $s8 = "Usage: %s [-dfile | -pfile | -wchars | -Wn | -t | -n | -H | -x | -b | -S | -B | -C | -P | -m | -Lcontext | -M | -N | -Ttype | -k" ascii
      $s9 = "-Wdate-time -D_FORTIFY_SOURCE=2 -g -O2 -ffile-prefix-map=/build/reproducible-path/ispell-3.4.06=. -fstack-protector-strong -fsta" ascii
      $s10 = "@(#) to ispell-el-bugs@itcorp.com." fullword ascii
      $s11 = "TEMPNAME = \"%s\"" fullword ascii
      $s12 = "Null hash table %s%s" fullword ascii
      $s13 = "ounter,addtocontents,newenvironment,renewenvironment,newtheorem,theoremstyle,color,colorbox,textcolor,pagecolor,enlargethispage," ascii
      $s14 = "  flag %s%c: " fullword ascii
      $s15 = "temporary file" fullword ascii
      $s16 = "code,samp,kbd,pre,listing,address,style,script" fullword ascii
      $s17 = "-- Type space to continue --" fullword ascii
      $s18 = "Commands are:%s" fullword ascii
      $s19 = "@(#) 4. The code that causes the 'ispell -v' command to display a" fullword ascii
      $s20 = "-Wdate-time -D_FORTIFY_SOURCE=2 -g -O2 -ffile-prefix-map=/build/reproducible-path/ispell-3.4.06=. -fstack-protector-strong -fsta" ascii
      $s21 = "!COMMANDFORSPACE" fullword ascii
      $s22 = "DICTIONARY" fullword ascii
      $s23 = "ck-clash-protection -Wformat -Werror=format-security -fcf-protection  -Wall" fullword ascii
      $s24 = "framebox" fullword ascii
      $s25 = "!NO_MKSTEMP (MKSTEMP)" fullword ascii
      $s26 = "HASHSUFFIX = \"%s\"" fullword ascii
      $s27 = "ok (derives from root %s)" fullword ascii
      $s28 = "EGREPCMD = \"%s\"" fullword ascii
      $s29 = "MASTERHASH = \"%s\"" fullword ascii
      $s30 = "default.aff" fullword ascii
      $s31 = "SORTTMP = \"%s\"" fullword ascii
      $s32 = "MASTERDICTS=american.sml+ american.med+ american.lrg+ american.xlg+,HASHFILES=debian-none,EXTRADICT=debian-auto}" fullword ascii
      $s33 = "DEFHASH = \"%s\"" fullword ascii
      $s34 = "{british,MASTERDICTS=british.sml+ british.med+ british.lrg+ british.xlg+,HASHFILES=debian-none,EXTRADICT=debian-auto} {american," ascii
      $s35 = "BINDIR = \"%s\"" fullword ascii
      $s36 = "default.hash" fullword ascii
      $s37 = "       %s [-dfile | -pfile | -wchars | -Wn | -t | -n | -H | -Ttype | -ktype kws | -Fpgm] -l" fullword ascii
      $s38 = "{british,MASTERDICTS=british.sml+ british.med+ british.lrg+ british.xlg+,HASHFILES=debian-none,EXTRADICT=debian-auto} {american," ascii
      $s39 = "       %s [-dfile | -pfile | -ffile | -Wn | -t | -n | -H | -B | -C | -P | -m | -Ttype | -ktype kws | -Fpgm] [-a | -A]" fullword ascii
      $s40 = "end,vspace,hspace,cite,shortcite,ref,eqref,parbox,label,input,nocite,include,includeonly,documentstyle,documentclass,usepackage," ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 45 00 00 00 00 00 00 40 00 00 00 00 00 00 00 a8 93 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d0 1c 00 00 00 00 00 00 d0 1c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 11 03 01 00 00 00 00 00 11 03 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 01 00 00 00 00 00 00 30 01 00 00 00 00 00 00 30 01 00 00 00 00 00 b4 4e 00 00 00 00 00 00 b4 4e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 68 8b 01 00 00 00 00 00 68 8b 01 00 00 00 00 00 68 8b 01 00 00 00 00 00 a8 06 00 00 00 00 00 00 d0 31 03 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 78 8b 01 00 00 00 00 00 78 8b 01 00 00 00 00 00 78 8b 01 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 7c 5d 01 00 00 00 00 00 7c 5d 01 00 00 00 00 00 7c 5d 01 00 00 00 00 00 c4 03 00 00 00 00 00 00 c4 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 68 8b 01 00 00 00 00 00 68 8b 01 00 00 00 00 00 68 8b 01 00 00 00 00 00 98 04 00 00 00 00 00 00 98 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 2d 00 35 3d c7 80 2b e9 be f8 9d 98 d2 eb 40 43 c3 c4 cb 6f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 4e 00 00 00 01 00 00 00 06 00 00 00 00 15 a1 00 80 01 10 02 4e 00 00 00 50 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 0a 73 59 00 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b0 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 300KB and
      8 of them and $magic
}

rule gtfobins_binaries_flock {
   strings:
      $s1 = " -c, --command <command>  run a single command string through the shell" fullword ascii
      $s2 = " -F, --no-fork            execute command without forking" fullword ascii
      $s3 = " %1$s [options] <file>|<directory> -c <command>" fullword ascii
      $s4 = " -o, --close              close file descriptor before running command" fullword ascii
      $s5 = "--command" fullword ascii
      $s6 = "Manage file locks from shell scripts." fullword ascii
      $s7 = "%s: executing %s" fullword ascii
      $s8 = "failed to get lock" fullword ascii
      $s9 = "%s requires exactly one command argument" fullword ascii
      $s10 = "%s: getting lock took %ld.%06ld seconds" fullword ascii
      $s11 = " -s, --shared             get a shared lock" fullword ascii
      $s12 = "the --no-fork and --close options are incompatible" fullword ascii
      $s13 = "timeout while waiting to get lock" fullword ascii
      $s14 = " %1$s [options] <file descriptor number>" fullword ascii
      $s15 = "requires file descriptor, file or directory" fullword ascii
      $s16 = "waitpid failed" fullword ascii
      $s17 = " -E, --conflict-exit-code <number>  exit code after conflict or timeout" fullword ascii
      $s18 = " -x, --exclusive          get an exclusive lock (default)" fullword ascii
      $s19 = " %1$s [options] <file>|<directory> <command> [<argument>...]" fullword ascii
      $s20 = " -n, --nonblock           fail rather than wait" fullword ascii
      $s21 = "invalid exit code" fullword ascii
      $s22 = "invalid timeout value" fullword ascii
      $s23 = "shared" fullword ascii /* Goodware String - occured 165 times */
      $s24 = "nonblocking" fullword ascii /* Goodware String - occured 1 times */
      $s25 = "conflict-exit-code" fullword ascii
      $s26 = "8ac57664152153de695adf46b6d725952420af.debug" fullword ascii
      $s27 = "exit code out of range (expected 0 to 255)" fullword ascii
      $s28 = "flock(1)" fullword ascii
      $s29 = "+sexnoFuw:E:hV?" fullword ascii
      $s30 = "not enough arguments" fullword ascii /* Goodware String - occured 2 times */
      $s31 = "     --verbose            increase verbosity" fullword ascii
      $s32 = " -w, --timeout <secs>     wait for a limited amount of time" fullword ascii
      $s33 = " -u, --unlock             remove a lock" fullword ascii
      $s34 = "\\$XL+t$@H+\\$H" fullword ascii
      $s35 = "cannot set up timer" fullword ascii
      $s36 = "no-fork" fullword ascii
      $s37 = "%-26s%s" fullword ascii
      $s38 = "8ac57664152153de695adf46b6d725952420af" ascii
      $s39 = "timer_settime" fullword ascii /* Goodware String - occured 5 times */
      $s40 = "timer_delete" fullword ascii /* Goodware String - occured 5 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 31 00 00 00 00 00 00 40 00 00 00 00 00 00 00 18 82 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b0 18 00 00 00 00 00 00 b0 18 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 49 3c 00 00 00 00 00 00 49 3c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 00 60 00 00 00 00 00 00 18 16 00 00 00 00 00 00 18 16 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 79 00 00 00 00 00 00 f0 89 00 00 00 00 00 00 f0 89 00 00 00 00 00 00 74 06 00 00 00 00 00 00 00 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c0 7b 00 00 00 00 00 00 c0 8b 00 00 00 00 00 00 c0 8b 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 20 68 00 00 00 00 00 00 20 68 00 00 00 00 00 00 20 68 00 00 00 00 00 00 04 02 00 00 00 00 00 00 04 02 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 79 00 00 00 00 00 00 f0 89 00 00 00 00 00 00 f0 89 00 00 00 00 00 00 10 06 00 00 00 00 00 00 10 06 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 fe 8a c5 76 64 15 21 53 de 69 5a df 46 b6 d7 25 95 24 20 af 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_crontab {
   strings:
      $s1 = "%s: \"%s\" killed; signal %d (%score dumped)" fullword ascii
      $s2 = "Creation of temporary crontab file failed - aborting" fullword ascii
      $s3 = "# (Cron version -- %s)" fullword ascii
      $s4 = "# 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/" fullword ascii
      $s5 = "Temporary filename too long - aborting" fullword ascii
      $s6 = "# and what command to run for the task" fullword ascii
      $s7 = "get_num, compare(%s,%s)" fullword ascii
      $s8 = "# DO NOT EDIT THIS FILE - edit the master and reinstall." fullword ascii
      $s9 = "no crontab for %s - using an empty one" fullword ascii
      $s10 = "TMPDIR value is to long -- exiting" fullword ascii
      $s11 = "%s [ -u user ] [ -i ] { -e | -l | -r }" fullword ascii
      $s12 = "%s: usage error: %s" fullword ascii
      $s13 = "crontab command not allowed" fullword ascii
      $s14 = "unable to stat temp file" fullword ascii
      $s15 = "%s:  user `%s' unknown" fullword ascii
      $s16 = "user=%s, file=%s, option=%s" fullword ascii
      $s17 = "%s: waitpid() failed waiting for PID %d from \"%s\": %s" fullword ascii
      $s18 = "%s: getgrnam: %s" fullword ascii
      $s19 = "# Edit this file to introduce tasks to be run by cron." fullword ascii
      $s20 = "# Notice that tasks will be started based on the cron's system" fullword ascii
      $s21 = "load_env, <%s> <%s> -> <%s>" fullword ascii
      $s22 = "# Each task to run has to be defined through a single line" fullword ascii
      $s23 = "must be privileged to use -u" fullword ascii
      $s24 = "# email to the user the crontab file belongs to (unless redirected)." fullword ascii
      $s25 = "# m h  dom mon dow   command" fullword ascii
      $s26 = "# (%s installed on %-24.24s)" fullword ascii
      $s27 = "Temporary crontab no longer owned by you." fullword ascii
      $s28 = "only one operation permitted" fullword ascii
      $s29 = "The temporary crontab must remain a regular file" fullword ascii
      $s30 = "# Output of the crontab jobs (including errors) is sent through" fullword ascii
      $s31 = "%s/: mkstemp: %s" fullword ascii
      $s32 = "load_env, read <%s>" fullword ascii
      $s33 = "# For example, you can run a backup of all your user accounts" fullword ascii
      $s34 = "%s: panic: bad switch() in replace_cmd()" fullword ascii
      $s35 = "set_element(?,%d,%d,%d)" fullword ascii
      $s36 = "%s: wrong PID (%d != %d) from \"%s\"" fullword ascii
      $s37 = "%s: error while writing new crontab to %s" fullword ascii
      $s38 = "%s: %s: rename: %s" fullword ascii
      $s39 = "%s: \"%s\" exited with status %d" fullword ascii
      $s40 = "%s: your UID isn't in the passwd file." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 3e 00 00 00 00 00 00 40 00 00 00 00 00 00 00 60 b3 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c0 20 00 00 00 00 00 00 c0 20 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 35 4e 00 00 00 00 00 00 35 4e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 d4 20 00 00 00 00 00 00 d4 20 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 aa 00 00 00 00 00 00 50 ba 00 00 00 00 00 00 50 ba 00 00 00 00 00 00 70 07 00 00 00 00 00 00 b0 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 f0 aa 00 00 00 00 00 00 f0 ba 00 00 00 00 00 00 f0 ba 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 5c 95 00 00 00 00 00 00 5c 95 00 00 00 00 00 00 5c 95 00 00 00 00 00 00 6c 01 00 00 00 00 00 00 6c 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 aa 00 00 00 00 00 00 50 ba 00 00 00 00 00 00 50 ba 00 00 00 00 00 00 b0 05 00 00 00 00 00 00 b0 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 44 9c f5 a2 5e d0 d3 b3 cd 6a 20 07 d9 3c 12 3d ad f9 52 0b 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 61 00 00 00 01 00 00 00 06 00 00 00 00 05 a1 00 80 01 1c 02 61 00 00 00 63 00 00 00 65 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 59 00 00 00 12 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_tasksh {
   strings:
      $s1 = "    tasksh> exec ls -al      Any shell command.  May also use '!ls -al'" fullword ascii
      $s2 = "There are no tasks needing revi (Enter) Mark as reviewed, (s)kip, (e)dit, (m)odify, (c)omplete, (d)elete, (q)ui Enter modificati" ascii
      $s3 = "on args [example: +tag -tag /teh/the/ project:XCommand '{1}' is not recognized.End of review. {1} out of {2} ta tasks reviewed.T" ascii
      $s4 = "The review process is important for keeping your list accurate, so you are working on the right tasks." fullword ascii
      $s5 = "St11_Mutex_baseILN9__gnu_cxx12_Lock_policyE2EE" fullword ascii
      $s6 = "_ZTISt11_Mutex_baseILN9__gnu_cxx12_Lock_policyE2EE" fullword ascii
      $s7 = "_ZTSSt11_Mutex_baseILN9__gnu_cxx12_Lock_policyE2EE" fullword ascii
      $s8 = "_Z7executeRKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEERKSt6vectorIS4_SaIS4_EES6_RS4_" fullword ascii
      $s9 = "_ZNK3Pig4dumpB5cxx11Ev" fullword ascii
      $s10 = "Error: Could not get Hook exit status!" fullword ascii
      $s11 = "  Commands:" fullword ascii
      $s12 = "report._reviewed.description" fullword ascii
      $s13 = "_ZNK4Path10executableEv" fullword ascii
      $s14 = "_Z8cmdShellRKSt6vectorINSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEESaIS5_EE" fullword ascii
      $s15 = "Run 'man tasksh' from your shell prompt." fullword ascii
      $s16 = "bold white on magenta" fullword ascii
      $s17 = "./src/libshared/src/Datetime.cpp" fullword ascii
      $s18 = "asksh needs to define a 'reviewed' UDA of type 'date' for all tasks.  Ok to prodefine a '_reviewed' report to identify tasks nee" ascii
      $s19 = "_ZSt7getlineIcSt11char_traitsIcESaIcEERSt13basic_istreamIT_T0_ES7_RNSt7__cxx1112basic_stringIS4_S5_T1_EES4_" fullword ascii
      $s20 = "_ZN8Datetime19initializeYesterdayER3Pig" fullword ascii
      $s21 = "_ZN5Lexer20isTripleCharOperatorEiiii" fullword ascii
      $s22 = "_ZNSt23_Sp_counted_ptr_inplaceINSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEESaIvELN9__gnu_cxx12_Lock_policyE2EE14_M_get_d" ascii
      $s23 = "_ZN3Pig8getOneOfERKSt6vectorINSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEESaIS6_EERS6_" fullword ascii
      $s24 = "_ZN5Lexer20isDoubleCharOperatorEiii" fullword ascii
      $s25 = "_ZN3Pig9getDigit4ERi" fullword ascii
      $s26 = " Compliance: " fullword ascii
      $s27 = "_ZN3Pig10getDecimalERd" fullword ascii
      $s28 = "_ZN3Pig9getQuotedEiRNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s29 = "_ZN3Pig9getNumberERd" fullword ascii
      $s30 = "_ZN3Pig6getHMSERiS0_S0_" fullword ascii
      $s31 = "_ZNSt23_Sp_counted_ptr_inplaceINSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEESaIvELN9__gnu_cxx12_Lock_policyE2EE14_M_get_d" ascii
      $s32 = "_ZN3Pig9getDigitsERi" fullword ascii
      $s33 = "_ZN3Pig8getDigitERi" fullword ascii
      $s34 = "_ZN3Pig10getUntilWSERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s35 = "_ZN3Pig9getDigit3ERi" fullword ascii
      $s36 = "_ZN3Pig12getCharacterERi" fullword ascii
      $s37 = " +stdc_hosted" fullword ascii
      $s38 = "_ZN3Pig8getUntilEiRNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s39 = "_ZN3Pig9getNumberERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s40 = "_ZN3Pig10getDecimalERNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 03 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 6b 01 00 00 00 00 00 40 00 00 00 00 00 00 00 90 89 05 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 78 e9 00 00 00 00 00 00 78 e9 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 0d a5 03 00 00 00 00 00 0d a5 03 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 04 00 00 00 00 00 00 a0 04 00 00 00 00 00 00 a0 04 00 00 00 00 00 4b d1 00 00 00 00 00 00 4b d1 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 88 73 05 00 00 00 00 00 88 83 05 00 00 00 00 00 88 83 05 00 00 00 00 00 a5 14 00 00 00 00 00 00 18 24 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 50 79 05 00 00 00 00 00 50 89 05 00 00 00 00 00 50 89 05 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 a8 bf 04 00 00 00 00 00 a8 bf 04 00 00 00 00 00 a8 bf 04 00 00 00 00 00 c4 13 00 00 00 00 00 00 c4 13 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 88 73 05 00 00 00 00 00 88 83 05 00 00 00 00 00 88 83 05 00 00 00 00 00 78 0c 00 00 00 00 00 00 78 0c 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 71 7e 9b 4f 2d 43 ba 8a 94 5a 8d 1b c8 c8 99 47 9b 89 e0 55 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 07 01 00 00 91 00 00 00 40 00 00 00 0c 00 00 00 82 a8 03 82 26 20 e1 b3 d0 c0 84 23 02 50 09 2f 9e 15 08 18 00 30 20 7a 06 80 04 88 10 25 46 20 40 00 01 80 49 08 20 83 40 21 00 c0 96 40 80 02 87 90 43 00 00 00 08 12 ac 03 24 41 08 00 04 ca 82 8c 4a 99 68 06 74 90 40 a0 00 10 03 10 80 00}
condition:
      filesize < 1000KB and
      8 of them and $magic
}

rule gtfobins_binaries_ul {
   strings:
      $s1 = " -t, -T, --terminal TERMINAL  override the TERM environment variable" fullword ascii
      $s2 = "trouble reading terminfo" fullword ascii
      $s3 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/bsdextrautils.debug" fullword ascii
      $s4 = "terminal `%s' is not known, defaulting to `dumb'" fullword ascii
      $s5 = "cur_term" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "indicated" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "Do underlining." fullword ascii
      $s8 = "tigetflag" fullword ascii /* Goodware String - occured 2 times */
      $s9 = "del_curterm" fullword ascii /* Goodware String - occured 2 times */
      $s10 = "62e9708728c5cafe37b811ebf6aec2dd153c49.debug" fullword ascii
      $s11 = "unknown escape sequence in input: %o, %o" fullword ascii
      $s12 = " %s [options] [<file> ...]" fullword ascii
      $s13 = "%-30s%s" fullword ascii
      $s14 = "it:T:Vh" fullword ascii
      $s15 = "62e9708728c5cafe37b811ebf6aec2dd153c49" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 c0 2a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 51 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d8 12 00 00 00 00 00 00 d8 12 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 09 1b 00 00 00 00 00 00 09 1b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 88 08 00 00 00 00 00 00 88 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 4b 00 00 00 00 00 00 b0 5b 00 00 00 00 00 00 b0 5b 00 00 00 00 00 00 60 04 00 00 00 00 00 00 c0 04 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 60 4c 00 00 00 00 00 00 60 5c 00 00 00 00 00 00 60 5c 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 88 44 00 00 00 00 00 00 88 44 00 00 00 00 00 00 88 44 00 00 00 00 00 00 a4 00 00 00 00 00 00 00 a4 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 4b 00 00 00 00 00 00 b0 5b 00 00 00 00 00 00 b0 5b 00 00 00 00 00 00 50 04 00 00 00 00 00 00 50 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 71 62 e9 70 87 28 c5 ca fe 37 b8 11 eb f6 ae c2 dd 15 3c 49 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 70KB and
      8 of them and $magic
}

rule gtfobins_binaries_c89 {
   strings:
      $s1 = "exec gcc $extra_flag ${1+\"$@\"}" fullword ascii
      $s2 = "# The following options are the same (as of gcc-2.95):" fullword ascii
      $s3 = "# Call the appropriate C compiler with options to accept ANSI/ISO C" fullword ascii
      $s4 = "-ansi|-std=c89|-std=iso9899:1990)" fullword ascii
      $s5 = "extra_flag=-std=c89" fullword ascii
      $s6 = "#! /bin/sh" fullword ascii /* Goodware String - occured 2 times */
      $s7 = "for i; do" fullword ascii
      $s8 = "-std=*)" fullword ascii
      $magic = {23 21 20 2f 62 69 6e 2f 73 68 0a 0a 23 20 43 61 6c 6c 20 74 68 65 20 61 70 70 72 6f 70 72 69 61 74 65 20 43 20 63 6f 6d 70 69 6c 65 72 20 77 69 74 68 20 6f 70 74 69 6f 6e 73 20 74 6f 20 61 63 63 65 70 74 20 41 4e 53 49 2f 49 53 4f 20 43 0a 23 20 54 68 65 20 66 6f 6c 6c 6f 77 69 6e 67 20 6f 70 74 69 6f 6e 73 20 61 72 65 20 74 68 65 20 73 61 6d 65 20 28 61 73 20 6f 66 20 67 63 63 2d 32 2e 39 35 29 3a 0a 23 20 09 2d 61 6e 73 69 0a 23 20 09 2d 73 74 64 3d 63 38 39 0a 23 20 09 2d 73 74 64 3d 69 73 6f 39 38 39 39 3a 31 39 39 30 0a 0a 65 78 74 72 61 5f 66 6c 61 67 3d 2d 73 74 64 3d 63 38 39 0a 0a 66 6f 72 20 69 3b 20 64 6f 0a 20 20 20 20 63 61 73 65 20 22 24 69 22 20 69 6e 0a 09 2d 61 6e 73 69 7c 2d 73 74 64 3d 63 38 39 7c 2d 73 74 64 3d 69 73 6f 39 38 39 39 3a 31 39 39 30 29 0a 09 20 20 20 20 65 78 74 72 61 5f 66 6c 61 67 3d 0a 09 20 20 20 20 3b 3b 0a 09 2d 73 74 64 3d 2a 29 0a 09 20 20 20 20 65 63 68 6f 20 3e 26 32 20 22 60 62 61 73 65 6e 61 6d 65 20 24 30 60 20 63 61 6c 6c 65 64 20 77 69 74 68 20 6e 6f 6e 20 41 4e 53 49 2f 49 53 4f 20 43 20 6f 70 74 69 6f 6e 20 24 69 22 0a 09 20 20 20 20 65 78 69 74 20 31 0a 09 20 20 20 20 3b 3b 0a 20 20 20 20 65 73 61 63 0a 64 6f 6e 65 0a 0a 65 78 65 63 20 67 63 63 20 24 65 78 74 72 61 5f 66 6c 61 67 20 24 7b 31 2b 22 24 40 22 7d 0a}
condition:
      filesize < 1KB and
      all of them
}

rule gtfobins_binaries_gcore {
   strings:
      $s1 = "# When the -a option is present, this may hold additional commands" fullword ascii
      $s2 = "# Attempt to fetch the absolute path to the gcore script that was" fullword ascii
      $s3 = "# It starts up gdb, attaches to the given PID and invokes the gcore command." fullword ascii
      $s4 = "# to ensure gdb dumps all mappings (OS dependent)." fullword ascii
      $s5 = "dump_all_cmds=()" fullword ascii
      $s6 = "  # We got \".\" back as a path.  This means the user executed" fullword ascii
      $s7 = "# Need to check for -o option, but set default basename to \"core\"." fullword ascii
      $s8 = "  if test -f \"$binary_basename\" ; then" fullword ascii
      $s9 = "  # script via a shell interpreter (i.e. sh gcore)." fullword ascii
      $s10 = "if [ ! -f \"$binary_path/gdb\" ]; then" fullword ascii
      $s11 = "# Script to generate a core file of a running program." fullword ascii
      $s12 = "# available but not accessible as GDB would get stopped on SIGTTIN." fullword ascii
      $s13 = "                    dump_all_cmds+=(\"-ex\" \"set dump-excluded-mappings on\")" fullword ascii
      $s14 = "    \"${dump_all_cmds[@]}\" \\" fullword ascii
      $s15 = "                    dump_all_cmds=(\"-ex\" \"set use-coredump-filter off\")" fullword ascii
      $s16 = "if [ -r \"$prefix.$pid\" ] ; then" fullword ascii
      $s17 = "# Check if the GDB binary is in the expected path.  If not, just" fullword ascii
      $s18 = "  # So first we check if the script is in the current directory" fullword ascii
      $s19 = "    --nx --batch --readnever -iex 'set debuginfod enabled off' \\" fullword ascii
      $s20 = "  # the gcore script locally (i.e. ./gcore) or called the" fullword ascii
      $s21 = "while getopts :ao: opt; do" fullword ascii
      $s22 = "# `</dev/null' to avoid touching interactive terminal if it is" fullword ascii
      $s23 = "# Loop through pids" fullword ascii
      $s24 = "# Initialise return code." fullword ascii
      $s25 = "# quit with a message." fullword ascii
      $s26 = "\"$binary_path/gdb\" </dev/null \\" fullword ascii
      $s27 = "if test \"x$binary_path\" = x. ; then" fullword ascii
      $s28 = "  binary_basename=`basename \"$0\"`" fullword ascii
      $s29 = "binary_path=`dirname \"$0\"`" fullword ascii
      $s30 = "  echo \"gcore: GDB binary (${binary_path}/gdb) not found\"" fullword ascii
      $s31 = "  # If the gcore script was called like \"sh gcore\" and the script" fullword ascii
      $s32 = "#   Copyright (C) 2003-2024 Free Software Foundation, Inc." fullword ascii
      $s33 = "    # The gcore script was not found in \".\", which means the script" fullword ascii
      $s34 = "if [ \"$#\" -eq \"0\" ]" fullword ascii
      $s35 = "#!/usr/bin/env bash" fullword ascii
      $s36 = "  # lives in the current directory, \"which\" will not give us \"gcore\"." fullword ascii
      $s37 = "shift $((OPTIND-1))" fullword ascii
      $s38 = "  # before using the output of \"which\"." fullword ascii
      $s39 = "exit $rc" fullword ascii
      $s40 = "# called." fullword ascii /* Goodware String - occured 1 times */
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 65 6e 76 20 62 61 73 68 0a 0a 23 20 20 20 43 6f 70 79 72 69 67 68 74 20 28 43 29 20 32 30 30 33 2d 32 30 32 34 20 46 72 65 65 20 53 6f 66 74 77 61 72 65 20 46 6f 75 6e 64 61 74 69 6f 6e 2c 20 49 6e 63 2e 0a 0a 23 20 54 68 69 73 20 70 72 6f 67 72 61 6d 20 69 73 20 66 72 65 65 20 73 6f 66 74 77 61 72 65 3b 20 79 6f 75 20 63 61 6e 20 72 65 64 69 73 74 72 69 62 75 74 65 20 69 74 20 61 6e 64 2f 6f 72 20 6d 6f 64 69 66 79 0a 23 20 69 74 20 75 6e 64 65 72 20 74 68 65 20 74 65 72 6d 73 20 6f 66 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 61 73 20 70 75 62 6c 69 73 68 65 64 20 62 79 0a 23 20 74 68 65 20 46 72 65 65 20 53 6f 66 74 77 61 72 65 20 46 6f 75 6e 64 61 74 69 6f 6e 3b 20 65 69 74 68 65 72 20 76 65 72 73 69 6f 6e 20 33 20 6f 66 20 74 68 65 20 4c 69 63 65 6e 73 65 2c 20 6f 72 0a 23 20 28 61 74 20 79 6f 75 72 20 6f 70 74 69 6f 6e 29 20 61 6e 79 20 6c 61 74 65 72 20 76 65 72 73 69 6f 6e 2e 0a 23 0a 23 20 54 68 69 73 20 70 72 6f 67 72 61 6d 20 69 73 20 64 69 73 74 72 69 62 75 74 65 64 20 69 6e 20 74 68 65 20 68 6f 70 65 20 74 68 61 74 20 69 74 20 77 69 6c 6c 20 62 65 20 75 73 65 66 75 6c 2c 0a 23 20 62 75 74 20 57 49 54 48 4f 55 54 20 41 4e 59 20 57 41 52 52 41 4e 54 59 3b 20 77 69 74 68 6f 75 74 20 65 76 65 6e 20 74 68 65 20 69 6d 70 6c 69 65 64 20 77 61 72 72 61 6e 74 79 20 6f 66 0a 23 20 4d 45 52 43 48 41 4e 54 41 42 49 4c 49 54 59 20 6f 72 20 46 49 54 4e 45 53 53 20 46 4f 52 20 41 20 50 41 52 54 49 43 55 4c 41 52 20 50 55 52 50 4f 53 45 2e 20 20 53 65 65 20 74 68 65 0a 23 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 66 6f 72 20 6d 6f 72 65 20 64 65 74 61 69 6c 73 2e 0a 23 0a 23 20 59 6f 75 20 73 68 6f 75 6c 64 20 68 61 76 65 20 72 65 63 65 69 76 65 64 20 61 20 63 6f 70 79 20 6f 66 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 0a 23 20 61 6c 6f 6e 67 20 77 69 74 68 20 74 68 69 73 20 70 72 6f 67 72 61 6d 2e 20 20 49 66 20 6e 6f 74 2c 20 73 65 65 20 3c 68 74 74 70 3a 2f 2f 77 77 77 2e 67 6e 75 2e 6f 72 67 2f 6c 69 63 65 6e 73 65 73 2f 3e 2e 0a 0a 23 0a 23 20 53 63 72 69 70 74 20 74 6f 20 67 65 6e 65 72 61 74 65 20 61 20 63 6f 72 65 20 66 69 6c 65 20 6f 66 20 61 20 72 75 6e 6e 69 6e 67 20 70 72 6f 67 72 61 6d 2e 0a 23 20 49 74 20 73 74 61 72 74 73 20 75 70 20 67 64 62 2c 20 61 74 74 61 63 68 65 73 20 74 6f 20 74 68 65 20 67 69 76 65 6e 20 50 49 44 20 61 6e 64 20 69 6e 76 6f 6b 65 73 20 74 68 65 20 67 63 6f 72 65 20 63 6f 6d 6d 61 6e 64 2e 0a 23 0a 0a 23 20 4e 65 65 64 20 74 6f 20 63 68 65 63 6b 20 66 6f 72 20 2d 6f 20 6f 70 74 69 6f 6e 2c 20 62 75 74 20 73 65 74 20 64 65 66 61 75 6c 74 20 62 61 73 65 6e 61 6d 65 20 74 6f 20 22 63 6f 72 65 22 2e 0a 70 72 65 66 69 78 3d 63 6f 72 65 0a 0a 23 20 57 68 65 6e 20 74 68 65 20 2d 61 20 6f 70 74 69 6f 6e 20 69 73 20 70 72 65 73 65 6e 74 2c 20 74 68 69 73 20 6d 61 79 20 68 6f 6c 64 20 61 64 64 69 74 69 6f 6e 61 6c 20 63 6f 6d 6d 61 6e 64 73 0a 23 20 74 6f 20 65 6e 73 75 72 65 20 67 64 62 20 64 75 6d 70 73 20 61 6c}
condition:
      filesize < 10KB and
      8 of them and $magic
}

rule gtfobins_binaries_c99 {
   strings:
      $s1 = "exec gcc $extra_flag ${1+\"$@\"}" fullword ascii
      $s2 = "# The following options are the same (as of gcc-3.3):" fullword ascii
      $s3 = "# Call the appropriate C compiler with options to accept ANSI/ISO C" fullword ascii
      $s4 = "extra_flag=-std=c99" fullword ascii
      $s5 = "#! /bin/sh" fullword ascii /* Goodware String - occured 2 times */
      $s6 = "for i; do" fullword ascii
      $s7 = "-std=c9[9x]|-std=iso9899:199[9x])" fullword ascii
      $s8 = "-std=*|-ansi)" fullword ascii
      $magic = {23 21 20 2f 62 69 6e 2f 73 68 0a 0a 23 20 43 61 6c 6c 20 74 68 65 20 61 70 70 72 6f 70 72 69 61 74 65 20 43 20 63 6f 6d 70 69 6c 65 72 20 77 69 74 68 20 6f 70 74 69 6f 6e 73 20 74 6f 20 61 63 63 65 70 74 20 41 4e 53 49 2f 49 53 4f 20 43 0a 23 20 54 68 65 20 66 6f 6c 6c 6f 77 69 6e 67 20 6f 70 74 69 6f 6e 73 20 61 72 65 20 74 68 65 20 73 61 6d 65 20 28 61 73 20 6f 66 20 67 63 63 2d 33 2e 33 29 3a 0a 23 20 09 2d 73 74 64 3d 63 39 39 0a 23 20 09 2d 73 74 64 3d 63 39 78 0a 23 20 09 2d 73 74 64 3d 69 73 6f 39 38 39 39 3a 31 39 39 39 0a 23 20 09 2d 73 74 64 3d 69 73 6f 39 38 39 39 3a 31 39 39 78 0a 0a 65 78 74 72 61 5f 66 6c 61 67 3d 2d 73 74 64 3d 63 39 39 0a 0a 66 6f 72 20 69 3b 20 64 6f 0a 20 20 20 20 63 61 73 65 20 22 24 69 22 20 69 6e 0a 09 2d 73 74 64 3d 63 39 5b 39 78 5d 7c 2d 73 74 64 3d 69 73 6f 39 38 39 39 3a 31 39 39 5b 39 78 5d 29 0a 09 20 20 20 20 65 78 74 72 61 5f 66 6c 61 67 3d 0a 09 20 20 20 20 3b 3b 0a 09 2d 73 74 64 3d 2a 7c 2d 61 6e 73 69 29 0a 09 20 20 20 20 65 63 68 6f 20 3e 26 32 20 22 60 62 61 73 65 6e 61 6d 65 20 24 30 60 20 63 61 6c 6c 65 64 20 77 69 74 68 20 6e 6f 6e 20 49 53 4f 20 43 39 39 20 6f 70 74 69 6f 6e 20 24 69 22 0a 09 20 20 20 20 65 78 69 74 20 31 0a 09 20 20 20 20 3b 3b 0a 20 20 20 20 65 73 61 63 0a 64 6f 6e 65 0a 0a 65 78 65 63 20 67 63 63 20 24 65 78 74 72 61 5f 66 6c 61 67 20 24 7b 31 2b 22 24 40 22 7d 0a}
condition:
      filesize < 1KB and
      all of them
}

rule gtfobins_binaries_7z {
   strings:
      $s1 = "exec /usr/lib/7zip/7z \"$@\"" fullword ascii
      $s2 = "#! /bin/sh" fullword ascii /* Goodware String - occured 2 times */
      $magic = {23 21 20 2f 62 69 6e 2f 73 68 0a 65 78 65 63 20 2f 75 73 72 2f 6c 69 62 2f 37 7a 69 70 2f 37 7a 20 22 24 40 22 0a
}
condition:
      filesize < 1KB and
      all of them
}

rule gtfobins_binaries_red {
   strings:
      $s1 = "exec \"${bindir}\"ed --restricted \"$@\"" fullword ascii
      $s2 = "bindir=`echo \"$0\" | sed -e 's,[^/]*$,,'`" fullword ascii
      $s3 = "#! /bin/sh" fullword ascii /* Goodware String - occured 2 times */
      $magic = {23 21 20 2f 62 69 6e 2f 73 68 0a 62 69 6e 64 69 72 3d 60 65 63 68 6f 20 22 24 30 22 20 7c 20 73 65 64 20 2d 65 20 27 73 2c 5b 5e 2f 5d 2a 24 2c 2c 27 60 0a 65 78 65 63 20 22 24 7b 62 69 6e 64 69 72 7d 22 65 64 20 2d 2d 72 65 73 74 72 69 63 74 65 64 20 22 24 40 22 0a}
condition:
      filesize < 1KB and
      all of them
}

rule gtfobins_binaries_torify {
   strings:
      $s1 = "if command -v torsocks > /dev/null; then" fullword ascii
      $s2 = "# behavior if -v/--verbose or -h/--help arguments are passed." fullword ascii
      $s3 = "echo \"Usage: $0 [-hv] <command> [<options>...]\"" fullword ascii
      $s4 = "# Now, it's just a backwards compatible shim around torsocks with reasonable" fullword ascii
      $s5 = "# Modified by Jacob Appelbaum <jacob@appelbaum.net> April 16th 2006" fullword ascii
      $s6 = "# Copyright (c) 2004, 2006, 2009 Peter Palfrader" fullword ascii
      $s7 = "# This script used to call (the now deprecated) tsocks as a fallback in case" fullword ascii
      $s8 = "usage() {" fullword ascii
      $s9 = "usage >&2" fullword ascii
      $s10 = "# May be distributed under the same terms as Tor itself" fullword ascii
      $s11 = "# Stripped of all the tsocks cruft by ugh on February 22nd 2012" fullword ascii
      $s12 = "# torsocks wasn't installed." fullword ascii
      $s13 = "echo \"torify is now just a wrapper around torsocks(1) for backwards compatibility.\"" fullword ascii
      $s14 = "compat >&2" fullword ascii
      $s15 = "compat() {" fullword ascii
      $s16 = "    exec torsocks \"$@\"" fullword ascii
      $s17 = "case $1 in -v|--verbose)" fullword ascii
      $s18 = "case $1 in -h|--help)" fullword ascii
      $s19 = "#! /bin/sh" fullword ascii /* Goodware String - occured 2 times */
      $s20 = "    echo \"$0: torsocks not found in your PATH.  Perhaps it isn't installed?  (tsocks is no longer supported, for security reaso" ascii
      $s21 = "    echo \"$0: torsocks not found in your PATH.  Perhaps it isn't installed?  (tsocks is no longer supported, for security reaso" ascii
      $s22 = "s.)\" >&2" fullword ascii
      $s23 = "case $# in 0)" fullword ascii
      $s24 = "case $# in 1)" fullword ascii
      $magic = {23 21 20 2f 62 69 6e 2f 73 68 0a 0a 23 20 54 68 69 73 20 73 63 72 69 70 74 20 75 73 65 64 20 74 6f 20 63 61 6c 6c 20 28 74 68 65 20 6e 6f 77 20 64 65 70 72 65 63 61 74 65 64 29 20 74 73 6f 63 6b 73 20 61 73 20 61 20 66 61 6c 6c 62 61 63 6b 20 69 6e 20 63 61 73 65 0a 23 20 74 6f 72 73 6f 63 6b 73 20 77 61 73 6e 27 74 20 69 6e 73 74 61 6c 6c 65 64 2e 0a 23 20 4e 6f 77 2c 20 69 74 27 73 20 6a 75 73 74 20 61 20 62 61 63 6b 77 61 72 64 73 20 63 6f 6d 70 61 74 69 62 6c 65 20 73 68 69 6d 20 61 72 6f 75 6e 64 20 74 6f 72 73 6f 63 6b 73 20 77 69 74 68 20 72 65 61 73 6f 6e 61 62 6c 65 0a 23 20 62 65 68 61 76 69 6f 72 20 69 66 20 2d 76 2f 2d 2d 76 65 72 62 6f 73 65 20 6f 72 20 2d 68 2f 2d 2d 68 65 6c 70 20 61 72 67 75 6d 65 6e 74 73 20 61 72 65 20 70 61 73 73 65 64 2e 0a 23 0a 23 20 43 6f 70 79 72 69 67 68 74 20 28 63 29 20 32 30 30 34 2c 20 32 30 30 36 2c 20 32 30 30 39 20 50 65 74 65 72 20 50 61 6c 66 72 61 64 65 72 0a 23 20 4d 6f 64 69 66 69 65 64 20 62 79 20 4a 61 63 6f 62 20 41 70 70 65 6c 62 61 75 6d 20 3c 6a 61 63 6f 62 40 61 70 70 65 6c 62 61 75 6d 2e 6e 65 74 3e 20 41 70 72 69 6c 20 31 36 74 68 20 32 30 30 36 0a 23 20 53 74 72 69 70 70 65 64 20 6f 66 20 61 6c 6c 20 74 68 65 20 74 73 6f 63 6b 73 20 63 72 75 66 74 20 62 79 20 75 67 68 20 6f 6e 20 46 65 62 72 75 61 72 79 20 32 32 6e 64 20 32 30 31 32 0a 23 20 4d 61 79 20 62 65 20 64 69 73 74 72 69 62 75 74 65 64 20 75 6e 64 65 72 20 74 68 65 20 73 61 6d 65 20 74 65 72 6d 73 20 61 73 20 54 6f 72 20 69 74 73 65 6c 66 0a 0a 0a 63 6f 6d 70 61 74 28 29 20 7b 0a 09 65 63 68 6f 20 22 74 6f 72 69 66 79 20 69 73 20 6e 6f 77 20 6a 75 73 74 20 61 20 77 72 61 70 70 65 72 20 61 72 6f 75 6e 64 20 74 6f 72 73 6f 63 6b 73 28 31 29 20 66 6f 72 20 62 61 63 6b 77 61 72 64 73 20 63 6f 6d 70 61 74 69 62 69 6c 69 74 79 2e 22 0a 7d 0a 0a 75 73 61 67 65 28 29 20 7b 0a 09 63 6f 6d 70 61 74 0a 09 65 63 68 6f 20 22 55 73 61 67 65 3a 20 24 30 20 5b 2d 68 76 5d 20 3c 63 6f 6d 6d 61 6e 64 3e 20 5b 3c 6f 70 74 69 6f 6e 73 3e 2e 2e 2e 5d 22 0a 7d 0a 0a 63 61 73 65 20 24 23 20 69 6e 20 30 29 0a 09 75 73 61 67 65 20 3e 26 32 0a 09 65 78 69 74 20 31 0a 65 73 61 63 0a 0a 63 61 73 65 20 24 23 20 69 6e 20 31 29 0a 09 63 61 73 65 20 24 31 20 69 6e 20 2d 68 7c 2d 2d 68 65 6c 70 29 0a 09 09 75 73 61 67 65 0a 09 09 65 78 69 74 20 30 0a 09 65 73 61 63 0a 65 73 61 63 0a 0a 63 61 73 65 20 24 31 20 69 6e 20 2d 76 7c 2d 2d 76 65 72 62 6f 73 65 29 0a 09 63 6f 6d 70 61 74 20 3e 26 32 0a 09 73 68 69 66 74 0a 65 73 61 63 0a 0a 69 66 20 63 6f 6d 6d 61 6e 64 20 2d 76 20 74 6f 72 73 6f 63 6b 73 20 3e 20 2f 64 65 76 2f 6e 75 6c 6c 3b 20 74 68 65 6e 0a 20 20 20 20 65 78 65 63 20 74 6f 72 73 6f 63 6b 73 20 22 24 40 22 0a 65 6c 73 65 0a 20 20 20 20 65 63 68 6f 20 22 24 30 3a 20 74 6f 72 73 6f 63 6b 73 20 6e 6f 74 20 66 6f 75 6e 64 20 69 6e 20 79 6f 75 72 20 50 41 54 48 2e 20 20 50 65 72 68 61 70 73 20 69 74 20 69 73 6e 27 74 20 69 6e 73 74 61 6c 6c 65 64 3f 20 20 28 74 73 6f 63 6b 73 20 69 73 20 6e 6f 20 6c 6f 6e 67 65 72 20 73 75 70 70 6f 72 74 65 64 2c 20 66 6f 72 20 73 65 63 75 72 69 74 79 20 72 65 61 73 6f 6e 73 2e 29 22 20}
condition:
      filesize < 3KB and
      8 of them and $magic
}

rule gtfobins_binaries_nroff {
   strings:
      $s1 = "# principle here and store the entire command string to be executed into" fullword ascii
      $s2 = "[-n page-number] [-o page-list] [-P postprocessor-argument] \\" fullword ascii
      $s3 = "  # The separate `exec` is to work around a ~2004 bug in Cygwin sh.exe." fullword ascii
      $s4 = "# a variable, and then either display it or execute it.  For example:" fullword ascii
      $s5 = "usage: $prog {-v | --version}" fullword ascii
      $s6 = "# arguments in old shells; see \"Shell Substitutions\" in the GNU Autoconf" fullword ascii
      $s7 = "# contain embedded whitespace or shell metacharacters.  The solution" fullword ascii
      $s8 = "ve attempts to solve the problem fail when arguments to nroff" fullword ascii
      $s9 = "# Set up the 'GROFF_BIN_PATH' variable to be exported in the current" fullword ascii
      $s10 = "usage: $prog --help\"" fullword ascii
      $s11 = "if [ -n \"$is_option_argument_pending\" ]" fullword ascii
      $s12 = "# Determine the -T option.  Was a valid one specified?" fullword ascii
      $s13 = "# -T option absent or invalid; try environment." fullword ascii
      $s14 = "if [ -n \"$dry_run\" ]" fullword ascii
      $s15 = "  if [ -n \"$is_option_argument_pending\" ]" fullword ascii
      $s16 = "# Unfortunately, the shell is a nightmarish hellscape of quoting issues." fullword ascii
      $s17 = "# below works with those, but there is insufficient quoting in -V (dry" fullword ascii
      $s18 = "# by the Free Software Foundation, either version 3 of the License, or" fullword ascii
      $s19 = "# General Public License for more details." fullword ascii
      $s20 = "# if you pass it a filename like foo\"bar (with the embedded quotation" fullword ascii
      $s21 = "#   printf \"%s\\n\" \"$cmd\"" fullword ascii
      $s22 = "# Written by James Clark, Werner Lemberg, and G. Branden Robinson." fullword ascii
      $s23 = "# run) mode, such that you can't copy-and-paste the output of 'nroff -V'" fullword ascii
      $s24 = "# Finally, infer a -T option from the locale.  Try 'locale charmap'" fullword ascii
      $s25 = "# Let our test harness redirect us.  See LC_ALL comment above." fullword ascii
      $s26 = "# mark) and expect it to run without further quoting." fullword ascii
      $s27 = "# 'GROFF_RUNTIME' environment." fullword ascii
      $s28 = "  case \"`exec 2>/dev/null ; locale charmap`\" in" fullword ascii
      $s29 = "# under the terms of the GNU General Public License (GPL) as published" fullword ascii
      $s30 = "      # Some old shells don't support ${FOO:-bar} expansion syntax.  We" fullword ascii
      $s31 = "export GROFF_BIN_PATH" fullword ascii
      $s32 = "    -v | --version)" fullword ascii
      $s33 = "# Copyright (C) 1992-2021 Free Software Foundation, Inc." fullword ascii
      $s34 = "      # -u is for Solaris compatibility and not otherwise documented." fullword ascii
      $s35 = "GROFF_RUNTIME=\"${GROFF_BIN_PATH=/usr/bin}:\"" fullword ascii
      $s36 = "usage=\"usage: $prog [-bcCEhikpRStUVz] [-d ctext] [-d string=text] \\" fullword ascii
      $s37 = "if [ -z \"$T\" ]" fullword ascii
      $s38 = "# variables." fullword ascii
      $s39 = "# revisited." fullword ascii
      $s40 = "# fill-column: 72" fullword ascii
      $magic = {23 21 20 2f 62 69 6e 2f 73 68 0a 23 20 45 6d 75 6c 61 74 65 20 6e 72 6f 66 66 20 77 69 74 68 20 67 72 6f 66 66 2e 0a 23 0a 23 20 43 6f 70 79 72 69 67 68 74 20 28 43 29 20 31 39 39 32 2d 32 30 32 31 20 46 72 65 65 20 53 6f 66 74 77 61 72 65 20 46 6f 75 6e 64 61 74 69 6f 6e 2c 20 49 6e 63 2e 0a 23 0a 23 20 57 72 69 74 74 65 6e 20 62 79 20 4a 61 6d 65 73 20 43 6c 61 72 6b 2c 20 57 65 72 6e 65 72 20 4c 65 6d 62 65 72 67 2c 20 61 6e 64 20 47 2e 20 42 72 61 6e 64 65 6e 20 52 6f 62 69 6e 73 6f 6e 2e 0a 23 0a 23 20 54 68 69 73 20 66 69 6c 65 20 69 73 20 70 61 72 74 20 6f 66 20 27 67 72 6f 66 66 27 2e 0a 23 0a 23 20 27 67 72 6f 66 66 27 20 69 73 20 66 72 65 65 20 73 6f 66 74 77 61 72 65 3b 20 79 6f 75 20 63 61 6e 20 72 65 64 69 73 74 72 69 62 75 74 65 20 69 74 20 61 6e 64 2f 6f 72 20 6d 6f 64 69 66 79 20 69 74 0a 23 20 75 6e 64 65 72 20 74 68 65 20 74 65 72 6d 73 20 6f 66 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 28 47 50 4c 29 20 61 73 20 70 75 62 6c 69 73 68 65 64 0a 23 20 62 79 20 74 68 65 20 46 72 65 65 20 53 6f 66 74 77 61 72 65 20 46 6f 75 6e 64 61 74 69 6f 6e 2c 20 65 69 74 68 65 72 20 76 65 72 73 69 6f 6e 20 33 20 6f 66 20 74 68 65 20 4c 69 63 65 6e 73 65 2c 20 6f 72 0a 23 20 28 61 74 20 79 6f 75 72 20 6f 70 74 69 6f 6e 29 20 61 6e 79 20 6c 61 74 65 72 20 76 65 72 73 69 6f 6e 2e 0a 23 0a 23 20 27 67 72 6f 66 66 27 20 69 73 20 64 69 73 74 72 69 62 75 74 65 64 20 69 6e 20 74 68 65 20 68 6f 70 65 20 74 68 61 74 20 69 74 20 77 69 6c 6c 20 62 65 20 75 73 65 66 75 6c 2c 20 62 75 74 0a 23 20 57 49 54 48 4f 55 54 20 41 4e 59 20 57 41 52 52 41 4e 54 59 3b 20 77 69 74 68 6f 75 74 20 65 76 65 6e 20 74 68 65 20 69 6d 70 6c 69 65 64 20 77 61 72 72 61 6e 74 79 20 6f 66 0a 23 20 4d 45 52 43 48 41 4e 54 41 42 49 4c 49 54 59 20 6f 72 20 46 49 54 4e 45 53 53 20 46 4f 52 20 41 20 50 41 52 54 49 43 55 4c 41 52 20 50 55 52 50 4f 53 45 2e 20 20 53 65 65 20 74 68 65 20 47 4e 55 0a 23 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 66 6f 72 20 6d 6f 72 65 20 64 65 74 61 69 6c 73 2e 0a 23 0a 23 20 59 6f 75 20 73 68 6f 75 6c 64 20 68 61 76 65 20 72 65 63 65 69 76 65 64 20 61 20 63 6f 70 79 20 6f 66 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 0a 23 20 61 6c 6f 6e 67 20 77 69 74 68 20 74 68 69 73 20 70 72 6f 67 72 61 6d 2e 20 20 49 66 20 6e 6f 74 2c 20 73 65 65 20 3c 68 74 74 70 3a 2f 2f 77 77 77 2e 67 6e 75 2e 6f 72 67 2f 6c 69 63 65 6e 73 65 73 2f 3e 2e 0a 0a 75 6e 73 65 74 20 49 46 53 0a 0a 70 72 6f 67 3d 22 24 30 22 0a 0a 54 3d 0a 54 6f 70 74 3d 0a 6f 70 74 73 3d 0a 64 72 79 5f 72 75 6e 3d 0a 69 73 5f 6f 70 74 69 6f 6e 5f 61 72 67 75 6d 65 6e 74 5f 70 65 6e 64 69 6e 67 3d 0a 0a 75 73 61 67 65 3d 22 75 73 61 67 65 3a 20 24 70 72 6f 67 20 5b 2d 62 63 43 45 68 69 6b 70 52 53 74 55 56 7a 5d 20 5b 2d 64 20 63 74 65 78 74 5d 20 5b 2d 64 20 73 74 72 69 6e 67 3d 74 65 78 74 5d 20 5c 0a 5b 2d 4b 20 66 61 6c 6c 62 61 63 6b 2d 65 6e 63 6f 64 69 6e 67 5d 20 5b 2d 6d 20 6d 61 63 72 6f 2d 70 61 63 6b 61 67 65 5d 20 5b 2d 4d 20 6d}
condition:
      filesize < 20KB and
      8 of them and $magic
}

rule gtfobins_binaries_cdist {
   strings:
      $s1 = "# 2016 Darko Poljak (darko.poljak at gmail.com)" fullword ascii
      $s2 = "# along with cdist. If not, see <http://www.gnu.org/licenses/>." fullword ascii
      $s3 = "        log = logging.getLogger(\"cdist\")" fullword ascii
      $s4 = "def commandline():" fullword ascii
      $s5 = "# 2010-2016 Nico Schottelius (nico-cdist at schottelius.org)" fullword ascii
      $s6 = "        return cdist.preos.PreOS.commandline(sys.argv[1:])" fullword ascii
      $s7 = "# the Free Software Foundation, either version 3 of the License, or" fullword ascii
      $s8 = "# cdist is distributed in the hope that it will be useful," fullword ascii
      $s9 = "# See if this file's parent is cdist module" fullword ascii
      $s10 = "# and if so add it to module search path." fullword ascii
      $s11 = "# This file is part of cdist." fullword ascii
      $s12 = "    \"\"\"Parse command line\"\"\"" fullword ascii
      $s13 = "            commandline()" fullword ascii
      $s14 = "        log.error(e)" fullword ascii
      $s15 = "#!/usr/bin/python3" fullword ascii
      $s16 = "import cdist.shell      # noqa 402" fullword ascii
      $s17 = "import cdist.inventory  # noqa 402" fullword ascii
      $s18 = "    # preos subcommand hack" fullword ascii
      $s19 = "            emulator.run()" fullword ascii
      $s20 = "    if sys.version_info[:3] < cdist.MIN_SUPPORTED_PYTHON_VERSION:" fullword ascii
      $s21 = "    # http://bugs.python.org/issue16308" fullword ascii
      $s22 = "import cdist.config     # noqa 402" fullword ascii
      $s23 = "    # http://bugs.python.org/issue9253" fullword ascii
      $s24 = "                \".\".join(map(str, cdist.MIN_SUPPORTED_PYTHON_VERSION)))," fullword ascii
      $s25 = "        import re" fullword ascii
      $s26 = "cdist_init_dir = os.path.join(cdist_dir, 'cdist', '__init__.py')" fullword ascii
      $s27 = "# cdist is free software: you can redistribute it and/or modify" fullword ascii
      $s28 = "        getattr(args, \"func\")" fullword ascii
      $s29 = "    args = cfg.get_args()" fullword ascii
      $s30 = "if os.path.exists(cdist_init_dir):" fullword ascii
      $s31 = "cdist_dir = os.path.realpath(" fullword ascii
      $s32 = "        import os" fullword ascii
      $s33 = "            'Python >= {} is required on the source host.'.format(" fullword ascii
      $s34 = "import cdist            # noqa 402" fullword ascii
      $s35 = "    parser, cfg = cdist.argparse.parse_and_configure(sys.argv[1:])" fullword ascii
      $s36 = "import cdist.install    # noqa 402" fullword ascii
      $s37 = "    except AttributeError:" fullword ascii
      $s38 = "    except cdist.Error as e:" fullword ascii
      $s39 = "import cdist.banner     # noqa 402" fullword ascii
      $s40 = "    except KeyboardInterrupt:" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 79 74 68 6f 6e 33 0a 23 20 2d 2a 2d 20 63 6f 64 69 6e 67 3a 20 75 74 66 2d 38 20 2d 2a 2d 0a 23 0a 23 20 32 30 31 30 2d 32 30 31 36 20 4e 69 63 6f 20 53 63 68 6f 74 74 65 6c 69 75 73 20 28 6e 69 63 6f 2d 63 64 69 73 74 20 61 74 20 73 63 68 6f 74 74 65 6c 69 75 73 2e 6f 72 67 29 0a 23 20 32 30 31 36 20 44 61 72 6b 6f 20 50 6f 6c 6a 61 6b 20 28 64 61 72 6b 6f 2e 70 6f 6c 6a 61 6b 20 61 74 20 67 6d 61 69 6c 2e 63 6f 6d 29 0a 23 0a 23 20 54 68 69 73 20 66 69 6c 65 20 69 73 20 70 61 72 74 20 6f 66 20 63 64 69 73 74 2e 0a 23 0a 23 20 63 64 69 73 74 20 69 73 20 66 72 65 65 20 73 6f 66 74 77 61 72 65 3a 20 79 6f 75 20 63 61 6e 20 72 65 64 69 73 74 72 69 62 75 74 65 20 69 74 20 61 6e 64 2f 6f 72 20 6d 6f 64 69 66 79 0a 23 20 69 74 20 75 6e 64 65 72 20 74 68 65 20 74 65 72 6d 73 20 6f 66 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 61 73 20 70 75 62 6c 69 73 68 65 64 20 62 79 0a 23 20 74 68 65 20 46 72 65 65 20 53 6f 66 74 77 61 72 65 20 46 6f 75 6e 64 61 74 69 6f 6e 2c 20 65 69 74 68 65 72 20 76 65 72 73 69 6f 6e 20 33 20 6f 66 20 74 68 65 20 4c 69 63 65 6e 73 65 2c 20 6f 72 0a 23 20 28 61 74 20 79 6f 75 72 20 6f 70 74 69 6f 6e 29 20 61 6e 79 20 6c 61 74 65 72 20 76 65 72 73 69 6f 6e 2e 0a 23 0a 23 20 63 64 69 73 74 20 69 73 20 64 69 73 74 72 69 62 75 74 65 64 20 69 6e 20 74 68 65 20 68 6f 70 65 20 74 68 61 74 20 69 74 20 77 69 6c 6c 20 62 65 20 75 73 65 66 75 6c 2c 0a 23 20 62 75 74 20 57 49 54 48 4f 55 54 20 41 4e 59 20 57 41 52 52 41 4e 54 59 3b 20 77 69 74 68 6f 75 74 20 65 76 65 6e 20 74 68 65 20 69 6d 70 6c 69 65 64 20 77 61 72 72 61 6e 74 79 20 6f 66 0a 23 20 4d 45 52 43 48 41 4e 54 41 42 49 4c 49 54 59 20 6f 72 20 46 49 54 4e 45 53 53 20 46 4f 52 20 41 20 50 41 52 54 49 43 55 4c 41 52 20 50 55 52 50 4f 53 45 2e 20 20 53 65 65 20 74 68 65 0a 23 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 66 6f 72 20 6d 6f 72 65 20 64 65 74 61 69 6c 73 2e 0a 23 0a 23 20 59 6f 75 20 73 68 6f 75 6c 64 20 68 61 76 65 20 72 65 63 65 69 76 65 64 20 61 20 63 6f 70 79 20 6f 66 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 0a 23 20 61 6c 6f 6e 67 20 77 69 74 68 20 63 64 69 73 74 2e 20 49 66 20 6e 6f 74 2c 20 73 65 65 20 3c 68 74 74 70 3a 2f 2f 77 77 77 2e 67 6e 75 2e 6f 72 67 2f 6c 69 63 65 6e 73 65 73 2f 3e 2e 0a 23 0a 23 0a 0a 69 6d 70 6f 72 74 20 6c 6f 67 67 69 6e 67 0a 69 6d 70 6f 72 74 20 6f 73 0a 69 6d 70 6f 72 74 20 73 79 73 0a 0a 23 20 53 65 65 20 69 66 20 74 68 69 73 20 66 69 6c 65 27 73 20 70 61 72 65 6e 74 20 69 73 20 63 64 69 73 74 20 6d 6f 64 75 6c 65 0a 23 20 61 6e 64 20 69 66 20 73 6f 20 61 64 64 20 69 74 20 74 6f 20 6d 6f 64 75 6c 65 20 73 65 61 72 63 68 20 70 61 74 68 2e 0a 63 64 69 73 74 5f 64 69 72 20 3d 20 6f 73 2e 70 61 74 68 2e 72 65 61 6c 70 61 74 68 28 0a 20 20 20 20 6f 73 2e 70 61 74 68 2e 6a 6f 69 6e 28 0a 20 20 20 20 20 20 20 20 6f 73 2e 70 61 74 68 2e 64 69 72 6e 61 6d 65 28 6f 73 2e 70 61 74 68 2e 72 65 61 6c 70 61 74 68 28 5f 5f 66 69 6c 65 5f}
condition:
      filesize < 8KB and
      8 of them and $magic
}

rule gtfobins_binaries_service {
   strings:
      $s1 = "# This script is a modified version of the /sbin/service utility found on" fullword ascii
      $s2 = "[ service_name [ command | --full-restart ] ]\"" fullword ascii
      $s3 = "# /usr/bin/service" fullword ascii
      $s4 = "# A convenient wrapper for the /etc/init.d init scripts." fullword ascii
      $s5 = "#   * August 2008 - Dustin Kirkland <kirkland@canonical.com>" fullword ascii
      $s6 = "      exec env -i LANG=\"$LANG\" LANGUAGE=\"$LANGUAGE\" LC_CTYPE=\"$LC_CTYPE\" LC_NUMERIC=\"$LC_NUMERIC\" LC_TIME=\"$LC_TIME\" L" ascii
      $s7 = "      exec env -i LANG=\"$LANG\" LANGUAGE=\"$LANGUAGE\" LC_CTYPE=\"$LC_CTYPE\" LC_NUMERIC=\"$LC_NUMERIC\" LC_TIME=\"$LC_TIME\" L" ascii
      $s8 = "# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA" fullword ascii
      $s9 = "if [ -d /run/systemd/system ]; then" fullword ascii
      $s10 = "if [ -n \"$is_systemd\" ]" fullword ascii
      $s11 = "                        if echo \"$out\" | grep -Fiq \"usage:\"; then" fullword ascii
      $s12 = "# On Debian GNU/Linux systems, the complete text of the GNU General" fullword ascii
      $s13 = "                            #printf \" %s %-60s %s\\n\" \"[-]\" \"$SERVICE:\" \"NOT running\"" fullword ascii
      $s14 = "                            #printf \" %s %-60s %s\\n\" \"[+]\" \"$SERVICE:\" \"running\"" fullword ascii
      $s15 = "         if [ ! -h /run/openrc/started/$SERVICE ] ; then" fullword ascii
      $s16 = "    && [ -x \"${SERVICEDIR}/${SERVICE}\" ]; then" fullword ascii
      $s17 = "USAGE=\"Usage: `basename $0` < option > | --status-all | \\" fullword ascii
      $s18 = "# Public License can be found in `/usr/share/common-licenses/GPL-2'." fullword ascii
      $s19 = "# Copyright (C) 2013 Michael Stapelberg <stapelberg@debian.org>" fullword ascii
      $s20 = "            ln -s $SERVICEDIR/$SERVICE /run/openrc/started/$SERVICE || true" fullword ascii
      $s21 = "# Red Hat/Fedora systems (licensed GPLv2+)." fullword ascii
      $s22 = "         exec systemctl --signal=KILL kill \"${UNIT}\"" fullword ascii
      $s23 = "    --help | -h | --h* )" fullword ascii
      $s24 = "                          #printf \" %s %-60s %s\\n\" \"[?]\" \"$SERVICE:\" \"unknown\" 1>&2" fullword ascii
      $s25 = "# the Free Software Foundation; either version 2 of the License, or" fullword ascii
      $s26 = "   if [ -d /run/openrc/started ] ; then" fullword ascii
      $s27 = "   # rc-status works with the service command as well" fullword ascii
      $s28 = "             if [ -x \"${SERVICEDIR}/${SERVICE}\" ]; then" fullword ascii
      $s29 = "# When this machine is running systemd, standard service calls are turned into" fullword ascii
      $s30 = "             if [ \"$(systemctl -p Triggers show $unit)\" = \"Triggers=${UNIT}\" ]; then" fullword ascii
      $s31 = "       elif [ -z \"${SERVICE}\" ]; then" fullword ascii
      $s32 = "# Copyright (C) 2006 Red Hat, Inc. All rights reserved." fullword ascii
      $s33 = "   if [ -x \"${SERVICEDIR}/${SERVICE}\" ]; then" fullword ascii
      $s34 = "          if [ -n \"$is_systemd\" ]; then" fullword ascii
      $s35 = "       if [ -z \"${SERVICE}\" -a $# -eq 1 -a \"${1}\" = \"--status-all\" ]; then" fullword ascii
      $s36 = "                            echo \" [ - ]  $SERVICE\"" fullword ascii
      $s37 = "         # Users who need more control will use systemctl directly." fullword ascii
      $s38 = "               env -i LANG=\"$LANG\" LANGUAGE=\"$LANGUAGE\" LC_CTYPE=\"$LC_CTYPE\" LC_NUMERIC=\"$LC_NUMERIC\" LC_TIME=\"$LC_TIME" ascii
      $s39 = "               env -i LANG=\"$LANG\" LANGUAGE=\"$LANGUAGE\" LC_CTYPE=\"$LC_CTYPE\" LC_NUMERIC=\"$LC_NUMERIC\" LC_TIME=\"$LC_TIME" ascii
      $s40 = "                  #env -i LANG=\"$LANG\" LANGUAGE=\"$LANGUAGE\" LC_CTYPE=\"$LC_CTYPE\" LC_NUMERIC=\"$LC_NUMERIC\" LC_TIME=\"$LC_" ascii
      $magic = {23 21 2f 62 69 6e 2f 73 68 0a 0a 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 23 0a 23 20 2f 75 73 72 2f 62 69 6e 2f 73 65 72 76 69 63 65 0a 23 0a 23 20 41 20 63 6f 6e 76 65 6e 69 65 6e 74 20 77 72 61 70 70 65 72 20 66 6f 72 20 74 68 65 20 2f 65 74 63 2f 69 6e 69 74 2e 64 20 69 6e 69 74 20 73 63 72 69 70 74 73 2e 0a 23 0a 23 20 54 68 69 73 20 73 63 72 69 70 74 20 69 73 20 61 20 6d 6f 64 69 66 69 65 64 20 76 65 72 73 69 6f 6e 20 6f 66 20 74 68 65 20 2f 73 62 69 6e 2f 73 65 72 76 69 63 65 20 75 74 69 6c 69 74 79 20 66 6f 75 6e 64 20 6f 6e 0a 23 20 52 65 64 20 48 61 74 2f 46 65 64 6f 72 61 20 73 79 73 74 65 6d 73 20 28 6c 69 63 65 6e 73 65 64 20 47 50 4c 76 32 2b 29 2e 0a 23 0a 23 20 43 6f 70 79 72 69 67 68 74 20 28 43 29 20 32 30 30 36 20 52 65 64 20 48 61 74 2c 20 49 6e 63 2e 20 41 6c 6c 20 72 69 67 68 74 73 20 72 65 73 65 72 76 65 64 2e 0a 23 20 43 6f 70 79 72 69 67 68 74 20 28 43 29 20 32 30 30 38 20 43 61 6e 6f 6e 69 63 61 6c 20 4c 74 64 2e 0a 23 20 20 20 2a 20 41 75 67 75 73 74 20 32 30 30 38 20 2d 20 44 75 73 74 69 6e 20 4b 69 72 6b 6c 61 6e 64 20 3c 6b 69 72 6b 6c 61 6e 64 40 63 61 6e 6f 6e 69 63 61 6c 2e 63 6f 6d 3e 0a 23 20 43 6f 70 79 72 69 67 68 74 20 28 43 29 20 32 30 31 33 20 4d 69 63 68 61 65 6c 20 53 74 61 70 65 6c 62 65 72 67 20 3c 73 74 61 70 65 6c 62 65 72 67 40 64 65 62 69 61 6e 2e 6f 72 67 3e 0a 23 0a 23 20 54 68 69 73 20 70 72 6f 67 72 61 6d 20 69 73 20 66 72 65 65 20 73 6f 66 74 77 61 72 65 3b 20 79 6f 75 20 63 61 6e 20 72 65 64 69 73 74 72 69 62 75 74 65 20 69 74 20 61 6e 64 2f 6f 72 20 6d 6f 64 69 66 79 0a 23 20 69 74 20 75 6e 64 65 72 20 74 68 65 20 74 65 72 6d 73 20 6f 66 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 61 73 20 70 75 62 6c 69 73 68 65 64 20 62 79 0a 23 20 74 68 65 20 46 72 65 65 20 53 6f 66 74 77 61 72 65 20 46 6f 75 6e 64 61 74 69 6f 6e 3b 20 65 69 74 68 65 72 20 76 65 72 73 69 6f 6e 20 32 20 6f 66 20 74 68 65 20 4c 69 63 65 6e 73 65 2c 20 6f 72 0a 23 20 28 61 74 20 79 6f 75 72 20 6f 70 74 69 6f 6e 29 20 61 6e 79 20 6c 61 74 65 72 20 76 65 72 73 69 6f 6e 2e 0a 23 0a 23 20 54 68 69 73 20 70 72 6f 67 72 61 6d 20 69 73 20 64 69 73 74 72 69 62 75 74 65 64 20 69 6e 20 74 68 65 20 68 6f 70 65 20 74 68 61 74 20 69 74 20 77 69 6c 6c 20 62 65 20 75 73 65 66 75 6c 2c 0a 23 20 62 75 74 20 57 49 54 48 4f 55 54 20 41 4e 59 20 57 41 52 52 41 4e 54 59 3b 20 77 69 74 68 6f 75 74 20 65 76 65 6e 20 74 68 65 20 69 6d 70 6c 69 65 64 20 77 61 72 72 61 6e 74 79 20 6f 66 0a 23 20 4d 45 52 43 48 41 4e 54 41 42 49 4c 49 54 59 20 6f 72 20 46 49 54 4e 45 53 53 20 46 4f 52 20 41 20 50 41 52 54 49 43 55 4c 41 52 20 50 55 52 50 4f 53 45 2e 20 20 53 65 65 20 74 68 65 0a 23 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 66 6f 72 20 6d 6f 72 65 20 64 65 74 61 69 6c 73 2e 0a 23 0a 23 20 59 6f 75 20 73 68 6f 75 6c 64 20 68 61 76 65 20 72 65 63 65 69 76}
condition:
      filesize < 30KB and
      8 of them and $magic
}

rule gtfobins_binaries_ascii85 {
   strings:
      $s1 = "# A simple command-line tool to de- and encode Ascii85, modeled after `base64`" fullword ascii
      $s2 = "# from the GNU Coreutils." fullword ascii
      $s3 = "  @input = $stdin.binmode.read" fullword ascii
      $s4 = "  opts.banner = \"Usage: #{File.basename($PROGRAM_NAME)} [OPTIONS] [FILE]\\n\" +" fullword ascii
      $s5 = "# encoding: utf-8" fullword ascii
      $s6 = "  unless File.readable_real?(@options[:file])" fullword ascii
      $s7 = "  rescue Ascii85::DecodingError => error" fullword ascii
      $s8 = "  opts.on( \"--version\", \"Output version information\") do |opt|" fullword ascii
      $s9 = "ARGV.options do |opts|" fullword ascii
      $s10 = "if @options[:decode]" fullword ascii
      $s11 = "  :decode => false" fullword ascii
      $s12 = "  opts.on( \"-d\", \"--decode\", \"Decode the input\") do" fullword ascii
      $s13 = "require \"ascii85\"" fullword ascii
      $s14 = "  opts.on( \"-h\", \"--help\", \"Display this help and exit\") do" fullword ascii
      $s15 = "if @options[:file] == '-'" fullword ascii
      $s16 = "                \"Encodes or decodes FILE or STDIN using Ascii85 and writes to STDOUT.\"" fullword ascii
      $s17 = "    abort \"Superfluous operand(s): \\\"#{remaining_args.join('\", \"')}\\\"\"" fullword ascii
      $s18 = "@options = {" fullword ascii
      $s19 = "  remaining_args = opts.parse!" fullword ascii
      $s20 = "  File.open(@options[:file], 'rb') do |f|" fullword ascii
      $s21 = "  opts.on( \"-w\", \"--wrap COLUMN\", Integer," fullword ascii
      $s22 = "require \"optparse\"" fullword ascii
      $s23 = "  print Ascii85.encode(@input, @options[:wrap])" fullword ascii
      $s24 = "  unless File.exists?(@options[:file])" fullword ascii
      $s25 = "  else" fullword ascii
      $s26 = "  begin" fullword ascii
      $s27 = "    abort \"Decoding Error: #{error.message.to_s}\"" fullword ascii
      $s28 = "    @input = f.read" fullword ascii
      $s29 = "    puts \"Ascii85 v#{Ascii85::VERSION},\\nwritten by Johannes Holzfu" fullword ascii
      $s30 = "    abort \"File is not readable: \\\"#{@options[:file]}\\\"\"" fullword ascii
      $s31 = "    @options[:wrap] = opt.abs" fullword ascii
      $s32 = "    puts opts" fullword ascii
      $s33 = "    @options[:decode] = true" fullword ascii
      $s34 = "    print Ascii85.decode(@input)" fullword ascii
      $s35 = "  when 0" fullword ascii
      $s36 = "  when 1" fullword ascii
      $s37 = "  case remaining_args.size" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 72 75 62 79 0a 23 20 65 6e 63 6f 64 69 6e 67 3a 20 75 74 66 2d 38 0a 0a 23 0a 23 20 41 20 73 69 6d 70 6c 65 20 63 6f 6d 6d 61 6e 64 2d 6c 69 6e 65 20 74 6f 6f 6c 20 74 6f 20 64 65 2d 20 61 6e 64 20 65 6e 63 6f 64 65 20 41 73 63 69 69 38 35 2c 20 6d 6f 64 65 6c 65 64 20 61 66 74 65 72 20 60 62 61 73 65 36 34 60 0a 23 20 66 72 6f 6d 20 74 68 65 20 47 4e 55 20 43 6f 72 65 75 74 69 6c 73 2e 0a 23 0a 0a 0a 72 65 71 75 69 72 65 20 22 6f 70 74 70 61 72 73 65 22 0a 72 65 71 75 69 72 65 20 22 61 73 63 69 69 38 35 22 0a 0a 40 6f 70 74 69 6f 6e 73 20 3d 20 7b 0a 20 20 3a 77 72 61 70 20 20 20 3d 3e 20 38 30 2c 0a 20 20 3a 64 65 63 6f 64 65 20 3d 3e 20 66 61 6c 73 65 0a 7d 0a 0a 41 52 47 56 2e 6f 70 74 69 6f 6e 73 20 64 6f 20 7c 6f 70 74 73 7c 0a 20 20 6f 70 74 73 2e 62 61 6e 6e 65 72 20 3d 20 22 55 73 61 67 65 3a 20 23 7b 46 69 6c 65 2e 62 61 73 65 6e 61 6d 65 28 24 50 52 4f 47 52 41 4d 5f 4e 41 4d 45 29 7d 20 5b 4f 50 54 49 4f 4e 53 5d 20 5b 46 49 4c 45 5d 5c 6e 22 20 2b 0a 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 22 45 6e 63 6f 64 65 73 20 6f 72 20 64 65 63 6f 64 65 73 20 46 49 4c 45 20 6f 72 20 53 54 44 49 4e 20 75 73 69 6e 67 20 41 73 63 69 69 38 35 20 61 6e 64 20 77 72 69 74 65 73 20 74 6f 20 53 54 44 4f 55 54 2e 22 0a 0a 0a 20 20 6f 70 74 73 2e 6f 6e 28 20 22 2d 77 22 2c 20 22 2d 2d 77 72 61 70 20 43 4f 4c 55 4d 4e 22 2c 20 49 6e 74 65 67 65 72 2c 0a 20 20 20 20 20 20 20 20 20 20 22 57 72 61 70 20 6c 69 6e 65 73 20 61 74 20 43 4f 4c 55 4d 4e 2e 20 44 65 66 61 75 6c 74 20 69 73 20 38 30 2c 20 75 73 65 20 30 20 66 6f 72 20 6e 6f 20 77 72 61 70 70 69 6e 67 22 29 20 64 6f 20 7c 6f 70 74 7c 0a 0a 20 20 20 20 40 6f 70 74 69 6f 6e 73 5b 3a 77 72 61 70 5d 20 3d 20 6f 70 74 2e 61 62 73 0a 20 20 20 20 40 6f 70 74 69 6f 6e 73 5b 3a 77 72 61 70 5d 20 3d 20 66 61 6c 73 65 20 69 66 20 6f 70 74 2e 7a 65 72 6f 3f 0a 20 20 65 6e 64 0a 0a 20 20 6f 70 74 73 2e 6f 6e 28 20 22 2d 64 22 2c 20 22 2d 2d 64 65 63 6f 64 65 22 2c 20 22 44 65 63 6f 64 65 20 74 68 65 20 69 6e 70 75 74 22 29 20 64 6f 0a 20 20 20 20 40 6f 70 74 69 6f 6e 73 5b 3a 64 65 63 6f 64 65 5d 20 3d 20 74 72 75 65 0a 20 20 65 6e 64 0a 0a 20 20 6f 70 74 73 2e 6f 6e 28 20 22 2d 68 22 2c 20 22 2d 2d 68 65 6c 70 22 2c 20 22 44 69 73 70 6c 61 79 20 74 68 69 73 20 68 65 6c 70 20 61 6e 64 20 65 78 69 74 22 29 20 64 6f 0a 20 20 20 20 70 75 74 73 20 6f 70 74 73 0a 20 20 20 20 65 78 69 74 0a 20 20 65 6e 64 0a 0a 20 20 6f 70 74 73 2e 6f 6e 28 20 22 2d 2d 76 65 72 73 69 6f 6e 22 2c 20 22 4f 75 74 70 75 74 20 76 65 72 73 69 6f 6e 20 69 6e 66 6f 72 6d 61 74 69 6f 6e 22 29 20 64 6f 20 7c 6f 70 74 7c 0a 20 20 20 20 70 75 74 73 20 22 41 73 63 69 69 38 35 20 76 23 7b 41 73 63 69 69 38 35 3a 3a 56 45 52 53 49 4f 4e 7d 2c 5c 6e 77 72 69 74 74 65 6e 20 62 79 20 4a 6f 68 61 6e 6e 65 73 20 48 6f 6c 7a 66 75 c3 9f 22 0a 20 20 20 20 65 78 69 74 0a 20 20 65 6e 64 0a 0a 20 20 72 65 6d 61 69 6e 69 6e 67 5f 61 72 67 73 20 3d 20 6f 70 74 73 2e 70 61 72 73 65 21 0a 0a 20 20 63 61 73 65 20 72 65 6d 61 69 6e 69 6e 67 5f 61 72 67 73 2e 73 69 7a 65 0a 20 20 77 68 65 6e 20 30}
condition:
      filesize < 5KB and
      8 of them and $magic
}

rule gtfobins_binaries_dstat {
   strings:
      $s1 = "        line += '\"Host:\",\"' + self.context.pmGetContextHostName() + '\",,,,\"User:\",\"' + getpass.getuser() + '\"\\n'" fullword ascii
      $s2 = "            line += '\"Author:\",\"PCP team <pcp@groups.io> and Dag Wieers <dag@wieers.com>\",,,,\"URL:\",\"https://pcp.io/ and " ascii
      $s3 = "            line += '\"Author:\",\"PCP team <pcp@groups.io> and Dag Wieers <dag@wieers.com>\",,,,\"URL:\",\"https://pcp.io/ and " ascii
      $s4 = "# Copyright (C) 2004-2016 Dag Wieers <dag@wieers.com>" fullword ascii
      $s5 = "        ### Complete command line processing" fullword ascii
      $s6 = "        line += '\"Cmdline:\",\"' + self.context.pmProgname() + ' ' + ' '.join(self.arguments) + '\",,,,\"Date:\",\"' + time.str" ascii
      $s7 = "dag.wieers.com/home-made/dstat/\"\\n'" fullword ascii
      $s8 = "        line += '\"Cmdline:\",\"' + self.context.pmProgname() + ' ' + ' '.join(self.arguments) + '\",,,,\"Date:\",\"' + time.str" ascii
      $s9 = "        dstat.execute()" fullword ascii
      $s10 = "        # Avoid tracedump with --version and non-existing --archive" fullword ascii
      $s11 = "# Common imports" fullword ascii
      $s12 = "        # 1 - command line options" fullword ascii
      $s13 = "TIMEFMT = os.getenv('DSTAT_TIMEFMT') or '%d-%m %H:%M:%S'" fullword ascii
      $s14 = "            line += '\"pcp-dstat ' + self.context.pmGetConfig('PCP_VERSION') + ' CSV Output\"\\n'" fullword ascii
      $s15 = "            sys.stderr.write(\"%s: failed to read configuration file(s)\" % path)" fullword ascii
      $s16 = "                    value = config.get(section, key)" fullword ascii
      $s17 = "        print('pcp-dstat %s' % self.context.pmGetConfig('PCP_VERSION'))" fullword ascii
      $s18 = "        print('Processors: %d' % cpucount())" fullword ascii
      $s19 = "    def execute(self):" fullword ascii
      $s20 = "        self.context.prepare_execute(self.opts, False, self.interpol, self.interval)" fullword ascii
      $s21 = "from cpmapi import PM_ERR_EOL, PM_IN_NULL, pmUsageMessage" fullword ascii
      $s22 = "        print('Homepages at https://pcp.io/ and http://dag.wieers.com/home-made/dstat/')" fullword ascii
      $s23 = "        shell = os.getenv('SHELL')" fullword ascii
      $s24 = "        \"\"\" Complete all initialisation and get ready to begin sampling \"\"\"" fullword ascii
      $s25 = "# Free Software Foundation; either version 2 of the License, or (at your" fullword ascii
      $s26 = "# under the terms of the GNU General Public License as published by the" fullword ascii
      $s27 = "# pylint: disable=missing-docstring,multiple-imports,invalid-name" fullword ascii
      $s28 = "# option) any later version." fullword ascii
      $s29 = "# or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License" fullword ascii
      $s30 = "            sys.stderr.write(\"Incompatible configuration file version (read v%s, need v%d).\\n\" % (self.version, self.CONFIG_V" ascii
      $s31 = "            sys.stderr.write(\"Incompatible configuration file version (read v%s, need v%d).\\n\" % (self.version, self.CONFIG_V" ascii
      $s32 = "        except KeyError:" fullword ascii
      $s33 = "        ### Process subtitle" fullword ascii
      $s34 = "        if not shell or shell != '/bin/bash':" fullword ascii
      $s35 = "from pcp import pmapi, pmconfig" fullword ascii
      $s36 = "            value = re.compile(r'\\A' + value + r'\\Z')" fullword ascii
      $s37 = "        import getpass # pylint: disable=import-outside-toplevel" fullword ascii
      $s38 = "        opts.pmSetLongOption('proc', 0, 'p', '', 'enable process stats')" fullword ascii
      $s39 = "# Copyright (C) 2018-2022 Red Hat." fullword ascii
      $s40 = "        # 2 - options from configuration file(s)" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 65 6e 76 20 70 6d 70 79 74 68 6f 6e 0a 23 0a 23 20 43 6f 70 79 72 69 67 68 74 20 28 43 29 20 32 30 31 38 2d 32 30 32 32 20 52 65 64 20 48 61 74 2e 0a 23 20 43 6f 70 79 72 69 67 68 74 20 28 43 29 20 32 30 30 34 2d 32 30 31 36 20 44 61 67 20 57 69 65 65 72 73 20 3c 64 61 67 40 77 69 65 65 72 73 2e 63 6f 6d 3e 0a 23 0a 23 20 54 68 69 73 20 70 72 6f 67 72 61 6d 20 69 73 20 66 72 65 65 20 73 6f 66 74 77 61 72 65 3b 20 79 6f 75 20 63 61 6e 20 72 65 64 69 73 74 72 69 62 75 74 65 20 69 74 20 61 6e 64 2f 6f 72 20 6d 6f 64 69 66 79 20 69 74 0a 23 20 75 6e 64 65 72 20 74 68 65 20 74 65 72 6d 73 20 6f 66 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 61 73 20 70 75 62 6c 69 73 68 65 64 20 62 79 20 74 68 65 0a 23 20 46 72 65 65 20 53 6f 66 74 77 61 72 65 20 46 6f 75 6e 64 61 74 69 6f 6e 3b 20 65 69 74 68 65 72 20 76 65 72 73 69 6f 6e 20 32 20 6f 66 20 74 68 65 20 4c 69 63 65 6e 73 65 2c 20 6f 72 20 28 61 74 20 79 6f 75 72 0a 23 20 6f 70 74 69 6f 6e 29 20 61 6e 79 20 6c 61 74 65 72 20 76 65 72 73 69 6f 6e 2e 0a 23 0a 23 20 54 68 69 73 20 70 72 6f 67 72 61 6d 20 69 73 20 64 69 73 74 72 69 62 75 74 65 64 20 69 6e 20 74 68 65 20 68 6f 70 65 20 74 68 61 74 20 69 74 20 77 69 6c 6c 20 62 65 20 75 73 65 66 75 6c 2c 20 62 75 74 0a 23 20 57 49 54 48 4f 55 54 20 41 4e 59 20 57 41 52 52 41 4e 54 59 3b 20 77 69 74 68 6f 75 74 20 65 76 65 6e 20 74 68 65 20 69 6d 70 6c 69 65 64 20 77 61 72 72 61 6e 74 79 20 6f 66 20 4d 45 52 43 48 41 4e 54 41 42 49 4c 49 54 59 0a 23 20 6f 72 20 46 49 54 4e 45 53 53 20 46 4f 52 20 41 20 50 41 52 54 49 43 55 4c 41 52 20 50 55 52 50 4f 53 45 2e 20 20 53 65 65 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 0a 23 20 66 6f 72 20 6d 6f 72 65 20 64 65 74 61 69 6c 73 2e 0a 23 0a 23 20 70 79 6c 69 6e 74 3a 20 64 69 73 61 62 6c 65 3d 6d 69 73 73 69 6e 67 2d 64 6f 63 73 74 72 69 6e 67 2c 6d 75 6c 74 69 70 6c 65 2d 69 6d 70 6f 72 74 73 2c 69 6e 76 61 6c 69 64 2d 6e 61 6d 65 0a 23 20 70 79 6c 69 6e 74 3a 20 64 69 73 61 62 6c 65 3d 74 6f 6f 2d 6d 61 6e 79 2d 6c 69 6e 65 73 2c 74 6f 6f 2d 6d 61 6e 79 2d 61 72 67 75 6d 65 6e 74 73 2c 74 6f 6f 2d 6d 61 6e 79 2d 6e 65 73 74 65 64 2d 62 6c 6f 63 6b 73 0a 23 20 70 79 6c 69 6e 74 3a 20 64 69 73 61 62 6c 65 3d 6c 69 6e 65 2d 74 6f 6f 2d 6c 6f 6e 67 2c 62 61 64 2d 63 6f 6e 74 69 6e 75 61 74 69 6f 6e 2c 62 72 6f 61 64 2d 65 78 63 65 70 74 2c 62 61 72 65 2d 65 78 63 65 70 74 0a 23 20 70 79 6c 69 6e 74 3a 20 64 69 73 61 62 6c 65 3d 67 6c 6f 62 61 6c 2d 76 61 72 69 61 62 6c 65 2d 75 6e 64 65 66 69 6e 65 64 2c 67 6c 6f 62 61 6c 2d 61 74 2d 6d 6f 64 75 6c 65 2d 6c 65 76 65 6c 0a 0a 23 20 43 6f 6d 6d 6f 6e 20 69 6d 70 6f 72 74 73 0a 66 72 6f 6d 20 63 6f 6c 6c 65 63 74 69 6f 6e 73 20 69 6d 70 6f 72 74 20 4f 72 64 65 72 65 64 44 69 63 74 0a 74 72 79 3a 0a 20 20 20 20 69 6d 70 6f 72 74 20 63 6f 6e 66 69 67 70 61 72 73 65 72 20 61 73 20 43 6f 6e 66 69 67 50 61 72 73 65 72 0a 65 78 63 65 70 74 20 49 6d 70 6f 72 74 45 72 72 6f 72 3a 0a 20 20 20 20 69 6d 70 6f 72 74 20 43}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_pip {
   strings:
      $s1 = "    sys.argv[0] = re.sub(r\"(-script\\.pyw|\\.exe)?$\", \"\", sys.argv[0])" fullword ascii
      $s2 = "from pip._internal.cli.main import main" fullword ascii
      $s3 = "#!/usr/bin/python3" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 79 74 68 6f 6e 33 0a 23 20 2d 2a 2d 20 63 6f 64 69 6e 67 3a 20 75 74 66 2d 38 20 2d 2a 2d 0a 69 6d 70 6f 72 74 20 72 65 0a 69 6d 70 6f 72 74 20 73 79 73 0a 66 72 6f 6d 20 70 69 70 2e 5f 69 6e 74 65 72 6e 61 6c 2e 63 6c 69 2e 6d 61 69 6e 20 69 6d 70 6f 72 74 20 6d 61 69 6e 0a 69 66 20 5f 5f 6e 61 6d 65 5f 5f 20 3d 3d 20 22 5f 5f 6d 61 69 6e 5f 5f 22 3a 0a 20 20 20 20 73 79 73 2e 61 72 67 76 5b 30 5d 20 3d 20 72 65 2e 73 75 62 28 72 22 28 2d 73 63 72 69 70 74 5c 2e 70 79 77 7c 5c 2e 65 78 65 29 3f 24 22 2c 20 22 22 2c 20 73 79 73 2e 61 72 67 76 5b 30 5d 29 0a 20 20 20 20 73 79 73 2e 65 78 69 74 28 6d 61 69 6e 28 29 29 0a}
condition:
      filesize < 1KB and
      all of them
}

rule gtfobins_binaries_ansible_playbook {
   strings:
      $s1 = "    sys.argv[0] = re.sub(r'(-script\\.pyw|\\.exe)?$', '', sys.argv[0])" fullword ascii
      $s2 = "from ansible.cli.playbook import main" fullword ascii
      $s3 = "#!/usr/bin/python3" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 79 74 68 6f 6e 33 0a 23 20 2d 2a 2d 20 63 6f 64 69 6e 67 3a 20 75 74 66 2d 38 20 2d 2a 2d 0a 69 6d 70 6f 72 74 20 72 65 0a 69 6d 70 6f 72 74 20 73 79 73 0a 66 72 6f 6d 20 61 6e 73 69 62 6c 65 2e 63 6c 69 2e 70 6c 61 79 62 6f 6f 6b 20 69 6d 70 6f 72 74 20 6d 61 69 6e 0a 69 66 20 5f 5f 6e 61 6d 65 5f 5f 20 3d 3d 20 27 5f 5f 6d 61 69 6e 5f 5f 27 3a 0a 20 20 20 20 73 79 73 2e 61 72 67 76 5b 30 5d 20 3d 20 72 65 2e 73 75 62 28 72 27 28 2d 73 63 72 69 70 74 5c 2e 70 79 77 7c 5c 2e 65 78 65 29 3f 24 27 2c 20 27 27 2c 20 73 79 73 2e 61 72 67 76 5b 30 5d 29 0a 20 20 20 20 73 79 73 2e 65 78 69 74 28 6d 61 69 6e 28 29 29 0a}
condition:
      filesize < 1KB and
      all of them
}

rule gtfobins_binaries_sqlmap {
   strings:
      $s1 = "        elif kb.get(\"dumpKeyboardInterrupt\"):" fullword ascii
      $s2 = "        if cmdLineOptions.get(\"sqlmapShell\"):" fullword ascii
      $s3 = "        elif all(_ in excMsg for _ in (\"Access is denied\", \"subprocess\", \"metasploit\")):" fullword ascii
      $s4 = "        if conf.get(\"dumper\"):" fullword ascii
      $s5 = "                                    infoMsg = \"starting crawler for target URL '%s' (%d/%d)\" % (target, i + 1, len(targets))" fullword ascii
      $s6 = "    from lib.core.data import logger" fullword ascii
      $s7 = "                                        target = \"http://%s\" % target" fullword ascii
      $s8 = "        # Reference: http://stackoverflow.com/questions/1635080/terminate-a-multi-thread-python-program" fullword ascii
      $s9 = "            errMsg += \"Python 3 (Reference: 'https://github.com/mullender/python-ntlm/pull/61')\"" fullword ascii
      $s10 = "        if kb.get(\"tempDir\"):" fullword ascii
      $s11 = "    from lib.core.common import getSafeExString" fullword ascii
      $s12 = "    from lib.core.common import getDaysFromLastUpdate" fullword ascii
      $s13 = "            errMsg = \"unable to write to the temporary directory '%s'. \" % tempfile.gettempdir()" fullword ascii
      $s14 = "    from lib.core.data import cmdLineOptions" fullword ascii
      $s15 = "            errMsg = \"permission error occurred while running Metasploit\"" fullword ascii
      $s16 = "    from lib.core.common import getFileItems" fullword ascii
      $s17 = "        elif all(_ in excMsg for _ in (\"PermissionError: [WinError 5]\", \"multiprocessing\")):" fullword ascii
      $s18 = "            errMsg = \"there has been a problem while running the multiprocessing hash cracking. \"" fullword ascii
      $s19 = "            if not filterNone(filepath for filepath in glob.glob(os.path.join(kb.tempDir, '*')) if not any(filepath.endswith(_) " ascii
      $s20 = "    from lib.core.compat import LooseVersion" fullword ascii
      $s21 = "            logger.error(errMsg)" fullword ascii
      $s22 = " bytes\", \"No module named\", \"tp_name field\", \"module 'sqlite3' has no attribute 'OperationalError'\")):" fullword ascii
      $s23 = "                                    if not re.search(r\"(?i)\\Ahttp[s]*://\", target):" fullword ascii
      $s24 = "                                        logger.error(errMsg)" fullword ascii
      $s25 = "                    json.dump(conf.httpCollector.obtain(), fp=f, indent=4, separators=(',', ': '))" fullword ascii
      $s26 = "                                    if target and not isinstance(ex, SqlmapUserQuitException):" fullword ascii
      $s27 = "        sys.exit(\"[!] wrong installation detected (missing modules). Visit 'https://github.com/sqlmapproject/sqlmap/#installati" ascii
      $s28 = "        logger.error(errMsg)" fullword ascii
      $s29 = "        cmdLineOptions.sqlmapShell = False" fullword ascii
      $s30 = "            errMsg += \"(Reference: 'https://github.com/PyMySQL/PyMySQL/issues/700')\"" fullword ascii
      $s31 = "        sys.exit(\"[!] wrong installation detected (missing modules). Visit 'https://github.com/sqlmapproject/sqlmap/#installati" ascii
      $s32 = "        elif any(_ in excMsg for _ in (\"ImportError\", \"ModuleNotFoundError\", \"<frozen\", \"Can't find file for module\", \"" ascii
      $s33 = "            for prefix in (MKSTEMP_PREFIX.IPC, MKSTEMP_PREFIX.TESTING, MKSTEMP_PREFIX.COOKIE_JAR, MKSTEMP_PREFIX.BIG_ARRAY):" fullword ascii
      $s34 = "            errMsg += \"(Reference: 'https://stackoverflow.com/a/38841364' & 'https://bugs.python.org/issue24944#msg249231')\"" fullword ascii
      $s35 = "                                        errMsg = \"problem occurred while crawling '%s' ('%s')\" % (target, getSafeExString(ex))" ascii
      $s36 = "            errMsg += \" (Reference: 'https://github.com/sqlmapproject/sqlmap/issues/4572#issuecomment-775041086')\"" fullword ascii
      $s37 = "            errMsg += \"(Reference: 'https://qiita.com/tkprof/items/7d7b2d00df9c5f16fffe')\"" fullword ascii
      $s38 = "            errMsg = \"permission error occurred while using Metasploit\"" fullword ascii
      $s39 = "#! /usr/bin/python3" fullword ascii
      $s40 = "    import tempfile" fullword ascii
      $magic = {23 21 20 2f 75 73 72 2f 62 69 6e 2f 70 79 74 68 6f 6e 33 0a 0a 22 22 22 0a 43 6f 70 79 72 69 67 68 74 20 28 63 29 20 32 30 30 36 2d 32 30 32 34 20 73 71 6c 6d 61 70 20 64 65 76 65 6c 6f 70 65 72 73 20 28 68 74 74 70 73 3a 2f 2f 73 71 6c 6d 61 70 2e 6f 72 67 2f 29 0a 53 65 65 20 74 68 65 20 66 69 6c 65 20 27 4c 49 43 45 4e 53 45 27 20 66 6f 72 20 63 6f 70 79 69 6e 67 20 70 65 72 6d 69 73 73 69 6f 6e 0a 22 22 22 0a 0a 66 72 6f 6d 20 5f 5f 66 75 74 75 72 65 5f 5f 20 69 6d 70 6f 72 74 20 70 72 69 6e 74 5f 66 75 6e 63 74 69 6f 6e 0a 0a 74 72 79 3a 0a 20 20 20 20 69 6d 70 6f 72 74 20 73 79 73 0a 0a 20 20 20 20 73 79 73 2e 64 6f 6e 74 5f 77 72 69 74 65 5f 62 79 74 65 63 6f 64 65 20 3d 20 54 72 75 65 0a 0a 20 20 20 20 74 72 79 3a 0a 20 20 20 20 20 20 20 20 5f 5f 69 6d 70 6f 72 74 5f 5f 28 22 6c 69 62 2e 75 74 69 6c 73 2e 76 65 72 73 69 6f 6e 63 68 65 63 6b 22 29 20 20 23 20 74 68 69 73 20 68 61 73 20 74 6f 20 62 65 20 74 68 65 20 66 69 72 73 74 20 6e 6f 6e 2d 73 74 61 6e 64 61 72 64 20 69 6d 70 6f 72 74 0a 20 20 20 20 65 78 63 65 70 74 20 49 6d 70 6f 72 74 45 72 72 6f 72 3a 0a 20 20 20 20 20 20 20 20 73 79 73 2e 65 78 69 74 28 22 5b 21 5d 20 77 72 6f 6e 67 20 69 6e 73 74 61 6c 6c 61 74 69 6f 6e 20 64 65 74 65 63 74 65 64 20 28 6d 69 73 73 69 6e 67 20 6d 6f 64 75 6c 65 73 29 2e 20 56 69 73 69 74 20 27 68 74 74 70 73 3a 2f 2f 67 69 74 68 75 62 2e 63 6f 6d 2f 73 71 6c 6d 61 70 70 72 6f 6a 65 63 74 2f 73 71 6c 6d 61 70 2f 23 69 6e 73 74 61 6c 6c 61 74 69 6f 6e 27 20 66 6f 72 20 66 75 72 74 68 65 72 20 64 65 74 61 69 6c 73 22 29 0a 0a 20 20 20 20 69 6d 70 6f 72 74 20 62 64 62 0a 20 20 20 20 69 6d 70 6f 72 74 20 67 6c 6f 62 0a 20 20 20 20 69 6d 70 6f 72 74 20 69 6e 73 70 65 63 74 0a 20 20 20 20 69 6d 70 6f 72 74 20 6a 73 6f 6e 0a 20 20 20 20 69 6d 70 6f 72 74 20 6c 6f 67 67 69 6e 67 0a 20 20 20 20 69 6d 70 6f 72 74 20 6f 73 0a 20 20 20 20 69 6d 70 6f 72 74 20 72 65 0a 20 20 20 20 69 6d 70 6f 72 74 20 73 68 75 74 69 6c 0a 20 20 20 20 69 6d 70 6f 72 74 20 73 79 73 0a 20 20 20 20 69 6d 70 6f 72 74 20 74 65 6d 70 66 69 6c 65 0a 20 20 20 20 69 6d 70 6f 72 74 20 74 68 72 65 61 64 69 6e 67 0a 20 20 20 20 69 6d 70 6f 72 74 20 74 69 6d 65 0a 20 20 20 20 69 6d 70 6f 72 74 20 74 72 61 63 65 62 61 63 6b 0a 20 20 20 20 69 6d 70 6f 72 74 20 77 61 72 6e 69 6e 67 73 0a 0a 20 20 20 20 69 66 20 22 2d 2d 64 65 70 72 65 63 61 74 69 6f 6e 73 22 20 6e 6f 74 20 69 6e 20 73 79 73 2e 61 72 67 76 3a 0a 20 20 20 20 20 20 20 20 77 61 72 6e 69 6e 67 73 2e 66 69 6c 74 65 72 77 61 72 6e 69 6e 67 73 28 61 63 74 69 6f 6e 3d 22 69 67 6e 6f 72 65 22 2c 20 63 61 74 65 67 6f 72 79 3d 44 65 70 72 65 63 61 74 69 6f 6e 57 61 72 6e 69 6e 67 29 0a 20 20 20 20 65 6c 73 65 3a 0a 20 20 20 20 20 20 20 20 77 61 72 6e 69 6e 67 73 2e 72 65 73 65 74 77 61 72 6e 69 6e 67 73 28 29 0a 20 20 20 20 20 20 20 20 77 61 72 6e 69 6e 67 73 2e 66 69 6c 74 65 72 77 61 72 6e 69 6e 67 73 28 61 63 74 69 6f 6e 3d 22 69 67 6e 6f 72 65 22 2c 20 6d 65 73 73 61 67 65 3d 22 27 63 72 79 70 74 27 22 2c 20 63 61 74 65 67 6f 72 79 3d 44 65 70 72 65 63 61 74 69 6f 6e 57 61 72 6e 69 6e 67 29 0a 20 20 20 20}
condition:
      filesize < 80KB and
      8 of them and $magic
}

rule gtfobins_binaries_grc {
   strings:
      $s1 = "grc [options] command [args]" fullword ascii
      $s2 = "    optlist, args = getopt.getopt(sys.argv[1:], \"sec:\", [\"stdout\", \"stderr\", \"config=\", \"colour=\", \"pty\"] )" fullword ascii
      $s3 = "    except OSError: # if the subprocess already died" fullword ascii
      $s4 = "import os, re, string, sys, getopt, signal" fullword ascii
      $s5 = "#! /usr/bin/python3" fullword ascii
      $s6 = "            os.execvp(args[0], args)" fullword ascii
      $s7 = "    xdg  = os.environ.get('XDG_CONFIG_HOME')" fullword ascii
      $s8 = "--pty          run command in pseudoterminal (experimental)" fullword ascii
      $s9 = "    if pidp == 0: # child, command to run" fullword ascii
      $s10 = "            sys.stderr.write('grc: %s: %s\\n' % (args[0], e.strerror))" fullword ascii
      $s11 = "from __future__ import print_function" fullword ascii
      $s12 = "sys.exit(status and os.WEXITSTATUS(status))" fullword ascii
      $s13 = "# configure file for grcat" fullword ascii
      $s14 = "-s --stdout    redirect stdout, even if -e is selected" fullword ascii
      $s15 = "    home = os.environ.get('HOME')" fullword ascii
      $s16 = "            os.execvp(\"grcat\", [\"grcat\", cfile])" fullword ascii
      $s17 = "        xdg = home + '/.config'" fullword ascii
      $s18 = "        conffilenames += [home + '/.grc/grc.conf']" fullword ascii
      $s19 = "        choo, chio = os.pipe()" fullword ascii
      $s20 = "        choe, chie = os.pipe()" fullword ascii
      $s21 = "            # connect child (this) stdout to pipe write end" fullword ascii
      $s22 = "cfile = \"\"" fullword ascii
      $s23 = "colour = sys.stdout.isatty()" fullword ascii
      $s24 = "def version():" fullword ascii /* Goodware String - occured 1 times */
      $s25 = "if stderrf == 1:" fullword ascii
      $s26 = "if cfile != \"\" and colour:" fullword ascii
      $s27 = "stderrf = 0" fullword ascii
      $s28 = "stdoutf = 0" fullword ascii
      $s29 = "            # connect grcat's stdin to pipe read end, or pty master" fullword ascii
      $s30 = "if cfile == \"\":" fullword ascii
      $s31 = "if stdoutf == 1:" fullword ascii
      $s32 = "stderrff = 0" fullword ascii
      $s33 = "--colour=word  word is one of: on, off, auto" fullword ascii
      $s34 = "stdoutff = 1" fullword ascii
      $s35 = "for i in optlist:" fullword ascii
      $s36 = "    import pty" fullword ascii
      $s37 = "#        pass" fullword ascii
      $s38 = "def catch_signal(signum, frame):" fullword ascii
      $s39 = "#        os.kill(pidp, signal.SIGINT)" fullword ascii
      $s40 = "        conffilenames += [xdg + '/grc/grc.conf']" fullword ascii
      $magic = {23 21 20 2f 75 73 72 2f 62 69 6e 2f 70 79 74 68 6f 6e 33 0a 0a 66 72 6f 6d 20 5f 5f 66 75 74 75 72 65 5f 5f 20 69 6d 70 6f 72 74 20 70 72 69 6e 74 5f 66 75 6e 63 74 69 6f 6e 0a 0a 69 6d 70 6f 72 74 20 6f 73 2c 20 72 65 2c 20 73 74 72 69 6e 67 2c 20 73 79 73 2c 20 67 65 74 6f 70 74 2c 20 73 69 67 6e 61 6c 0a 0a 0a 64 65 66 20 76 65 72 73 69 6f 6e 28 29 3a 0a 20 20 20 20 70 72 69 6e 74 20 28 22 47 65 6e 65 72 69 63 20 43 6f 6c 6f 75 72 69 73 65 72 20 31 2e 31 33 22 29 0a 20 20 20 20 73 79 73 2e 65 78 69 74 28 29 0a 0a 64 65 66 20 68 65 6c 70 28 29 3a 0a 20 20 20 20 70 72 69 6e 74 28 22 22 22 47 65 6e 65 72 69 63 20 43 6f 6c 6f 75 72 69 73 65 72 20 31 2e 31 33 0a 67 72 63 20 5b 6f 70 74 69 6f 6e 73 5d 20 63 6f 6d 6d 61 6e 64 20 5b 61 72 67 73 5d 0a 4f 70 74 69 6f 6e 73 3a 0a 2d 65 20 2d 2d 73 74 64 65 72 72 20 20 20 20 72 65 64 69 72 65 63 74 20 73 74 64 65 72 72 2e 20 49 66 20 74 68 69 73 20 6f 70 74 69 6f 6e 20 69 73 20 73 65 6c 65 63 74 65 64 2c 0a 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 64 6f 20 6e 6f 74 20 61 75 74 6f 6d 61 74 69 63 61 6c 6c 79 20 72 65 64 69 72 65 63 74 20 73 74 64 6f 75 74 0a 2d 73 20 2d 2d 73 74 64 6f 75 74 20 20 20 20 72 65 64 69 72 65 63 74 20 73 74 64 6f 75 74 2c 20 65 76 65 6e 20 69 66 20 2d 65 20 69 73 20 73 65 6c 65 63 74 65 64 0a 2d 63 20 6e 61 6d 65 20 2d 2d 63 6f 6e 66 69 67 3d 6e 61 6d 65 20 20 20 20 75 73 65 20 6e 61 6d 65 20 61 73 20 63 6f 6e 66 69 67 75 72 61 74 69 6f 6e 20 66 69 6c 65 20 66 6f 72 20 67 72 63 61 74 0a 2d 2d 63 6f 6c 6f 75 72 3d 77 6f 72 64 20 20 77 6f 72 64 20 69 73 20 6f 6e 65 20 6f 66 3a 20 6f 6e 2c 20 6f 66 66 2c 20 61 75 74 6f 0a 2d 2d 70 74 79 20 20 20 20 20 20 20 20 20 20 72 75 6e 20 63 6f 6d 6d 61 6e 64 20 69 6e 20 70 73 65 75 64 6f 74 65 72 6d 69 6e 61 6c 20 28 65 78 70 65 72 69 6d 65 6e 74 61 6c 29 0a 22 22 22 29 0a 20 20 20 20 73 79 73 2e 65 78 69 74 28 29 0a 0a 0a 64 65 66 20 63 61 74 63 68 5f 73 69 67 6e 61 6c 28 73 69 67 6e 75 6d 2c 20 66 72 61 6d 65 29 3a 0a 20 20 20 20 22 63 61 74 63 68 20 73 69 67 6e 61 6c 20 73 65 6e 74 20 74 6f 20 67 72 63 20 61 6e 64 20 66 6f 72 77 61 72 64 20 69 74 20 74 6f 20 74 68 65 20 6f 72 69 67 69 6e 61 6c 20 61 70 70 6c 69 63 61 74 69 6f 6e 22 0a 20 20 20 20 67 6c 6f 62 61 6c 20 70 69 64 70 0a 20 20 20 20 74 72 79 3a 0a 20 20 20 20 20 20 20 20 6f 73 2e 6b 69 6c 6c 28 70 69 64 70 2c 20 73 69 67 6e 75 6d 29 0a 20 20 20 20 65 78 63 65 70 74 20 4f 53 45 72 72 6f 72 3a 20 23 20 69 66 20 74 68 65 20 73 75 62 70 72 6f 63 65 73 73 20 61 6c 72 65 61 64 79 20 64 69 65 64 0a 20 20 20 20 20 20 20 20 70 61 73 73 0a 0a 74 72 79 3a 0a 20 20 20 20 6f 70 74 6c 69 73 74 2c 20 61 72 67 73 20 3d 20 67 65 74 6f 70 74 2e 67 65 74 6f 70 74 28 73 79 73 2e 61 72 67 76 5b 31 3a 5d 2c 20 22 73 65 63 3a 22 2c 20 5b 22 73 74 64 6f 75 74 22 2c 20 22 73 74 64 65 72 72 22 2c 20 22 63 6f 6e 66 69 67 3d 22 2c 20 22 63 6f 6c 6f 75 72 3d 22 2c 20 22 70 74 79 22 5d 20 29 0a 65 78 63 65 70 74 3a 0a 20 20 20 20 68 65 6c 70 28 29 0a 0a 69 66 20 6e 6f 74 20 61 72 67 73 3a 0a 20 20 20 20 68 65 6c 70 28 29 0a 0a 73 74 64 6f 75 74 66 20 3d 20 30 0a 73 74 64 65}
condition:
      filesize < 20KB and
      8 of them and $magic
}

rule gtfobins_binaries_dnf {
   strings:
      $s1 = "# The dnf executable script." fullword ascii
      $s2 = "# the GNU General Public License v.2, or (at your option) any later version." fullword ascii
      $s3 = "# Public License for more details.  You should have received a copy of the" fullword ascii
      $s4 = "# source code or documentation are not subject to the GNU General Public" fullword ascii
      $s5 = "# GNU General Public License along with this program; if not, write to the" fullword ascii
      $s6 = "# do this ASAP to prevent tracebacks after ^C during imports" fullword ascii
      $s7 = "from dnf.cli import main" fullword ascii
      $s8 = "    sys.stderr.write('The executable DNF module must not be imported.')" fullword ascii
      $s9 = "# Copyright (C) 2012-2016 Red Hat, Inc." fullword ascii
      $s10 = "main.user_main(sys.argv[1:], exit_code=True)" fullword ascii
      $s11 = "    # we never import Python modules from /usr/bin" fullword ascii
      $s12 = "# This program is distributed in the hope that it will be useful, but WITHOUT" fullword ascii
      $s13 = "# modify, copy, or redistribute it subject to the terms and conditions of" fullword ascii
      $s14 = "# ANY WARRANTY expressed or implied, including the implied warranties of" fullword ascii
      $s15 = "# This copyrighted material is made available to anyone wishing to use," fullword ascii
      $s16 = "# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General" fullword ascii
      $s17 = "# Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA" fullword ascii
      $s18 = "# 02110-1301, USA.  Any Red Hat trademarks that are incorporated in the" fullword ascii
      $s19 = "#!/usr/bin/python3" fullword ascii
      $s20 = "suppress_keyboard_interrupt_message()" fullword ascii
      $s21 = "def suppress_keyboard_interrupt_message():" fullword ascii
      $s22 = "from __future__ import unicode_literals" fullword ascii
      $s23 = "if here == '/usr/bin':" fullword ascii
      $s24 = "# Red Hat, Inc." fullword ascii
      $s25 = "here = sys.path[0]" fullword ascii
      $s26 = "# License and may only be used or replicated with the express permission of" fullword ascii
      $s27 = "if __name__ != \"__main__\":" fullword ascii
      $s28 = "    # removing this lowers the risk of accidental imports of weird files" fullword ascii
      $s29 = "    \"\"\"Prevent unsightly KeyboardInterrupt tracebacks." fullword ascii
      $s30 = "        if type != KeyboardInterrupt:" fullword ascii
      $s31 = "            pass" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 79 74 68 6f 6e 33 0a 23 20 54 68 65 20 64 6e 66 20 65 78 65 63 75 74 61 62 6c 65 20 73 63 72 69 70 74 2e 0a 23 0a 23 20 43 6f 70 79 72 69 67 68 74 20 28 43 29 20 32 30 31 32 2d 32 30 31 36 20 52 65 64 20 48 61 74 2c 20 49 6e 63 2e 0a 23 0a 23 20 54 68 69 73 20 63 6f 70 79 72 69 67 68 74 65 64 20 6d 61 74 65 72 69 61 6c 20 69 73 20 6d 61 64 65 20 61 76 61 69 6c 61 62 6c 65 20 74 6f 20 61 6e 79 6f 6e 65 20 77 69 73 68 69 6e 67 20 74 6f 20 75 73 65 2c 0a 23 20 6d 6f 64 69 66 79 2c 20 63 6f 70 79 2c 20 6f 72 20 72 65 64 69 73 74 72 69 62 75 74 65 20 69 74 20 73 75 62 6a 65 63 74 20 74 6f 20 74 68 65 20 74 65 72 6d 73 20 61 6e 64 20 63 6f 6e 64 69 74 69 6f 6e 73 20 6f 66 0a 23 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 76 2e 32 2c 20 6f 72 20 28 61 74 20 79 6f 75 72 20 6f 70 74 69 6f 6e 29 20 61 6e 79 20 6c 61 74 65 72 20 76 65 72 73 69 6f 6e 2e 0a 23 20 54 68 69 73 20 70 72 6f 67 72 61 6d 20 69 73 20 64 69 73 74 72 69 62 75 74 65 64 20 69 6e 20 74 68 65 20 68 6f 70 65 20 74 68 61 74 20 69 74 20 77 69 6c 6c 20 62 65 20 75 73 65 66 75 6c 2c 20 62 75 74 20 57 49 54 48 4f 55 54 0a 23 20 41 4e 59 20 57 41 52 52 41 4e 54 59 20 65 78 70 72 65 73 73 65 64 20 6f 72 20 69 6d 70 6c 69 65 64 2c 20 69 6e 63 6c 75 64 69 6e 67 20 74 68 65 20 69 6d 70 6c 69 65 64 20 77 61 72 72 61 6e 74 69 65 73 20 6f 66 0a 23 20 4d 45 52 43 48 41 4e 54 41 42 49 4c 49 54 59 20 6f 72 20 46 49 54 4e 45 53 53 20 46 4f 52 20 41 20 50 41 52 54 49 43 55 4c 41 52 20 50 55 52 50 4f 53 45 2e 20 20 53 65 65 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 0a 23 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 66 6f 72 20 6d 6f 72 65 20 64 65 74 61 69 6c 73 2e 20 20 59 6f 75 20 73 68 6f 75 6c 64 20 68 61 76 65 20 72 65 63 65 69 76 65 64 20 61 20 63 6f 70 79 20 6f 66 20 74 68 65 0a 23 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 20 4c 69 63 65 6e 73 65 20 61 6c 6f 6e 67 20 77 69 74 68 20 74 68 69 73 20 70 72 6f 67 72 61 6d 3b 20 69 66 20 6e 6f 74 2c 20 77 72 69 74 65 20 74 6f 20 74 68 65 0a 23 20 46 72 65 65 20 53 6f 66 74 77 61 72 65 20 46 6f 75 6e 64 61 74 69 6f 6e 2c 20 49 6e 63 2e 2c 20 35 31 20 46 72 61 6e 6b 6c 69 6e 20 53 74 72 65 65 74 2c 20 46 69 66 74 68 20 46 6c 6f 6f 72 2c 20 42 6f 73 74 6f 6e 2c 20 4d 41 0a 23 20 30 32 31 31 30 2d 31 33 30 31 2c 20 55 53 41 2e 20 20 41 6e 79 20 52 65 64 20 48 61 74 20 74 72 61 64 65 6d 61 72 6b 73 20 74 68 61 74 20 61 72 65 20 69 6e 63 6f 72 70 6f 72 61 74 65 64 20 69 6e 20 74 68 65 0a 23 20 73 6f 75 72 63 65 20 63 6f 64 65 20 6f 72 20 64 6f 63 75 6d 65 6e 74 61 74 69 6f 6e 20 61 72 65 20 6e 6f 74 20 73 75 62 6a 65 63 74 20 74 6f 20 74 68 65 20 47 4e 55 20 47 65 6e 65 72 61 6c 20 50 75 62 6c 69 63 0a 23 20 4c 69 63 65 6e 73 65 20 61 6e 64 20 6d 61 79 20 6f 6e 6c 79 20 62 65 20 75 73 65 64 20 6f 72 20 72 65 70 6c 69 63 61 74 65 64 20 77 69 74 68 20 74 68 65 20 65 78 70 72 65 73 73 20 70 65 72 6d 69 73 73 69 6f 6e 20 6f 66 0a 23 20 52 65 64 20 48 61 74 2c 20 49 6e 63 2e 0a 23 0a 0a 66 72 6f 6d 20 5f 5f 66 75 74 75 72 65 5f}
condition:
      filesize < 5KB and
      8 of them and $magic
}

rule gtfobins_binaries_aws {
   strings:
      $s1 = "# Copyright 2012 Amazon.com, Inc. or its affiliates. All Rights Reserved." fullword ascii
      $s2 = "#     http://aws.amazon.com/apache2.0/" fullword ascii
      $s3 = "if os.environ.get('LC_CTYPE', '') == 'UTF-8':" fullword ascii
      $s4 = "# Licensed under the Apache License, Version 2.0 (the \"License\"). You" fullword ascii
      $s5 = "# may not use this file except in compliance with the License. A copy of" fullword ascii
      $s6 = "# or in the \"license\" file accompanying this file. This file is" fullword ascii
      $s7 = "import awscli.clidriver" fullword ascii
      $s8 = "# ANY KIND, either express or implied. See the License for the specific" fullword ascii
      $s9 = "# distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF" fullword ascii
      $s10 = "# language governing permissions and limitations under the License." fullword ascii
      $s11 = "#!/usr/bin/python3" fullword ascii
      $s12 = "# the License is located at" fullword ascii
      $s13 = "    os.environ['LC_CTYPE'] = 'en_US.UTF-8'" fullword ascii
      $s14 = "    return awscli.clidriver.main()" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 79 74 68 6f 6e 33 0a 23 20 43 6f 70 79 72 69 67 68 74 20 32 30 31 32 20 41 6d 61 7a 6f 6e 2e 63 6f 6d 2c 20 49 6e 63 2e 20 6f 72 20 69 74 73 20 61 66 66 69 6c 69 61 74 65 73 2e 20 41 6c 6c 20 52 69 67 68 74 73 20 52 65 73 65 72 76 65 64 2e 0a 0a 23 20 4c 69 63 65 6e 73 65 64 20 75 6e 64 65 72 20 74 68 65 20 41 70 61 63 68 65 20 4c 69 63 65 6e 73 65 2c 20 56 65 72 73 69 6f 6e 20 32 2e 30 20 28 74 68 65 20 22 4c 69 63 65 6e 73 65 22 29 2e 20 59 6f 75 0a 23 20 6d 61 79 20 6e 6f 74 20 75 73 65 20 74 68 69 73 20 66 69 6c 65 20 65 78 63 65 70 74 20 69 6e 20 63 6f 6d 70 6c 69 61 6e 63 65 20 77 69 74 68 20 74 68 65 20 4c 69 63 65 6e 73 65 2e 20 41 20 63 6f 70 79 20 6f 66 0a 23 20 74 68 65 20 4c 69 63 65 6e 73 65 20 69 73 20 6c 6f 63 61 74 65 64 20 61 74 0a 0a 23 20 20 20 20 20 68 74 74 70 3a 2f 2f 61 77 73 2e 61 6d 61 7a 6f 6e 2e 63 6f 6d 2f 61 70 61 63 68 65 32 2e 30 2f 0a 0a 23 20 6f 72 20 69 6e 20 74 68 65 20 22 6c 69 63 65 6e 73 65 22 20 66 69 6c 65 20 61 63 63 6f 6d 70 61 6e 79 69 6e 67 20 74 68 69 73 20 66 69 6c 65 2e 20 54 68 69 73 20 66 69 6c 65 20 69 73 0a 23 20 64 69 73 74 72 69 62 75 74 65 64 20 6f 6e 20 61 6e 20 22 41 53 20 49 53 22 20 42 41 53 49 53 2c 20 57 49 54 48 4f 55 54 20 57 41 52 52 41 4e 54 49 45 53 20 4f 52 20 43 4f 4e 44 49 54 49 4f 4e 53 20 4f 46 0a 23 20 41 4e 59 20 4b 49 4e 44 2c 20 65 69 74 68 65 72 20 65 78 70 72 65 73 73 20 6f 72 20 69 6d 70 6c 69 65 64 2e 20 53 65 65 20 74 68 65 20 4c 69 63 65 6e 73 65 20 66 6f 72 20 74 68 65 20 73 70 65 63 69 66 69 63 0a 23 20 6c 61 6e 67 75 61 67 65 20 67 6f 76 65 72 6e 69 6e 67 20 70 65 72 6d 69 73 73 69 6f 6e 73 20 61 6e 64 20 6c 69 6d 69 74 61 74 69 6f 6e 73 20 75 6e 64 65 72 20 74 68 65 20 4c 69 63 65 6e 73 65 2e 0a 69 6d 70 6f 72 74 20 73 79 73 0a 69 6d 70 6f 72 74 20 6f 73 0a 0a 69 66 20 6f 73 2e 65 6e 76 69 72 6f 6e 2e 67 65 74 28 27 4c 43 5f 43 54 59 50 45 27 2c 20 27 27 29 20 3d 3d 20 27 55 54 46 2d 38 27 3a 0a 20 20 20 20 6f 73 2e 65 6e 76 69 72 6f 6e 5b 27 4c 43 5f 43 54 59 50 45 27 5d 20 3d 20 27 65 6e 5f 55 53 2e 55 54 46 2d 38 27 0a 69 6d 70 6f 72 74 20 61 77 73 63 6c 69 2e 63 6c 69 64 72 69 76 65 72 0a 0a 0a 64 65 66 20 6d 61 69 6e 28 29 3a 0a 20 20 20 20 72 65 74 75 72 6e 20 61 77 73 63 6c 69 2e 63 6c 69 64 72 69 76 65 72 2e 6d 61 69 6e 28 29 0a 0a 0a 69 66 20 5f 5f 6e 61 6d 65 5f 5f 20 3d 3d 20 27 5f 5f 6d 61 69 6e 5f 5f 27 3a 0a 20 20 20 20 73 79 73 2e 65 78 69 74 28 6d 61 69 6e 28 29 29 0a}
condition:
      filesize < 2KB and
      8 of them and $magic
}

rule gtfobins_binaries_base58 {
   strings:
      $s1 = "# EASY-INSTALL-ENTRY-SCRIPT: 'base58==1.0.3','console_scripts','base58'" fullword ascii
      $s2 = "    sys.argv[0] = re.sub(r'(-script\\.pyw?|\\.exe)?$', '', sys.argv[0])" fullword ascii
      $s3 = "# for compatibility with easy_install; see #2198" fullword ascii
      $s4 = "#!/usr/bin/python3" fullword ascii
      $s5 = "def importlib_load_entry_point(spec, group, name):" fullword ascii
      $s6 = "globals().setdefault('load_entry_point', importlib_load_entry_point)" fullword ascii
      $s7 = "    except ImportError:" fullword ascii
      $s8 = "    sys.exit(load_entry_point('base58==1.0.3', 'console_scripts', 'base58')())" fullword ascii
      $s9 = "__requires__ = 'base58==1.0.3'" fullword ascii
      $s10 = "        from importlib_metadata import distribution" fullword ascii
      $s11 = "    from importlib.metadata import distribution" fullword ascii
      $s12 = "        from pkg_resources import load_entry_point" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 79 74 68 6f 6e 33 0a 23 20 45 41 53 59 2d 49 4e 53 54 41 4c 4c 2d 45 4e 54 52 59 2d 53 43 52 49 50 54 3a 20 27 62 61 73 65 35 38 3d 3d 31 2e 30 2e 33 27 2c 27 63 6f 6e 73 6f 6c 65 5f 73 63 72 69 70 74 73 27 2c 27 62 61 73 65 35 38 27 0a 69 6d 70 6f 72 74 20 72 65 0a 69 6d 70 6f 72 74 20 73 79 73 0a 0a 23 20 66 6f 72 20 63 6f 6d 70 61 74 69 62 69 6c 69 74 79 20 77 69 74 68 20 65 61 73 79 5f 69 6e 73 74 61 6c 6c 3b 20 73 65 65 20 23 32 31 39 38 0a 5f 5f 72 65 71 75 69 72 65 73 5f 5f 20 3d 20 27 62 61 73 65 35 38 3d 3d 31 2e 30 2e 33 27 0a 0a 74 72 79 3a 0a 20 20 20 20 66 72 6f 6d 20 69 6d 70 6f 72 74 6c 69 62 2e 6d 65 74 61 64 61 74 61 20 69 6d 70 6f 72 74 20 64 69 73 74 72 69 62 75 74 69 6f 6e 0a 65 78 63 65 70 74 20 49 6d 70 6f 72 74 45 72 72 6f 72 3a 0a 20 20 20 20 74 72 79 3a 0a 20 20 20 20 20 20 20 20 66 72 6f 6d 20 69 6d 70 6f 72 74 6c 69 62 5f 6d 65 74 61 64 61 74 61 20 69 6d 70 6f 72 74 20 64 69 73 74 72 69 62 75 74 69 6f 6e 0a 20 20 20 20 65 78 63 65 70 74 20 49 6d 70 6f 72 74 45 72 72 6f 72 3a 0a 20 20 20 20 20 20 20 20 66 72 6f 6d 20 70 6b 67 5f 72 65 73 6f 75 72 63 65 73 20 69 6d 70 6f 72 74 20 6c 6f 61 64 5f 65 6e 74 72 79 5f 70 6f 69 6e 74 0a 0a 0a 64 65 66 20 69 6d 70 6f 72 74 6c 69 62 5f 6c 6f 61 64 5f 65 6e 74 72 79 5f 70 6f 69 6e 74 28 73 70 65 63 2c 20 67 72 6f 75 70 2c 20 6e 61 6d 65 29 3a 0a 20 20 20 20 64 69 73 74 5f 6e 61 6d 65 2c 20 5f 2c 20 5f 20 3d 20 73 70 65 63 2e 70 61 72 74 69 74 69 6f 6e 28 27 3d 3d 27 29 0a 20 20 20 20 6d 61 74 63 68 65 73 20 3d 20 28 0a 20 20 20 20 20 20 20 20 65 6e 74 72 79 5f 70 6f 69 6e 74 0a 20 20 20 20 20 20 20 20 66 6f 72 20 65 6e 74 72 79 5f 70 6f 69 6e 74 20 69 6e 20 64 69 73 74 72 69 62 75 74 69 6f 6e 28 64 69 73 74 5f 6e 61 6d 65 29 2e 65 6e 74 72 79 5f 70 6f 69 6e 74 73 0a 20 20 20 20 20 20 20 20 69 66 20 65 6e 74 72 79 5f 70 6f 69 6e 74 2e 67 72 6f 75 70 20 3d 3d 20 67 72 6f 75 70 20 61 6e 64 20 65 6e 74 72 79 5f 70 6f 69 6e 74 2e 6e 61 6d 65 20 3d 3d 20 6e 61 6d 65 0a 20 20 20 20 29 0a 20 20 20 20 72 65 74 75 72 6e 20 6e 65 78 74 28 6d 61 74 63 68 65 73 29 2e 6c 6f 61 64 28 29 0a 0a 0a 67 6c 6f 62 61 6c 73 28 29 2e 73 65 74 64 65 66 61 75 6c 74 28 27 6c 6f 61 64 5f 65 6e 74 72 79 5f 70 6f 69 6e 74 27 2c 20 69 6d 70 6f 72 74 6c 69 62 5f 6c 6f 61 64 5f 65 6e 74 72 79 5f 70 6f 69 6e 74 29 0a 0a 0a 69 66 20 5f 5f 6e 61 6d 65 5f 5f 20 3d 3d 20 27 5f 5f 6d 61 69 6e 5f 5f 27 3a 0a 20 20 20 20 73 79 73 2e 61 72 67 76 5b 30 5d 20 3d 20 72 65 2e 73 75 62 28 72 27 28 2d 73 63 72 69 70 74 5c 2e 70 79 77 3f 7c 5c 2e 65 78 65 29 3f 24 27 2c 20 27 27 2c 20 73 79 73 2e 61 72 67 76 5b 30 5d 29 0a 20 20 20 20 73 79 73 2e 65 78 69 74 28 6c 6f 61 64 5f 65 6e 74 72 79 5f 70 6f 69 6e 74 28 27 62 61 73 65 35 38 3d 3d 31 2e 30 2e 33 27 2c 20 27 63 6f 6e 73 6f 6c 65 5f 73 63 72 69 70 74 73 27 2c 20 27 62 61 73 65 35 38 27 29 28 29 29 0a}
condition:
      filesize < 2KB and
      8 of them and $magic
}

rule gtfobins_binaries_ansible_test {
   strings:
      $s1 = "# NOTE: This file resides in the _util/target directory to ensure compatibility with all supported Python versions." fullword ascii
      $s2 = "    from ansible_test._util.target.common.constants import CONTROLLER_PYTHON_VERSIONS" fullword ascii
      $s3 = "        raise SystemExit('This version of ansible-test cannot be executed with Python version %s. Supported Python versions are:" ascii
      $s4 = "        raise SystemExit('This version of ansible-test cannot be executed with Python version %s. Supported Python versions are:" ascii
      $s5 = "\"\"\"Command line entry point for ansible-test.\"\"\"" fullword ascii
      $s6 = "# PYTHON_ARGCOMPLETE_OK" fullword ascii
      $s7 = "#!/usr/bin/python3" fullword ascii
      $s8 = "from __future__ import (absolute_import, division, print_function)" fullword ascii
      $s9 = "    if any(not os.get_blocking(handle.fileno()) for handle in (sys.stdin, sys.stdout, sys.stderr)):" fullword ascii
      $s10 = "def version_to_str(version):" fullword ascii
      $s11 = "        raise SystemExit('Standard input, output and error file handles must be blocking to run ansible-test.')" fullword ascii
      $s12 = "        # running from source, use that version of ansible-test instead of any version that may already be installed" fullword ascii
      $s13 = " %s' % (" fullword ascii
      $s14 = "__metaclass__ = type" fullword ascii /* Goodware String - occured 1 times */
      $s15 = "def main(args=None):" fullword ascii /* Goodware String - occured 2 times */
      $s16 = "    return '.'.join(str(n) for n in version)" fullword ascii
      $s17 = "    ansible_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))" fullword ascii
      $s18 = "    source_root = os.path.join(ansible_root, 'test', 'lib')" fullword ascii
      $s19 = "        sys.path.insert(0, source_root)" fullword ascii
      $s20 = "            version_to_str(sys.version_info[:3]), ', '.join(CONTROLLER_PYTHON_VERSIONS)))" fullword ascii
      $s21 = "    from ansible_test._internal import main as cli_main" fullword ascii
      $s22 = "    if version_to_str(sys.version_info[:2]) not in CONTROLLER_PYTHON_VERSIONS:" fullword ascii
      $s23 = "    \"\"\"Return a version string from a version tuple.\"\"\"" fullword ascii
      $s24 = "    if os.path.exists(os.path.join(source_root, 'ansible_test', '_internal', '__init__.py')):" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 79 74 68 6f 6e 33 0a 23 20 50 59 54 48 4f 4e 5f 41 52 47 43 4f 4d 50 4c 45 54 45 5f 4f 4b 0a 22 22 22 43 6f 6d 6d 61 6e 64 20 6c 69 6e 65 20 65 6e 74 72 79 20 70 6f 69 6e 74 20 66 6f 72 20 61 6e 73 69 62 6c 65 2d 74 65 73 74 2e 22 22 22 0a 0a 23 20 4e 4f 54 45 3a 20 54 68 69 73 20 66 69 6c 65 20 72 65 73 69 64 65 73 20 69 6e 20 74 68 65 20 5f 75 74 69 6c 2f 74 61 72 67 65 74 20 64 69 72 65 63 74 6f 72 79 20 74 6f 20 65 6e 73 75 72 65 20 63 6f 6d 70 61 74 69 62 69 6c 69 74 79 20 77 69 74 68 20 61 6c 6c 20 73 75 70 70 6f 72 74 65 64 20 50 79 74 68 6f 6e 20 76 65 72 73 69 6f 6e 73 2e 0a 0a 66 72 6f 6d 20 5f 5f 66 75 74 75 72 65 5f 5f 20 69 6d 70 6f 72 74 20 28 61 62 73 6f 6c 75 74 65 5f 69 6d 70 6f 72 74 2c 20 64 69 76 69 73 69 6f 6e 2c 20 70 72 69 6e 74 5f 66 75 6e 63 74 69 6f 6e 29 0a 5f 5f 6d 65 74 61 63 6c 61 73 73 5f 5f 20 3d 20 74 79 70 65 0a 0a 69 6d 70 6f 72 74 20 6f 73 0a 69 6d 70 6f 72 74 20 73 79 73 0a 0a 0a 64 65 66 20 6d 61 69 6e 28 61 72 67 73 3d 4e 6f 6e 65 29 3a 0a 20 20 20 20 22 22 22 4d 61 69 6e 20 70 72 6f 67 72 61 6d 20 65 6e 74 72 79 20 70 6f 69 6e 74 2e 22 22 22 0a 20 20 20 20 61 6e 73 69 62 6c 65 5f 72 6f 6f 74 20 3d 20 6f 73 2e 70 61 74 68 2e 64 69 72 6e 61 6d 65 28 6f 73 2e 70 61 74 68 2e 64 69 72 6e 61 6d 65 28 6f 73 2e 70 61 74 68 2e 61 62 73 70 61 74 68 28 5f 5f 66 69 6c 65 5f 5f 29 29 29 0a 20 20 20 20 73 6f 75 72 63 65 5f 72 6f 6f 74 20 3d 20 6f 73 2e 70 61 74 68 2e 6a 6f 69 6e 28 61 6e 73 69 62 6c 65 5f 72 6f 6f 74 2c 20 27 74 65 73 74 27 2c 20 27 6c 69 62 27 29 0a 0a 20 20 20 20 69 66 20 6f 73 2e 70 61 74 68 2e 65 78 69 73 74 73 28 6f 73 2e 70 61 74 68 2e 6a 6f 69 6e 28 73 6f 75 72 63 65 5f 72 6f 6f 74 2c 20 27 61 6e 73 69 62 6c 65 5f 74 65 73 74 27 2c 20 27 5f 69 6e 74 65 72 6e 61 6c 27 2c 20 27 5f 5f 69 6e 69 74 5f 5f 2e 70 79 27 29 29 3a 0a 20 20 20 20 20 20 20 20 23 20 72 75 6e 6e 69 6e 67 20 66 72 6f 6d 20 73 6f 75 72 63 65 2c 20 75 73 65 20 74 68 61 74 20 76 65 72 73 69 6f 6e 20 6f 66 20 61 6e 73 69 62 6c 65 2d 74 65 73 74 20 69 6e 73 74 65 61 64 20 6f 66 20 61 6e 79 20 76 65 72 73 69 6f 6e 20 74 68 61 74 20 6d 61 79 20 61 6c 72 65 61 64 79 20 62 65 20 69 6e 73 74 61 6c 6c 65 64 0a 20 20 20 20 20 20 20 20 73 79 73 2e 70 61 74 68 2e 69 6e 73 65 72 74 28 30 2c 20 73 6f 75 72 63 65 5f 72 6f 6f 74 29 0a 0a 20 20 20 20 23 20 6e 6f 69 6e 73 70 65 63 74 69 6f 6e 20 50 79 50 72 6f 74 65 63 74 65 64 4d 65 6d 62 65 72 0a 20 20 20 20 66 72 6f 6d 20 61 6e 73 69 62 6c 65 5f 74 65 73 74 2e 5f 75 74 69 6c 2e 74 61 72 67 65 74 2e 63 6f 6d 6d 6f 6e 2e 63 6f 6e 73 74 61 6e 74 73 20 69 6d 70 6f 72 74 20 43 4f 4e 54 52 4f 4c 4c 45 52 5f 50 59 54 48 4f 4e 5f 56 45 52 53 49 4f 4e 53 0a 0a 20 20 20 20 69 66 20 76 65 72 73 69 6f 6e 5f 74 6f 5f 73 74 72 28 73 79 73 2e 76 65 72 73 69 6f 6e 5f 69 6e 66 6f 5b 3a 32 5d 29 20 6e 6f 74 20 69 6e 20 43 4f 4e 54 52 4f 4c 4c 45 52 5f 50 59 54 48 4f 4e 5f 56 45 52 53 49 4f 4e 53 3a 0a 20 20 20 20 20 20 20 20 72 61 69 73 65 20 53 79 73 74 65 6d 45 78 69 74 28 27 54 68 69 73 20 76 65 72 73 69 6f 6e 20 6f 66 20 61 6e 73 69 62 6c 65 2d}
condition:
      filesize < 4KB and
      8 of them and $magic
}

rule gtfobins_binaries_certbot {
   strings:
      $s1 = "# EASY-INSTALL-ENTRY-SCRIPT: 'certbot==2.11.0','console_scripts','certbot'" fullword ascii
      $s2 = "    sys.argv[0] = re.sub(r'(-script\\.pyw?|\\.exe)?$', '', sys.argv[0])" fullword ascii
      $s3 = "# for compatibility with easy_install; see #2198" fullword ascii
      $s4 = "#!/usr/bin/python3" fullword ascii
      $s5 = "def importlib_load_entry_point(spec, group, name):" fullword ascii
      $s6 = "globals().setdefault('load_entry_point', importlib_load_entry_point)" fullword ascii
      $s7 = "    except ImportError:" fullword ascii
      $s8 = "    sys.exit(load_entry_point('certbot==2.11.0', 'console_scripts', 'certbot')())" fullword ascii
      $s9 = "__requires__ = 'certbot==2.11.0'" fullword ascii
      $s10 = "        from importlib_metadata import distribution" fullword ascii
      $s11 = "    from importlib.metadata import distribution" fullword ascii
      $s12 = "        from pkg_resources import load_entry_point" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 70 79 74 68 6f 6e 33 0a 23 20 45 41 53 59 2d 49 4e 53 54 41 4c 4c 2d 45 4e 54 52 59 2d 53 43 52 49 50 54 3a 20 27 63 65 72 74 62 6f 74 3d 3d 32 2e 31 31 2e 30 27 2c 27 63 6f 6e 73 6f 6c 65 5f 73 63 72 69 70 74 73 27 2c 27 63 65 72 74 62 6f 74 27 0a 69 6d 70 6f 72 74 20 72 65 0a 69 6d 70 6f 72 74 20 73 79 73 0a 0a 23 20 66 6f 72 20 63 6f 6d 70 61 74 69 62 69 6c 69 74 79 20 77 69 74 68 20 65 61 73 79 5f 69 6e 73 74 61 6c 6c 3b 20 73 65 65 20 23 32 31 39 38 0a 5f 5f 72 65 71 75 69 72 65 73 5f 5f 20 3d 20 27 63 65 72 74 62 6f 74 3d 3d 32 2e 31 31 2e 30 27 0a 0a 74 72 79 3a 0a 20 20 20 20 66 72 6f 6d 20 69 6d 70 6f 72 74 6c 69 62 2e 6d 65 74 61 64 61 74 61 20 69 6d 70 6f 72 74 20 64 69 73 74 72 69 62 75 74 69 6f 6e 0a 65 78 63 65 70 74 20 49 6d 70 6f 72 74 45 72 72 6f 72 3a 0a 20 20 20 20 74 72 79 3a 0a 20 20 20 20 20 20 20 20 66 72 6f 6d 20 69 6d 70 6f 72 74 6c 69 62 5f 6d 65 74 61 64 61 74 61 20 69 6d 70 6f 72 74 20 64 69 73 74 72 69 62 75 74 69 6f 6e 0a 20 20 20 20 65 78 63 65 70 74 20 49 6d 70 6f 72 74 45 72 72 6f 72 3a 0a 20 20 20 20 20 20 20 20 66 72 6f 6d 20 70 6b 67 5f 72 65 73 6f 75 72 63 65 73 20 69 6d 70 6f 72 74 20 6c 6f 61 64 5f 65 6e 74 72 79 5f 70 6f 69 6e 74 0a 0a 0a 64 65 66 20 69 6d 70 6f 72 74 6c 69 62 5f 6c 6f 61 64 5f 65 6e 74 72 79 5f 70 6f 69 6e 74 28 73 70 65 63 2c 20 67 72 6f 75 70 2c 20 6e 61 6d 65 29 3a 0a 20 20 20 20 64 69 73 74 5f 6e 61 6d 65 2c 20 5f 2c 20 5f 20 3d 20 73 70 65 63 2e 70 61 72 74 69 74 69 6f 6e 28 27 3d 3d 27 29 0a 20 20 20 20 6d 61 74 63 68 65 73 20 3d 20 28 0a 20 20 20 20 20 20 20 20 65 6e 74 72 79 5f 70 6f 69 6e 74 0a 20 20 20 20 20 20 20 20 66 6f 72 20 65 6e 74 72 79 5f 70 6f 69 6e 74 20 69 6e 20 64 69 73 74 72 69 62 75 74 69 6f 6e 28 64 69 73 74 5f 6e 61 6d 65 29 2e 65 6e 74 72 79 5f 70 6f 69 6e 74 73 0a 20 20 20 20 20 20 20 20 69 66 20 65 6e 74 72 79 5f 70 6f 69 6e 74 2e 67 72 6f 75 70 20 3d 3d 20 67 72 6f 75 70 20 61 6e 64 20 65 6e 74 72 79 5f 70 6f 69 6e 74 2e 6e 61 6d 65 20 3d 3d 20 6e 61 6d 65 0a 20 20 20 20 29 0a 20 20 20 20 72 65 74 75 72 6e 20 6e 65 78 74 28 6d 61 74 63 68 65 73 29 2e 6c 6f 61 64 28 29 0a 0a 0a 67 6c 6f 62 61 6c 73 28 29 2e 73 65 74 64 65 66 61 75 6c 74 28 27 6c 6f 61 64 5f 65 6e 74 72 79 5f 70 6f 69 6e 74 27 2c 20 69 6d 70 6f 72 74 6c 69 62 5f 6c 6f 61 64 5f 65 6e 74 72 79 5f 70 6f 69 6e 74 29 0a 0a 0a 69 66 20 5f 5f 6e 61 6d 65 5f 5f 20 3d 3d 20 27 5f 5f 6d 61 69 6e 5f 5f 27 3a 0a 20 20 20 20 73 79 73 2e 61 72 67 76 5b 30 5d 20 3d 20 72 65 2e 73 75 62 28 72 27 28 2d 73 63 72 69 70 74 5c 2e 70 79 77 3f 7c 5c 2e 65 78 65 29 3f 24 27 2c 20 27 27 2c 20 73 79 73 2e 61 72 67 76 5b 30 5d 29 0a 20 20 20 20 73 79 73 2e 65 78 69 74 28 6c 6f 61 64 5f 65 6e 74 72 79 5f 70 6f 69 6e 74 28 27 63 65 72 74 62 6f 74 3d 3d 32 2e 31 31 2e 30 27 2c 20 27 63 6f 6e 73 6f 6c 65 5f 73 63 72 69 70 74 73 27 2c 20 27 63 65 72 74 62 6f 74 27 29 28 29 29 0a}
condition:
      filesize < 2KB and
      8 of them and $magic
}

rule gtfobins_binaries_eb {
   strings:
      $s1 = "exit(_exec_cmd(['/root/.ebcli-virtual-env/bin/eb'] + sys.argv[1:]))" fullword ascii
      $s2 = "def _exec_cmd(args):" fullword ascii
      $s3 = "    Function invokes the real `eb` executable within the EBCLI-specifc" fullword ascii
      $s4 = "activate_this = \"/root/.ebcli-virtual-env/bin/activate_this.py\"" fullword ascii
      $s5 = "    virtualenv. `KeyboardInterrupt`s are in this parent process as showing" fullword ascii
      $s6 = "    p = subprocess.Popen(args)" fullword ascii
      $s7 = "    is prudent to wait for the subprocess to exit normally." fullword ascii
      $s8 = "    Note that any of the stack traces the subprocess (the real `eb` process)" fullword ascii
      $s9 = "    the stacktrace associated with this script has no information for" fullword ascii
      $s10 = "    execfile(activate_this, dict(__file__=activate_this))" fullword ascii
      $s11 = "    exec(open(activate_this).read(), dict(__file__=activate_this))" fullword ascii
      $s12 = "    the return code of the subprocess to remain None. In all such cases, the" fullword ascii
      $s13 = "    except KeyboardInterrupt:" fullword ascii
      $s14 = "    to be completely non-intervening." fullword ascii
      $s15 = "    In the event of a `KeyboardInterrupt`s, it is possible that the child might" fullword ascii
      $s16 = "    the user and is confusing." fullword ascii
      $s17 = "    wrapper will assume a failure and return a non-zero exit code." fullword ascii
      $s18 = "        p.communicate()" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 65 6e 76 20 70 79 74 68 6f 6e 0a 69 6d 70 6f 72 74 20 73 75 62 70 72 6f 63 65 73 73 0a 69 6d 70 6f 72 74 20 73 79 73 0a 0a 0a 64 65 66 20 5f 65 78 65 63 5f 63 6d 64 28 61 72 67 73 29 3a 0a 20 20 20 20 22 22 22 0a 20 20 20 20 46 75 6e 63 74 69 6f 6e 20 69 6e 76 6f 6b 65 73 20 74 68 65 20 72 65 61 6c 20 60 65 62 60 20 65 78 65 63 75 74 61 62 6c 65 20 77 69 74 68 69 6e 20 74 68 65 20 45 42 43 4c 49 2d 73 70 65 63 69 66 63 0a 20 20 20 20 76 69 72 74 75 61 6c 65 6e 76 2e 20 60 4b 65 79 62 6f 61 72 64 49 6e 74 65 72 72 75 70 74 60 73 20 61 72 65 20 69 6e 20 74 68 69 73 20 70 61 72 65 6e 74 20 70 72 6f 63 65 73 73 20 61 73 20 73 68 6f 77 69 6e 67 0a 20 20 20 20 74 68 65 20 73 74 61 63 6b 74 72 61 63 65 20 61 73 73 6f 63 69 61 74 65 64 20 77 69 74 68 20 74 68 69 73 20 73 63 72 69 70 74 20 68 61 73 20 6e 6f 20 69 6e 66 6f 72 6d 61 74 69 6f 6e 20 66 6f 72 0a 20 20 20 20 74 68 65 20 75 73 65 72 20 61 6e 64 20 69 73 20 63 6f 6e 66 75 73 69 6e 67 2e 0a 0a 20 20 20 20 4e 6f 74 65 20 74 68 61 74 20 61 6e 79 20 6f 66 20 74 68 65 20 73 74 61 63 6b 20 74 72 61 63 65 73 20 74 68 65 20 73 75 62 70 72 6f 63 65 73 73 20 28 74 68 65 20 72 65 61 6c 20 60 65 62 60 20 70 72 6f 63 65 73 73 29 0a 20 20 20 20 77 69 73 68 65 73 20 74 6f 20 70 72 69 6e 74 20 77 69 6c 6c 20 62 65 20 70 72 69 6e 74 65 64 20 74 6f 20 53 54 44 4f 55 54 2e 20 41 73 20 73 75 63 68 2c 20 74 68 69 73 20 77 72 61 70 70 65 72 20 73 74 72 69 76 65 73 0a 20 20 20 20 74 6f 20 62 65 20 63 6f 6d 70 6c 65 74 65 6c 79 20 6e 6f 6e 2d 69 6e 74 65 72 76 65 6e 69 6e 67 2e 0a 0a 20 20 20 20 49 6e 20 74 68 65 20 65 76 65 6e 74 20 6f 66 20 61 20 60 4b 65 79 62 6f 61 72 64 49 6e 74 65 72 72 75 70 74 60 73 2c 20 69 74 20 69 73 20 70 6f 73 73 69 62 6c 65 20 74 68 61 74 20 74 68 65 20 63 68 69 6c 64 20 6d 69 67 68 74 0a 20 20 20 20 6e 6f 74 20 68 61 76 65 20 72 65 74 75 72 6e 65 64 20 6c 65 61 76 69 6e 67 20 74 68 65 20 72 65 74 75 72 6e 63 6f 64 65 20 60 4e 6f 6e 65 60 2e 20 49 6e 20 74 68 69 73 20 73 69 74 75 61 74 69 6f 6e 2c 20 69 74 0a 20 20 20 20 69 73 20 70 72 75 64 65 6e 74 20 74 6f 20 77 61 69 74 20 66 6f 72 20 74 68 65 20 73 75 62 70 72 6f 63 65 73 73 20 74 6f 20 65 78 69 74 20 6e 6f 72 6d 61 6c 6c 79 2e 0a 20 20 20 20 0a 20 20 20 20 4f 75 74 73 69 64 65 20 60 4b 79 65 62 6f 61 72 64 49 6e 74 65 72 72 75 70 74 73 60 73 2c 20 69 74 20 69 73 20 75 6e 63 6c 65 61 72 20 77 68 65 74 68 65 72 20 69 74 20 69 73 20 70 6f 73 73 69 62 6c 65 20 66 6f 72 0a 20 20 20 20 74 68 65 20 72 65 74 75 72 6e 20 63 6f 64 65 20 6f 66 20 74 68 65 20 73 75 62 70 72 6f 63 65 73 73 20 74 6f 20 72 65 6d 61 69 6e 20 4e 6f 6e 65 2e 20 49 6e 20 61 6c 6c 20 73 75 63 68 20 63 61 73 65 73 2c 20 74 68 65 0a 20 20 20 20 77 72 61 70 70 65 72 20 77 69 6c 6c 20 61 73 73 75 6d 65 20 61 20 66 61 69 6c 75 72 65 20 61 6e 64 20 72 65 74 75 72 6e 20 61 20 6e 6f 6e 2d 7a 65 72 6f 20 65 78 69 74 20 63 6f 64 65 2e 0a 20 20 20 20 22 22 22 0a 20 20 20 20 70 20 3d 20 73 75 62 70 72 6f 63 65 73 73 2e 50 6f 70 65 6e 28 61 72 67 73 29 0a 20 20 20 20 74 72 79 3a 0a 20 20 20 20 20 20 20 20 70 2e 63 6f 6d}
condition:
      filesize < 4KB and
      8 of them and $magic
}

rule gtfobins_binaries_ascii_xfr {
   strings:
      $s1 = "ASCII download of \"%s\"" fullword ascii
      $s2 = "Usage: ascii-xfr -s|-r [-dvn] [-l linedelay] [-c character delay] filename" fullword ascii
      $s3 = "Error while writing (errno = %d)" fullword ascii
      $s4 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/minicom.debug" fullword ascii
      $s5 = "ASCII upload of \"%s\"" fullword ascii
      $s6 = "Line delay: %d ms, character delay %d ms" fullword ascii
      $s7 = "%.1f Kbytes transferred at %d CPS" fullword ascii
      $s8 = "       -d:  set End Of File character to Control-D (instead of Control-Z)" fullword ascii
      $s9 = "6ee0862927de2c5e356732bf948742b2821a00.debug" fullword ascii
      $s10 = "srdevnl:c:" fullword ascii
      $s11 = "       -n:  do not translate CRLF <--> LF" fullword ascii
      $s12 = "       -v:  verbose (statistics on stderr output)" fullword ascii
      $s13 = "       -e:  send the End Of File character (default is not to)" fullword ascii
      $s14 = "       -r:  receive" fullword ascii
      $s15 = "6ee0862927de2c5e356732bf948742b2821a00" ascii
      $s16 = "6ee0862927de2c5e356732bf948742b2821a" ascii
      $s17 = "       -s:  send" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 14 00 00 00 00 00 00 40 00 00 00 00 00 00 00 70 32 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 38 0c 00 00 00 00 00 00 38 0c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 61 0a 00 00 00 00 00 00 61 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 a0 04 00 00 00 00 00 00 a0 04 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 2d 00 00 00 00 00 00 d0 3d 00 00 00 00 00 00 d0 3d 00 00 00 00 00 00 00 03 00 00 00 00 00 00 80 03 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 2d 00 00 00 00 00 00 e0 3d 00 00 00 00 00 00 e0 3d 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 a0 22 00 00 00 00 00 00 a0 22 00 00 00 00 00 00 a0 22 00 00 00 00 00 00 4c 00 00 00 00 00 00 00 4c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 2d 00 00 00 00 00 00 d0 3d 00 00 00 00 00 00 d0 3d 00 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 63 6e e0 86 29 27 de 2c 5e 35 67 32 bf 94 87 42 b2 82 1a 00 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 1c 00 00 00 01 00 00 00 06 00 00 00 00 05 81 00 00 01 1c 02 1c 00 00 00 1e 00 00 00 1f 00 00 00 28 1d 8c 1c d1 65 ce 6d 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 8d 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 40KB and
      8 of them and $magic
}

rule gtfobins_binaries_dos2unix {
   strings:
      $s1 = "Failed to change the owner and group of temporary output file %s:" fullword ascii
      $s2 = "Failed to change the permissions of temporary output file %s:" fullword ascii
      $s3 = "Failed to write to temporary output file %s:" fullword ascii
      $s4 = " -F, --follow-symlink  follow symbolic links and convert the targets" fullword ascii
      $s5 = "target of file %s not specified in new-file mode" fullword ascii
      $s6 = "Skipping UTF-16 file %s, an UTF-16 conversion error occurred on line %u." fullword ascii
      $s7 = " -S, --skip-symlink    keep symbolic links and targets unchanged (default)" fullword ascii
      $s8 = "Failed to close input file %s:" fullword ascii
      $s9 = "mkstemp64" fullword ascii
      $s10 = "wrong flag '%c' for option -i or --info" fullword ascii
      $s11 = "          which is the target of symbolic link '%s'" fullword ascii
      $s12 = "With support to preserve the user and group ownership of files." fullword ascii
      $s13 = "The user and/or group ownership of file %s is not preserved." fullword ascii
      $s14 = "                         (original target files remain unchanged)" fullword ascii
      $s15 = " -f, --force           force conversion of binary files" fullword ascii
      $s16 = "can not read from input file %s:" fullword ascii
      $s17 = " -R, --replace-symlink replace symbolic links with converted files" fullword ascii
      $s18 = " -v,  --verbose        verbose operation" fullword ascii
      $s19 = " -ul, --assume-utf16le assume that the input format is UTF-16LE" fullword ascii
      $s20 = " -ub, --assume-utf16be assume that the input format is UTF-16BE" fullword ascii
      $s21 = "Binary symbol 0x00%02X found at line %u" fullword ascii
      $s22 = "https://dos2unix.sourceforge.io/" fullword ascii
      $s23 = "Copyright (C) 2009-%d Erwin Waterlander" fullword ascii
      $s24 = "Input file %s has %s BOM." fullword ascii
      $s25 = "error: Invalid surrogate pair. Missing high surrogate." fullword ascii
      $s26 = "error: Invalid surrogate pair. Missing low surrogate." fullword ascii
      $s27 = "problems renaming '%s' to '%s':" fullword ascii
      $s28 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/dos2unix.debug" fullword ascii
      $s29 = "https://waterlan.home.xs4all.nl/dos2unix.html" fullword ascii
      $s30 = "Writing %s BOM." fullword ascii
      $s31 = "Binary symbol 0x%02X found at line %u" fullword ascii
      $s32 = "%s: %s:" fullword ascii
      $s33 = " -iso                  conversion between DOS and ISO-8859-1 character set" fullword ascii
      $s34 = " -s, --safe            skip binary files (default)" fullword ascii
      $s35 = " -V, --version         display version number" fullword ascii
      $s36 = " -c, --convmode        conversion mode" fullword ascii
      $s37 = "   -860                use DOS code page 860 (Portuguese)" fullword ascii
      $s38 = " -ascii                default conversion mode" fullword ascii
      $s39 = "  binary" fullword ascii
      $s40 = "Text %s has been truncated from %d to %d characters in %s to prevent a buffer overflow." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 40 25 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c0 f1 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 10 00 00 00 00 00 00 80 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 f1 67 00 00 00 00 00 00 f1 67 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 d4 2c 00 00 00 00 00 00 d4 2c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 cc 00 00 00 00 00 00 70 cc 00 00 00 00 00 00 70 cc 00 00 00 00 00 00 b4 23 00 00 00 00 00 00 18 24 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 80 cc 00 00 00 00 00 00 80 cc 00 00 00 00 00 00 80 cc 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 e0 ae 00 00 00 00 00 00 e0 ae 00 00 00 00 00 00 e0 ae 00 00 00 00 00 00 b4 01 00 00 00 00 00 00 b4 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 cc 00 00 00 00 00 00 70 cc 00 00 00 00 00 00 70 cc 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 2f f2 b8 35 88 3e 16 9a 1d 14 cf b4 9b 0b 7b 9e 73 69 ae 25 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 2f 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 2f 00 00 00 31 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 51 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_tac {
   strings:
      $s1 = "failed to make temporary file name" fullword ascii
      $s2 = "failed to create temporary file %s" fullword ascii
      $s3 = "failed to open %s for writing" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "/%.*sXXXXXX" fullword ascii
      $s5 = "failed to rewind stream for %s" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "bf2a55eed1b839b2d8eef435b636c4d05b852f.debug" fullword ascii
      $s7 = "  -r, --regex              interpret the separator as a regular expression" fullword ascii
      $s8 = "%s: seek failed" fullword ascii /* Goodware String - occured 2 times */
      $s9 = "%s: write error" fullword ascii /* Goodware String - occured 2 times */
      $s10 = "Write each FILE to standard output, last line first." fullword ascii /* Goodware String - occured 2 times */
      $s11 = "Jay Lepreau" fullword ascii /* Goodware String - occured 2 times */
      $s12 = "  -b, --before             attach the separator before instead of after" fullword ascii
      $s13 = "separator cannot be empty" fullword ascii /* Goodware String - occured 2 times */
      $s14 = "  -s, --separator=STRING   use STRING as the separator instead of newline" fullword ascii
      $s15 = "failed to open %s for reading" fullword ascii /* Goodware String - occured 3 times */
      $s16 = "d$ u>D" fullword ascii
      $s17 = "bf2a55eed1b839b2d8eef435b636c4d05b852f" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 2a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 30 b4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b0 18 00 00 00 00 00 00 b0 18 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 f9 55 00 00 00 00 00 00 f9 55 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 a0 21 00 00 00 00 00 00 a0 21 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 ac 00 00 00 00 00 00 90 bc 00 00 00 00 00 00 90 bc 00 00 00 00 00 00 f0 05 00 00 00 00 00 00 78 29 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ad 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 30 8d 00 00 00 00 00 00 30 8d 00 00 00 00 00 00 30 8d 00 00 00 00 00 00 64 03 00 00 00 00 00 00 64 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 ac 00 00 00 00 00 00 90 bc 00 00 00 00 00 00 90 bc 00 00 00 00 00 00 70 03 00 00 00 00 00 00 70 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 87 bf 2a 55 ee d1 b8 39 b2 d8 ee f4 35 b6 36 c4 d0 5b 85 2f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 42 00 00 00 01 00 00 00 06 00 00 00 04 4d c1 00 20 01 1c 12 42 00 00 00 44 00 00 00 49 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_strings {
   strings:
      $s1 = "  -T --target=<BFDNAME>     Specify the binary file format" fullword ascii
      $s2 = "%s: Reading section %s failed: %s" fullword ascii
      $s3 = "  -U {d|s|i|x|e|h}          Specify how to treat UTF-8 encoded unicode characters" fullword ascii
      $s4 = "bfd_set_default_target" fullword ascii
      $s5 = "bfd_target_list" fullword ascii
      $s6 = "  -a - --all                Scan the entire file, not just the data section [default]" fullword ascii
      $s7 = "  -s --output-separator=<string> String used to separate strings in output." fullword ascii
      $s8 = "  -e --encoding={s,S,b,l,B,L} Select character size and endianness:" fullword ascii
      $s9 = "  -w --include-all-whitespace Include all whitespace as valid string characters" fullword ascii
      $s10 = "<https://sourceware.org/bugzilla/>" fullword ascii
      $s11 = "{\"type\":\"deb\",\"os\":\"debian\",\"name\":\"binutils\",\"version\":\"2.42.90.20240720-2\",\"architecture\":\"amd64\"}" fullword ascii
      $s12 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/binutils-x86-64-linux-gnu.debug" fullword ascii
      $s13 = "  -v -V --version           Print the program's version number" fullword ascii
      $s14 = "%s: error: @-file refers to a directory" fullword ascii
      $s15 = "bfd_get_error" fullword ascii
      $s16 = "bfd_malloc_and_get_section" fullword ascii
      $s17 = "invalid argument to -U/--unicode: %s" fullword ascii
      $s18 = "  -d --data                 Only scan the data sections in the file" fullword ascii
      $s19 = "fatal error: libbfd ABI mismatch" fullword ascii
      $s20 = "libbfd-2.42.90-system.20240720.so" fullword ascii
      $s21 = "Warning: '%s' is a directory" fullword ascii
      $s22 = "bfd_set_error_program_name" fullword ascii
      $s23 = "(GNU Binutils for Debian) 2.42.90.20240720" fullword ascii
      $s24 = " Display printable strings in [file(s)] (stdin by default)" fullword ascii
      $s25 = "minimum string length %s is too big" fullword ascii
      $s26 = "  -h --help                 Display this information" fullword ascii
      $s27 = "  -o                        An alias for --radix=o" fullword ascii
      $s28 = "  -f --print-file-name      Print the name of the file before each string" fullword ascii
      $s29 = "cause of error unknown" fullword ascii
      $s30 = " The options are:" fullword ascii
      $s31 = "bfd_check_format" fullword ascii
      $s32 = "Copyright (C) 2024 Free Software Foundation, Inc." fullword ascii
      $s33 = "ICE: unexpected unicode display type" fullword ascii
      $s34 = "minimum string length is too small: %s" fullword ascii
      $s35 = "adfhHn:wot:e:T:s:U:Vv0123456789" fullword ascii
      $s36 = "ICE: bad arguments to print_unicode_stream" fullword ascii
      $s37 = "ICE: bad arguments to print_unicode_buffer" fullword ascii
      $s38 = "include-all-whitespace" fullword ascii
      $s39 = "  --unicode={default|show|invalid|hex|escape|highlight}" fullword ascii
      $s40 = "output-separator" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 3a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c0 74 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 30 14 00 00 00 00 00 00 30 14 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 99 2a 00 00 00 00 00 00 99 2a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 b8 11 00 00 00 00 00 00 b8 11 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 6d 00 00 00 00 00 00 90 7d 00 00 00 00 00 00 90 7d 00 00 00 00 00 00 b0 05 00 00 00 00 00 00 f0 05 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a0 6d 00 00 00 00 00 00 a0 7d 00 00 00 00 00 00 a0 7d 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 bc 00 00 00 00 00 00 00 bc 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 68 5d 00 00 00 00 00 00 68 5d 00 00 00 00 00 00 68 5d 00 00 00 00 00 00 bc 00 00 00 00 00 00 00 bc 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 6d 00 00 00 00 00 00 90 7d 00 00 00 00 00 00 90 7d 00 00 00 00 00 00 70 02 00 00 00 00 00 00 70 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 3e b9 67 8a 19 06 1c 23 6e 91 89 16 f6 24 90 4d 3b 7f 3b 5d 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 68 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 64 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 62 69 6e 75 74 69 6c 73 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 32 2e 39 30 2e 32 30 32 34 30 37 32 30 2d 32 22 2c 22 61 72 63 68 69 74}
condition:
      filesize < 90KB and
      8 of them and $magic
}

rule gtfobins_binaries_journalctl {
   strings:
      $s1 = "Failed to open a temporary file for %s: %m" fullword ascii
      $s2 = "New keys have been generated for host %s%s%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x." fullword ascii
      $s3 = "Failed to get boot ID%s%s: %m" fullword ascii
      $s4 = "Failed to process inotify events: %m" fullword ascii
      $s5 = "Failed to process journal events: %m" fullword ascii
      $s6 = "     --relinquish-var        Stop logging to disk, log to temporary file system" fullword ascii
      $s7 = "-- Journal begins at %s, ends at %s. --" fullword ascii
      $s8 = "Failed to set file attributes on a temporary file for '%s', ignoring: %m" fullword ascii
      $s9 = "  -k --dmesg                 Show kernel message log from the current boot" fullword ascii
      $s10 = "ask_password_agent_close" fullword ascii
      $s11 = "COREDUMP_USER_UNIT" fullword ascii
      $s12 = "Sealing key file %s exists already. Use --force to recreate." fullword ascii
      $s13 = "Failed to get disk usage: %m" fullword ascii
      $s14 = "Failed to check if /var/log/journal/ is a directory: %m" fullword ascii
      $s15 = "/var/log/journal/ is on root file system, not relinquishing access to /var." fullword ascii
      $s16 = "Failed to parse boot descriptor '%s'" fullword ascii
      $s17 = "Failed to read cursor file %s: %m" fullword ascii
      $s18 = "_KERNEL_DEVICE=%c%u:%u" fullword ascii
      $s19 = "sd_journal_process" fullword ascii
      $s20 = "Failed to add exclude filter for syslog identifiers: %m" fullword ascii
      $s21 = "Failed to get root mount ID, ignoring: %m" fullword ascii
      $s22 = "Failed to add filter for syslog identifiers: %m" fullword ascii
      $s23 = "  -t --identifier=STRING     Show entries with the specified syslog identifier" fullword ascii
      $s24 = "-- Journal begins at %s. --" fullword ascii
      $s25 = "dump-catalog" fullword ascii
      $s26 = "Failed to get device '%s': %m" fullword ascii
      $s27 = "executable_is_script" fullword ascii
      $s28 = "_KERNEL_DEVICE=+%s:%s" fullword ascii
      $s29 = "%s-- Boot %02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x --%s" fullword ascii
      $s30 = "The --follow switch is not supported in conjunction with reading from STDIN." fullword ascii
      $s31 = "Failed to parse --lines='%s'." fullword ascii
      $s32 = "COREDUMP_UNIT" fullword ascii
      $s33 = "Insufficient watch descriptors available. Reverting to -n." fullword ascii
      $s34 = "Failed to find journal entry from the specified boot (%s%+i): %m" fullword ascii
      $s35 = "gethostname_full" fullword ascii
      $s36 = "sd_journal_get_usage" fullword ascii
      $s37 = "An extra path in match filter is currently not supported with --root, --image, or -M/--machine." fullword ascii
      $s38 = "     --dump-catalog          Show entries in the message catalog" fullword ascii
      $s39 = "=> Validated from %s to %s, final %s entries not sealed." fullword ascii
      $s40 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"systemd\",\"version\":\"256.2-1\",\"architecture\":\"amd64\",\"debugInfoUrl\":\"h" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 50 72 00 00 00 00 00 00 40 00 00 00 00 00 00 00 68 43 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 20 00 1f 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 70 4a 00 00 00 00 00 00 70 4a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 85 84 00 00 00 00 00 00 85 84 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 5c 46 00 00 00 00 00 00 5c 46 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 2e 01 00 00 00 00 00 10 3e 01 00 00 00 00 00 10 3e 01 00 00 00 00 00 90 13 00 00 00 00 00 00 f8 14 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 c0 36 01 00 00 00 00 00 c0 46 01 00 00 00 00 00 c0 46 01 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 dc 00 00 00 00 00 00 00 dc 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 dc 1b 01 00 00 00 00 00 dc 1b 01 00 00 00 00 00 dc 1b 01 00 00 00 00 00 2c 01 00 00 00 00 00 00 2c 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 2e 01 00 00 00 00 00 10 3e 01 00 00 00 00 00 10 3e 01 00 00 00 00 00 f0 11 00 00 00 00 00 00 f0 11 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 93 61 4a 03 05 e4 56 54 3e 04 dd b1 c1 46 7b 77 cc 7d 80 ae 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 88 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 73 79 73 74 65 6d 64 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 35 36 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a 22 61 6d 64}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_ln {
   strings:
      $s1 = "Usage: %s [OPTION]... [-T] TARGET LINK_NAME" fullword ascii
      $s2 = "  or:  %s [OPTION]... -t DIRECTORY TARGET..." fullword ascii
      $s3 = "  -t, --target-directory=DIRECTORY  specify the DIRECTORY in which to create" fullword ascii
      $s4 = "  -L, --logical               dereference TARGETs that are symbolic links" fullword ascii
      $s5 = "  -d, -F, --directory         allow the superuser to attempt to hard link" fullword ascii
      $s6 = "  -T, --no-target-directory   treat LINK_NAME as a normal file always" fullword ascii
      $s7 = "  or:  %s [OPTION]... TARGET" fullword ascii
      $s8 = "  or:  %s [OPTION]... TARGET... DIRECTORY" fullword ascii
      $s9 = "The backup suffix is '~', unless set with --suffix or SIMPLE_BACKUP_SUFFIX." fullword ascii
      $s10 = "rpmatch" fullword ascii
      $s11 = "  -S, --suffix=SUFFIX         override the usual backup suffix" fullword ascii
      $s12 = "failed to access %s" fullword ascii
      $s13 = "  -b                          like --backup but does not accept an argument" fullword ascii
      $s14 = "generating relative path" fullword ascii
      $s15 = "renameat2" fullword ascii
      $s16 = "%s%s%s %c> %s" fullword ascii
      $s17 = "                                system restrictions, even for the superuser)" fullword ascii
      $s18 = "backup" fullword ascii /* Goodware String - occured 74 times */
      $s19 = "target %s" fullword ascii /* Goodware String - occured 1 times */
      $s20 = "CuXXXXXX" fullword ascii
      $s21 = "failed to create symbolic link %s" fullword ascii /* Goodware String - occured 1 times */
      $s22 = "When creating hard links, each TARGET must exist.  Symbolic links" fullword ascii /* Goodware String - occured 1 times */
      $s23 = "failed to create hard link %s" fullword ascii /* Goodware String - occured 1 times */
      $s24 = "failed to create symbolic link %s -> %s" fullword ascii /* Goodware String - occured 1 times */
      $s25 = "cannot do --relative without --symbolic" fullword ascii
      $s26 = "can hold arbitrary text; if later resolved, a relative link is" fullword ascii /* Goodware String - occured 1 times */
      $s27 = "bdfinrst:vFLPS:T" fullword ascii
      $s28 = "e896e30b78737952e7f555c266d045e06e1881.debug" fullword ascii
      $s29 = "interpreted in relation to its parent directory." fullword ascii /* Goodware String - occured 1 times */
      $s30 = "failed to create hard link %s => %s" fullword ascii /* Goodware String - occured 1 times */
      $s31 = "Using -s ignores -L and -P.  Otherwise, the last option specified controls" fullword ascii /* Goodware String - occured 1 times */
      $s32 = "By default, each destination (name of new link) should not already exist." fullword ascii /* Goodware String - occured 1 times */
      $s33 = "cannot combine --target-directory and --no-target-directory" fullword ascii /* Goodware String - occured 1 times */
      $s34 = "failed to create hard link to %.0s%s" fullword ascii /* Goodware String - occured 1 times */
      $s35 = "behavior when a TARGET is a symbolic link, defaulting to %s." fullword ascii /* Goodware String - occured 1 times */
      $s36 = "  none, off       never make backups (even if --backup is given)" fullword ascii
      $s37 = "In the 3rd and 4th forms, create links to each TARGET in DIRECTORY." fullword ascii /* Goodware String - occured 2 times */
      $s38 = "  -f, --force                 remove existing destination files" fullword ascii
      $s39 = "  -i, --interactive           prompt whether to remove destinations" fullword ascii
      $s40 = "  -s, --symbolic              make symbolic links instead of hard links" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 2c 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 14 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 1e 00 00 00 00 00 00 40 1e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 79 94 00 00 00 00 00 00 79 94 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 00 c0 00 00 00 00 00 00 98 3e 00 00 00 00 00 00 98 3e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 0a 01 00 00 00 00 00 f0 0a 01 00 00 00 00 00 f0 0a 01 00 00 00 00 00 18 08 00 00 00 00 00 00 18 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 0d 01 00 00 00 00 00 d8 0d 01 00 00 00 00 00 d8 0d 01 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 90 da 00 00 00 00 00 00 90 da 00 00 00 00 00 00 90 da 00 00 00 00 00 00 e4 05 00 00 00 00 00 00 e4 05 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 0a 01 00 00 00 00 00 f0 0a 01 00 00 00 00 00 f0 0a 01 00 00 00 00 00 10 05 00 00 00 00 00 00 10 05 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 3c e8 96 e3 0b 78 73 79 52 e7 f5 55 c2 66 d0 45 e0 6e 18 81 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 51 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 51 00 00 00 53 00 00 00 59 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_xpad {
   strings:
      $s1 = "** BinReloc (%s): assertion %s failed" fullword ascii
      $s2 = "There is a problem in the program Xpad. In function 'xpad_pad_save_content' the variable 'pad->priv->textview' is not of type te" ascii
      $s3 = "IceProcessMessages" fullword ascii
      $s4 = "Whether to wait for the systray after login" fullword ascii
      $s5 = "Start Xpad after login" fullword ascii
      $s6 = "xpad-user-help.txt" fullword ascii
      $s7 = "Arthur Borsboom <arthurborsboom@gmail.com>" fullword ascii
      $s8 = "Sachin Raut <great.sachin@gmail.com>" fullword ascii
      $s9 = "Error casting argument length. Arguments might not be processed correctly." fullword ascii
      $s10 = "ive number. Please send a bugreport to https://bugs.launchpad.net/xpad/+filebug to help improve Xpad." fullword ascii
      $s11 = "xtview. Please send a bugreport to https://bugs.launchpad.net/xpad/+filebug to help improve Xpad." fullword ascii
      $s12 = "Please send a bugreport to https://bugs.launchpad.net/xpad/+filebug to help improve Xpad." fullword ascii
      $s13 = "There is a problem in the program Xpad. In function 'xpad_pad_show_toolbar' the variable 'req.height' is not a positive number. " ascii
      $s14 = "SmcGetIceConnection" fullword ascii
      $s15 = "_Start Xpad automatically after login" fullword ascii
      $s16 = "Clear Pad Contents" fullword ascii
      $s17 = "Could not read file %s." fullword ascii
      $s18 = "https://launchpad.net/xpad" fullword ascii
      $s19 = "%s:%d: invalid %s id %u for \"%s\" of type '%s' in '%s'" fullword ascii
      $s20 = "Could not write to file %s: %s" fullword ascii
      $s21 = "gtk_widget_set_halign" fullword ascii
      $s22 = "gtk_widget_get_style_context" fullword ascii
      $s23 = "gtk_widget_set_valign" fullword ascii
      $s24 = "gtk_widget_get_preferred_size" fullword ascii
      $s25 = "gtk_widget_set_margin_top" fullword ascii
      $s26 = "gtk_widget_set_margin_bottom" fullword ascii
      $s27 = "gtk_style_context_get_color" fullword ascii
      $s28 = "gtk_widget_set_margin_end" fullword ascii
      $s29 = "gtk_style_context_get" fullword ascii
      $s30 = "gtk_widget_set_margin_start" fullword ascii
      $s31 = "content-" fullword ascii
      $s32 = "gdk_x11_display_get_type" fullword ascii
      $s33 = "gtk_source_search_context_get_settings" fullword ascii
      $s34 = "gtk_font_chooser_get_font" fullword ascii
      $s35 = "gdk_rgba_get_type" fullword ascii
      $s36 = "Bad type to fio_get_values_from_file: %c" fullword ascii
      $s37 = "save-content" fullword ascii
      $s38 = "reload-pad-content" fullword ascii
      $s39 = "gtk_source_buffer_get_type" fullword ascii
      $s40 = "get_background_color" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 b3 00 00 00 00 00 00 40 00 00 00 00 00 00 00 88 83 02 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c0 8e 00 00 00 00 00 00 c0 8e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 19 51 01 00 00 00 00 00 19 51 01 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 18 74 00 00 00 00 00 00 18 74 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 6c 02 00 00 00 00 00 b0 7c 02 00 00 00 00 00 b0 7c 02 00 00 00 00 00 8c 15 00 00 00 00 00 00 e0 19 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 f0 6e 02 00 00 00 00 00 f0 7e 02 00 00 00 00 00 f0 7e 02 00 00 00 00 00 90 02 00 00 00 00 00 00 90 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 4c 1d 02 00 00 00 00 00 4c 1d 02 00 00 00 00 00 4c 1d 02 00 00 00 00 00 1c 0a 00 00 00 00 00 00 1c 0a 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 6c 02 00 00 00 00 00 b0 7c 02 00 00 00 00 00 b0 7c 02 00 00 00 00 00 50 13 00 00 00 00 00 00 50 13 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 07 47 d3 56 ab 2f 22 45 9a 13 bb ae 03 1a 48 1f 08 40 f6 8b 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 c6 01 00 00 01 00 00 00 06 00 00 00 88 49 a1 01 0c 41 92 0a c6 01 00 00 cb 01 00 00 ce 01 00 00 d0 65 ce 6d ba e3 92 7c e8 82 84 28 28 1d 8c 1c 43 45 d5 ec d8 71 58 1c 38 f2 8b 1c 4f fc d3 24 f6 e8 ec 58 a3 3b 47 f1 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 500KB and
      8 of them and $magic
}

rule gtfobins_binaries_xmodmap {
   strings:
      $s1 = "keysym target key symbol '%s'" fullword ascii
      $s2 = "keysym target keysym '%s', no corresponding keycodes" fullword ascii
      $s3 = "target keysym name" fullword ascii
      $s4 = "! dump of work queue" fullword ascii
      $s5 = "%s:  unable to get keyboard mapping table." fullword ascii
      $s6 = "%s:  unknown command on line %s:%d" fullword ascii
      $s7 = "    -e expression                execute string" fullword ascii
      $s8 = "    -n                           don't execute changes, just show like make" fullword ascii
      $s9 = "keycode command (missing keysym list)," fullword ascii
      $s10 = "attempt to grow keysym list to %ld bytes" fullword ascii
      $s11 = "%s:  up to %d keys per modifier, (keycodes in parentheses):" fullword ascii
      $s12 = "%s:  %d error%s encountered, aborting." fullword ascii
      $s13 = "%s:  unable to open file '%s' for reading" fullword ascii
      $s14 = "%s:  please release the following keys within %d seconds:" fullword ascii
      $s15 = "! executing work queue" fullword ascii
      $s16 = "! Keysym %s (0x%lx) corresponds to keycode(s)" fullword ascii
      $s17 = "There are %d KeySyms per KeyCode; KeyCodes range from %d to %d." fullword ascii
      $s18 = "keysym name '%s' in keysym list" fullword ascii
      $s19 = "attempt to allocate %ld byte keycode list" fullword ascii
      $s20 = "keysym in remove modifier list '%s', no corresponding keycodes" fullword ascii
      $s21 = "attempt to allocate %ld byte keycode set" fullword ascii
      $s22 = "attempt to allocate %ld byte initial keysymlist" fullword ascii
      $s23 = "attempt to allocate a %ld byte keycode opcode" fullword ascii
      $s24 = "attempt to allocate %d byte scratch buffer" fullword ascii
      $s25 = "    -                            read standard input" fullword ascii
      $s26 = "%s:  bad return %d from XSetPointerMapping" fullword ascii
      $s27 = "BADKEYSYM" fullword ascii
      $s28 = "%s:  bad return %d from XSetModifierMapping" fullword ascii
      $s29 = "%s: no available keycode for assignment" fullword ascii
      $s30 = "%s:  please release the following buttons within %d seconds:" fullword ascii
      $s31 = "%s:  unable to set modifier mapping, keyboard problem" fullword ascii
      $s32 = "%s: %s requires an argument" fullword ascii
      $s33 = "%s:  unable to open display '%s'" fullword ascii
      $s34 = "keysym input line" fullword ascii
      $s35 = "XGetPointerMapping" fullword ascii
      $s36 = "keysym name list" fullword ascii
      $s37 = "keycode input line" fullword ascii
      $s38 = "keycode value" fullword ascii
      $s39 = "    -verbose, -quiet             turn logging on or off" fullword ascii
      $s40 = "    -display host:dpy            X server to use" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 2a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c0 a4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f0 15 00 00 00 00 00 00 f0 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 bd 44 00 00 00 00 00 00 bd 44 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 70 22 00 00 00 00 00 00 70 22 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 c0 9d 00 00 00 00 00 00 c0 ad 00 00 00 00 00 00 c0 ad 00 00 00 00 00 00 50 05 00 00 00 00 00 00 f0 05 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d0 9d 00 00 00 00 00 00 d0 ad 00 00 00 00 00 00 d0 ad 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 8c 86 00 00 00 00 00 00 8c 86 00 00 00 00 00 00 8c 86 00 00 00 00 00 00 74 01 00 00 00 00 00 00 74 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 c0 9d 00 00 00 00 00 00 c0 ad 00 00 00 00 00 00 c0 ad 00 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 92 9f a5 23 a8 5f c3 1e b1 21 e1 73 7e a4 a8 01 15 4c a2 27 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 37 00 00 00 01 00 00 00 06 00 00 00 88 41 a1 01 80 01 10 0a 37 00 00 00 3b 00 00 00 00 00 00 00 28 1d 8c 1c 42 45 d5 ec ba e3 92 7c d1 65 ce 6d 66 55 61 10 d8 71 58 1c 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ff 01 00 00 12 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_cpulimit {
   strings:
      $s1 = "Error: You must specify a target process" fullword ascii
      $s2 = "      -f  --foreground   launch target process in foreground and wait for it to exit" fullword ascii
      $s3 = "Error: You must specify exactly one target process" fullword ascii
      $s4 = "      -z, --lazy         exit if there is no suitable target process," fullword ascii
      $s5 = "      -m, --monitor-forks  Watch children/forks of the target process" fullword ascii
      $s6 = "Usage: %s TARGET [OPTIONS...] [-- PROGRAM]" fullword ascii
      $s7 = "Error: Process %d detected, but you don't have permission to control it" fullword ascii
      $s8 = "Warning: no target process found. Waiting for it..." fullword ascii
      $s9 = "Process %d dead!" fullword ascii
      $s10 = "Failed to launch specified process." fullword ascii
      $s11 = "Failed to restore killed process." fullword ascii
      $s12 = "Process %d detected" fullword ascii
      $s13 = "No process found" fullword ascii
      $s14 = "Throttling process %ld" fullword ascii
      $s15 = "Child process %ld done, cleaning up." fullword ascii
      $s16 = "      -r, --restore      Restore processes after they have" fullword ascii
      $s17 = "      -s, --signal=SIG   Send this signal to the watched process when cpulimit exits." fullword ascii
      $s18 = "      -p, --pid=N        pid of the process" fullword ascii
      $s19 = "      -k, --kill         kill processes going over their limit" fullword ascii
      $s20 = "      -c  --cpu=N        override the detection of CPUs on the machine." fullword ascii
      $s21 = "      -e, --exe=FILE     name of the executable program file" fullword ascii
      $s22 = "Caught child process: %ld" fullword ascii
      $s23 = "      -b  --background   run in background" fullword ascii
      $s24 = "Creating fork monitoring thread failed." fullword ascii
      $s25 = "Child process is finished, exiting..." fullword ascii
      $s26 = "Error: limit must be in the range of 1 to %d00" fullword ascii
      $s27 = "                         executable program file" fullword ascii
      $s28 = "   TARGET must be exactly one of these:" fullword ascii
      $s29 = "      -q, --quiet        run in quiet mode (only print errors)." fullword ascii
      $s30 = "/proc/%d/stat" fullword ascii
      $s31 = "/proc/%d/exe" fullword ascii
      $s32 = "/proc/%s/status" fullword ascii
      $s33 = "CPUlimit version %1.1f" fullword ascii
      $s34 = "                         been killed. Works with the -k flag." fullword ascii
      $s35 = "                         The -e option only works when" fullword ascii
      $s36 = "Error: You must specify a cpu limit" fullword ascii
      $s37 = "          --             This is the final CPUlimit option. All following" fullword ascii
      $s38 = "                         Usually 1 - %d00, but can be higher" fullword ascii
      $s39 = "work quantum" fullword ascii
      $s40 = "sleep quantum" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 2f 00 00 00 00 00 00 40 00 00 00 00 00 00 00 78 73 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 90 12 00 00 00 00 00 00 90 12 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 79 22 00 00 00 00 00 00 79 22 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 80 13 00 00 00 00 00 00 80 13 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 78 6c 00 00 00 00 00 00 78 7c 00 00 00 00 00 00 78 7c 00 00 00 00 00 00 c0 05 00 00 00 00 00 00 e0 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 88 6c 00 00 00 00 00 00 88 7c 00 00 00 00 00 00 88 7c 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 40 5e 00 00 00 00 00 00 40 5e 00 00 00 00 00 00 40 5e 00 00 00 00 00 00 d4 00 00 00 00 00 00 00 d4 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 78 6c 00 00 00 00 00 00 78 7c 00 00 00 00 00 00 78 7c 00 00 00 00 00 00 88 03 00 00 00 00 00 00 88 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 ec 70 2e b1 74 f3 98 b9 b9 b6 36 ca 3c ad f9 88 69 e3 05 2f 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 2e 00 00 00 01 00 00 00 06 00 00 00 02 85 81 00 00 01 14 02 2e 00 00 00 30 00 00 00 32 00 00 00 28 1d 8c 1c d1 65 ce 6d c0 b3 f7 12 39 f2 8b 1c b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 92 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 90KB and
      8 of them and $magic
}

rule gtfobins_binaries_setfacl {
   strings:
      $s1 = "%s %s -- set file access control lists" fullword ascii
      $s2 = "%s: Option -%c incomplete" fullword ascii
      $s3 = "%s: Option -%c: %s near character %d" fullword ascii
      $s4 = "  -X, --remove-file=file  read ACL entries to remove from file" fullword ascii
      $s5 = "  -M, --modify-file=file  read ACL entries to modify from file" fullword ascii
      $s6 = "%s: %s: %s in line %d" fullword ascii
      $s7 = "%s: No filename found in line %d of standard input, aborting" fullword ascii
      $s8 = "%s: %s: No filename found in line %d, aborting" fullword ascii
      $s9 = "%s: %s in line %d of standard input" fullword ascii
      $s10 = "%s: %s: Malformed default ACL `%s': %s at entry %d" fullword ascii
      $s11 = "%s: %s in line %d of file %s" fullword ascii
      $s12 = "%s: %s: Malformed access ACL `%s': %s at entry %d" fullword ascii
      $s13 = "acl_get_qualifier" fullword ascii
      $s14 = "acl_get_permset" fullword ascii
      $s15 = "  -d, --default           operations apply to the default ACL" fullword ascii
      $s16 = "      --restore=file      restore ACLs (inverse of `getfacl -R')" fullword ascii
      $s17 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/acl.debug" fullword ascii
      $s18 = "%s: %s,%s" fullword ascii
      $s19 = "%s: Standard input: %s" fullword ascii
      $s20 = "acl_get_file" fullword ascii
      $s21 = "      --set-file=file     read ACL entries to set from file" fullword ascii
      $s22 = "acl_get_entry" fullword ascii
      $s23 = "acl_get_perm" fullword ascii
      $s24 = "  -v, --version           print version and exit" fullword ascii
      $s25 = "acl_get_tag_type" fullword ascii
      $s26 = "%s: %s: Only directories can have default ACLs" fullword ascii
      $s27 = "%s: %s: Cannot change owner/group: %s" fullword ascii
      $s28 = "%s: %s: Cannot change mode: %s" fullword ascii
      $s29 = "modify" fullword ascii /* Goodware String - occured 43 times */
      $s30 = "libacl.so.1" fullword ascii
      $s31 = "acl_copy_entry" fullword ascii
      $s32 = "remove-all" fullword ascii
      $s33 = "-:bkndvhm:M:x:X:RLP" fullword ascii
      $s34 = "d7fe5a1ed3334318460b9869b8891c949194c3.debug" fullword ascii
      $s35 = "acl_set_qualifier" fullword ascii
      $s36 = "acl_delete_def_file" fullword ascii
      $s37 = "acl_from_mode" fullword ascii
      $s38 = "acl_delete_perm" fullword ascii
      $s39 = "  -L, --logical           logical walk, follow symbolic links" fullword ascii
      $s40 = "-:bkndvhm:M:x:X:" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 2d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 91 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e8 19 00 00 00 00 00 00 e8 19 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 55 43 00 00 00 00 00 00 55 43 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 e8 14 00 00 00 00 00 00 e8 14 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 89 00 00 00 00 00 00 10 99 00 00 00 00 00 00 10 99 00 00 00 00 00 00 04 07 00 00 00 00 00 00 b0 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 80 8b 00 00 00 00 00 00 80 9b 00 00 00 00 00 00 80 9b 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 dc 7a 00 00 00 00 00 00 dc 7a 00 00 00 00 00 00 dc 7a 00 00 00 00 00 00 44 01 00 00 00 00 00 00 44 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 89 00 00 00 00 00 00 10 99 00 00 00 00 00 00 10 99 00 00 00 00 00 00 f0 06 00 00 00 00 00 00 f0 06 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 f8 d7 fe 5a 1e d3 33 43 18 46 0b 98 69 b8 89 1c 94 91 94 c3 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 4b 00 00 00 01 00 00 00 06 00 00 00 00 05 a1 00 80 01 1c 02 4b 00 00 00 4d 00 00 00 4f 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 77 00 00 00 12 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_msgcat {
   strings:
      $s1 = "https://savannah.gnu.org/projects/gettext" fullword ascii
      $s2 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/gettext.debug" fullword ascii
      $s3 = "bug-gettext@gnu.org" fullword ascii
      $s4 = "Report bugs in the bug tracker at <%s>" fullword ascii
      $s5 = "License GPLv3+: GNU GPL version 3 or later <%s>" fullword ascii
      $s6 = "libgettextlib-0.22.5.so" fullword ascii
      $s7 = "libgettextsrc-0.22.5.so" fullword ascii
      $s8 = "      --lang=CATALOGNAME      set 'Language' field in the header entry" fullword ascii
      $s9 = "  -f, --files-from=FILE       get list of input files from FILE" fullword ascii
      $s10 = "or by email to <%s>." fullword ascii
      $s11 = "handle_filepos_comment_option" fullword ascii
      $s12 = "last_component" fullword ascii
      $s13 = "  -V, --version               output version information and exit" fullword ascii
      $s14 = "error_message_count" fullword ascii /* Goodware String - occured 1 times */
      $s15 = "Concatenates and merges the specified PO files." fullword ascii /* Goodware String - occured 1 times */
      $s16 = "that if --use-first is specified, they will be taken from the first PO file" fullword ascii /* Goodware String - occured 1 times */
      $s17 = "f68d4929ea35d665ad73f57c209d081e4484fd.debug" fullword ascii
      $s18 = "error_print_progname" fullword ascii /* Goodware String - occured 1 times */
      $s19 = "comments, extracted comments, and file positions will be cumulated, except" fullword ascii /* Goodware String - occured 1 times */
      $s20 = "to define them." fullword ascii /* Goodware String - occured 1 times */
      $s21 = "message_print_style_filepos" fullword ascii
      $s22 = "libtextstyle.so.0" fullword ascii
      $s23 = "      --use-first             use first available translation for each" fullword ascii
      $s24 = "      --force-po              write PO file even if empty" fullword ascii
      $s25 = "Find messages which are common to two or more of the specified PO files." fullword ascii /* Goodware String - occured 2 times */
      $s26 = "      --strict                write out strict Uniforum conforming .po file" fullword ascii
      $s27 = "  -o, --output-file=FILE      write output to specified file" fullword ascii
      $s28 = "impossible selection criteria specified (%d < n < %d)" fullword ascii /* Goodware String - occured 2 times */
      $s29 = "      --color                 use colors and other text attributes always" fullword ascii
      $s30 = "  -P, --properties-input      input files are in Java .properties syntax" fullword ascii
      $s31 = "  -D, --directory=DIRECTORY   add DIRECTORY to list for input files search" fullword ascii
      $s32 = "used to specify less commonality before messages are printed (i.e." fullword ascii /* Goodware String - occured 2 times */
      $s33 = "      --stringtable-output    write out a NeXTstep/GNUstep .strings file" fullword ascii
      $s34 = "By using the --more-than option, greater commonality may be requested" fullword ascii /* Goodware String - occured 2 times */
      $s35 = "more-than" fullword ascii /* Goodware String - occured 2 times */
      $s36 = "print_color_test" fullword ascii /* Goodware String - occured 2 times */
      $s37 = "--less-than=2 will only print the unique messages).  Translations," fullword ascii /* Goodware String - occured 2 times */
      $s38 = "      --stringtable-input     input files are in NeXTstep/GNUstep .strings" fullword ascii
      $s39 = "<:>:D:eEf:Fhino:pPst:uVw:" fullword ascii /* Goodware String - occured 2 times */
      $s40 = "  -u, --unique                shorthand for --less-than=2, requests" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 00 28 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 51 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 17 00 00 00 00 00 00 80 17 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 39 0f 00 00 00 00 00 00 39 0f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 10 15 00 00 00 00 00 00 10 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 48 00 00 00 00 00 00 30 58 00 00 00 00 00 00 30 58 00 00 00 00 00 00 e0 07 00 00 00 00 00 00 70 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 78 4c 00 00 00 00 00 00 78 5c 00 00 00 00 00 00 78 5c 00 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 dc 43 00 00 00 00 00 00 dc 43 00 00 00 00 00 00 dc 43 00 00 00 00 00 00 3c 00 00 00 00 00 00 00 3c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 48 00 00 00 00 00 00 30 58 00 00 00 00 00 00 30 58 00 00 00 00 00 00 d0 07 00 00 00 00 00 00 d0 07 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 ed f6 8d 49 29 ea 35 d6 65 ad 73 f5 7c 20 9d 08 1e 44 84 fd 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 2a 00 00 00 02 00 00 00 07 00 00 00 e0 07 00 2d 10 00 9d 1a 14 18 01 00 10 00 18 1a 2a 00 00 00 00 00 00 00 2b 00 00 00 2d 00 00 00 00 00 00 00 2e 00 00 00 00 00 00 00 2f 00 00 00 00 00 00 00 31 00 00 00 33 00 00 00 00 00 00 00 34 00 00 00 35 00 00 00 37 00 00 00 38 00 00 00}
condition:
      filesize < 70KB and
      8 of them and $magic
}

rule gtfobins_binaries_msguniq {
   strings:
      $s1 = "https://savannah.gnu.org/projects/gettext" fullword ascii
      $s2 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/gettext.debug" fullword ascii
      $s3 = "bug-gettext@gnu.org" fullword ascii
      $s4 = "Report bugs in the bug tracker at <%s>" fullword ascii
      $s5 = "License GPLv3+: GNU GPL version 3 or later <%s>" fullword ascii
      $s6 = "libgettextlib-0.22.5.so" fullword ascii
      $s7 = "libgettextsrc-0.22.5.so" fullword ascii
      $s8 = "or by email to <%s>." fullword ascii
      $s9 = "handle_filepos_comment_option" fullword ascii
      $s10 = "last_component" fullword ascii
      $s11 = "  -V, --version               output version information and exit" fullword ascii
      $s12 = "error_message_count" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "error_print_progname" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "message_print_style_filepos" fullword ascii
      $s15 = "libtextstyle.so.0" fullword ascii
      $s16 = "Unifies duplicate translations in a translation catalog." fullword ascii /* Goodware String - occured 1 times */
      $s17 = "and extracted comments will be cumulated, except that if --use-first is" fullword ascii /* Goodware String - occured 1 times */
      $s18 = "specified, they will be taken from the first translation.  File positions" fullword ascii /* Goodware String - occured 1 times */
      $s19 = "33a684fb9f9911c8788a01d1903c462787b1d1.debug" fullword ascii
      $s20 = "invalid input for other programs like msgfmt, msgmerge or msgcat.  By" fullword ascii /* Goodware String - occured 1 times */
      $s21 = "Finds duplicate translations of the same message ID.  Such duplicates are" fullword ascii /* Goodware String - occured 1 times */
      $s22 = "will be cumulated.  When using the --unique option, duplicates are discarded." fullword ascii /* Goodware String - occured 1 times */
      $s23 = "default, duplicates are merged together.  When using the --repeated option," fullword ascii /* Goodware String - occured 1 times */
      $s24 = "only duplicates are output, and all other messages are discarded.  Comments" fullword ascii /* Goodware String - occured 1 times */
      $s25 = "dD:eEFhino:pPst:uVw:" fullword ascii /* Goodware String - occured 1 times */
      $s26 = "      --use-first             use first available translation for each" fullword ascii
      $s27 = "      --force-po              write PO file even if empty" fullword ascii
      $s28 = "      --strict                write out strict Uniforum conforming .po file" fullword ascii
      $s29 = "  -o, --output-file=FILE      write output to specified file" fullword ascii
      $s30 = "      --color                 use colors and other text attributes always" fullword ascii
      $s31 = "  -D, --directory=DIRECTORY   add DIRECTORY to list for input files search" fullword ascii
      $s32 = "      --stringtable-output    write out a NeXTstep/GNUstep .strings file" fullword ascii
      $s33 = "  -s, --sort-output           generate sorted output" fullword ascii
      $s34 = "  -i, --indent                write the .po file using indented style" fullword ascii
      $s35 = "      --no-wrap               do not break long message lines, longer than" fullword ascii
      $s36 = "      --style=STYLEFILE       specify CSS style rule file for --color" fullword ascii
      $s37 = "  -p, --properties-output     write out a Java .properties file" fullword ascii
      $s38 = "use-first" fullword ascii /* Goodware String - occured 2 times */
      $s39 = "  -t, --to-code=NAME          encoding for output" fullword ascii
      $s40 = "  -w, --width=NUMBER          set output page width" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 e0 26 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 51 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a0 16 00 00 00 00 00 00 a0 16 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 a9 0d 00 00 00 00 00 00 a9 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 08 13 00 00 00 00 00 00 08 13 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 48 00 00 00 00 00 00 90 58 00 00 00 00 00 00 90 58 00 00 00 00 00 00 80 07 00 00 00 00 00 00 18 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 78 4c 00 00 00 00 00 00 78 5c 00 00 00 00 00 00 78 5c 00 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d0 41 00 00 00 00 00 00 d0 41 00 00 00 00 00 00 d0 41 00 00 00 00 00 00 3c 00 00 00 00 00 00 00 3c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 48 00 00 00 00 00 00 90 58 00 00 00 00 00 00 90 58 00 00 00 00 00 00 70 07 00 00 00 00 00 00 70 07 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 21 33 a6 84 fb 9f 99 11 c8 78 8a 01 d1 90 3c 46 27 87 b1 d1 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 27 00 00 00 02 00 00 00 07 00 00 00 e0 07 22 2d 10 00 9d 1a 14 18 01 00 10 00 18 1a 27 00 00 00 00 00 00 00 28 00 00 00 2a 00 00 00 00 00 00 00 2b 00 00 00 00 00 00 00 2c 00 00 00 00 00 00 00 2e 00 00 00 30 00 00 00 00 00 00 00 31 00 00 00 32 00 00 00 34 00 00 00 35 00 00 00}
condition:
      filesize < 70KB and
      8 of them and $magic
}

rule gtfobins_binaries_socket {
   strings:
      $s1 = "Usage: %s [-bclqrvw] [-B local ip] [-p prog] {{-s|host} port | [-s] /path}" fullword ascii
      $s2 = "exec /bin/sh" fullword ascii
      $s3 = "inet: connected to %s port %d" fullword ascii
      $s4 = "Broken pipe condition" fullword ascii
      $s5 = "%s: error writing to %s" fullword ascii
      $s6 = "%s: unknown service" fullword ascii
      $s7 = "end of input on stdin" fullword ascii
      $s8 = "power failure imminent signal" fullword ascii
      $s9 = "User signal 1" fullword ascii
      $s10 = "inet: listening on port %d" fullword ascii
      $s11 = "unix: connection from %s" fullword ascii
      $s12 = "I/O ready signal" fullword ascii
      $s13 = "User signal 2" fullword ascii
      $s14 = "inet: connection from %s" fullword ascii
      $s15 = "It does not make sense to set %s and %s." fullword ascii
      $s16 = "client socket" fullword ascii
      $s17 = "server socket" fullword ascii
      $s18 = "not -s" fullword ascii
      $s19 = "connection closed by peer" fullword ascii /* Goodware String - occured 1 times */
      $s20 = "%s occured, exiting" fullword ascii
      $s21 = "Continue signal" fullword ascii
      $s22 = "Socket-1.1 (Wed Sep  9 19:11:19 1992 by nickel@cs.tu-berlin.de)" fullword ascii
      $s23 = "Urgent IO condition" fullword ascii
      $s24 = "Alarm clock signal" fullword ascii
      $s25 = "Termination signal" fullword ascii
      $s26 = "ABORT instruction" fullword ascii
      $s27 = "CPU limit exceeded" fullword ascii
      $s28 = "Hangup signal" fullword ascii
      $s29 = "unix: connected to %s" fullword ascii
      $s30 = "Stop (tty input) signal" fullword ascii
      $s31 = "Child signal" fullword ascii
      $s32 = "File limit exceeded" fullword ascii
      $s33 = "B:bcflp:qrsvWw?" fullword ascii
      $s34 = "%s: unknown host %s" fullword ascii /* Goodware String - occured 1 times */
      $s35 = "Kill signal" fullword ascii
      $s36 = "Unknown Signal #%d" fullword ascii
      $s37 = "Stop signal" fullword ascii
      $s38 = "Window change" fullword ascii
      $s39 = "Bogus signal" fullword ascii
      $s40 = "Quit signal" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 c0 26 00 00 00 00 00 00 40 00 00 00 00 00 00 00 30 53 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 88 10 00 00 00 00 00 00 88 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 a5 19 00 00 00 00 00 00 a5 19 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 c4 0a 00 00 00 00 00 00 c4 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 4d 00 00 00 00 00 00 d0 5d 00 00 00 00 00 00 d0 5d 00 00 00 00 00 00 5c 04 00 00 00 00 00 00 f8 06 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 4d 00 00 00 00 00 00 e0 5d 00 00 00 00 00 00 e0 5d 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 0c 45 00 00 00 00 00 00 0c 45 00 00 00 00 00 00 0c 45 00 00 00 00 00 00 e4 00 00 00 00 00 00 00 e4 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 4d 00 00 00 00 00 00 d0 5d 00 00 00 00 00 00 d0 5d 00 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 c8 cc 35 a9 4e 48 06 13 e8 ce da 48 f3 95 8f c2 99 a3 7b c4 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 32 00 00 00 01 00 00 00 06 00 00 00 00 01 81 00 00 00 08 02 32 00 00 00 33 00 00 00 34 00 00 00 d1 65 ce 6d 39 f2 8b 1c 33 c4 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c7 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 70KB and
      8 of them and $magic
}

rule gtfobins_binaries_apt_get {
   strings:
      $s1 = "_Z10DoDownloadR11CommandLine" fullword ascii
      $s2 = "indextargets" fullword ascii
      $s3 = "_Z11DoChangelogR11CommandLine" fullword ascii
      $s4 = "_ZNK11IndexTarget6OptionB5cxx11ENS_10OptionKeysE" fullword ascii
      $s5 = "Usage: apt-get [options] command" fullword ascii
      $s6 = "_Z16ParseCommandLineR11CommandLine7APT_CMDPKP13ConfigurationPP9pkgSystemiPPKcPFbS0_EPFSt6vectorI19aptDispatchWithHelpSaISF_EEvE" fullword ascii
      $s7 = "Download and display the changelog for the given package" fullword ascii
      $s8 = "APT::Get::IndexTargets::ReleaseInfo" fullword ascii
      $s9 = "APT::Get::IndexTargets::Format" fullword ascii
      $s10 = "_ZNK11IndexTarget6FormatENSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE" fullword ascii
      $s11 = "changelog" fullword ascii
      $s12 = "Download the binary package into the current directory" fullword ascii
      $s13 = "_Z7DoCleanR11CommandLine" fullword ascii
      $s14 = "_ZN11CommandLineC1Ev" fullword ascii
      $s15 = "_Z11DoDistCleanR11CommandLine" fullword ascii
      $s16 = "_ZN11CommandLineD1Ev" fullword ascii
      $s17 = "_Z8DoUpdateR11CommandLine" fullword ascii
      $s18 = "_Z19CheckIfSimulateModeR11CommandLine" fullword ascii
      $s19 = "_Z8DoSourceR11CommandLine" fullword ascii
      $s20 = "_Z10DoBuildDepR11CommandLine" fullword ascii
      $s21 = "_Z11DoAutoCleanR11CommandLine" fullword ascii
      $s22 = "_Z5DoMooR11CommandLine" fullword ascii
      $s23 = "_Z9DoUpgradeR11CommandLine" fullword ascii
      $s24 = "_Z13DoDistUpgradeR11CommandLine" fullword ascii
      $s25 = "_Z19DispatchCommandLineR11CommandLineRKSt6vectorINS_8DispatchESaIS2_EE" fullword ascii
      $s26 = "_Z9DoInstallR11CommandLine" fullword ascii
      $s27 = "apt-get is a command line interface for retrieval of packages" fullword ascii
      $s28 = "_ZNK11CommandLine8FileSizeEv" fullword ascii
      $s29 = "gIcSt11char_traitsIcESaIcEEERK11CommandLine" fullword ascii
      $s30 = "_Z12_GetErrorObjv" fullword ascii
      $s31 = "Erase old downloaded archive files" fullword ascii
      $s32 = "_ZN19pkgVersioningSystem10GlobalListE" fullword ascii
      $s33 = "Erase downloaded archive files" fullword ascii
      $s34 = "_ZN19pkgVersioningSystem13GlobalListLenE" fullword ascii
      $s35 = "Download source archives" fullword ascii
      $s36 = "COMPRESSIONTYPES" fullword ascii
      $s37 = "KEEPCOMPRESSEDAS" fullword ascii
      $s38 = "Distribution upgrade, see apt-get(8)" fullword ascii
      $s39 = "APT::Get::Print-URIs" fullword ascii
      $s40 = "APT::Get::Simulate" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 10 4b 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 c1 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 48 37 00 00 00 00 00 00 48 37 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 9d 56 00 00 00 00 00 00 9d 56 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 c7 12 00 00 00 00 00 00 c7 12 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 b7 00 00 00 00 00 00 90 c7 00 00 00 00 00 00 90 c7 00 00 00 00 00 00 88 08 00 00 00 00 00 00 c8 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 68 ba 00 00 00 00 00 00 68 ca 00 00 00 00 00 00 68 ca 00 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c8 a8 00 00 00 00 00 00 c8 a8 00 00 00 00 00 00 c8 a8 00 00 00 00 00 00 44 01 00 00 00 00 00 00 44 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 b7 00 00 00 00 00 00 90 c7 00 00 00 00 00 00 90 c7 00 00 00 00 00 00 70 08 00 00 00 00 00 00 70 08 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 8d 42 e1 5a c8 2f 79 41 a7 f4 fd 52 93 de ec 85 3b c0 6c 54 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 11 00 00 00 6c 00 00 00 04 00 00 00 08 00 00 00 4a 11 15 01 22 00 04 00 93 00 62 01 62 6d 09 96 00 09 03 50 00 68 00 04 60 03 71 00 25 00 10 60 6c 00 00 00 6f 00 00 00 70 00 00 00 72 00 00 00 00 00 00 00 74 00 00 00 75 00 00 00 78 00 00 00 00 00 00 00 7d 00 00 00 7e 00 00 00 82 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_openvt {
   strings:
      $s1 = "make the command a login shell." fullword ascii
      $s2 = "Usage: %s [option...] -- command" fullword ascii
      $s3 = "execute the command, without forking." fullword ascii
      $s4 = "vt %d is in use; command aborted; use `%s -f' to force." fullword ascii
      $s5 = "-l, --login" fullword ascii
      $s6 = "Couldn't get a file descriptor referring to the console." fullword ascii
      $s7 = "wait for command to complete" fullword ascii
      $s8 = "-e, --exec" fullword ascii
      $s9 = "Unable to find command." fullword ascii
      $s10 = "-V, --version" fullword ascii
      $s11 = "Only root can use the -u flag." fullword ascii
      $s12 = "Report bugs to authors." fullword ascii
      $s13 = "Unable to open file: %s: %m" fullword ascii
      $s14 = "ioctl(VT_GETSTATE)" fullword ascii
      $s15 = "print this usage message." fullword ascii
      $s16 = "-c, --console=DEV" fullword ascii
      $s17 = "-u, --user" fullword ascii
      $s18 = "-v, --verbose" fullword ascii
      $s19 = "print version number." fullword ascii
      $s20 = "Unable to set new session" fullword ascii
      $s21 = "Cannot check whether vt %d is free; use `%s -f' to force." fullword ascii
      $s22 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/kbd.debug" fullword ascii
      $s23 = "/proc/%s/fd/0" fullword ascii
      $s24 = "%s: Illegal vt number" fullword ascii
      $s25 = "Cannot open %s read/write" fullword ascii
      $s26 = "-s, --switch" fullword ascii
      $s27 = "-f, --force" fullword ascii
      $s28 = "-w, --wait" fullword ascii
      $s29 = "-h, --help" fullword ascii /* Goodware String - occured 1 times */
      $s30 = "opendir(/proc)" fullword ascii
      $s31 = "Couldn't activate vt %d" fullword ascii
      $s32 = "This utility helps you to start a program on a new virtual terminal (VT)." fullword ascii
      $s33 = "switch to the new VT." fullword ascii
      $s34 = "ioctl(VT_WAITACTIVE)" fullword ascii
      $s35 = "/proc/self/fd/0" fullword ascii
      $s36 = "8fee6e2297b43b311d566b7f4395ed601440d2.debug" fullword ascii
      $s37 = "Unable to set timer" fullword ascii
      $s38 = "c:lsfuewhvV" fullword ascii
      $s39 = "Using VT %s" fullword ascii
      $s40 = "be more verbose." fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 30 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 54 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a8 13 00 00 00 00 00 00 a8 13 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 b9 1a 00 00 00 00 00 00 b9 1a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 14 09 00 00 00 00 00 00 14 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 4d 00 00 00 00 00 00 90 5d 00 00 00 00 00 00 90 5d 00 00 00 00 00 00 90 05 00 00 00 00 00 00 e8 05 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 4d 00 00 00 00 00 00 d8 5d 00 00 00 00 00 00 d8 5d 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 60 46 00 00 00 00 00 00 60 46 00 00 00 00 00 00 60 46 00 00 00 00 00 00 74 00 00 00 00 00 00 00 74 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 4d 00 00 00 00 00 00 90 5d 00 00 00 00 00 00 90 5d 00 00 00 00 00 00 70 02 00 00 00 00 00 00 70 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 b8 8f ee 6e 22 97 b4 3b 31 1d 56 6b 7f 43 95 ed 60 14 40 d2 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 36 00 00 00 01 00 00 00 06 00 00 00 00 05 81 00 00 00 0c 02 36 00 00 00 37 00 00 00 38 00 00 00 d1 65 ce 6d 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 60 01 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 70KB and
      8 of them and $magic
}

rule gtfobins_binaries_column {
   strings:
      $s1 = "failed to parse --table-noextreme list" fullword ascii
      $s2 = "failed to parse --table-trunc list" fullword ascii
      $s3 = "getttynam" fullword ascii
      $s4 = " -E, --table-noextreme <columns>  don't count long text from the columns to column width" fullword ascii
      $s5 = "failed to parse --table-right list" fullword ascii
      $s6 = "failed to parse --table-hide list" fullword ascii
      $s7 = "failed to parse --table-wrap list" fullword ascii
      $s8 = "failed to parse --table-order list" fullword ascii
      $s9 = "failed to add output data" fullword ascii
      $s10 = "failed to use input separator" fullword ascii
      $s11 = "table-header-repeat" fullword ascii
      $s12 = "scols_table_enable_noheadings" fullword ascii
      $s13 = "scols_table_get_ncols" fullword ascii
      $s14 = "scols_table_enable_header_repeat" fullword ascii
      $s15 = "scols_column_get_flags" fullword ascii
      $s16 = "scols_table_get_nlines" fullword ascii
      $s17 = "scols_table_get_column" fullword ascii
      $s18 = "scols_column_get_name" fullword ascii
      $s19 = "scols_cell_get_data" fullword ascii
      $s20 = "scols_table_get_column_by_name" fullword ascii
      $s21 = "scols_line_get_column_cell" fullword ascii
      $s22 = "table-noextreme" fullword ascii
      $s23 = "failed to parse column names" fullword ascii
      $s24 = "failed to parse column" fullword ascii
      $s25 = "table-noheadings" fullword ascii
      $s26 = " -d, --table-noheadings           don't print header" fullword ascii
      $s27 = " -o, --output-separator <string>  columns separator for table output (default is two spaces)" fullword ascii
      $s28 = "option --table required for all --table-*" fullword ascii
      $s29 = "fillrows" fullword ascii
      $s30 = "options --tree-id and --tree-parent are required for tree formatting" fullword ascii
      $s31 = " -e, --table-header-repeat        repeat header for each page" fullword ascii
      $s32 = "option --table-columns or --table-column required for --json" fullword ascii
      $s33 = " -l, --table-columns-limit <num>  maximal number of input columns" fullword ascii
      $s34 = " -C, --table-column <properties>  define column" fullword ascii
      $s35 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/bsdextrautils.debug" fullword ascii
      $s36 = "undefined column name '%s'" fullword ascii
      $s37 = "%s: mutually exclusive arguments:" fullword ascii
      $s38 = " -N, --table-columns <names>      comma separated columns names" fullword ascii
      $s39 = "invalid columns limit argument" fullword ascii
      $s40 = "columns limit must be greater than zero" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 4d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d0 e1 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 30 27 00 00 00 00 00 00 30 27 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 79 6e 00 00 00 00 00 00 79 6e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 80 28 00 00 00 00 00 00 80 28 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 d6 00 00 00 00 00 00 d0 d6 00 00 00 00 00 00 d0 d6 00 00 00 00 00 00 44 09 00 00 00 00 00 00 a0 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 60 da 00 00 00 00 00 00 60 da 00 00 00 00 00 00 60 da 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 8c af 00 00 00 00 00 00 8c af 00 00 00 00 00 00 8c af 00 00 00 00 00 00 8c 03 00 00 00 00 00 00 8c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 d6 00 00 00 00 00 00 d0 d6 00 00 00 00 00 00 d0 d6 00 00 00 00 00 00 30 09 00 00 00 00 00 00 30 09 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 6f d8 bd 89 c3 08 17 20 d1 63 42 43 e9 9e 6a e5 0f e6 b8 c7 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 75 74 69 6c 2d 6c 69 6e 75 78 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 32 2e 34 30 2e 32 2d 31 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_gem {
   strings:
      $s1 = "# See LICENSE.txt for permissions." fullword ascii
      $s2 = "Gem::GemRunner.new.run ARGV.clone" fullword ascii
      $s3 = "# Copyright 2006 by Chad Fowler, Rich Kilmer, Jim Weirich and others." fullword ascii
      $s4 = "# frozen_string_literal: true" fullword ascii
      $s5 = "require \"rubygems/gem_runner\"" fullword ascii
      $s6 = "#!/usr/bin/env ruby" fullword ascii /* Goodware String - occured 2 times */
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 65 6e 76 20 72 75 62 79 0a 23 20 66 72 6f 7a 65 6e 5f 73 74 72 69 6e 67 5f 6c 69 74 65 72 61 6c 3a 20 74 72 75 65 0a 0a 23 2d 2d 0a 23 20 43 6f 70 79 72 69 67 68 74 20 32 30 30 36 20 62 79 20 43 68 61 64 20 46 6f 77 6c 65 72 2c 20 52 69 63 68 20 4b 69 6c 6d 65 72 2c 20 4a 69 6d 20 57 65 69 72 69 63 68 20 61 6e 64 20 6f 74 68 65 72 73 2e 0a 23 20 41 6c 6c 20 72 69 67 68 74 73 20 72 65 73 65 72 76 65 64 2e 0a 23 20 53 65 65 20 4c 49 43 45 4e 53 45 2e 74 78 74 20 66 6f 72 20 70 65 72 6d 69 73 73 69 6f 6e 73 2e 0a 23 2b 2b 0a 0a 72 65 71 75 69 72 65 20 22 72 75 62 79 67 65 6d 73 2f 67 65 6d 5f 72 75 6e 6e 65 72 22 0a 0a 47 65 6d 3a 3a 47 65 6d 52 75 6e 6e 65 72 2e 6e 65 77 2e 72 75 6e 20 41 52 47 56 2e 63 6c 6f 6e 65 0a}
condition:
      filesize < 1KB and
      all of them
}

rule gtfobins_binaries_puppet {
   strings:
      $s1 = "  Puppet::Util::CommandLine.new.execute" fullword ascii
      $s2 = "rescue LoadError => e" fullword ascii
      $s3 = "  require 'puppet/util/command_line'" fullword ascii
      $s4 = "# frozen_string_literal: true" fullword ascii
      $s5 = "  exit(1)" fullword ascii
      $s6 = "  $stderr.puts e.message" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 72 75 62 79 0a 23 20 66 72 6f 7a 65 6e 5f 73 74 72 69 6e 67 5f 6c 69 74 65 72 61 6c 3a 20 74 72 75 65 0a 0a 62 65 67 69 6e 0a 20 20 72 65 71 75 69 72 65 20 27 70 75 70 70 65 74 2f 75 74 69 6c 2f 63 6f 6d 6d 61 6e 64 5f 6c 69 6e 65 27 0a 20 20 50 75 70 70 65 74 3a 3a 55 74 69 6c 3a 3a 43 6f 6d 6d 61 6e 64 4c 69 6e 65 2e 6e 65 77 2e 65 78 65 63 75 74 65 0a 72 65 73 63 75 65 20 4c 6f 61 64 45 72 72 6f 72 20 3d 3e 20 65 0a 20 20 24 73 74 64 65 72 72 2e 70 75 74 73 20 65 2e 6d 65 73 73 61 67 65 0a 20 20 65 78 69 74 28 31 29 0a 65 6e 64 0a}
condition:
      filesize < 1KB and
      all of them
}

rule gtfobins_binaries_facter {
   strings:
      $s1 = "CliLauncher.start(processed_arguments)" fullword ascii
      $s2 = "processed_arguments = CliLauncher.prepare_arguments(ARGV)" fullword ascii
      $s3 = "# frozen_string_literal: true" fullword ascii
      $s4 = "require 'facter/framework/cli/cli_launcher'" fullword ascii
      $s5 = "Facter::OptionsValidator.validate(ARGV)" fullword ascii
      $s6 = "require 'pathname'" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 72 75 62 79 0a 23 20 66 72 6f 7a 65 6e 5f 73 74 72 69 6e 67 5f 6c 69 74 65 72 61 6c 3a 20 74 72 75 65 0a 0a 72 65 71 75 69 72 65 20 27 70 61 74 68 6e 61 6d 65 27 0a 72 65 71 75 69 72 65 20 27 66 61 63 74 65 72 2f 66 72 61 6d 65 77 6f 72 6b 2f 63 6c 69 2f 63 6c 69 5f 6c 61 75 6e 63 68 65 72 27 0a 0a 46 61 63 74 65 72 3a 3a 4f 70 74 69 6f 6e 73 56 61 6c 69 64 61 74 6f 72 2e 76 61 6c 69 64 61 74 65 28 41 52 47 56 29 0a 70 72 6f 63 65 73 73 65 64 5f 61 72 67 75 6d 65 6e 74 73 20 3d 20 43 6c 69 4c 61 75 6e 63 68 65 72 2e 70 72 65 70 61 72 65 5f 61 72 67 75 6d 65 6e 74 73 28 41 52 47 56 29 0a 0a 43 6c 69 4c 61 75 6e 63 68 65 72 2e 73 74 61 72 74 28 70 72 6f 63 65 73 73 65 64 5f 61 72 67 75 6d 65 6e 74 73 29 0a}
condition:
      filesize < 1KB and
      all of them
}

rule gtfobins_binaries_rpm {
   strings:
      $s1 = "creating a pipe for --pipe failed: %m" fullword ascii
      $s2 = "Common options for all rpm modes and executables:" fullword ascii
      $s3 = "Query options (with -q or --query):" fullword ascii
      $s4 = "Copyright (C) 1998-2002 - Red Hat, Inc." fullword ascii
      $s5 = "script disabling options may only be specified during package installation and erasure" fullword ascii
      $s6 = "arguments to --root (-r) must begin with a /" fullword ascii
      $s7 = "rpmlog" fullword ascii
      $s8 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"rpm\",\"version\":\"4.20.0+dfsg-3\",\"architecture\":\"amd64\",\"debugInfoUrl\":" ascii
      $s9 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"rpm\",\"version\":\"4.20.0+dfsg-3\",\"architecture\":\"amd64\",\"debugInfoUrl\":" ascii
      $s10 = "rpmcliPipeOutput" fullword ascii
      $s11 = "rpmlogSetMask" fullword ascii
      $s12 = "arguments to --prefix must begin with a /" fullword ascii
      $s13 = "only one of --excludedocs and --includedocs may be specified" fullword ascii
      $s14 = "rpmquery" fullword ascii
      $s15 = "Verify options (with -V or --verify):" fullword ascii
      $s16 = "rmalloc" fullword ascii
      $s17 = "rpmverify" fullword ascii
      $s18 = "rrealloc" fullword ascii
      $s19 = "rpmcliRootDir" fullword ascii
      $s20 = "RPM version %s" fullword ascii
      $s21 = "ian.net\"}" fullword ascii
      $s22 = "rpmtsSetRootDir" fullword ascii
      $s23 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/rpm.debug" fullword ascii
      $s24 = "--hash (-h) may only be specified during package installation and erasure" fullword ascii
      $s25 = "only installation and upgrading may be forced" fullword ascii
      $s26 = "trigger disabling options may only be specified during package installation and erasure" fullword ascii
      $s27 = "no packages given for erase" fullword ascii
      $s28 = "no arguments given for verify" fullword ascii
      $s29 = "no packages given for install" fullword ascii
      $s30 = "no arguments given for query" fullword ascii
      $s31 = "--ignoresize may only be specified during package installation" fullword ascii
      $s32 = "rpmRestore" fullword ascii
      $s33 = "Options implemented via popt alias/exec:" fullword ascii /* Goodware String - occured 1 times */
      $s34 = "rpmInstall" fullword ascii
      $s35 = "exec failed" fullword ascii /* Goodware String - occured 1 times */
      $s36 = "rpmcliInit" fullword ascii
      $s37 = "--allmatches may only be specified during package erasure" fullword ascii
      $s38 = "rpmQVSourcePoptTable" fullword ascii
      $s39 = "rpmVerifyPoptTable" fullword ascii
      $s40 = "--ignoreos may only be specified during package installation" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 2b 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b0 43 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 58 15 00 00 00 00 00 00 58 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 bd 0f 00 00 00 00 00 00 bd 0f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 c0 0a 00 00 00 00 00 00 c0 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 3c 00 00 00 00 00 00 50 4c 00 00 00 00 00 00 50 4c 00 00 00 00 00 00 b0 05 00 00 00 00 00 00 90 06 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 68 3c 00 00 00 00 00 00 68 4c 00 00 00 00 00 00 68 4c 00 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 fc 38 00 00 00 00 00 00 fc 38 00 00 00 00 00 00 fc 38 00 00 00 00 00 00 4c 00 00 00 00 00 00 00 4c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 3c 00 00 00 00 00 00 50 4c 00 00 00 00 00 00 50 4c 00 00 00 00 00 00 b0 03 00 00 00 00 00 00 b0 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 df 1a 52 a5 f4 b0 9c 10 d1 96 9c d8 36 44 96 a7 a3 37 ba 83 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 72 70 6d 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 34 2e 32 30 2e 30 2b 64 66 73 67 2d 33 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a 22 61}
condition:
      filesize < 60KB and
      8 of them and $magic
}

rule gtfobins_binaries_rpmdb {
   strings:
      $s1 = "creating a pipe for --pipe failed: %m" fullword ascii
      $s2 = "import database from stdin header list" fullword ascii
      $s3 = "Common options for all rpm modes and executables:" fullword ascii
      $s4 = "export database to stdout header list" fullword ascii
      $s5 = "Copyright (C) 1998-2002 - Red Hat, Inc." fullword ascii
      $s6 = "rpmtsImportHeader" fullword ascii
      $s7 = "headerRead" fullword ascii
      $s8 = "rebuild database inverted lists from installed package headers" fullword ascii
      $s9 = "exportdb" fullword ascii
      $s10 = "importdb" fullword ascii
      $s11 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"rpm\",\"version\":\"4.20.0+dfsg-3\",\"architecture\":\"amd64\",\"debugInfoUrl\":" ascii
      $s12 = "{\"type\":\"deb\",\"os\":\"Debian\",\"name\":\"rpm\",\"version\":\"4.20.0+dfsg-3\",\"architecture\":\"amd64\",\"debugInfoUrl\":" ascii
      $s13 = "rpmcliPipeOutput" fullword ascii
      $s14 = "rpmlogSetMask" fullword ascii
      $s15 = "headerWrite" fullword ascii
      $s16 = "rebuilddb" fullword ascii
      $s17 = "salvagedb" fullword ascii
      $s18 = "verifydb" fullword ascii
      $s19 = "rpmcliRootDir" fullword ascii
      $s20 = "RPM version %s" fullword ascii
      $s21 = "ian.net\"}" fullword ascii
      $s22 = "rpmtsSetRootDir" fullword ascii
      $s23 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/rpm.debug" fullword ascii
      $s24 = "only one major mode may be specified" fullword ascii
      $s25 = "salvage database" fullword ascii
      $s26 = "verify database" fullword ascii
      $s27 = "initialize database" fullword ascii
      $s28 = "initdb" fullword ascii
      $s29 = "Options implemented via popt alias/exec:" fullword ascii /* Goodware String - occured 1 times */
      $s30 = "exec failed" fullword ascii /* Goodware String - occured 1 times */
      $s31 = "rpmcliInit" fullword ascii
      $s32 = "rpmcliFini" fullword ascii
      $s33 = "libpopt.so.0" fullword ascii
      $s34 = "This program may be freely redistributed under the terms of the GNU GPL" fullword ascii
      $s35 = "rpmcliAllPoptTable" fullword ascii
      $s36 = "LIBPOPT_0" fullword ascii
      $s37 = "rpmExpandNumeric" fullword ascii
      $s38 = "rpmtsFree" fullword ascii
      $s39 = "librpm.so.10" fullword ascii
      $s40 = "Help options:" fullword ascii /* Goodware String - occured 1 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 24 00 00 00 00 00 00 40 00 00 00 00 00 00 00 20 44 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 60 15 00 00 00 00 00 00 60 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 bd 08 00 00 00 00 00 00 bd 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 10 05 00 00 00 00 00 00 10 05 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 3c 00 00 00 00 00 00 30 4c 00 00 00 00 00 00 30 4c 00 00 00 00 00 00 40 06 00 00 00 00 00 00 d0 06 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 48 3c 00 00 00 00 00 00 48 4c 00 00 00 00 00 00 48 4c 00 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 e0 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 38 33 00 00 00 00 00 00 38 33 00 00 00 00 00 00 38 33 00 00 00 00 00 00 4c 00 00 00 00 00 00 00 4c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 3c 00 00 00 00 00 00 30 4c 00 00 00 00 00 00 30 4c 00 00 00 00 00 00 d0 03 00 00 00 00 00 00 d0 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 7b 91 98 1c 39 6a 75 c3 b1 3c d2 f5 4d 21 d0 09 a1 0c d2 72 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 04 00 00 00 8c 00 00 00 7e 1a fe ca 46 44 4f 00 7b 22 74 79 70 65 22 3a 22 64 65 62 22 2c 22 6f 73 22 3a 22 44 65 62 69 61 6e 22 2c 22 6e 61 6d 65 22 3a 22 72 70 6d 22 2c 22 76 65 72 73 69 6f 6e 22 3a 22 34 2e 32 30 2e 30 2b 64 66 73 67 2d 33 22 2c 22 61 72 63 68 69 74 65 63 74 75 72 65 22 3a 22 61}
condition:
      filesize < 60KB and
      8 of them and $magic
}

rule gtfobins_binaries_split {
   strings:
      $s1 = "      --filter=COMMAND    write to shell COMMAND; file name is $FILE" fullword ascii
      $s2 = "failed to make temporary file name" fullword ascii
      $s3 = "failed to create temporary file %s" fullword ascii
      $s4 = "  -e, --elide-empty-files  do not generate empty output files with '-n'" fullword ascii
      $s5 = "  -d                      use numeric suffixes starting at 0, not alphabetic" fullword ascii
      $s6 = "Usage: %s [OPTION]... [FILE [PREFIX]]" fullword ascii
      $s7 = "  -x                      use hex suffixes starting at 0, not alphabetic" fullword ascii
      $s8 = "%s: invalid start value for hexadecimal suffix" fullword ascii
      $s9 = "invalid chunk number" fullword ascii
      $s10 = "invalid number of chunks" fullword ascii
      $s11 = "multiple separator characters specified" fullword ascii
      $s12 = "invalid suffix length" fullword ascii
      $s13 = "empty record separator" fullword ascii
      $s14 = "  -a, --suffix-length=N   generate suffixes of length N (default %d)" fullword ascii
      $s15 = "bEGKkMmPQRTYZ0" fullword ascii
      $s16 = "failed to create pipe" fullword ascii /* Goodware String - occured 1 times */
      $s17 = "aligned_alloc" fullword ascii
      $s18 = "%s would overwrite input; aborting" fullword ascii
      $s19 = "moving input pipe" fullword ascii /* Goodware String - occured 1 times */
      $s20 = "bytes_chunk_extract" fullword ascii /* Goodware String - occured 1 times */
      $s21 = "-io-blksize" fullword ascii /* Goodware String - occured 1 times */
      $s22 = "--filter does not process a chunk extracted to stdout" fullword ascii /* Goodware String - occured 1 times */
      $s23 = "L9|$8H" fullword ascii /* Goodware String - occured 1 times */
      $s24 = "0 < k && k <= n" fullword ascii
      $s25 = "with FILE=%s, signal %s from command: %s" fullword ascii /* Goodware String - occured 1 times */
      $s26 = "%s: cannot determine file size" fullword ascii /* Goodware String - occured 1 times */
      $s27 = "closing prior pipe" fullword ascii /* Goodware String - occured 1 times */
      $s28 = "failed to open %s for writing" fullword ascii /* Goodware String - occured 1 times */
      $s29 = "waiting for child process" fullword ascii /* Goodware String - occured 1 times */
      $s30 = "failed to run command: \"%s -c %s\"" fullword ascii /* Goodware String - occured 1 times */
      $s31 = "n && k <= n" fullword ascii
      $s32 = "default size is 1000 lines, and default PREFIX is 'x'." fullword ascii
      $s33 = "/%.*sXXXXXX" fullword ascii
      $s34 = "src/split.c" fullword ascii
      $s35 = "next_file_name" fullword ascii
      $s36 = "closing input pipe" fullword ascii /* Goodware String - occured 1 times */
      $s37 = "multi-character separator %s" fullword ascii
      $s38 = "with FILE=%s, exit %d from command: %s" fullword ascii /* Goodware String - occured 1 times */
      $s39 = "invalid suffix %s, contains directory separator" fullword ascii /* Goodware String - occured 1 times */
      $s40 = "hex-suffixes" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 10 41 00 00 00 00 00 00 40 00 00 00 00 00 00 00 98 f6 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f0 1e 00 00 00 00 00 00 f0 1e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 c9 88 00 00 00 00 00 00 c9 88 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 00 b0 00 00 00 00 00 00 30 36 00 00 00 00 00 00 30 36 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 eb 00 00 00 00 00 00 50 fb 00 00 00 00 00 00 50 fb 00 00 00 00 00 00 94 09 00 00 00 00 00 00 b8 0c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ed 00 00 00 00 00 00 d8 fd 00 00 00 00 00 00 d8 fd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 bc cc 00 00 00 00 00 00 bc cc 00 00 00 00 00 00 bc cc 00 00 00 00 00 00 1c 04 00 00 00 00 00 00 1c 04 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 eb 00 00 00 00 00 00 50 fb 00 00 00 00 00 00 50 fb 00 00 00 00 00 00 b0 04 00 00 00 00 00 00 b0 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 ce 34 57 ca 0b d7 08 44 e3 95 0f d6 90 c6 55 2a 08 fd 95 f4 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 59 00 00 00 01 00 00 00 06 00 00 00 04 4d c1 00 20 01 1c 12 59 00 00 00 5b 00 00 00 60 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_at {
   strings:
      $s1 = "warning: commands will be executed using /bin/sh" fullword ascii
      $s2 = "Internal error, process_jobs = %d" fullword ascii
      $s3 = " echo 'Execution directory inaccessible' >&2" fullword ascii
      $s4 = "Please report bugs to the Debian bug tracking system (http://bugs.debian.org/)" fullword ascii
      $s5 = "# atrun uid=%d gid=%d" fullword ascii
      $s6 = "# mail %s %d" fullword ascii
      $s7 = "       at [-V] [-q x] [-f file] [-u username] [-mMlbv] -t time" fullword ascii
      $s8 = "Reading a token" fullword ascii
      $s9 = "Can't open /run/atd.pid to signal atd. No atd running?" fullword ascii
      $s10 = "%s: incomplete last line." fullword ascii
      $s11 = "kill returned impossible error number" fullword ascii
      $s12 = "Error in dup() of job file" fullword ascii
      $s13 = "Input error" fullword ascii
      $s14 = "Error in hyphenated date" fullword ascii
      $s15 = "Warning: deleting running job" fullword ascii
      $s16 = "\"invalid token\"" fullword ascii
      $s17 = "/run/atd.pid" fullword ascii
      $s18 = "Warning: at daemon not running" fullword ascii
      $s19 = "Error in month number" fullword ascii
      $s20 = "Error in dotted date" fullword ascii
      $s21 = "%s. Last token seen: %s" fullword ascii
      $s22 = "Internal parser error" fullword ascii
      $s23 = "Cannot open lockfile /var/spool/cron/atjobs/.SEQ" fullword ascii
      $s24 = "Output error" fullword ascii
      $s25 = "Error in year" fullword ascii
      $s26 = "Usage: at [-V] [-q x] [-f file] [-u username] [-mMlbv] timespec ..." fullword ascii
      $s27 = "/var/spool/cron/atjobs/.SEQ" fullword ascii
      $s28 = "Reducing stack by rule %d (line %d):" fullword ascii
      $s29 = "or contact the maintainers (at@packages.debian.org)." fullword ascii
      $s30 = "; export " fullword ascii
      $s31 = "Error in day of month" fullword ascii
      $s32 = "be7d30b0edefb78dfb875f8e6553b72ac11dc7.debug" fullword ascii
      $s33 = "at version 3.2.5" fullword ascii
      $s34 = "HOURMIN" fullword ascii
      $s35 = "TEATIME" fullword ascii
      $s36 = "DOTTEDDATE" fullword ascii
      $s37 = "MIDNIGHT" fullword ascii
      $s38 = "ABBBBBBBCCDEF" ascii
      $s39 = "HYPHENDATE" fullword ascii
      $s40 = "ABHFKNOIPQLMRSVTGCWDEJZ" fullword wide
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 b0 3f 00 00 00 00 00 00 40 00 00 00 00 00 00 00 38 e2 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 30 23 00 00 00 00 00 00 30 23 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 95 60 00 00 00 00 00 00 95 60 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 6c 31 00 00 00 00 00 00 6c 31 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 d8 00 00 00 00 00 00 b0 e8 00 00 00 00 00 00 b0 e8 00 00 00 00 00 00 3c 08 00 00 00 00 00 00 f8 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 20 db 00 00 00 00 00 00 20 eb 00 00 00 00 00 00 20 eb 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 08 c7 00 00 00 00 00 00 08 c7 00 00 00 00 00 00 08 c7 00 00 00 00 00 00 b4 01 00 00 00 00 00 00 b4 01 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 d8 00 00 00 00 00 00 b0 e8 00 00 00 00 00 00 b0 e8 00 00 00 00 00 00 50 07 00 00 00 00 00 00 50 07 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 28 be 7d 30 b0 ed ef b7 8d fb 87 5f 8e 65 53 b7 2a c1 1d c7 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 58 00 00 00 01 00 00 00 06 00 00 00 12 85 a1 08 f0 01 5c 02 58 00 00 00 5b 00 00 00 5f 00 00 00 28 1d 8c 1c a6 dd a3 6b d1 65 ce 6d 66 55 61 10 c4 b9 9c 40 c0 b3 f7 12 39 f2 8b 1c 32 c4 f7 12 b2 a2 f7 12 38 b9 6d 86 5b 59 59 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_cmp {
   strings:
      $s1 = "standard file descriptors" fullword ascii
      $s2 = "extra operand '%s'" fullword ascii
      $s3 = "missing operand after '%s'" fullword ascii
      $s4 = "invalid --ignore-initial value '%s'" fullword ascii
      $s5 = "invalid --bytes value '%s'" fullword ascii
      $s6 = "https://www.gnu.org/software/diffutils/" fullword ascii
      $s7 = "cmp: EOF on %s after byte %s, in line %s" fullword ascii
      $s8 = "cmp: EOF on %s after byte %s, line %s" fullword ascii
      $s9 = "program error" fullword ascii
      $s10 = "If a FILE is '-' or missing, read standard input." fullword ascii
      $s11 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/diffutils.debug" fullword ascii
      $s12 = "cmp: EOF on %s which is empty" fullword ascii
      $s13 = "cmp: EOF on %s after byte %s" fullword ascii
      $s14 = "/proc/self/maps" fullword ascii
      $s15 = "xstrtol.c" fullword ascii
      $s16 = "gnulib sigsegv (stackoverflow_deinstall_handler)" fullword ascii
      $s17 = "-s, --quiet, --silent      suppress all normal output" fullword ascii /* Goodware String - occured 1 times */
      $s18 = "H;T$hu" fullword ascii /* Goodware String - occured 1 times */
      $s19 = "//TRANSLH" fullword ascii
      $s20 = "-v, --version              output version information and exit" fullword ascii /* Goodware String - occured 1 times */
      $s21 = "-b, --print-bytes          print differing bytes" fullword ascii /* Goodware String - occured 1 times */
      $s22 = "-n, --bytes=LIMIT          compare at most LIMIT bytes" fullword ascii /* Goodware String - occured 1 times */
      $s23 = "-i, --ignore-initial=SKIP         skip first SKIP bytes of both inputs" fullword ascii /* Goodware String - occured 1 times */
      $s24 = "-l, --verbose              output byte numbers and differing byte values" fullword ascii /* Goodware String - occured 1 times */
      $s25 = "-i, --ignore-initial=SKIP1:SKIP2  skip first SKIP1 bytes of FILE1 and" fullword ascii /* Goodware String - occured 1 times */
      $s26 = "The optional SKIP1 and SKIP2 specify the number of bytes to skip" fullword ascii /* Goodware String - occured 1 times */
      $s27 = "at the beginning of each file (zero by default)." fullword ascii /* Goodware String - occured 1 times */
      $s28 = "GB 1,000,000,000, G 1,073,741,824, and so on for T, P, E, Z, Y." fullword ascii /* Goodware String - occured 2 times */
      $s29 = "%*s %3o %-4s %3o %s" fullword ascii /* Goodware String - occured 2 times */
      $s30 = "bci:ln:sv" fullword ascii /* Goodware String - occured 2 times */
      $s31 = "%*s %3o %3o" fullword ascii /* Goodware String - occured 2 times */
      $s32 = "SKIP values may be followed by the following multiplicative suffixes:" fullword ascii /* Goodware String - occured 2 times */
      $s33 = "print-chars" fullword ascii /* Goodware String - occured 2 times */
      $s34 = "Compare two files byte by byte." fullword ascii /* Goodware String - occured 2 times */
      $s35 = "    --help                 display this help and exit" fullword ascii
      $s36 = "ignore-initial" fullword ascii /* Goodware String - occured 2 times */
      $s37 = "55c91130b1decab70a655ad0878183bc72e13d.debug" fullword ascii
      $s38 = "kB 1000, K 1024, MB 1,000,000, M 1,048,576," fullword ascii /* Goodware String - occured 2 times */
      $s39 = "options -l and -s are incompatible" fullword ascii /* Goodware String - occured 2 times */
      $s40 = "%s %s differ: byte %s, line %s is %3o %s %3o %s" fullword ascii /* Goodware String - occured 2 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 35 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 c4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 68 1a 00 00 00 00 00 00 68 1a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 e1 67 00 00 00 00 00 00 e1 67 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 8c 23 00 00 00 00 00 00 8c 23 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 bc 00 00 00 00 00 00 30 cc 00 00 00 00 00 00 30 cc 00 00 00 00 00 00 30 06 00 00 00 00 00 00 b0 08 01 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 bd 00 00 00 00 00 00 e0 cd 00 00 00 00 00 00 e0 cd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d4 9e 00 00 00 00 00 00 d4 9e 00 00 00 00 00 00 d4 9e 00 00 00 00 00 00 1c 03 00 00 00 00 00 00 1c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 bc 00 00 00 00 00 00 30 cc 00 00 00 00 00 00 30 cc 00 00 00 00 00 00 d0 03 00 00 00 00 00 00 d0 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 c7 55 c9 11 30 b1 de ca b7 0a 65 5a d0 87 81 83 bc 72 e1 3d 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 4c 00 00 00 01 00 00 00 06 00 00 00 04 4d c1 00 20 01 1c 12 4c 00 00 00 4e 00 00 00 53 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_gzip {
   strings:
      $s1 = "%s: %s: header checksum 0x%04x != computed checksum 0x%04x" fullword ascii
      $s2 = "%s: %s has %lu other link%s -- file ignored" fullword ascii
      $s3 = "invalid compressed data -- unexpected end of file" fullword ascii
      $s4 = "invalid compressed data -- Huffman code bit length out of range" fullword ascii
      $s5 = "%s: option --ascii ignored on this system" fullword ascii
      $s6 = "the GNU General Public License <https://www.gnu.org/licenses/gpl.html>." fullword ascii
      $s7 = " -- %s %s" fullword ascii
      $s8 = "  -S, --suffix=SUF  use suffix SUF on compressed files" fullword ascii
      $s9 = "  -d, --decompress  decompress" fullword ascii
      $s10 = "  -l, --list        list compressed file contents" fullword ascii
      $s11 = "%s: %s: non-option in GZIP environment variable" fullword ascii
      $s12 = "%s: %s: file size changed while zipping" fullword ascii
      $s13 = "%s: %s: MTIME %lu out of range for this platform" fullword ascii
      $s14 = "%s: invalid suffix '%s'" fullword ascii
      $s15 = "%s: warning: GZIP environment variable is deprecated; use an alias or script" fullword ascii
      $s16 = "  -r, --recursive   operate recursively on directories" fullword ascii
      $s17 = "--%s: " fullword ascii
      $s18 = "%s: timestamp restored" fullword ascii
      $s19 = "  -9, --best        compress better" fullword ascii
      $s20 = "file timestamp out of range for gzip format" fullword ascii
      $s21 = "      --synchronous synchronous output (safer if system crashes, but slower)" fullword ascii
      $s22 = "  -f, --force       force overwrite of output file and compress links" fullword ascii
      $s23 = "  -t, --test        test compressed file integrity" fullword ascii
      $s24 = "  -1, --fast        compress faster" fullword ascii
      $s25 = "  -V, --version     display version number" fullword ascii
      $s26 = "replaced with" fullword ascii
      $s27 = "too few leaves in Huffman tree" fullword ascii
      $s28 = " (totals)" fullword ascii
      $s29 = "ab:cdfhH?klLmMnNqrS:tvVZ123456789" fullword ascii
      $s30 = "Copyright (C) 2018 Free Software Foundation, Inc." fullword ascii
      $s31 = "rsyncable" fullword ascii /* Goodware String - occured 1 times */
      $s32 = "gfffffffSH" fullword ascii
      $s33 = " do you wish to overwrite (y or n)? " fullword ascii
      $s34 = "-presume-input-tty" fullword ascii /* Goodware String - occured 1 times */
      $s35 = "option not valid in GZIP environment variable" fullword ascii
      $s36 = "%s: %s: not a valid zip file" fullword ascii /* Goodware String - occured 2 times */
      $s37 = "%s: %s: encrypted file -- use unzip" fullword ascii /* Goodware String - occured 2 times */
      $s38 = "  -L, --license     display software license" fullword ascii
      $s39 = "invalid compressed data--format violated" fullword ascii /* Goodware String - occured 2 times */
      $s40 = "method  crc     date  time  " fullword ascii /* Goodware String - occured 2 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 3d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 77 01 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 48 21 00 00 00 00 00 00 48 21 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 a1 e8 00 00 00 00 00 00 a1 e8 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 01 00 00 00 00 00 00 20 01 00 00 00 00 00 00 20 01 00 00 00 00 00 0c 40 00 00 00 00 00 00 0c 40 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 f0 68 01 00 00 00 00 00 f0 78 01 00 00 00 00 00 f0 78 01 00 00 00 00 00 70 0d 00 00 00 00 00 00 d0 85 0c 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 6d 01 00 00 00 00 00 e0 7d 01 00 00 00 00 00 e0 7d 01 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 c4 43 01 00 00 00 00 00 c4 43 01 00 00 00 00 00 c4 43 01 00 00 00 00 00 fc 03 00 00 00 00 00 00 fc 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 f0 68 01 00 00 00 00 00 f0 78 01 00 00 00 00 00 f0 78 01 00 00 00 00 00 10 07 00 00 00 00 00 00 10 07 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 7c da ad 1e e1 fd 00 24 2b 6c a0 9b 05 63 1a 6f b4 4b 2f 38 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 50 00 00 00 01 00 00 00 06 00 00 00 00 05 a1 00 80 01 1c 02 50 00 00 00 52 00 00 00 54 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ee 01 00 00 12 00 00 00}
condition:
      filesize < 300KB and
      8 of them and $magic
}

rule gtfobins_binaries_tclsh {
   strings:
      $s1 = "libtcl8.6.so" fullword ascii
      $s2 = "Tcl_CreateInterp" fullword ascii /* Goodware String - occured 1 times */
      $s3 = "Tcl_NewStringObj" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "Tcl_ObjSetVar2" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "~/.tclshrc" fullword ascii
      $s6 = "tcl_rcFileName" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "Tcl_Init" fullword ascii /* Goodware String - occured 1 times */
      $s8 = "d8bc41d3cf684dcca75a7a9a34161f48a0a892.debug" fullword ascii
      $s9 = "Tcl_MainEx" fullword ascii
      $s10 = "d8bc41d3cf684dcca75a7a9a34161f48a0a892" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 d0 10 00 00 00 00 00 00 40 00 00 00 00 00 00 00 80 31 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 38 08 00 00 00 00 00 00 38 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 25 02 00 00 00 00 00 00 25 02 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 34 01 00 00 00 00 00 00 34 01 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 c0 2d 00 00 00 00 00 00 c0 3d 00 00 00 00 00 00 c0 3d 00 00 00 00 00 00 78 02 00 00 00 00 00 00 80 02 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d0 2d 00 00 00 00 00 00 d0 3d 00 00 00 00 00 00 d0 3d 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 20 20 00 00 00 00 00 00 20 20 00 00 00 00 00 00 20 20 00 00 00 00 00 00 34 00 00 00 00 00 00 00 34 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 c0 2d 00 00 00 00 00 00 c0 3d 00 00 00 00 00 00 c0 3d 00 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 60 d8 bc 41 d3 cf 68 4d cc a7 5a 7a 9a 34 16 1f 48 a0 a8 92 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 0a 00 00 00 01 00 00 00 06 00 00 00 88 51 a1 01 20 65 04 08 0a 00 00 00 0e 00 00 00 00 00 00 00 6a 09 43 d6 d0 65 ce 6d ba e3 92 7c 43 45 d5 ec 0c 3a 97 0b 32 62 db ed ac 4b e3 c0 d9 71 58 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 40KB and
      all of them
}

rule gtfobins_binaries_wish {
   strings:
      $s1 = "libtcl8.6.so" fullword ascii
      $s2 = "Tcl_CreateInterp" fullword ascii /* Goodware String - occured 1 times */
      $s3 = "Tcl_NewStringObj" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "Tcl_ObjSetVar2" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "tcl_rcFileName" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "Tcl_Init" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "21c8b760d5b4d416cfa0a90d75f764d7f514d3.debug" fullword ascii
      $s8 = "libtk8.6.so" fullword ascii
      $s9 = "Tk_Init" fullword ascii /* Goodware String - occured 1 times */
      $s10 = "Tk_MainEx" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "Tk_SafeInit" fullword ascii /* Goodware String - occured 1 times */
      $s12 = "Tcl_StaticPackage" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "Tcl_FindExecutable" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "~/.wishrc" fullword ascii
      $s15 = "21c8b760d5b4d416cfa0a90d75f764d7f514d3" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 f0 10 00 00 00 00 00 00 40 00 00 00 00 00 00 00 90 31 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 09 00 00 00 00 00 00 40 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 7d 02 00 00 00 00 00 00 7d 02 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 40 01 00 00 00 00 00 00 40 01 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 a0 2d 00 00 00 00 00 00 a0 3d 00 00 00 00 00 00 a0 3d 00 00 00 00 00 00 a8 02 00 00 00 00 00 00 b0 02 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 b0 2d 00 00 00 00 00 00 b0 3d 00 00 00 00 00 00 b0 3d 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 20 20 00 00 00 00 00 00 20 20 00 00 00 00 00 00 20 20 00 00 00 00 00 00 34 00 00 00 00 00 00 00 34 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 a0 2d 00 00 00 00 00 00 a0 3d 00 00 00 00 00 00 a0 3d 00 00 00 00 00 00 60 02 00 00 00 00 00 00 60 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 98 21 c8 b7 60 d5 b4 d4 16 cf a0 a9 0d 75 f7 64 d7 f5 14 d3 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 0d 00 00 00 01 00 00 00 06 00 00 00 88 51 a1 01 20 65 84 08 0d 00 00 00 11 00 00 00 15 00 00 00 6a 09 43 d6 d0 65 ce 6d ba e3 92 7c 43 45 d5 ec 0c 3a 97 0b 32 62 db ed ac 4b e3 c0 d9 71 58 1c 77 89 54 46 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 40KB and
      8 of them and $magic
}

rule gtfobins_binaries_expect {
   strings:
      $s1 = "exp_cmdfile" fullword ascii
      $s2 = "Tcl_Init failed: %s" fullword ascii
      $s3 = "exp_cmdfilename" fullword ascii
      $s4 = "Expect_Init failed: %s" fullword ascii
      $s5 = "exp_interpret_cmdfile" fullword ascii
      $s6 = "exp_interpret_cmdfilename" fullword ascii
      $s7 = "libtcl8.6.so" fullword ascii
      $s8 = "Tcl_CreateInterp" fullword ascii /* Goodware String - occured 1 times */
      $s9 = "Tcl_Init" fullword ascii /* Goodware String - occured 1 times */
      $s10 = "Tcl_FindExecutable" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "exit %d" fullword ascii /* Goodware String - occured 1 times */
      $s12 = "libexpect.so.5.45" fullword ascii
      $s13 = "exp_parse_argv" fullword ascii
      $s14 = "Expect_Init" fullword ascii
      $s15 = "Tcl_GetStringResult" fullword ascii /* Goodware String - occured 1 times */
      $s16 = "exp_interpreter" fullword ascii
      $s17 = "Tcl_Eval" fullword ascii /* Goodware String - occured 1 times */
      $s18 = "exp_interactive" fullword ascii
      $s19 = "b68fcc1bdc08cabf08752dc7f73b89854cc1c9.debug" fullword ascii
      $s20 = "b68fcc1bdc08cabf08752dc7f73b89854cc1c9" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 12 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c8 31 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e8 0b 00 00 00 00 00 00 e8 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 65 03 00 00 00 00 00 00 65 03 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 28 01 00 00 00 00 00 00 28 01 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 2d 00 00 00 00 00 00 90 3d 00 00 00 00 00 00 90 3d 00 00 00 00 00 00 f0 02 00 00 00 00 00 00 f8 02 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a0 2d 00 00 00 00 00 00 a0 3d 00 00 00 00 00 00 a0 3d 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 3c 20 00 00 00 00 00 00 3c 20 00 00 00 00 00 00 3c 20 00 00 00 00 00 00 2c 00 00 00 00 00 00 00 2c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 2d 00 00 00 00 00 00 90 3d 00 00 00 00 00 00 90 3d 00 00 00 00 00 00 70 02 00 00 00 00 00 00 70 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 84 b6 8f cc 1b dc 08 ca bf 08 75 2d c7 f7 3b 89 85 4c c1 c9 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 17 00 00 00 01 00 00 00 06 00 00 00 88 51 a1 01 20 65 04 28 17 00 00 00 1b 00 00 00 00 00 00 00 6a 09 43 d6 d0 65 ce 6d ba e3 92 7c 43 45 d5 ec 0c 3a 97 0b 32 62 db ed ac 4b e3 c0 d8 71 58 1c 6b 7f 9a 7c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 40KB and
      8 of them and $magic
}

rule gtfobins_binaries_file {
   strings:
      $s1 = "Report bugs to https://bugs.astron.com/" fullword ascii
      $s2 = "  -%c, --uncompress-noreport" fullword ascii
      $s3 = "Compiled magic version [%d] does not match with shared library magic version [%d]" fullword ascii
      $s4 = "max ELF notes processed" fullword ascii
      $s5 = "max ELF sections processed" fullword ascii
      $s6 = "max ELF prog sections processed" fullword ascii
      $s7 = "  only print the contents of compressed files" fullword ascii
      $s8 = "ERROR: %s%c" fullword ascii
      $s9 = "  -%c, --uncompress" fullword ascii
      $s10 = "  -%c, --compile" fullword ascii
      $s11 = "  -%c, --version" fullword ascii
      $s12 = "Usage: %s [-bcCdEhikLlNnprsSvzZ0] [--apple] [--extension] [--mime-encoding]" fullword ascii
      $s13 = "  -%c, --dereference" fullword ascii
      $s14 = "  -%c, --keep-going" fullword ascii
      $s15 = "  -%c, --preserve-date" fullword ascii
      $s16 = "  -%c, --separator" fullword ascii
      $s17 = "  -%c, --special-files" fullword ascii
      $s18 = "  -%c, --no-sandbox" fullword ascii
      $s19 = "  -%c, --exclude" fullword ascii
      $s20 = "  -%c, --files-from" fullword ascii
      $s21 = "  -%c, --no-dereference" fullword ascii
      $s22 = "  -%c, --parameter" fullword ascii
      $s23 = "  -%c, --magic-file" fullword ascii
      $s24 = "  -%c, --checking-printout" fullword ascii
      $s25 = "  -%c, --list" fullword ascii
      $s26 = "  -%c, --brief" fullword ascii
      $s27 = "  -%c, --debug" fullword ascii
      $s28 = "  -%c, --mime" fullword ascii
      $s29 = "  -%c, --print0" fullword ascii
      $s30 = "  -%c, --no-pad" fullword ascii
      $s31 = "  -%c, --raw" fullword ascii
      $s32 = "  -%c, --no-buffer" fullword ascii
      $s33 = "@(#)$File: seccomp.c,v 1.25 2022/12/26 18:57:29 christos Exp $" fullword ascii
      $s34 = "                               conjunction with -m to debug a new magic file" fullword ascii
      $s35 = "magic_version" fullword ascii
      $s36 = "max bytes to scan for encoding" fullword ascii
      $s37 = "max bytes to look inside file" fullword ascii
      $s38 = "              compile file specified by -m" fullword ascii
      $s39 = "       %s -C [-m <magicfiles>]" fullword ascii
      $s40 = "recursion limit for indirection" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 2f 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 62 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b0 16 00 00 00 00 00 00 b0 16 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 8d 1d 00 00 00 00 00 00 8d 1d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 10 15 00 00 00 00 00 00 10 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 90 57 00 00 00 00 00 00 90 67 00 00 00 00 00 00 90 67 00 00 00 00 00 00 00 0a 00 00 00 00 00 00 80 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 60 5c 00 00 00 00 00 00 60 6c 00 00 00 00 00 00 60 6c 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 20 51 00 00 00 00 00 00 20 51 00 00 00 00 00 00 20 51 00 00 00 00 00 00 94 00 00 00 00 00 00 00 94 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 90 57 00 00 00 00 00 00 90 67 00 00 00 00 00 00 90 67 00 00 00 00 00 00 70 08 00 00 00 00 00 00 70 08 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 d2 57 7e 21 a8 88 93 e5 39 d9 86 87 61 e1 21 f0 27 76 1f 0c 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 2e 00 00 00 01 00 00 00 06 00 00 00 00 05 a1 00 80 01 1c 02 2e 00 00 00 30 00 00 00 32 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b8 01 00 00 12 00 00 00}
condition:
      filesize < 80KB and
      8 of them and $magic
}

rule gtfobins_binaries_xxd {
   strings:
      $s1 = "    -r          reverse operation: convert (or patch) hexdump into binary." fullword ascii
      $s2 = "    -e          little-endian dump (incompatible with -ps,-i,-r)." fullword ascii
      $s3 = "    -ps         output in postscript plain hexdump style." fullword ascii
      $s4 = "    -b          binary digit dump (incompatible with -ps,-i). Default hex." fullword ascii
      $s5 = "    -v          show version: \"%s%s\"." fullword ascii
      $s6 = "    -r -s off   revert with <off> added to file positions found in hexdump." fullword ascii
      $s7 = "Sorry, cannot revert this type of hexdump" fullword ascii
      $s8 = "       %s -r [-s [-]offset] [-c cols] [-ps] [infile [outfile]]" fullword ascii
      $s9 = "apitalize" fullword ascii
      $s10 = "number of octets per group must be a power of 2 with -e." fullword ascii
      $s11 = "fddb60633bd1f978595ebd925f847ae501c328.debug" fullword ascii
      $s12 = "    -a          toggle autoskip: A single '*' replaces nul-lines. Default off." fullword ascii
      $s13 = "    -o off      add <off> to the displayed file position." fullword ascii
      $s14 = "    -d          show offset in decimal instead of hex." fullword ascii
      $s15 = "    -s %sseek  start at <seek> bytes abs. %sinfile offset." fullword ascii
      $s16 = "    -i          output in C include file style." fullword ascii
      $s17 = "    -g bytes    number of octets per group in normal output. Default 2 (-e: 4)." fullword ascii
      $s18 = "    -c cols     format <cols> octets per line. Default 16 (-i: 12, -ps: 30)." fullword ascii
      $s19 = "    -h          print this summary." fullword ascii
      $s20 = "    -n name     set the variable name used in C include output (-i)." fullword ascii
      $s21 = "    -l len      stop after <len> octets." fullword ascii
      $s22 = "_%s = %d;" fullword ascii
      $s23 = "Hct$tH" fullword ascii /* Goodware String - occured 1 times */
      $s24 = "fddb60633bd1f978595ebd925f847ae501c328" ascii
      $s25 = "xxd 2024-05-10 by Juergen Weigert et al." fullword ascii
      $s26 = "[0m%s: %s" fullword ascii
      $s27 = "    -E          show characters in EBCDIC. Default ASCII." fullword ascii
      $s28 = "%s: invalid number of columns (max. %d)." fullword ascii /* Goodware String - occured 2 times */
      $s29 = "[+][-]" fullword ascii /* Goodware String - occured 2 times */
      $s30 = "%s0X%02X" fullword ascii /* Goodware String - occured 2 times */
      $s31 = "(or +: rel.) " fullword ascii /* Goodware String - occured 2 times */
      $s32 = "unsigned int %s" fullword ascii /* Goodware String - occured 2 times */
      $s33 = "unsigned char %s" fullword ascii /* Goodware String - occured 2 times */
      $s34 = "    -u          use upper case hex letters." fullword ascii
      $s35 = "       %s [options] [infile [outfile]]" fullword ascii
      $s36 = "[1;31m " fullword ascii
      $s37 = "ED$<E1" fullword ascii
      $s38 = "[] = {" fullword ascii /* Goodware String - occured 4 times */
      $s39 = "%08ld:" fullword ascii
      $s40 = "%08lx:" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 2c 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 51 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 58 0d 00 00 00 00 00 00 58 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 69 24 00 00 00 00 00 00 69 24 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 44 0b 00 00 00 00 00 00 44 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 e0 4c 00 00 00 00 00 00 e0 5c 00 00 00 00 00 00 e0 5c 00 00 00 00 00 00 b8 03 00 00 00 00 00 00 98 38 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 f0 4c 00 00 00 00 00 00 f0 5c 00 00 00 00 00 00 f0 5c 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d0 48 00 00 00 00 00 00 d0 48 00 00 00 00 00 00 d0 48 00 00 00 00 00 00 74 00 00 00 00 00 00 00 74 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 e0 4c 00 00 00 00 00 00 e0 5c 00 00 00 00 00 00 e0 5c 00 00 00 00 00 00 20 03 00 00 00 00 00 00 20 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 78 fd db 60 63 3b d1 f9 78 59 5e bd 92 5f 84 7a e5 01 c3 28 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 21 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 21 00 00 00 23 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 70KB and
      8 of them and $magic
}

rule gtfobins_binaries_cut {
   strings:
      $s1 = "  -n                      (ignored)" fullword ascii
      $s2 = "byte/character offset %s is too large" fullword ascii
      $s3 = "                            the -s option is specified" fullword ascii
      $s4 = "invalid byte or character range" fullword ascii
      $s5 = "invalid field range" fullword ascii
      $s6 = "only one list may be specified" fullword ascii
      $s7 = "      --complement        complement the set of selected bytes, characters" fullword ascii
      $s8 = "Usage: %s OPTION... [FILE]..." fullword ascii /* Goodware String - occured 1 times */
      $s9 = "byte/character positions are numbered from 1" fullword ascii
      $s10 = "6e0f920bf061030fa6a2f8f5bb761a9ccc1f44.debug" fullword ascii
      $s11 = "cut_fields" fullword ascii /* Goodware String - occured 1 times */
      $s12 = "invalid decreasing range" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "fields are numbered from 1" fullword ascii
      $s14 = "invalid range with no endpoint: -" fullword ascii /* Goodware String - occured 1 times */
      $s15 = "invalid byte/character position %s" fullword ascii
      $s16 = "W(H;W0" fullword ascii /* Goodware String - occured 1 times */
      $s17 = "A(H;A0" fullword ascii /* Goodware String - occured 1 times */
      $s18 = "missing list of byte/character positions" fullword ascii
      $s19 = "invalid field value %s" fullword ascii
      $s20 = "in the same order that it is read, and is written exactly once." fullword ascii /* Goodware String - occured 2 times */
      $s21 = "Print selected parts of lines from each FILE to standard output." fullword ascii /* Goodware String - occured 2 times */
      $s22 = "only-delimited" fullword ascii /* Goodware String - occured 2 times */
      $s23 = "  N-    from N'th byte, character or field, to end of line" fullword ascii
      $s24 = "  -b, --bytes=LIST        select only these bytes" fullword ascii
      $s25 = "  -d, --delimiter=DELIM   use DELIM instead of TAB for field delimiter" fullword ascii
      $s26 = "      --output-delimiter=STRING  use STRING as the output delimiter" fullword ascii
      $s27 = "field number %s is too large" fullword ascii /* Goodware String - occured 2 times */
      $s28 = "  -c, --characters=LIST   select only these characters" fullword ascii
      $s29 = "Each range is one of:" fullword ascii /* Goodware String - occured 2 times */
      $s30 = "  -z, --zero-terminated   line delimiter is NUL, not newline" fullword ascii
      $s31 = "Use one, and only one of -b, -c or -f.  Each LIST is made up of one" fullword ascii /* Goodware String - occured 2 times */
      $s32 = "only when operating on fields" fullword ascii /* Goodware String - occured 2 times */
      $s33 = "n_bytes != 0" fullword ascii /* Goodware String - occured 2 times */
      $s34 = "range, or many ranges separated by commas.  Selected input is written" fullword ascii /* Goodware String - occured 2 times */
      $s35 = "missing list of fields" fullword ascii /* Goodware String - occured 2 times */
      $s36 = "suppressing non-delimited lines makes sense" fullword ascii /* Goodware String - occured 2 times */
      $s37 = "  -s, --only-delimited    do not print lines not containing delimiters" fullword ascii
      $s38 = "you must specify a list of bytes, characters, or fields" fullword ascii /* Goodware String - occured 2 times */
      $s39 = "an input delimiter may be specified only when operating on fields" fullword ascii /* Goodware String - occured 2 times */
      $s40 = "  -f, --fields=LIST       select only these fields;  also print any line" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 50 28 00 00 00 00 00 00 40 00 00 00 00 00 00 00 50 b4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 68 19 00 00 00 00 00 00 68 19 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 89 5d 00 00 00 00 00 00 89 5d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 d0 28 00 00 00 00 00 00 d0 28 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 ac 00 00 00 00 00 00 10 bc 00 00 00 00 00 00 10 bc 00 00 00 00 00 00 90 06 00 00 00 00 00 00 90 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ad 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 30 94 00 00 00 00 00 00 30 94 00 00 00 00 00 00 30 94 00 00 00 00 00 00 7c 03 00 00 00 00 00 00 7c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 ac 00 00 00 00 00 00 10 bc 00 00 00 00 00 00 10 bc 00 00 00 00 00 00 f0 03 00 00 00 00 00 00 f0 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 2a 6e 0f 92 0b f0 61 03 0f a6 a2 f8 f5 bb 76 1a 9c cc 1f 44 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 44 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 44 00 00 00 46 00 00 00 4c 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_msgfilter {
   strings:
      $s1 = "  -e, --expression=SCRIPT     add SCRIPT to the commands to be executed" fullword ascii
      $s2 = "  -f, --file=SCRIPTFILE       add the contents of SCRIPTFILE to the commands" fullword ascii
      $s3 = "https://savannah.gnu.org/projects/gettext" fullword ascii
      $s4 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/gettext.debug" fullword ascii
      $s5 = "bug-gettext@gnu.org" fullword ascii
      $s6 = "                                to be executed" fullword ascii
      $s7 = "Report bugs in the bug tracker at <%s>" fullword ascii
      $s8 = "License GPLv3+: GNU GPL version 3 or later <%s>" fullword ascii
      $s9 = "libgettextlib-0.22.5.so" fullword ascii
      $s10 = "libgettextsrc-0.22.5.so" fullword ascii
      $s11 = "boldquot" fullword ascii
      $s12 = "      --keep-header           keep header entry unmodified, don't filter it" fullword ascii
      $s13 = "or by email to <%s>." fullword ascii
      $s14 = "handle_filepos_comment_option" fullword ascii
      $s15 = "last_component" fullword ascii
      $s16 = "fbf84e261c4a9f8a26edd92eafd16526340a2b.debug" fullword ascii
      $s17 = "  -V, --version               output version information and exit" fullword ascii
      $s18 = "filter output is not terminated with a newline" fullword ascii
      $s19 = "error_print_progname" fullword ascii /* Goodware String - occured 1 times */
      $s20 = "message_print_style_filepos" fullword ascii
      $s21 = "libtextstyle.so.0" fullword ascii
      $s22 = "MSGFILTER_PREV_MSGID" fullword ascii
      $s23 = "keep-header" fullword ascii /* Goodware String - occured 1 times */
      $s24 = "Applies a filter to all translations of a translation catalog." fullword ascii /* Goodware String - occured 1 times */
      $s25 = "MSGFILTER_PREV_MSGCTXT" fullword ascii
      $s26 = "+D:EFhi:n:o:pPsVw:" fullword ascii
      $s27 = "and writes a modified translation to standard output." fullword ascii /* Goodware String - occured 1 times */
      $s28 = "MSGFILTER_MSGID_PLURAL" fullword ascii
      $s29 = "MSGFILTER_MSGID" fullword ascii /* Goodware String - occured 1 times */
      $s30 = "MSGFILTER_MSGCTXT" fullword ascii /* Goodware String - occured 1 times */
      $s31 = "MSGFILTER_PLURAL_FORM" fullword ascii
      $s32 = "Useful FILTER-OPTIONs when the FILTER is 'sed':" fullword ascii /* Goodware String - occured 1 times */
      $s33 = "The FILTER can be any program that reads a translation from standard input" fullword ascii /* Goodware String - occured 1 times */
      $s34 = "missing filter name" fullword ascii /* Goodware String - occured 1 times */
      $s35 = "MSGFILTER_PREV_MSGID_PLURAL" fullword ascii
      $s36 = "Filter input and output:" fullword ascii
      $s37 = "Usage: %s [OPTION] FILTER [FILTER-OPTION]" fullword ascii /* Goodware String - occured 1 times */
      $s38 = "--expression" fullword ascii /* Goodware String - occured 1 times */
      $s39 = "fbf84e261c4a9f8a26edd92eafd16526340a2b" ascii
      $s40 = "MSGFILTER_LOCATION" fullword ascii /* Goodware String - occured 1 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 20 2f 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 81 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 19 00 00 00 00 00 00 10 19 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 f9 20 00 00 00 00 00 00 f9 20 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 18 1a 00 00 00 00 00 00 18 1a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 50 78 00 00 00 00 00 00 50 78 00 00 00 00 00 00 50 78 00 00 00 00 00 00 c0 07 00 00 00 00 00 00 70 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 18 7c 00 00 00 00 00 00 18 7c 00 00 00 00 00 00 18 7c 00 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 80 66 00 00 00 00 00 00 80 66 00 00 00 00 00 00 80 66 00 00 00 00 00 00 9c 00 00 00 00 00 00 00 9c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 50 78 00 00 00 00 00 00 50 78 00 00 00 00 00 00 50 78 00 00 00 00 00 00 b0 07 00 00 00 00 00 00 b0 07 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 e2 fb f8 4e 26 1c 4a 9f 8a 26 ed d9 2e af d1 65 26 34 0a 2b 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 36 00 00 00 02 00 00 00 07 00 00 00 e0 27 08 2d 10 00 9c 12 10 08 01 00 10 00 18 18 36 00 00 00 38 00 00 00 3c 00 00 00 d0 65 ce 6d 7b 02 b4 34 7c 3a 40 af 3c cc 28 a8 38 f2 8b 1c 8b 84 85 fc 06 5a c0 af b2 a2 f7 12 72 12 be 0f 88 db c4 08 1c ed 63 2a 1a 03 53 3c 32 c4 f7 12}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_msgconv {
   strings:
      $s1 = "https://savannah.gnu.org/projects/gettext" fullword ascii
      $s2 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/gettext.debug" fullword ascii
      $s3 = "bug-gettext@gnu.org" fullword ascii
      $s4 = "Report bugs in the bug tracker at <%s>" fullword ascii
      $s5 = "License GPLv3+: GNU GPL version 3 or later <%s>" fullword ascii
      $s6 = "libgettextlib-0.22.5.so" fullword ascii
      $s7 = "libgettextsrc-0.22.5.so" fullword ascii
      $s8 = "or by email to <%s>." fullword ascii
      $s9 = "handle_filepos_comment_option" fullword ascii
      $s10 = "last_component" fullword ascii
      $s11 = "e9f45ccf539a6455fb61bbcb10f7f843a42dcf.debug" fullword ascii
      $s12 = "  -V, --version               output version information and exit" fullword ascii
      $s13 = "error_print_progname" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "message_print_style_filepos" fullword ascii
      $s15 = "libtextstyle.so.0" fullword ascii
      $s16 = "e9f45ccf539a6455fb61bbcb10f7f843a42dcf" ascii
      $s17 = "The default encoding is the current locale's encoding." fullword ascii /* Goodware String - occured 1 times */
      $s18 = "Converts a translation catalog to a different character encoding." fullword ascii /* Goodware String - occured 1 times */
      $s19 = "D:eEFhin:o:pPst:Vw:" fullword ascii
      $s20 = "Conversion target:" fullword ascii /* Goodware String - occured 1 times */
      $s21 = "      --force-po              write PO file even if empty" fullword ascii
      $s22 = "  -o, --output-file=FILE      write output to specified file" fullword ascii
      $s23 = "      --color                 use colors and other text attributes always" fullword ascii
      $s24 = "  -D, --directory=DIRECTORY   add DIRECTORY to list for input files search" fullword ascii
      $s25 = "      --stringtable-output    write out a NeXTstep/GNUstep .strings file" fullword ascii
      $s26 = "  -s, --sort-output           generate sorted output" fullword ascii
      $s27 = "      --no-wrap               do not break long message lines, longer than" fullword ascii
      $s28 = "      --style=STYLEFILE       specify CSS style rule file for --color" fullword ascii
      $s29 = "  -p, --properties-output     write out a Java .properties file" fullword ascii
      $s30 = "  -t, --to-code=NAME          encoding for output" fullword ascii
      $s31 = "  -w, --width=NUMBER          set output page width" fullword ascii
      $s32 = "      --color=WHEN            use colors and other text attributes if WHEN." fullword ascii
      $s33 = "  -h, --help                  display this help and exit" fullword ascii
      $s34 = "      --strict                strict Uniforum output style" fullword ascii
      $s35 = "  -P, --properties-input      input file is in Java .properties syntax" fullword ascii
      $s36 = "      --stringtable-input     input file is in NeXTstep/GNUstep .strings syntax" fullword ascii
      $s37 = "  -i, --indent                indented output style" fullword ascii
      $s38 = "to-code" fullword ascii /* Goodware String - occured 4 times */
      $s39 = "0.22.5" fullword ascii
      $s40 = "2001-2023" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 26 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 51 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 14 00 00 00 00 00 00 80 14 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 09 0d 00 00 00 00 00 00 09 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 e8 0f 00 00 00 00 00 00 e8 0f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 49 00 00 00 00 00 00 10 49 00 00 00 00 00 00 10 49 00 00 00 00 00 00 00 07 00 00 00 00 00 00 70 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 98 4c 00 00 00 00 00 00 98 4c 00 00 00 00 00 00 98 4c 00 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 b0 3e 00 00 00 00 00 00 b0 3e 00 00 00 00 00 00 b0 3e 00 00 00 00 00 00 3c 00 00 00 00 00 00 00 3c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 49 00 00 00 00 00 00 10 49 00 00 00 00 00 00 10 49 00 00 00 00 00 00 f0 06 00 00 00 00 00 00 f0 06 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 d5 e9 f4 5c cf 53 9a 64 55 fb 61 bb cb 10 f7 f8 43 a4 2d cf 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 26 00 00 00 02 00 00 00 07 00 00 00 e0 07 00 2d 10 00 9c 12 10 08 01 00 10 00 18 18 26 00 00 00 28 00 00 00 2c 00 00 00 d0 65 ce 6d 7b 02 b4 34 7c 3a 40 af 3c cc 28 a8 38 f2 8b 1c 8b 84 85 fc 06 5a c0 af b2 a2 f7 12 72 12 be 0f 88 db c4 08 1c ed 63 2a 1a 03 53 3c 33 c4 f7 12}
condition:
      filesize < 70KB and
      8 of them and $magic
}

rule gtfobins_binaries_dc {
   strings:
      $s1 = "%s: Will not attempt to process directory %s" fullword ascii
      $s2 = "%s: Will not attempt to process block-special file %s" fullword ascii
      $s3 = "%s: Will not attempt to process file of unusual type: %s" fullword ascii
      $s4 = "%s: Q command argument exceeded string execution depth" fullword ascii
      $s5 = "%s: square root of nonnumeric attempted" fullword ascii
      $s6 = "%s: Q command requires a number >= 1" fullword ascii
      $s7 = "error reading input" fullword ascii
      $s8 = "error reading stdin" fullword ascii
      $s9 = "Runtime error: " fullword ascii
      $s10 = "Email bug reports to:  bug-dc@gnu.org ." fullword ascii
      $s11 = "%s: square root of negative number" fullword ascii
      $s12 = "%s:%s register " fullword ascii
      $s13 = "%s: input base must be a number between 2 and %d (inclusive)" fullword ascii
      $s14 = "error closing stdout" fullword ascii
      $s15 = "error writing to stdout" fullword ascii
      $s16 = "error flushing stdout" fullword ascii
      $s17 = "%s: Could not fstat file " fullword ascii
      $s18 = "  -f, --file=FILE          evaluate contents of file" fullword ascii
      $s19 = "dc: could not read input file" fullword ascii
      $s20 = "Runtime warning: " fullword ascii
      $s21 = "8466e81a5390865d3ddd3ecdb93a470314dffb.debug" fullword ascii
      $s22 = "Usage: %s [OPTION] [file ...]" fullword ascii
      $s23 = "%s: stack register " fullword ascii
      $s24 = "%s: stack empty" fullword ascii
      $s25 = "%s: unexpected EOS" fullword ascii
      $s26 = "%s: divide by zero" fullword ascii
      $s27 = "%s: non-numeric value" fullword ascii
      $s28 = "%s: BUG: register " fullword ascii
      $s29 = "%s: array index must be a nonnegative integer" fullword ascii
      $s30 = "%s: output base must be a number greater than 1" fullword ascii
      $s31 = "%s: garbage %s" fullword ascii
      $s32 = "%s: remainder by zero" fullword ascii
      $s33 = " unimplemented" fullword ascii
      $s34 = "  -V, --version            output version information and exit" fullword ascii
      $s35 = " is garbage" fullword ascii
      $s36 = "in data being printed" fullword ascii
      $s37 = "in data being pushed" fullword ascii
      $s38 = "dc: could not write output file" fullword ascii
      $s39 = "_bc_shift_addsub" fullword ascii
      $s40 = "number.c" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 10 26 00 00 00 00 00 00 40 00 00 00 00 00 00 00 70 d1 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 88 11 00 00 00 00 00 00 88 11 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 b5 73 00 00 00 00 00 00 b5 73 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 00 a0 00 00 00 00 00 00 8c 22 00 00 00 00 00 00 8c 22 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 cb 00 00 00 00 00 00 d0 db 00 00 00 00 00 00 d0 db 00 00 00 00 00 00 54 04 00 00 00 00 00 00 30 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 80 cc 00 00 00 00 00 00 80 dc 00 00 00 00 00 00 80 dc 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 44 ab 00 00 00 00 00 00 44 ab 00 00 00 00 00 00 44 ab 00 00 00 00 00 00 7c 03 00 00 00 00 00 00 7c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 cb 00 00 00 00 00 00 d0 db 00 00 00 00 00 00 d0 db 00 00 00 00 00 00 30 04 00 00 00 00 00 00 30 04 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 0c 84 66 e8 1a 53 90 86 5d 3d dd 3e cd b9 3a 47 03 14 df fb 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 2f 00 00 00 01 00 00 00 06 00 00 00 00 05 a1 00 80 01 1c 02 2f 00 00 00 31 00 00 00 33 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 2c 01 00 00 12 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_msgattrib {
   strings:
      $s1 = "https://savannah.gnu.org/projects/gettext" fullword ascii
      $s2 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/gettext.debug" fullword ascii
      $s3 = "bug-gettext@gnu.org" fullword ascii
      $s4 = "Report bugs in the bug tracker at <%s>" fullword ascii
      $s5 = "License GPLv3+: GNU GPL version 3 or later <%s>" fullword ascii
      $s6 = "libgettextlib-0.22.5.so" fullword ascii
      $s7 = "libgettextsrc-0.22.5.so" fullword ascii
      $s8 = "or by email to <%s>." fullword ascii
      $s9 = "handle_filepos_comment_option" fullword ascii
      $s10 = "last_component" fullword ascii
      $s11 = "a9a7f193694240d94cd045529daad023c950f5.debug" fullword ascii
      $s12 = "  -V, --version               output version information and exit" fullword ascii
      $s13 = "error_print_progname" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "message_print_style_filepos" fullword ascii
      $s15 = "libtextstyle.so.0" fullword ascii
      $s16 = "a9a7f193694240d94cd045529daad023c950f5" ascii
      $s17 = "clear-obsolete" fullword ascii /* Goodware String - occured 1 times */
      $s18 = "clear-previous" fullword ascii /* Goodware String - occured 1 times */
      $s19 = "Attribute manipulation:" fullword ascii /* Goodware String - occured 1 times */
      $s20 = "only-fuzzy" fullword ascii /* Goodware String - occured 1 times */
      $s21 = "set-obsolete" fullword ascii /* Goodware String - occured 1 times */
      $s22 = "clear-fuzzy" fullword ascii /* Goodware String - occured 1 times */
      $s23 = "set-fuzzy" fullword ascii /* Goodware String - occured 1 times */
      $s24 = "and manipulates the attributes." fullword ascii /* Goodware String - occured 1 times */
      $s25 = "only-obsolete" fullword ascii /* Goodware String - occured 1 times */
      $s26 = "Filters the messages of a translation catalog according to their attributes," fullword ascii /* Goodware String - occured 1 times */
      $s27 = "no-obsolete" fullword ascii /* Goodware String - occured 1 times */
      $s28 = "D:eEFhino:pPsVw:" fullword ascii /* Goodware String - occured 1 times */
      $s29 = "      --force-po              write PO file even if empty" fullword ascii
      $s30 = "      --strict                write out strict Uniforum conforming .po file" fullword ascii
      $s31 = "  -o, --output-file=FILE      write output to specified file" fullword ascii
      $s32 = "      --color                 use colors and other text attributes always" fullword ascii
      $s33 = "  -D, --directory=DIRECTORY   add DIRECTORY to list for input files search" fullword ascii
      $s34 = "      --stringtable-output    write out a NeXTstep/GNUstep .strings file" fullword ascii
      $s35 = "  -s, --sort-output           generate sorted output" fullword ascii
      $s36 = "  -i, --indent                write the .po file using indented style" fullword ascii
      $s37 = "      --no-wrap               do not break long message lines, longer than" fullword ascii
      $s38 = "      --style=STYLEFILE       specify CSS style rule file for --color" fullword ascii
      $s39 = "  -p, --properties-output     write out a Java .properties file" fullword ascii
      $s40 = "  -w, --width=NUMBER          set output page width" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 60 2a 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b8 61 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 38 17 00 00 00 00 00 00 38 17 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 c9 13 00 00 00 00 00 00 c9 13 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 b0 15 00 00 00 00 00 00 b0 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 56 00 00 00 00 00 00 d0 66 00 00 00 00 00 00 d0 66 00 00 00 00 00 00 40 09 00 00 00 00 00 00 b0 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 58 5c 00 00 00 00 00 00 58 6c 00 00 00 00 00 00 58 6c 00 00 00 00 00 00 20 02 00 00 00 00 00 00 20 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 60 54 00 00 00 00 00 00 60 54 00 00 00 00 00 00 60 54 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 56 00 00 00 00 00 00 d0 66 00 00 00 00 00 00 d0 66 00 00 00 00 00 00 30 09 00 00 00 00 00 00 30 09 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 36 a9 a7 f1 93 69 42 40 d9 4c d0 45 52 9d aa d0 23 c9 50 f5 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 2b 00 00 00 02 00 00 00 07 00 00 00 e0 07 00 2d 10 00 9c 12 10 08 01 00 10 00 18 18 2b 00 00 00 2d 00 00 00 31 00 00 00 d0 65 ce 6d 7b 02 b4 34 7c 3a 40 af 3c cc 28 a8 38 f2 8b 1c 8b 84 85 fc 06 5a c0 af b2 a2 f7 12 72 12 be 0f 88 db c4 08 1c ed 63 2a 1a 03 53 3c 33 c4 f7 12}
condition:
      filesize < 80KB and
      8 of them and $magic
}

rule gtfobins_binaries_msfconsole {
   strings:
      $s1 = "  # @see https://github.com/rails/rails/blob/v3.2.17/railties/lib/rails/generators/rails/app/templates/script/rails#L3-L5" fullword ascii
      $s2 = "  require 'metasploit/framework/command/console'" fullword ascii
      $s3 = "# This user interface provides users with a command console interface to the" fullword ascii
      $s4 = "  Metasploit::Framework::Command::Console.start" fullword ascii
      $s5 = "#!/usr/share/metasploit-framework/ruby" fullword ascii
      $s6 = "# -*- coding: binary -*-" fullword ascii
      $s7 = "  Metasploit::Framework::Profiler.start" fullword ascii
      $s8 = "  require 'metasploit/framework/profiler'" fullword ascii
      $s9 = "  # Silences warnings as they only serve to confuse end users" fullword ascii
      $s10 = "# framework." fullword ascii
      $s11 = "  require Pathname.new(__FILE__).realpath.expand_path.parent.join('config', 'boot')" fullword ascii
      $s12 = "  if defined?(Warning) && Warning.respond_to?(:[]=)" fullword ascii
      $s13 = "  exit(1)" fullword ascii
      $s14 = "require 'pathname'" fullword ascii
      $s15 = "  require 'msfenv'" fullword ascii
      $s16 = "rescue Interrupt" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 73 68 61 72 65 2f 6d 65 74 61 73 70 6c 6f 69 74 2d 66 72 61 6d 65 77 6f 72 6b 2f 72 75 62 79 0a 23 20 2d 2a 2d 20 63 6f 64 69 6e 67 3a 20 62 69 6e 61 72 79 20 2d 2a 2d 0a 23 0a 23 20 54 68 69 73 20 75 73 65 72 20 69 6e 74 65 72 66 61 63 65 20 70 72 6f 76 69 64 65 73 20 75 73 65 72 73 20 77 69 74 68 20 61 20 63 6f 6d 6d 61 6e 64 20 63 6f 6e 73 6f 6c 65 20 69 6e 74 65 72 66 61 63 65 20 74 6f 20 74 68 65 0a 23 20 66 72 61 6d 65 77 6f 72 6b 2e 0a 23 0a 0a 72 65 71 75 69 72 65 20 27 70 61 74 68 6e 61 6d 65 27 0a 62 65 67 69 6e 0a 0a 20 20 23 20 53 69 6c 65 6e 63 65 73 20 77 61 72 6e 69 6e 67 73 20 61 73 20 74 68 65 79 20 6f 6e 6c 79 20 73 65 72 76 65 20 74 6f 20 63 6f 6e 66 75 73 65 20 65 6e 64 20 75 73 65 72 73 0a 20 20 69 66 20 64 65 66 69 6e 65 64 3f 28 57 61 72 6e 69 6e 67 29 20 26 26 20 57 61 72 6e 69 6e 67 2e 72 65 73 70 6f 6e 64 5f 74 6f 3f 28 3a 5b 5d 3d 29 0a 20 20 20 20 57 61 72 6e 69 6e 67 5b 3a 64 65 70 72 65 63 61 74 65 64 5d 20 3d 20 66 61 6c 73 65 20 75 6e 6c 65 73 73 20 45 4e 56 5b 27 43 49 27 5d 0a 20 20 65 6e 64 0a 0a 20 20 23 20 40 73 65 65 20 68 74 74 70 73 3a 2f 2f 67 69 74 68 75 62 2e 63 6f 6d 2f 72 61 69 6c 73 2f 72 61 69 6c 73 2f 62 6c 6f 62 2f 76 33 2e 32 2e 31 37 2f 72 61 69 6c 74 69 65 73 2f 6c 69 62 2f 72 61 69 6c 73 2f 67 65 6e 65 72 61 74 6f 72 73 2f 72 61 69 6c 73 2f 61 70 70 2f 74 65 6d 70 6c 61 74 65 73 2f 73 63 72 69 70 74 2f 72 61 69 6c 73 23 4c 33 2d 4c 35 0a 20 20 72 65 71 75 69 72 65 20 50 61 74 68 6e 61 6d 65 2e 6e 65 77 28 5f 5f 46 49 4c 45 5f 5f 29 2e 72 65 61 6c 70 61 74 68 2e 65 78 70 61 6e 64 5f 70 61 74 68 2e 70 61 72 65 6e 74 2e 6a 6f 69 6e 28 27 63 6f 6e 66 69 67 27 2c 20 27 62 6f 6f 74 27 29 0a 20 20 72 65 71 75 69 72 65 20 27 6d 65 74 61 73 70 6c 6f 69 74 2f 66 72 61 6d 65 77 6f 72 6b 2f 70 72 6f 66 69 6c 65 72 27 0a 20 20 4d 65 74 61 73 70 6c 6f 69 74 3a 3a 46 72 61 6d 65 77 6f 72 6b 3a 3a 50 72 6f 66 69 6c 65 72 2e 73 74 61 72 74 0a 0a 20 20 72 65 71 75 69 72 65 20 27 6d 73 66 65 6e 76 27 0a 20 20 72 65 71 75 69 72 65 20 27 6d 65 74 61 73 70 6c 6f 69 74 2f 66 72 61 6d 65 77 6f 72 6b 2f 63 6f 6d 6d 61 6e 64 2f 63 6f 6e 73 6f 6c 65 27 0a 20 20 4d 65 74 61 73 70 6c 6f 69 74 3a 3a 46 72 61 6d 65 77 6f 72 6b 3a 3a 43 6f 6d 6d 61 6e 64 3a 3a 43 6f 6e 73 6f 6c 65 2e 73 74 61 72 74 0a 72 65 73 63 75 65 20 49 6e 74 65 72 72 75 70 74 0a 20 20 70 75 74 73 20 22 5c 6e 41 62 6f 72 74 69 6e 67 2e 2e 2e 22 0a 20 20 65 78 69 74 28 31 29 0a 65 6e 64 0a}
condition:
      filesize < 2KB and
      8 of them and $magic
}

rule gtfobins_binaries_head {
   strings:
      $s1 = "  -n, --lines=[-]NUM       print the first NUM lines instead of the first %d;" fullword ascii
      $s2 = "  -q, --quiet, --silent    never print headers giving file names" fullword ascii
      $s3 = "  -v, --verbose            always print headers giving file names" fullword ascii
      $s4 = "failed to close %s" fullword ascii
      $s5 = "Print the first %d lines of each FILE to standard output." fullword ascii
      $s6 = "diagnose_copy_fd_failure" fullword ascii
      $s7 = "src/head.c" fullword ascii
      $s8 = "bkKmMGTPEZYRQ0" fullword ascii
      $s9 = "NUM may have a multiplier suffix:" fullword ascii
      $s10 = "invalid trailing option -- %c" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "-presume-input-pipe" fullword ascii /* Goodware String - occured 2 times */
      $s12 = "  -z, --zero-terminated    line delimiter is NUL, not newline" fullword ascii
      $s13 = "Binary prefixes can be used, too: KiB=K, MiB=M, and so on." fullword ascii
      $s14 = "%s: cannot seek to relative offset %s" fullword ascii /* Goodware String - occured 2 times */
      $s15 = "  -c, --bytes=[-]NUM       print the first NUM bytes of each file;" fullword ascii
      $s16 = "%s: file has shrunk too much" fullword ascii /* Goodware String - occured 2 times */
      $s17 = "b 512, kB 1000, K 1024, MB 1000*1000, M 1024*1024," fullword ascii /* Goodware String - occured 3 times */
      $s18 = "%s: cannot seek to offset %s" fullword ascii /* Goodware String - occured 4 times */
      $s19 = "GB 1000*1000*1000, G 1024*1024*1024, and so on for T, P, E, Z, Y, R, Q." fullword ascii
      $s20 = "invalid number of bytes" fullword ascii /* Goodware String - occured 4 times */
      $s21 = "With more than one FILE, precede each with a header giving the file name." fullword ascii /* Goodware String - occured 4 times */
      $s22 = "invalid number of lines" fullword ascii /* Goodware String - occured 4 times */
      $s23 = "error writing %s" fullword ascii /* Goodware String - occured 4 times */
      $s24 = "%s==> %s <==" fullword ascii /* Goodware String - occured 4 times */
      $s25 = "H9l$XH" fullword ascii /* Goodware String - occured 4 times */
      $s26 = "c:n:qvz0123456789" fullword ascii
      $s27 = "b47908c0a80ace4b153680b5c814a338ca7cff.debug" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 30 34 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 c4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 68 17 00 00 00 00 00 00 68 17 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 99 60 00 00 00 00 00 00 99 60 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 00 90 00 00 00 00 00 00 00 27 00 00 00 00 00 00 00 27 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 10 bc 00 00 00 00 00 00 10 cc 00 00 00 00 00 00 10 cc 00 00 00 00 00 00 50 06 00 00 00 00 00 00 10 08 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 bd 00 00 00 00 00 00 d8 cd 00 00 00 00 00 00 d8 cd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 34 a2 00 00 00 00 00 00 34 a2 00 00 00 00 00 00 34 a2 00 00 00 00 00 00 7c 03 00 00 00 00 00 00 7c 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 10 bc 00 00 00 00 00 00 10 cc 00 00 00 00 00 00 10 cc 00 00 00 00 00 00 f0 03 00 00 00 00 00 00 f0 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 8a b4 79 08 c0 a8 0a ce 4b 15 36 80 b5 c8 14 a3 38 ca 7c ff 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 3c 00 00 00 01 00 00 00 06 00 00 00 04 4d c1 00 20 01 1c 12 3c 00 00 00 3e 00 00 00 43 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 200KB and
      8 of them and $magic
}

rule gtfobins_binaries_xdg_user_dir {
   strings:
      $s1 = "test -f ${XDG_CONFIG_HOME:-~/.config}/user-dirs.dirs && . ${XDG_CONFIG_HOME:-~/.config}/user-dirs.dirs" fullword ascii
      $s2 = "if [ \"x$1\" = \"xDESKTOP\" ]; then" fullword ascii
      $s3 = "  eval echo \\${XDG_${1}_DIR:-$HOME}" fullword ascii
      $s4 = "  eval echo \\${XDG_${1}_DIR:-$HOME/Desktop}" fullword ascii
      $s5 = "#!/bin/sh" fullword ascii /* Goodware String - occured 3 times */
      $magic = {23 21 2f 62 69 6e 2f 73 68 0a 0a 74 65 73 74 20 2d 66 20 24 7b 58 44 47 5f 43 4f 4e 46 49 47 5f 48 4f 4d 45 3a 2d 7e 2f 2e 63 6f 6e 66 69 67 7d 2f 75 73 65 72 2d 64 69 72 73 2e 64 69 72 73 20 26 26 20 2e 20 24 7b 58 44 47 5f 43 4f 4e 46 49 47 5f 48 4f 4d 45 3a 2d 7e 2f 2e 63 6f 6e 66 69 67 7d 2f 75 73 65 72 2d 64 69 72 73 2e 64 69 72 73 0a 69 66 20 5b 20 22 78 24 31 22 20 3d 20 22 78 44 45 53 4b 54 4f 50 22 20 5d 3b 20 74 68 65 6e 0a 20 20 65 76 61 6c 20 65 63 68 6f 20 5c 24 7b 58 44 47 5f 24 7b 31 7d 5f 44 49 52 3a 2d 24 48 4f 4d 45 2f 44 65 73 6b 74 6f 70 7d 0a 65 6c 73 65 0a 20 20 65 76 61 6c 20 65 63 68 6f 20 5c 24 7b 58 44 47 5f 24 7b 31 7d 5f 44 49 52 3a 2d 24 48 4f 4d 45 7d 0a 66 69 0a}
condition:
      filesize < 1KB and
      all of them
}

rule gtfobins_binaries_basez {
   strings:
      $s1 = "Base32 encoded stream is a multiple of eight-character blocks consisting of " fullword ascii
      $s2 = "Base64mime and base64pem are the same encodes as base64 but with encoded " fullword ascii
      $s3 = "out and typed in by humans. If needed, the last encoded block is padded " fullword ascii
      $s4 = "Base64 encoded stream is a multiple of four-character blocks using " fullword ascii
      $s5 = "character-set [0-9a-v] to preserve the encoded data sort order. " fullword ascii
      $s6 = "or transport over -- any medium or data transport mechanism, including " fullword ascii
      $s7 = "Creative Commons Attribution-ShareAlike license version 3 or a later" fullword ascii
      $s8 = "   -e  --base32hex  Base32hex coding. Default for base32hex command." fullword ascii
      $s9 = "end of the encoded steam can be avoided by encoding data of size divisible " fullword ascii
      $s10 = "version as published by the Creative Commons Corporation." fullword ascii
      $s11 = "the padding character [=] in the encoded stream can be avoided by encoding " fullword ascii
      $s12 = "encoded data. Decoding is case insensitive." fullword ascii
      $s13 = "Inspect output of a command:" fullword ascii
      $s14 = "These commands are parts of the BaseZ software package." fullword ascii
      $s15 = "are skipped intentionally to make this encoding suitable for storage on -- " fullword ascii
      $s16 = "When no FILE is specified or when FILE is -, read standard input. " fullword ascii
      $s17 = "                    Set encoded stream line length limit to N characters. " fullword ascii
      $s18 = "                    encoded stream, set to 0." fullword ascii
      $s19 = "   -p, --base64pem  PEM printable coding. Default for base64pem command." fullword ascii
      $s20 = "stream per RFC 4648; MIME base64 Content-Transfer-Encoding per RFC 2045; " fullword ascii
      $s21 = "   -u, --base64url  Base64url coding. Default for base64url command." fullword ascii
      $s22 = "Report bugs to <bug-basez@quarkline.net> with a 'bug:' somewhere in the subject line." fullword ascii
      $s23 = "%s: %s: invalid value" fullword ascii
      $s24 = "%s: %s: invalid argument" fullword ascii
      $s25 = "%s: %s: invalid option" fullword ascii
      $s26 = "   -w N, -b N, --wrap=N, --break=N" fullword ascii
      $s27 = "Software Foundation. User documentation is alternatively licensed under the" fullword ascii
      $s28 = "MIME base64 encode a binary file to stdout per RFC 2045:" fullword ascii
      $s29 = "                    unhex commands." fullword ascii
      $s30 = "                    MIME base64 coding. Default for base64mime command." fullword ascii
      $s31 = "   -o FILEOUT, --output=FILEOUT" fullword ascii
      $s32 = "                    commands." fullword ascii
      $s33 = "                    base64plain commands." fullword ascii
      $s34 = "terms of the GNU GPL version 3 or any later version as published by the Free" fullword ascii
      $s35 = "This program comes with ABSOLUTELY NO WARRANTY; not even for MERCHANTABILITY" fullword ascii
      $s36 = "   -i FILEIN, --input=FILEIN" fullword ascii
      $s37 = "                    Default option for unhex command." fullword ascii
      $s38 = "%s: invalid input" fullword ascii
      $s39 = "BaseZ encodes/decodes base16, base32, base32hex, base64 or base64url data " fullword ascii
      $s40 = "Base16 decode a string:" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 f0 22 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f0 81 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 0b 00 00 00 00 00 00 10 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 6d 39 00 00 00 00 00 00 6d 39 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 dc 27 00 00 00 00 00 00 dc 27 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 7d 00 00 00 00 00 00 d0 8d 00 00 00 00 00 00 d0 8d 00 00 00 00 00 00 dc 02 00 00 00 00 00 00 90 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 7d 00 00 00 00 00 00 e0 8d 00 00 00 00 00 00 e0 8d 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 44 73 00 00 00 00 00 00 44 73 00 00 00 00 00 00 44 73 00 00 00 00 00 00 e4 00 00 00 00 00 00 00 e4 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 7d 00 00 00 00 00 00 d0 8d 00 00 00 00 00 00 d0 8d 00 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 04 06 66 c7 45 bc 92 18 9c 6d d0 7c 1a 66 32 01 3f 64 7d c3 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 17 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 17 00 00 00 19 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 7b 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_valgrind {
   strings:
      $s1 = "# Use 'exec' to avoid having another shell process hanging around." fullword ascii
      $s2 = "exec $0.bin \"$@\"" fullword ascii
      $s3 = "if [ -z \"$LD_LIBRARY_PATH\" ]; then" fullword ascii
      $s4 = "# Force C++ STL to use malloc and to free memory by disabling " fullword ascii
      $s5 = "# For gcc >= 3.4 versions" fullword ascii
      $s6 = "# For gcc < 3.4 versions" fullword ascii
      $s7 = "# Default Debian debug libraries." fullword ascii
      $s8 = "# Use debug libraries if found." fullword ascii
      $s9 = "#!/bin/sh -e" fullword ascii
      $s10 = "# Valgrind wrapper" fullword ascii
      $s11 = "export GLIBCXX_FORCE_NEW=1" fullword ascii
      $s12 = "export LD_LIBRARY_PATH=\"$LD_LIBRARY_PATH:$DBGPATH\"" fullword ascii
      $s13 = "export GLIBCPP_FORCE_NEW=1" fullword ascii
      $s14 = "export LD_LIBRARY_PATH=\"$DBGPATH\"" fullword ascii
      $s15 = "# memory caching." fullword ascii
      $s16 = "DBGPATH=/usr/lib/debug" fullword ascii
      $magic = {23 21 2f 62 69 6e 2f 73 68 20 2d 65 0a 23 0a 23 20 56 61 6c 67 72 69 6e 64 20 77 72 61 70 70 65 72 0a 0a 23 20 44 65 66 61 75 6c 74 20 44 65 62 69 61 6e 20 64 65 62 75 67 20 6c 69 62 72 61 72 69 65 73 2e 0a 44 42 47 50 41 54 48 3d 2f 75 73 72 2f 6c 69 62 2f 64 65 62 75 67 0a 0a 23 20 55 73 65 20 64 65 62 75 67 20 6c 69 62 72 61 72 69 65 73 20 69 66 20 66 6f 75 6e 64 2e 0a 69 66 20 5b 20 2d 7a 20 22 24 4c 44 5f 4c 49 42 52 41 52 59 5f 50 41 54 48 22 20 5d 3b 20 74 68 65 6e 0a 09 65 78 70 6f 72 74 20 4c 44 5f 4c 49 42 52 41 52 59 5f 50 41 54 48 3d 22 24 44 42 47 50 41 54 48 22 0a 65 6c 73 65 0a 09 65 78 70 6f 72 74 20 4c 44 5f 4c 49 42 52 41 52 59 5f 50 41 54 48 3d 22 24 4c 44 5f 4c 49 42 52 41 52 59 5f 50 41 54 48 3a 24 44 42 47 50 41 54 48 22 0a 66 69 0a 0a 23 20 46 6f 72 63 65 20 43 2b 2b 20 53 54 4c 20 74 6f 20 75 73 65 20 6d 61 6c 6c 6f 63 20 61 6e 64 20 74 6f 20 66 72 65 65 20 6d 65 6d 6f 72 79 20 62 79 20 64 69 73 61 62 6c 69 6e 67 20 0a 23 20 6d 65 6d 6f 72 79 20 63 61 63 68 69 6e 67 2e 0a 23 20 46 6f 72 20 67 63 63 20 3c 20 33 2e 34 20 76 65 72 73 69 6f 6e 73 0a 65 78 70 6f 72 74 20 47 4c 49 42 43 50 50 5f 46 4f 52 43 45 5f 4e 45 57 3d 31 0a 0a 23 20 46 6f 72 20 67 63 63 20 3e 3d 20 33 2e 34 20 76 65 72 73 69 6f 6e 73 0a 65 78 70 6f 72 74 20 47 4c 49 42 43 58 58 5f 46 4f 52 43 45 5f 4e 45 57 3d 31 0a 0a 23 20 55 73 65 20 27 65 78 65 63 27 20 74 6f 20 61 76 6f 69 64 20 68 61 76 69 6e 67 20 61 6e 6f 74 68 65 72 20 73 68 65 6c 6c 20 70 72 6f 63 65 73 73 20 68 61 6e 67 69 6e 67 20 61 72 6f 75 6e 64 2e 0a 65 78 65 63 20 24 30 2e 62 69 6e 20 22 24 40 22 0a}
condition:
      filesize < 1KB and
      8 of them and $magic
}

rule gtfobins_binaries_paste {
   strings:
      $s1 = "serial" fullword ascii /* Goodware String - occured 168 times */
      $s2 = "W(H;W0" fullword ascii /* Goodware String - occured 1 times */
      $s3 = "A(H;A0" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "delimiter list ends with an unescaped backslash: %s" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "  -z, --zero-terminated    line delimiter is NUL, not newline" fullword ascii
      $s6 = "standard input is closed" fullword ascii /* Goodware String - occured 2 times */
      $s7 = "  -s, --serial            paste one file at a time instead of in parallel" fullword ascii
      $s8 = "each FILE, separated by TABs, to standard output." fullword ascii /* Goodware String - occured 2 times */
      $s9 = "Write lines consisting of the sequentially corresponding lines from" fullword ascii /* Goodware String - occured 2 times */
      $s10 = "  -d, --delimiters=LIST   reuse characters from LIST instead of TABs" fullword ascii
      $s11 = "David M. Ihnat" fullword ascii /* Goodware String - occured 3 times */
      $s12 = "O(H;O0sAH" fullword ascii
      $s13 = "W(H;W0r" fullword ascii
      $s14 = "ba4da5021ec3b0caf1a2359f62cfd5a6e21104.debug" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 10 27 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 a4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f0 16 00 00 00 00 00 00 f0 16 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 c9 4d 00 00 00 00 00 00 c9 4d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 a0 1f 00 00 00 00 00 00 a0 1f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 9c 00 00 00 00 00 00 b0 9c 00 00 00 00 00 00 b0 9c 00 00 00 00 00 00 b0 05 00 00 00 00 00 00 70 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 9d 00 00 00 00 00 00 d8 9d 00 00 00 00 00 00 d8 9d 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 50 7d 00 00 00 00 00 00 50 7d 00 00 00 00 00 00 50 7d 00 00 00 00 00 00 34 03 00 00 00 00 00 00 34 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 9c 00 00 00 00 00 00 b0 9c 00 00 00 00 00 00 b0 9c 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 1f ba 4d a5 02 1e c3 b0 ca f1 a2 35 9f 62 cf d5 a6 e2 11 04 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 3b 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 3b 00 00 00 3d 00 00 00 43 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_apt {
   strings:
      $s1 = "_Z10DoDownloadR11CommandLine" fullword ascii
      $s2 = "Usage: apt [options] command" fullword ascii
      $s3 = "_Z11DoChangelogR11CommandLine" fullword ascii
      $s4 = "_Z16ParseCommandLineR11CommandLine7APT_CMDPKP13ConfigurationPP9pkgSystemiPPKcPFbS0_EPFSt6vectorI19aptDispatchWithHelpSaISF_EEvE" fullword ascii
      $s5 = "apt is a commandline package manager and provides commands for" fullword ascii
      $s6 = "changelog" fullword ascii
      $s7 = "_Z11ShowPackageR11CommandLine" fullword ascii
      $s8 = "_Z8DoSearchR11CommandLine" fullword ascii
      $s9 = "_Z7DoCleanR11CommandLine" fullword ascii
      $s10 = "_ZN11CommandLineC1Ev" fullword ascii
      $s11 = "search in package descriptions" fullword ascii
      $s12 = "_Z11DoDistCleanR11CommandLine" fullword ascii
      $s13 = "_ZN11CommandLineD1Ev" fullword ascii
      $s14 = "_Z14ShowSrcPackageR11CommandLine" fullword ascii
      $s15 = "_Z8DoUpdateR11CommandLine" fullword ascii
      $s16 = "_Z6DoListR11CommandLine" fullword ascii
      $s17 = "_Z19CheckIfSimulateModeR11CommandLine" fullword ascii
      $s18 = "_Z8DoSourceR11CommandLine" fullword ascii
      $s19 = "_Z10DoBuildDepR11CommandLine" fullword ascii
      $s20 = "_Z8RDependsR11CommandLine" fullword ascii
      $s21 = "_Z11DoAutoCleanR11CommandLine" fullword ascii
      $s22 = "_Z5DoMooR11CommandLine" fullword ascii
      $s23 = "_Z9DoUpgradeR11CommandLine" fullword ascii
      $s24 = "_Z13DoDistUpgradeR11CommandLine" fullword ascii
      $s25 = "_Z19DispatchCommandLineR11CommandLineRKSt6vectorINS_8DispatchESaIS2_EE" fullword ascii
      $s26 = "_Z11EditSourcesR11CommandLine" fullword ascii
      $s27 = "_Z9DoInstallR11CommandLine" fullword ascii
      $s28 = "_Z6PolicyR11CommandLine" fullword ascii
      $s29 = "_Z7DependsR11CommandLine" fullword ascii
      $s30 = "autoremove" fullword ascii
      $s31 = "rdepends" fullword ascii
      $s32 = "distclean" fullword ascii
      $s33 = "showsrc" fullword ascii
      $s34 = "autopurge" fullword ascii
      $s35 = "upgrade the system by installing/upgrading packages" fullword ascii
      $s36 = "upgrade the system by removing/installing/upgrading packages" fullword ascii
      $s37 = "libapt-private.so.0.0" fullword ascii
      $s38 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/apt.debug" fullword ascii
      $s39 = "_ZN13Configuration6CndSetEPKci" fullword ascii
      $s40 = "APTPRIVATE_0.0" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 50 23 00 00 00 00 00 00 40 00 00 00 00 00 00 00 c0 41 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 38 15 00 00 00 00 00 00 38 15 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 b5 0a 00 00 00 00 00 00 b5 0a 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 00 30 00 00 00 00 00 00 fa 05 00 00 00 00 00 00 fa 05 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 38 3c 00 00 00 00 00 00 38 4c 00 00 00 00 00 00 38 4c 00 00 00 00 00 00 e0 03 00 00 00 00 00 00 68 05 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 48 3c 00 00 00 00 00 00 48 4c 00 00 00 00 00 00 48 4c 00 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 e4 33 00 00 00 00 00 00 e4 33 00 00 00 00 00 00 e4 33 00 00 00 00 00 00 4c 00 00 00 00 00 00 00 4c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 38 3c 00 00 00 00 00 00 38 4c 00 00 00 00 00 00 38 4c 00 00 00 00 00 00 c8 03 00 00 00 00 00 00 c8 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 49 3f ce 0b 31 05 ab 81 a6 dd 3b b3 a1 7b 95 fb 20 e6 b7 c1 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 2e 00 00 00 01 00 00 00 06 00 00 00 04 02 91 00 09 00 00 04 2e 00 00 00 2f 00 00 00 31 00 00 00 d1 65 ce 6d c8 08 ac a9 bb 90 a1 83 15 98 0c 43 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ea 02 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 50KB and
      8 of them and $magic
}

rule gtfobins_binaries_jrunscript {
   strings:
      $s1 = "java.scripting/com.sun.tools.script.shell.Main" fullword ascii
      $s2 = "JLI_InitArgProcessing" fullword ascii
      $s3 = "JLI_PreprocessArg" fullword ascii
      $s4 = "jrunscript" fullword ascii
      $s5 = "jrunscript.debuginfo" fullword ascii
      $s6 = "NOTE: Picked up %s: %s" fullword ascii
      $s7 = "11.0.25-ea+5-post-Debian-1" fullword ascii
      $s8 = "openjdk" fullword ascii
      $s9 = "JLI_StringDup" fullword ascii
      $s10 = "JLI_MemFree" fullword ascii
      $s11 = "-J--add-modules" fullword ascii
      $s12 = "JDK_JAVA_OPTIONS" fullword ascii
      $s13 = "JLI_List_add" fullword ascii
      $s14 = "JLI_List_new" fullword ascii
      $s15 = "JLI_AddArgsFromEnvVar" fullword ascii
      $s16 = "-JALL-DEFAULT" fullword ascii
      $s17 = "libjli.so" fullword ascii
      $s18 = "JLI_ReportMessage" fullword ascii /* Goodware String - occured 2 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 12 00 00 00 00 00 00 40 00 00 00 00 00 00 00 70 31 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b8 09 00 00 00 00 00 00 b8 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 85 03 00 00 00 00 00 00 85 03 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 bc 01 00 00 00 00 00 00 bc 01 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 2d 00 00 00 00 00 00 30 3d 00 00 00 00 00 00 30 3d 00 00 00 00 00 00 18 03 00 00 00 00 00 00 20 03 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 40 2d 00 00 00 00 00 00 40 3d 00 00 00 00 00 00 40 3d 00 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d0 20 00 00 00 00 00 00 d0 20 00 00 00 00 00 00 d0 20 00 00 00 00 00 00 2c 00 00 00 00 00 00 00 2c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 2d 00 00 00 00 00 00 30 3d 00 00 00 00 00 00 30 3d 00 00 00 00 00 00 d0 02 00 00 00 00 00 00 d0 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 dc b4 59 87 ff f4 be 45 bc f7 31 96 b8 b8 22 c2 9d c2 b2 d6 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 16 00 00 00 10 00 00 00 00 00 00 00 00 00 00 00 04 00 00 00 0f 00 00 00 06 00 00 00 08 00 00 00 00 00 00 00 0e 00 00 00 05 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0d 00 00 00 0b 00 00 00 02 00 00 00 07 00 00 00 01 00 00 00 0c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0a 00 00 00}
condition:
      filesize < 40KB and
      8 of them and $magic
}

rule gtfobins_binaries_jjs {
   strings:
      $s1 = "jdk.scripting.nashorn.shell/jdk.nashorn.tools.jjs.Main" fullword ascii
      $s2 = "JLI_InitArgProcessing" fullword ascii
      $s3 = "JLI_PreprocessArg" fullword ascii
      $s4 = "NOTE: Picked up %s: %s" fullword ascii
      $s5 = "11.0.25-ea+5-post-Debian-1" fullword ascii
      $s6 = "openjdk" fullword ascii
      $s7 = "jjs.debuginfo" fullword ascii
      $s8 = "JLI_StringDup" fullword ascii
      $s9 = "JLI_MemFree" fullword ascii
      $s10 = "-J--add-modules" fullword ascii
      $s11 = "JDK_JAVA_OPTIONS" fullword ascii
      $s12 = "JLI_List_add" fullword ascii
      $s13 = "JLI_List_new" fullword ascii
      $s14 = "JLI_AddArgsFromEnvVar" fullword ascii
      $s15 = "-JALL-DEFAULT" fullword ascii
      $s16 = "libjli.so" fullword ascii
      $s17 = "JLI_ReportMessage" fullword ascii /* Goodware String - occured 2 times */
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 12 00 00 00 00 00 00 40 00 00 00 00 00 00 00 68 31 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b8 09 00 00 00 00 00 00 b8 09 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 85 03 00 00 00 00 00 00 85 03 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 bc 01 00 00 00 00 00 00 bc 01 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 30 2d 00 00 00 00 00 00 30 3d 00 00 00 00 00 00 30 3d 00 00 00 00 00 00 18 03 00 00 00 00 00 00 20 03 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 40 2d 00 00 00 00 00 00 40 3d 00 00 00 00 00 00 40 3d 00 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 d0 20 00 00 00 00 00 00 d0 20 00 00 00 00 00 00 d0 20 00 00 00 00 00 00 2c 00 00 00 00 00 00 00 2c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 30 2d 00 00 00 00 00 00 30 3d 00 00 00 00 00 00 30 3d 00 00 00 00 00 00 d0 02 00 00 00 00 00 00 d0 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 ce 0e 6c 92 48 98 18 d7 b2 6f fc 8b b2 f1 0f 3b a5 08 61 65 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 16 00 00 00 10 00 00 00 00 00 00 00 00 00 00 00 04 00 00 00 0f 00 00 00 06 00 00 00 08 00 00 00 00 00 00 00 0e 00 00 00 05 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0d 00 00 00 0b 00 00 00 02 00 00 00 07 00 00 00 01 00 00 00 0c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 0a 00 00 00}
condition:
      filesize < 40KB and
      8 of them and $magic
}

rule gtfobins_binaries_tee {
   strings:
      $s1 = "The default MODE for the -p option is 'warn-nopipe'." fullword ascii
      $s2 = "  -p                        operate in a more appropriate MODE with pipes." fullword ascii
      $s3 = "The default operation when --output-error is not specified, is to" fullword ascii
      $s4 = "exit immediately on error writing to a pipe, and diagnose errors" fullword ascii
      $s5 = "warn-nopipe" fullword ascii
      $s6 = "With \"nopipe\" MODEs, exit immediately if all outputs become broken pipes." fullword ascii
      $s7 = "exit-nopipe" fullword ascii
      $s8 = "writing to non pipe outputs." fullword ascii
      $s9 = "iopoll error" fullword ascii
      $s10 = "fdin != -1 || fdout != -1" fullword ascii
      $s11 = "  exit-nopipe    exit on error writing to any output not a pipe" fullword ascii
      $s12 = "  warn-nopipe    diagnose errors writing to any output not a pipe" fullword ascii
      $s13 = "--output-error" fullword ascii
      $s14 = "MODE determines behavior with write errors on the outputs:" fullword ascii
      $s15 = "      --output-error[=MODE]   set behavior on write error.  See MODE below" fullword ascii
      $s16 = "src/iopoll.c" fullword ascii
      $s17 = "iopoll_internal" fullword ascii
      $s18 = "  warn           diagnose errors writing to any output" fullword ascii
      $s19 = "  exit           exit on error writing to any output" fullword ascii
      $s20 = "fwrite_wait" fullword ascii
      $s21 = "6b5cd7e98cb7f3c0604300b08f065798023ed3.debug" fullword ascii
      $s22 = "  -a, --append              append to the given FILEs, do not overwrite" fullword ascii
      $s23 = "ignore-interrupts" fullword ascii /* Goodware String - occured 2 times */
      $s24 = "Copy standard input to each FILE, and also to standard output." fullword ascii /* Goodware String - occured 2 times */
      $s25 = "  -i, --ignore-interrupts   ignore interrupt signals" fullword ascii
      $s26 = "0 < ret" fullword ascii
      $s27 = "6b5cd7e98cb7f3c0604300b08f065798023ed3" ascii
      $s28 = "b08f065798023ed3" ascii
      $s29 = "6b5cd7e98cb7f3c06043" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 26 00 00 00 00 00 00 40 00 00 00 00 00 00 00 30 b4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a0 18 00 00 00 00 00 00 a0 18 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 19 55 00 00 00 00 00 00 19 55 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 00 80 00 00 00 00 00 00 b8 25 00 00 00 00 00 00 b8 25 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 70 ac 00 00 00 00 00 00 70 bc 00 00 00 00 00 00 70 bc 00 00 00 00 00 00 10 06 00 00 00 00 00 00 d8 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 ad 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 d8 bd 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 90 8f 00 00 00 00 00 00 90 8f 00 00 00 00 00 00 90 8f 00 00 00 00 00 00 b4 03 00 00 00 00 00 00 b4 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 70 ac 00 00 00 00 00 00 70 bc 00 00 00 00 00 00 70 bc 00 00 00 00 00 00 90 03 00 00 00 00 00 00 90 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 9f 6b 5c d7 e9 8c b7 f3 c0 60 43 00 b0 8f 06 57 98 02 3e d3 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 40 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 40 00 00 00 42 00 00 00 48 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_byebug {
   strings:
      $s1 = "# this file is here to facilitate running it." fullword ascii
      $s2 = "load Gem.activate_bin_path('byebug', 'byebug', version)" fullword ascii
      $s3 = "load Gem.bin_path(\"byebug\", \"byebug\", version)" fullword ascii
      $s4 = "# This file was generated by RubyGems." fullword ascii
      $s5 = "Gem.use_gemdeps" fullword ascii
      $s6 = "gem \"byebug\", version" fullword ascii
      $s7 = "if Gem.respond_to?(:activate_bin_path)" fullword ascii
      $s8 = "  if str and Gem::Version.correct?(str)" fullword ascii
      $s9 = "version = \">= 0.a\"" fullword ascii
      $s10 = "str = ARGV.first" fullword ascii
      $s11 = "# The application 'byebug' is installed as part of a gem, and" fullword ascii
      $s12 = "require 'rubygems'" fullword ascii
      $s13 = "if str" fullword ascii
      $s14 = "    version = str" fullword ascii
      $s15 = "  str = str.b[/\\A_(.*)_\\z/, 1]" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 72 75 62 79 0a 23 0a 23 20 54 68 69 73 20 66 69 6c 65 20 77 61 73 20 67 65 6e 65 72 61 74 65 64 20 62 79 20 52 75 62 79 47 65 6d 73 2e 0a 23 0a 23 20 54 68 65 20 61 70 70 6c 69 63 61 74 69 6f 6e 20 27 62 79 65 62 75 67 27 20 69 73 20 69 6e 73 74 61 6c 6c 65 64 20 61 73 20 70 61 72 74 20 6f 66 20 61 20 67 65 6d 2c 20 61 6e 64 0a 23 20 74 68 69 73 20 66 69 6c 65 20 69 73 20 68 65 72 65 20 74 6f 20 66 61 63 69 6c 69 74 61 74 65 20 72 75 6e 6e 69 6e 67 20 69 74 2e 0a 23 0a 0a 72 65 71 75 69 72 65 20 27 72 75 62 79 67 65 6d 73 27 0a 0a 47 65 6d 2e 75 73 65 5f 67 65 6d 64 65 70 73 0a 0a 76 65 72 73 69 6f 6e 20 3d 20 22 3e 3d 20 30 2e 61 22 0a 0a 73 74 72 20 3d 20 41 52 47 56 2e 66 69 72 73 74 0a 69 66 20 73 74 72 0a 20 20 73 74 72 20 3d 20 73 74 72 2e 62 5b 2f 5c 41 5f 28 2e 2a 29 5f 5c 7a 2f 2c 20 31 5d 0a 20 20 69 66 20 73 74 72 20 61 6e 64 20 47 65 6d 3a 3a 56 65 72 73 69 6f 6e 2e 63 6f 72 72 65 63 74 3f 28 73 74 72 29 0a 20 20 20 20 76 65 72 73 69 6f 6e 20 3d 20 73 74 72 0a 20 20 20 20 41 52 47 56 2e 73 68 69 66 74 0a 20 20 65 6e 64 0a 65 6e 64 0a 0a 69 66 20 47 65 6d 2e 72 65 73 70 6f 6e 64 5f 74 6f 3f 28 3a 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 29 0a 6c 6f 61 64 20 47 65 6d 2e 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 28 27 62 79 65 62 75 67 27 2c 20 27 62 79 65 62 75 67 27 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6c 73 65 0a 67 65 6d 20 22 62 79 65 62 75 67 22 2c 20 76 65 72 73 69 6f 6e 0a 6c 6f 61 64 20 47 65 6d 2e 62 69 6e 5f 70 61 74 68 28 22 62 79 65 62 75 67 22 2c 20 22 62 79 65 62 75 67 22 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6e 64 0a}
condition:
      filesize < 1KB and
      8 of them and $magic
}

rule gtfobins_binaries_pry {
   strings:
      $s1 = "# this file is here to facilitate running it." fullword ascii
      $s2 = "load Gem.activate_bin_path('pry', 'pry', version)" fullword ascii
      $s3 = "load Gem.bin_path(\"pry\", \"pry\", version)" fullword ascii
      $s4 = "# This file was generated by RubyGems." fullword ascii
      $s5 = "Gem.use_gemdeps" fullword ascii
      $s6 = "if Gem.respond_to?(:activate_bin_path)" fullword ascii
      $s7 = "  if str and Gem::Version.correct?(str)" fullword ascii
      $s8 = "version = \">= 0.a\"" fullword ascii
      $s9 = "gem \"pry\", version" fullword ascii
      $s10 = "str = ARGV.first" fullword ascii
      $s11 = "require 'rubygems'" fullword ascii
      $s12 = "# The application 'pry' is installed as part of a gem, and" fullword ascii
      $s13 = "if str" fullword ascii
      $s14 = "    version = str" fullword ascii
      $s15 = "  str = str.b[/\\A_(.*)_\\z/, 1]" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 72 75 62 79 0a 23 0a 23 20 54 68 69 73 20 66 69 6c 65 20 77 61 73 20 67 65 6e 65 72 61 74 65 64 20 62 79 20 52 75 62 79 47 65 6d 73 2e 0a 23 0a 23 20 54 68 65 20 61 70 70 6c 69 63 61 74 69 6f 6e 20 27 70 72 79 27 20 69 73 20 69 6e 73 74 61 6c 6c 65 64 20 61 73 20 70 61 72 74 20 6f 66 20 61 20 67 65 6d 2c 20 61 6e 64 0a 23 20 74 68 69 73 20 66 69 6c 65 20 69 73 20 68 65 72 65 20 74 6f 20 66 61 63 69 6c 69 74 61 74 65 20 72 75 6e 6e 69 6e 67 20 69 74 2e 0a 23 0a 0a 72 65 71 75 69 72 65 20 27 72 75 62 79 67 65 6d 73 27 0a 0a 47 65 6d 2e 75 73 65 5f 67 65 6d 64 65 70 73 0a 0a 76 65 72 73 69 6f 6e 20 3d 20 22 3e 3d 20 30 2e 61 22 0a 0a 73 74 72 20 3d 20 41 52 47 56 2e 66 69 72 73 74 0a 69 66 20 73 74 72 0a 20 20 73 74 72 20 3d 20 73 74 72 2e 62 5b 2f 5c 41 5f 28 2e 2a 29 5f 5c 7a 2f 2c 20 31 5d 0a 20 20 69 66 20 73 74 72 20 61 6e 64 20 47 65 6d 3a 3a 56 65 72 73 69 6f 6e 2e 63 6f 72 72 65 63 74 3f 28 73 74 72 29 0a 20 20 20 20 76 65 72 73 69 6f 6e 20 3d 20 73 74 72 0a 20 20 20 20 41 52 47 56 2e 73 68 69 66 74 0a 20 20 65 6e 64 0a 65 6e 64 0a 0a 69 66 20 47 65 6d 2e 72 65 73 70 6f 6e 64 5f 74 6f 3f 28 3a 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 29 0a 6c 6f 61 64 20 47 65 6d 2e 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 28 27 70 72 79 27 2c 20 27 70 72 79 27 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6c 73 65 0a 67 65 6d 20 22 70 72 79 22 2c 20 76 65 72 73 69 6f 6e 0a 6c 6f 61 64 20 47 65 6d 2e 62 69 6e 5f 70 61 74 68 28 22 70 72 79 22 2c 20 22 70 72 79 22 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6e 64 0a}
condition:
      filesize < 1KB and
      8 of them and $magic
}

rule gtfobins_binaries_irb {
   strings:
      $s1 = "# this file is here to facilitate running it." fullword ascii
      $s2 = "load Gem.activate_bin_path('irb', 'irb', version)" fullword ascii
      $s3 = "load Gem.bin_path(\"irb\", \"irb\", version)" fullword ascii
      $s4 = "# This file was generated by RubyGems." fullword ascii
      $s5 = "Gem.use_gemdeps" fullword ascii
      $s6 = "if Gem.respond_to?(:activate_bin_path)" fullword ascii
      $s7 = "  if str and Gem::Version.correct?(str)" fullword ascii
      $s8 = "version = \">= 0.a\"" fullword ascii
      $s9 = "gem \"irb\", version" fullword ascii
      $s10 = "#!/usr/bin/ruby3.1" fullword ascii
      $s11 = "str = ARGV.first" fullword ascii
      $s12 = "require 'rubygems'" fullword ascii
      $s13 = "# The application 'irb' is installed as part of a gem, and" fullword ascii
      $s14 = "if str" fullword ascii
      $s15 = "    version = str" fullword ascii
      $s16 = "  str = str.b[/\\A_(.*)_\\z/, 1]" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 72 75 62 79 33 2e 31 0a 23 0a 23 20 54 68 69 73 20 66 69 6c 65 20 77 61 73 20 67 65 6e 65 72 61 74 65 64 20 62 79 20 52 75 62 79 47 65 6d 73 2e 0a 23 0a 23 20 54 68 65 20 61 70 70 6c 69 63 61 74 69 6f 6e 20 27 69 72 62 27 20 69 73 20 69 6e 73 74 61 6c 6c 65 64 20 61 73 20 70 61 72 74 20 6f 66 20 61 20 67 65 6d 2c 20 61 6e 64 0a 23 20 74 68 69 73 20 66 69 6c 65 20 69 73 20 68 65 72 65 20 74 6f 20 66 61 63 69 6c 69 74 61 74 65 20 72 75 6e 6e 69 6e 67 20 69 74 2e 0a 23 0a 0a 72 65 71 75 69 72 65 20 27 72 75 62 79 67 65 6d 73 27 0a 0a 47 65 6d 2e 75 73 65 5f 67 65 6d 64 65 70 73 0a 0a 76 65 72 73 69 6f 6e 20 3d 20 22 3e 3d 20 30 2e 61 22 0a 0a 73 74 72 20 3d 20 41 52 47 56 2e 66 69 72 73 74 0a 69 66 20 73 74 72 0a 20 20 73 74 72 20 3d 20 73 74 72 2e 62 5b 2f 5c 41 5f 28 2e 2a 29 5f 5c 7a 2f 2c 20 31 5d 0a 20 20 69 66 20 73 74 72 20 61 6e 64 20 47 65 6d 3a 3a 56 65 72 73 69 6f 6e 2e 63 6f 72 72 65 63 74 3f 28 73 74 72 29 0a 20 20 20 20 76 65 72 73 69 6f 6e 20 3d 20 73 74 72 0a 20 20 20 20 41 52 47 56 2e 73 68 69 66 74 0a 20 20 65 6e 64 0a 65 6e 64 0a 0a 69 66 20 47 65 6d 2e 72 65 73 70 6f 6e 64 5f 74 6f 3f 28 3a 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 29 0a 6c 6f 61 64 20 47 65 6d 2e 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 28 27 69 72 62 27 2c 20 27 69 72 62 27 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6c 73 65 0a 67 65 6d 20 22 69 72 62 22 2c 20 76 65 72 73 69 6f 6e 0a 6c 6f 61 64 20 47 65 6d 2e 62 69 6e 5f 70 61 74 68 28 22 69 72 62 22 2c 20 22 69 72 62 22 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6e 64 0a}
condition:
      filesize < 1KB and
      8 of them and $magic
}

rule gtfobins_binaries_rake {
   strings:
      $s1 = "# this file is here to facilitate running it." fullword ascii
      $s2 = "load Gem.bin_path(\"rake\", \"rake\", version)" fullword ascii
      $s3 = "load Gem.activate_bin_path('rake', 'rake', version)" fullword ascii
      $s4 = "# This file was generated by RubyGems." fullword ascii
      $s5 = "Gem.use_gemdeps" fullword ascii
      $s6 = "if Gem.respond_to?(:activate_bin_path)" fullword ascii
      $s7 = "  if str and Gem::Version.correct?(str)" fullword ascii
      $s8 = "version = \">= 0.a\"" fullword ascii
      $s9 = "gem \"rake\", version" fullword ascii
      $s10 = "str = ARGV.first" fullword ascii
      $s11 = "require 'rubygems'" fullword ascii
      $s12 = "# The application 'rake' is installed as part of a gem, and" fullword ascii
      $s13 = "if str" fullword ascii
      $s14 = "    version = str" fullword ascii
      $s15 = "  str = str.b[/\\A_(.*)_\\z/, 1]" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 72 75 62 79 0a 23 0a 23 20 54 68 69 73 20 66 69 6c 65 20 77 61 73 20 67 65 6e 65 72 61 74 65 64 20 62 79 20 52 75 62 79 47 65 6d 73 2e 0a 23 0a 23 20 54 68 65 20 61 70 70 6c 69 63 61 74 69 6f 6e 20 27 72 61 6b 65 27 20 69 73 20 69 6e 73 74 61 6c 6c 65 64 20 61 73 20 70 61 72 74 20 6f 66 20 61 20 67 65 6d 2c 20 61 6e 64 0a 23 20 74 68 69 73 20 66 69 6c 65 20 69 73 20 68 65 72 65 20 74 6f 20 66 61 63 69 6c 69 74 61 74 65 20 72 75 6e 6e 69 6e 67 20 69 74 2e 0a 23 0a 0a 72 65 71 75 69 72 65 20 27 72 75 62 79 67 65 6d 73 27 0a 0a 47 65 6d 2e 75 73 65 5f 67 65 6d 64 65 70 73 0a 0a 76 65 72 73 69 6f 6e 20 3d 20 22 3e 3d 20 30 2e 61 22 0a 0a 73 74 72 20 3d 20 41 52 47 56 2e 66 69 72 73 74 0a 69 66 20 73 74 72 0a 20 20 73 74 72 20 3d 20 73 74 72 2e 62 5b 2f 5c 41 5f 28 2e 2a 29 5f 5c 7a 2f 2c 20 31 5d 0a 20 20 69 66 20 73 74 72 20 61 6e 64 20 47 65 6d 3a 3a 56 65 72 73 69 6f 6e 2e 63 6f 72 72 65 63 74 3f 28 73 74 72 29 0a 20 20 20 20 76 65 72 73 69 6f 6e 20 3d 20 73 74 72 0a 20 20 20 20 41 52 47 56 2e 73 68 69 66 74 0a 20 20 65 6e 64 0a 65 6e 64 0a 0a 69 66 20 47 65 6d 2e 72 65 73 70 6f 6e 64 5f 74 6f 3f 28 3a 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 29 0a 6c 6f 61 64 20 47 65 6d 2e 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 28 27 72 61 6b 65 27 2c 20 27 72 61 6b 65 27 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6c 73 65 0a 67 65 6d 20 22 72 61 6b 65 22 2c 20 76 65 72 73 69 6f 6e 0a 6c 6f 61 64 20 47 65 6d 2e 62 69 6e 5f 70 61 74 68 28 22 72 61 6b 65 22 2c 20 22 72 61 6b 65 22 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6e 64 0a}
condition:
      filesize < 1KB and
      8 of them and $magic
}

rule gtfobins_binaries_bundler {
   strings:
      $s1 = "# this file is here to facilitate running it." fullword ascii
      $s2 = "load Gem.bin_path(\"bundler\", \"bundler\", version)" fullword ascii
      $s3 = "load Gem.activate_bin_path('bundler', 'bundler', version)" fullword ascii
      $s4 = "# This file was generated by RubyGems." fullword ascii
      $s5 = "if Gem.respond_to?(:activate_bin_path)" fullword ascii
      $s6 = "  if str and Gem::Version.correct?(str)" fullword ascii
      $s7 = "version = \">= 0.a\"" fullword ascii
      $s8 = "gem \"bundler\", version" fullword ascii
      $s9 = "str = ARGV.first" fullword ascii
      $s10 = "require 'rubygems'" fullword ascii
      $s11 = "# The application 'bundler' is installed as part of a gem, and" fullword ascii
      $s12 = "if str" fullword ascii
      $s13 = "    version = str" fullword ascii
      $s14 = "    ENV['BUNDLER_VERSION'] = str" fullword ascii
      $s15 = "  str = str.b[/\\A_(.*)_\\z/, 1]" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 72 75 62 79 0a 23 0a 23 20 54 68 69 73 20 66 69 6c 65 20 77 61 73 20 67 65 6e 65 72 61 74 65 64 20 62 79 20 52 75 62 79 47 65 6d 73 2e 0a 23 0a 23 20 54 68 65 20 61 70 70 6c 69 63 61 74 69 6f 6e 20 27 62 75 6e 64 6c 65 72 27 20 69 73 20 69 6e 73 74 61 6c 6c 65 64 20 61 73 20 70 61 72 74 20 6f 66 20 61 20 67 65 6d 2c 20 61 6e 64 0a 23 20 74 68 69 73 20 66 69 6c 65 20 69 73 20 68 65 72 65 20 74 6f 20 66 61 63 69 6c 69 74 61 74 65 20 72 75 6e 6e 69 6e 67 20 69 74 2e 0a 23 0a 0a 72 65 71 75 69 72 65 20 27 72 75 62 79 67 65 6d 73 27 0a 0a 76 65 72 73 69 6f 6e 20 3d 20 22 3e 3d 20 30 2e 61 22 0a 0a 73 74 72 20 3d 20 41 52 47 56 2e 66 69 72 73 74 0a 69 66 20 73 74 72 0a 20 20 73 74 72 20 3d 20 73 74 72 2e 62 5b 2f 5c 41 5f 28 2e 2a 29 5f 5c 7a 2f 2c 20 31 5d 0a 20 20 69 66 20 73 74 72 20 61 6e 64 20 47 65 6d 3a 3a 56 65 72 73 69 6f 6e 2e 63 6f 72 72 65 63 74 3f 28 73 74 72 29 0a 20 20 20 20 76 65 72 73 69 6f 6e 20 3d 20 73 74 72 0a 20 20 20 20 45 4e 56 5b 27 42 55 4e 44 4c 45 52 5f 56 45 52 53 49 4f 4e 27 5d 20 3d 20 73 74 72 0a 0a 20 20 20 20 41 52 47 56 2e 73 68 69 66 74 0a 20 20 65 6e 64 0a 65 6e 64 0a 0a 69 66 20 47 65 6d 2e 72 65 73 70 6f 6e 64 5f 74 6f 3f 28 3a 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 29 0a 6c 6f 61 64 20 47 65 6d 2e 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 28 27 62 75 6e 64 6c 65 72 27 2c 20 27 62 75 6e 64 6c 65 72 27 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6c 73 65 0a 67 65 6d 20 22 62 75 6e 64 6c 65 72 22 2c 20 76 65 72 73 69 6f 6e 0a 6c 6f 61 64 20 47 65 6d 2e 62 69 6e 5f 70 61 74 68 28 22 62 75 6e 64 6c 65 72 22 2c 20 22 62 75 6e 64 6c 65 72 22 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6e 64 0a}
condition:
      filesize < 1KB and
      8 of them and $magic
}

rule gtfobins_binaries_vagrant {
   strings:
      $s1 = "load Gem.bin_path(\"vagrant\", \"vagrant\", version)" fullword ascii
      $s2 = "load Gem.activate_bin_path('vagrant', 'vagrant', version)" fullword ascii
      $s3 = "gem \"vagrant\", version" fullword ascii
      $s4 = "# this file is here to facilitate running it." fullword ascii
      $s5 = "# The application 'vagrant' is installed as part of a gem, and" fullword ascii
      $s6 = "# This file was generated by RubyGems." fullword ascii
      $s7 = "Gem.use_gemdeps" fullword ascii
      $s8 = "if Gem.respond_to?(:activate_bin_path)" fullword ascii
      $s9 = "  if str and Gem::Version.correct?(str)" fullword ascii
      $s10 = "version = \">= 0.a\"" fullword ascii
      $s11 = "str = ARGV.first" fullword ascii
      $s12 = "require 'rubygems'" fullword ascii
      $s13 = "if str" fullword ascii
      $s14 = "    version = str" fullword ascii
      $s15 = "  str = str.b[/\\A_(.*)_\\z/, 1]" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 72 75 62 79 0a 23 0a 23 20 54 68 69 73 20 66 69 6c 65 20 77 61 73 20 67 65 6e 65 72 61 74 65 64 20 62 79 20 52 75 62 79 47 65 6d 73 2e 0a 23 0a 23 20 54 68 65 20 61 70 70 6c 69 63 61 74 69 6f 6e 20 27 76 61 67 72 61 6e 74 27 20 69 73 20 69 6e 73 74 61 6c 6c 65 64 20 61 73 20 70 61 72 74 20 6f 66 20 61 20 67 65 6d 2c 20 61 6e 64 0a 23 20 74 68 69 73 20 66 69 6c 65 20 69 73 20 68 65 72 65 20 74 6f 20 66 61 63 69 6c 69 74 61 74 65 20 72 75 6e 6e 69 6e 67 20 69 74 2e 0a 23 0a 0a 72 65 71 75 69 72 65 20 27 72 75 62 79 67 65 6d 73 27 0a 0a 47 65 6d 2e 75 73 65 5f 67 65 6d 64 65 70 73 0a 0a 76 65 72 73 69 6f 6e 20 3d 20 22 3e 3d 20 30 2e 61 22 0a 0a 73 74 72 20 3d 20 41 52 47 56 2e 66 69 72 73 74 0a 69 66 20 73 74 72 0a 20 20 73 74 72 20 3d 20 73 74 72 2e 62 5b 2f 5c 41 5f 28 2e 2a 29 5f 5c 7a 2f 2c 20 31 5d 0a 20 20 69 66 20 73 74 72 20 61 6e 64 20 47 65 6d 3a 3a 56 65 72 73 69 6f 6e 2e 63 6f 72 72 65 63 74 3f 28 73 74 72 29 0a 20 20 20 20 76 65 72 73 69 6f 6e 20 3d 20 73 74 72 0a 20 20 20 20 41 52 47 56 2e 73 68 69 66 74 0a 20 20 65 6e 64 0a 65 6e 64 0a 0a 69 66 20 47 65 6d 2e 72 65 73 70 6f 6e 64 5f 74 6f 3f 28 3a 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 29 0a 6c 6f 61 64 20 47 65 6d 2e 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 28 27 76 61 67 72 61 6e 74 27 2c 20 27 76 61 67 72 61 6e 74 27 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6c 73 65 0a 67 65 6d 20 22 76 61 67 72 61 6e 74 22 2c 20 76 65 72 73 69 6f 6e 0a 6c 6f 61 64 20 47 65 6d 2e 62 69 6e 5f 70 61 74 68 28 22 76 61 67 72 61 6e 74 22 2c 20 22 76 61 67 72 61 6e 74 22 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6e 64 0a}
condition:
      filesize < 1KB and
      8 of them and $magic
}

rule gtfobins_binaries_redcarpet {
   strings:
      $s1 = "# this file is here to facilitate running it." fullword ascii
      $s2 = "# This file was generated by RubyGems." fullword ascii
      $s3 = "Gem.use_gemdeps" fullword ascii
      $s4 = "if Gem.respond_to?(:activate_bin_path)" fullword ascii
      $s5 = "  if str and Gem::Version.correct?(str)" fullword ascii
      $s6 = "version = \">= 0.a\"" fullword ascii
      $s7 = "load Gem.activate_bin_path('redcarpet', 'redcarpet', version)" fullword ascii
      $s8 = "load Gem.bin_path(\"redcarpet\", \"redcarpet\", version)" fullword ascii
      $s9 = "str = ARGV.first" fullword ascii
      $s10 = "require 'rubygems'" fullword ascii
      $s11 = "# The application 'redcarpet' is installed as part of a gem, and" fullword ascii
      $s12 = "if str" fullword ascii
      $s13 = "gem \"redcarpet\", version" fullword ascii
      $s14 = "    version = str" fullword ascii
      $s15 = "  str = str.b[/\\A_(.*)_\\z/, 1]" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 72 75 62 79 0a 23 0a 23 20 54 68 69 73 20 66 69 6c 65 20 77 61 73 20 67 65 6e 65 72 61 74 65 64 20 62 79 20 52 75 62 79 47 65 6d 73 2e 0a 23 0a 23 20 54 68 65 20 61 70 70 6c 69 63 61 74 69 6f 6e 20 27 72 65 64 63 61 72 70 65 74 27 20 69 73 20 69 6e 73 74 61 6c 6c 65 64 20 61 73 20 70 61 72 74 20 6f 66 20 61 20 67 65 6d 2c 20 61 6e 64 0a 23 20 74 68 69 73 20 66 69 6c 65 20 69 73 20 68 65 72 65 20 74 6f 20 66 61 63 69 6c 69 74 61 74 65 20 72 75 6e 6e 69 6e 67 20 69 74 2e 0a 23 0a 0a 72 65 71 75 69 72 65 20 27 72 75 62 79 67 65 6d 73 27 0a 0a 47 65 6d 2e 75 73 65 5f 67 65 6d 64 65 70 73 0a 0a 76 65 72 73 69 6f 6e 20 3d 20 22 3e 3d 20 30 2e 61 22 0a 0a 73 74 72 20 3d 20 41 52 47 56 2e 66 69 72 73 74 0a 69 66 20 73 74 72 0a 20 20 73 74 72 20 3d 20 73 74 72 2e 62 5b 2f 5c 41 5f 28 2e 2a 29 5f 5c 7a 2f 2c 20 31 5d 0a 20 20 69 66 20 73 74 72 20 61 6e 64 20 47 65 6d 3a 3a 56 65 72 73 69 6f 6e 2e 63 6f 72 72 65 63 74 3f 28 73 74 72 29 0a 20 20 20 20 76 65 72 73 69 6f 6e 20 3d 20 73 74 72 0a 20 20 20 20 41 52 47 56 2e 73 68 69 66 74 0a 20 20 65 6e 64 0a 65 6e 64 0a 0a 69 66 20 47 65 6d 2e 72 65 73 70 6f 6e 64 5f 74 6f 3f 28 3a 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 29 0a 6c 6f 61 64 20 47 65 6d 2e 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 28 27 72 65 64 63 61 72 70 65 74 27 2c 20 27 72 65 64 63 61 72 70 65 74 27 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6c 73 65 0a 67 65 6d 20 22 72 65 64 63 61 72 70 65 74 22 2c 20 76 65 72 73 69 6f 6e 0a 6c 6f 61 64 20 47 65 6d 2e 62 69 6e 5f 70 61 74 68 28 22 72 65 64 63 61 72 70 65 74 22 2c 20 22 72 65 64 63 61 72 70 65 74 22 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6e 64 0a}
condition:
      filesize < 1KB and
      8 of them and $magic
}

rule gtfobins_binaries_bundle {
   strings:
      $s1 = "# this file is here to facilitate running it." fullword ascii
      $s2 = "load Gem.activate_bin_path('bundler', 'bundle', version)" fullword ascii
      $s3 = "load Gem.bin_path(\"bundler\", \"bundle\", version)" fullword ascii
      $s4 = "# This file was generated by RubyGems." fullword ascii
      $s5 = "if Gem.respond_to?(:activate_bin_path)" fullword ascii
      $s6 = "  if str and Gem::Version.correct?(str)" fullword ascii
      $s7 = "version = \">= 0.a\"" fullword ascii
      $s8 = "gem \"bundler\", version" fullword ascii
      $s9 = "str = ARGV.first" fullword ascii
      $s10 = "require 'rubygems'" fullword ascii
      $s11 = "# The application 'bundler' is installed as part of a gem, and" fullword ascii
      $s12 = "if str" fullword ascii
      $s13 = "    version = str" fullword ascii
      $s14 = "    ENV['BUNDLER_VERSION'] = str" fullword ascii
      $s15 = "  str = str.b[/\\A_(.*)_\\z/, 1]" fullword ascii
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 72 75 62 79 0a 23 0a 23 20 54 68 69 73 20 66 69 6c 65 20 77 61 73 20 67 65 6e 65 72 61 74 65 64 20 62 79 20 52 75 62 79 47 65 6d 73 2e 0a 23 0a 23 20 54 68 65 20 61 70 70 6c 69 63 61 74 69 6f 6e 20 27 62 75 6e 64 6c 65 72 27 20 69 73 20 69 6e 73 74 61 6c 6c 65 64 20 61 73 20 70 61 72 74 20 6f 66 20 61 20 67 65 6d 2c 20 61 6e 64 0a 23 20 74 68 69 73 20 66 69 6c 65 20 69 73 20 68 65 72 65 20 74 6f 20 66 61 63 69 6c 69 74 61 74 65 20 72 75 6e 6e 69 6e 67 20 69 74 2e 0a 23 0a 0a 72 65 71 75 69 72 65 20 27 72 75 62 79 67 65 6d 73 27 0a 0a 76 65 72 73 69 6f 6e 20 3d 20 22 3e 3d 20 30 2e 61 22 0a 0a 73 74 72 20 3d 20 41 52 47 56 2e 66 69 72 73 74 0a 69 66 20 73 74 72 0a 20 20 73 74 72 20 3d 20 73 74 72 2e 62 5b 2f 5c 41 5f 28 2e 2a 29 5f 5c 7a 2f 2c 20 31 5d 0a 20 20 69 66 20 73 74 72 20 61 6e 64 20 47 65 6d 3a 3a 56 65 72 73 69 6f 6e 2e 63 6f 72 72 65 63 74 3f 28 73 74 72 29 0a 20 20 20 20 76 65 72 73 69 6f 6e 20 3d 20 73 74 72 0a 20 20 20 20 45 4e 56 5b 27 42 55 4e 44 4c 45 52 5f 56 45 52 53 49 4f 4e 27 5d 20 3d 20 73 74 72 0a 0a 20 20 20 20 41 52 47 56 2e 73 68 69 66 74 0a 20 20 65 6e 64 0a 65 6e 64 0a 0a 69 66 20 47 65 6d 2e 72 65 73 70 6f 6e 64 5f 74 6f 3f 28 3a 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 29 0a 6c 6f 61 64 20 47 65 6d 2e 61 63 74 69 76 61 74 65 5f 62 69 6e 5f 70 61 74 68 28 27 62 75 6e 64 6c 65 72 27 2c 20 27 62 75 6e 64 6c 65 27 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6c 73 65 0a 67 65 6d 20 22 62 75 6e 64 6c 65 72 22 2c 20 76 65 72 73 69 6f 6e 0a 6c 6f 61 64 20 47 65 6d 2e 62 69 6e 5f 70 61 74 68 28 22 62 75 6e 64 6c 65 72 22 2c 20 22 62 75 6e 64 6c 65 22 2c 20 76 65 72 73 69 6f 6e 29 0a 65 6e 64 0a}
condition:
      filesize < 1KB and
      8 of them and $magic
}

rule gtfobins_binaries_node {
   strings:
      $s1 = "_ZN4node15SnapshotBuilder23GetEmbeddedSnapshotDataEv" fullword ascii
      $s2 = "c319532a6898faee6d0b4df8987c4a41337acb.debug" fullword ascii
      $s3 = "c319532a6898faee6d0b4df8987c4a41337acb" ascii
      $s4 = "_ZN4node5StartEiPPc" fullword ascii
      $s5 = "libnode.so.115" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 10 20 00 00 00 00 00 00 40 00 00 00 00 00 00 00 50 61 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c8 07 00 00 00 00 00 00 c8 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 0d 30 00 00 00 00 00 00 0d 30 00 00 00 00 00 00 00 20 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 00 50 00 00 00 00 00 00 f0 00 00 00 00 00 00 00 f0 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 98 5d 00 00 00 00 00 00 98 6d 00 00 00 00 00 00 98 6d 00 00 00 00 00 00 78 02 00 00 00 00 00 00 80 02 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 a8 5d 00 00 00 00 00 00 a8 6d 00 00 00 00 00 00 a8 6d 00 00 00 00 00 00 10 02 00 00 00 00 00 00 10 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 04 50 00 00 00 00 00 00 04 50 00 00 00 00 00 00 04 50 00 00 00 00 00 00 34 00 00 00 00 00 00 00 34 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 98 5d 00 00 00 00 00 00 98 6d 00 00 00 00 00 00 98 6d 00 00 00 00 00 00 68 02 00 00 00 00 00 00 68 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 15 c3 19 53 2a 68 98 fa ee 6d 0b 4d f8 98 7c 4a 41 33 7a cb 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 06 00 00 00 01 00 00 00 06 00 00 00 88 51 a1 01 20 65 84 28 06 00 00 00 0a 00 00 00 00 00 00 00 ba e3 92 7c d0 65 ce 6d 6a 09 43 d6 43 45 d5 ec 6a 7f 9a 7c 32 62 db ed 76 0f ba 7d 0c 3a 97 0b ac 4b e3 c0 d9 71 58 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 80KB and
      all of them
}

rule gtfobins_binaries_npm {
   strings:
      $s1 = "require('../lib/cli.js')(process)" fullword ascii
      $s2 = "#!/usr/bin/env node" fullword ascii /* Goodware String - occured 2 times */
      $magic = {23 21 2f 75 73 72 2f 62 69 6e 2f 65 6e 76 20 6e 6f 64 65 0a 72 65 71 75 69 72 65 28 27 2e 2e 2f 6c 69 62 2f 63 6c 69 2e 6a 73 27 29 28 70 72 6f 63 65 73 73 29 0a}
condition:
      filesize < 1KB and
      all of them
}

rule gtfobins_binaries_expand {
   strings:
      $s1 = "  -t, --tabs=LIST  use comma separated list of tab positions." fullword ascii
      $s2 = "d5daabdfc76035c7b5204aa67cef9dbc40d62b.debug" fullword ascii
      $s3 = "'/' specifier only allowed with the last value" fullword ascii
      $s4 = "'/' specifier not at start of number: %s" fullword ascii
      $s5 = "'+' specifier not at start of number: %s" fullword ascii
      $s6 = "'/' specifier is mutually exclusive with '+'" fullword ascii
      $s7 = "d5daabdfc76035c7b5204aa67cef9dbc40d62b" ascii
      $s8 = "'+' specifier only allowed with the last value" fullword ascii
      $s9 = "  -t, --tabs=N     have tabs N characters apart, not 8" fullword ascii
      $s10 = "Convert tabs in each FILE to spaces, writing to standard output." fullword ascii /* Goodware String - occured 2 times */
      $s11 = "it:0::1::2::3::4::5::6::7::8::9::" fullword ascii /* Goodware String - occured 2 times */
      $s12 = "  -i, --initial    do not convert tabs after non blanks" fullword ascii
      $s13 = "tab stop is too large %s" fullword ascii /* Goodware String - occured 4 times */
      $s14 = "                     the last specified tab stop instead of the first column" fullword ascii
      $s15 = "tab sizes must be ascending" fullword ascii /* Goodware String - occured 4 times */
      $s16 = "tab size contains invalid character(s): %s" fullword ascii /* Goodware String - occured 4 times */
      $s17 = "tab size cannot be 0" fullword ascii /* Goodware String - occured 4 times */
      $s18 = "                     to specify a tab size to use after the last" fullword ascii
      $s19 = "input line is too long" fullword ascii /* Goodware String - occured 4 times */
      $s20 = "G(H;G0sxH" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 70 27 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 a4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 e8 16 00 00 00 00 00 00 e8 16 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 29 4e 00 00 00 00 00 00 29 4e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 d0 22 00 00 00 00 00 00 d0 22 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 9c 00 00 00 00 00 00 d0 ac 00 00 00 00 00 00 d0 ac 00 00 00 00 00 00 90 05 00 00 00 00 00 00 b0 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 9d 00 00 00 00 00 00 d8 ad 00 00 00 00 00 00 d8 ad 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 50 7f 00 00 00 00 00 00 50 7f 00 00 00 00 00 00 50 7f 00 00 00 00 00 00 64 03 00 00 00 00 00 00 64 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 9c 00 00 00 00 00 00 d0 ac 00 00 00 00 00 00 d0 ac 00 00 00 00 00 00 30 03 00 00 00 00 00 00 30 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 a9 d5 da ab df c7 60 35 c7 b5 20 4a a6 7c ef 9d bc 40 d6 2b 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 3b 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 3b 00 00 00 3d 00 00 00 43 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_unexpand {
   strings:
      $s1 = "  -t, --tabs=LIST  use comma separated list of tab positions." fullword ascii
      $s2 = "      --first-only  convert only leading sequences of blanks (overrides -a)" fullword ascii
      $s3 = "'/' specifier only allowed with the last value" fullword ascii
      $s4 = "'/' specifier not at start of number: %s" fullword ascii
      $s5 = "'+' specifier not at start of number: %s" fullword ascii
      $s6 = "'/' specifier is mutually exclusive with '+'" fullword ascii
      $s7 = "'+' specifier only allowed with the last value" fullword ascii
      $s8 = "0b757ae1621dfe62bd079c95cdf2b57b2cc5fc.debug" fullword ascii
      $s9 = "first-only" fullword ascii /* Goodware String - occured 2 times */
      $s10 = "unexpand" fullword ascii /* Goodware String - occured 2 times */
      $s11 = "  -t, --tabs=N     have tabs N characters apart instead of 8 (enables -a)" fullword ascii
      $s12 = ",0123456789at:" fullword ascii /* Goodware String - occured 2 times */
      $s13 = "Convert blanks in each FILE to tabs, writing to standard output." fullword ascii /* Goodware String - occured 2 times */
      $s14 = "  -a, --all        convert all blanks, instead of just initial blanks" fullword ascii
      $s15 = "tab stop value is too large" fullword ascii /* Goodware String - occured 2 times */
      $s16 = "tab stop is too large %s" fullword ascii /* Goodware String - occured 4 times */
      $s17 = "                     the last specified tab stop instead of the first column" fullword ascii
      $s18 = "tab sizes must be ascending" fullword ascii /* Goodware String - occured 4 times */
      $s19 = "tab size contains invalid character(s): %s" fullword ascii /* Goodware String - occured 4 times */
      $s20 = "tab size cannot be 0" fullword ascii /* Goodware String - occured 4 times */
      $s21 = "                     to specify a tab size to use after the last" fullword ascii
      $s22 = "input line is too long" fullword ascii /* Goodware String - occured 4 times */
      $s23 = "0123456789a" ascii
      $s24 = "0b757ae1621dfe62bd079c95cdf2b57b2cc5fc" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 f0 28 00 00 00 00 00 00 40 00 00 00 00 00 00 00 10 a4 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 40 17 00 00 00 00 00 00 40 17 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 a9 4f 00 00 00 00 00 00 a9 4f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 40 23 00 00 00 00 00 00 40 23 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 9c 00 00 00 00 00 00 b0 ac 00 00 00 00 00 00 b0 ac 00 00 00 00 00 00 b0 05 00 00 00 00 00 00 d0 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 9d 00 00 00 00 00 00 d8 ad 00 00 00 00 00 00 d8 ad 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 b0 7f 00 00 00 00 00 00 b0 7f 00 00 00 00 00 00 b0 7f 00 00 00 00 00 00 64 03 00 00 00 00 00 00 64 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 9c 00 00 00 00 00 00 b0 ac 00 00 00 00 00 00 b0 ac 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 f7 0b 75 7a e1 62 1d fe 62 bd 07 9c 95 cd f2 b5 7b 2c c5 fc 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 3c 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 3c 00 00 00 3e 00 00 00 44 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      8 of them and $magic
}

rule gtfobins_binaries_atobm {
   strings:
      $s1 = "%s:  line %d is %d characters wide instead of %d" fullword ascii
      $s2 = "%s:  line %d too long." fullword ascii
      $s3 = "%s:  bad character list \"%s\", must have exactly 2 characters" fullword ascii
      $s4 = "%s:  unable to open file \"%s\"." fullword ascii
      $s5 = "%s:  unable to allocate scan list" fullword ascii
      $s6 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/x11-apps.debug" fullword ascii
      $s7 = "usage:  %s [-options ...] [filename]" fullword ascii
      $s8 = "%s:  bad character '%c' on line %d" fullword ascii
      $s9 = "%s requires an argument" fullword ascii
      $s10 = "%s: unrecognized option '%s'" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "#define %s_x_hot %d" fullword ascii /* Goodware String - occured 1 times */
      $s12 = "-chars" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "#define %s_y_hot %d" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "    -name variable   name to use in bitmap file" fullword ascii
      $s15 = "    -chars cc        chars to use for 0 and 1 bits, respectively" fullword ascii
      $s16 = "    -yhot number     y position of hotspot" fullword ascii
      $s17 = "    -xhot number     x position of hotspot" fullword ascii
      $s18 = "where options include:" fullword ascii /* Goodware String - occured 2 times */
      $s19 = "static unsigned char %s_bits[] = {" fullword ascii /* Goodware String - occured 2 times */
      $s20 = " 0x%02x" fullword ascii
      $s21 = "313cd09a6cdf2b747bd21f4ca255de7e9456c6.debug" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 90 15 00 00 00 00 00 00 40 00 00 00 00 00 00 00 50 32 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1e 00 1d 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 80 0b 00 00 00 00 00 00 80 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 f5 0c 00 00 00 00 00 00 f5 0c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 e0 04 00 00 00 00 00 00 e0 04 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 d0 2d 00 00 00 00 00 00 d0 3d 00 00 00 00 00 00 d0 3d 00 00 00 00 00 00 e0 02 00 00 00 00 00 00 28 03 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 e0 2d 00 00 00 00 00 00 e0 3d 00 00 00 00 00 00 e0 3d 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 10 23 00 00 00 00 00 00 10 23 00 00 00 00 00 00 10 23 00 00 00 00 00 00 4c 00 00 00 00 00 00 00 4c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 d0 2d 00 00 00 00 00 00 d0 3d 00 00 00 00 00 00 d0 3d 00 00 00 00 00 00 30 02 00 00 00 00 00 00 30 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 22 31 3c d0 9a 6c df 2b 74 7b d2 1f 4c a2 55 de 7e 94 56 c6 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 19 00 00 00 01 00 00 00 06 00 00 00 00 01 a1 00 80 01 10 02 19 00 00 00 1b 00 00 00 00 00 00 00 28 1d 8c 1c d1 65 ce 6d 66 55 61 10 39 f2 8b 1c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d2 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 40KB and
      8 of them and $magic
}

rule gtfobins_binaries_espeak {
   strings:
      $s1 = "If neither -f nor --stdin, then <words> are spoken, or if none then text" fullword ascii
      $s2 = "phonout" fullword ascii
      $s3 = "--compile=<voice name>" fullword ascii
      $s4 = "   Separate phonemes (from -x --ipa) with <character>." fullword ascii
      $s5 = "espeak_Synchronize() failed, maybe error when opening output device" fullword ascii
      $s6 = "is spoken from stdin, each line separately." fullword ascii
      $s7 = "eSpeak text-to-speech: %s  Data at: %s" fullword ascii
      $s8 = "espeak_CompileDictionary" fullword ascii
      $s9 = "%svoice '%s'" fullword ascii
      $s10 = "   Write phoneme output from -x -X --ipa and --pho to this file" fullword ascii
      $s11 = "%sfile '%s'" fullword ascii
      $s12 = "compile-debug" fullword ascii
      $s13 = "--pho      Write mbrola phoneme data (.pho) to stdout or to the file in --phonout" fullword ascii
      $s14 = "Failed to allocate memory %d bytes" fullword ascii
      $s15 = "%s_%.2d%s" fullword ascii
      $s16 = "%2d  %-12s%s%c  %-20s %-13s " fullword ascii
      $s17 = "-a <integer>" fullword ascii
      $s18 = "espeak_SetPhonemeTrace" fullword ascii
      $s19 = "--voices=<language>" fullword ascii
      $s20 = "libespeak.so.1" fullword ascii
      $s21 = "espeak [options] [\"<words>\"]" fullword ascii
      $s22 = "voices" fullword ascii /* Goodware String - occured 1 times */
      $s23 = "-k <integer>" fullword ascii
      $s24 = "espeak_ListVoices" fullword ascii
      $s25 = "espeak_SetVoiceByProperties" fullword ascii
      $s26 = "--phonout=\"<filename>\"" fullword ascii
      $s27 = "--sep=<character>" fullword ascii
      $s28 = "-l <integer>" fullword ascii
      $s29 = "--split=<minutes>" fullword ascii
      $s30 = "-s <integer>" fullword ascii
      $s31 = "espeak_Info" fullword ascii
      $s32 = "-p <integer>" fullword ascii
      $s33 = "--path=\"<path>\"" fullword ascii
      $s34 = "-g <integer>" fullword ascii
      $s35 = "(%s %d)" fullword ascii
      $s36 = "   Compile pronunciation rules and dictionary from the current" fullword ascii
      $s37 = "espeak_SetVoiceByName" fullword ascii
      $s38 = "-v <voice name>" fullword ascii
      $s39 = "-w <wave file name>" fullword ascii
      $s40 = "espeak_Initialize" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 2d 00 00 00 00 00 00 40 00 00 00 00 00 00 00 08 65 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b8 13 00 00 00 00 00 00 b8 13 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 31 16 00 00 00 00 00 00 31 16 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 a4 11 00 00 00 00 00 00 a4 11 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 c0 5d 00 00 00 00 00 00 c0 6d 00 00 00 00 00 00 c0 6d 00 00 00 00 00 00 00 06 00 00 00 00 00 00 50 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d0 5d 00 00 00 00 00 00 d0 6d 00 00 00 00 00 00 d0 6d 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 58 4e 00 00 00 00 00 00 58 4e 00 00 00 00 00 00 58 4e 00 00 00 00 00 00 74 00 00 00 00 00 00 00 74 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 c0 5d 00 00 00 00 00 00 c0 6d 00 00 00 00 00 00 c0 6d 00 00 00 00 00 00 40 02 00 00 00 00 00 00 40 02 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 95 ef e8 fc d2 93 c3 88 f2 c3 80 d6 20 23 ef 77 ba 92 9d a8 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 2f 00 00 00 01 00 00 00 06 00 00 00 88 45 a1 01 80 05 1c 2a 2f 00 00 00 33 00 00 00 37 00 00 00 d0 65 ce 6d ba e3 92 7c 28 1d 8c 1c 43 45 d5 ec 6a 7f 9a 7c d8 71 58 1c 38 f2 8b 1c 67 55 61 10 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 80KB and
      8 of them and $magic
}

rule gtfobins_binaries_fold {
   strings:
      $s1 = "invalid number of columns" fullword ascii
      $s2 = "Wrap input lines in each FILE, writing to standard output." fullword ascii
      $s3 = "  -w, --width=WIDTH   use WIDTH columns instead of 80" fullword ascii
      $s4 = "  -s, --spaces        break at spaces" fullword ascii
      $s5 = "bsw:0::1::2::3::4::5::6::7::8::9::" fullword ascii /* Goodware String - occured 2 times */
      $s6 = "  -b, --bytes         count bytes rather than columns" fullword ascii
      $s7 = "e9d70123c166b9f9ca013b6aa8a38923f5d1f4.debug" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 26 00 00 00 00 00 00 40 00 00 00 00 00 00 00 f0 a3 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1f 00 1e 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 60 17 00 00 00 00 00 00 60 17 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 09 4f 00 00 00 00 00 00 09 4f 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 00 70 00 00 00 00 00 00 20 20 00 00 00 00 00 00 20 20 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 b0 9c 00 00 00 00 00 00 b0 ac 00 00 00 00 00 00 b0 ac 00 00 00 00 00 00 90 05 00 00 00 00 00 00 50 07 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 d8 9d 00 00 00 00 00 00 d8 ad 00 00 00 00 00 00 d8 ad 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 e0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 74 7d 00 00 00 00 00 00 74 7d 00 00 00 00 00 00 74 7d 00 00 00 00 00 00 34 03 00 00 00 00 00 00 34 03 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 b0 9c 00 00 00 00 00 00 b0 ac 00 00 00 00 00 00 b0 ac 00 00 00 00 00 00 50 03 00 00 00 00 00 00 50 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 48 e9 d7 01 23 c1 66 b9 f9 ca 01 3b 6a a8 a3 89 23 f5 d1 f4 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 03 00 00 00 3d 00 00 00 01 00 00 00 06 00 00 00 04 4d e1 00 a0 01 1c 12 3d 00 00 00 3f 00 00 00 45 00 00 00 28 1d 8c 1c d1 65 ce 6d bc 50 76 9e 66 55 61 10 96 a0 89 97 ce 2c 63 72 e4 62 41 f5 39 f2 8b 1c 32 c4 f7 12 b3 a2 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00}
condition:
      filesize < 100KB and
      all of them
}

rule gtfobins_binaries_tdbtool {
   strings:
      $s1 = "  ! command            : execute system command" fullword ascii
      $s2 = "  hexkeys              : dump the database keys as hex values" fullword ascii
      $s3 = "  keys                 : dump the database keys as strings" fullword ascii
      $s4 = "tdb_dump_all" fullword ascii
      $s5 = "  dump                 : dump the database as strings" fullword ascii
      $s6 = "Error getting freelist size." fullword ascii
      $s7 = "Can use mutexes only with MUTEX_LOCKING or NOLOCK" fullword ascii
      $s8 = "hexkeys" fullword ascii
      $s9 = "key %d bytes: " fullword ascii
      $s10 = "Could not open %s: %s" fullword ascii
      $s11 = "Could not create %s: %s" fullword ascii
      $s12 = "tdb_set_logging_function" fullword ascii
      $s13 = "need key" fullword ascii
      $s14 = "fetch failed" fullword ascii
      $s15 = "need hex key" fullword ascii
      $s16 = "failed to move record" fullword ascii
      $s17 = "delete failed" fullword ascii
      $s18 = "store failed" fullword ascii
      $s19 = "tdb_traverse" fullword ascii
      $s20 = "Testing traverse speed for %u seconds" fullword ascii
      $s21 = "insert failed" fullword ascii
      $s22 = "storehex" fullword ascii
      $s23 = "Integrity check for the opened database failed." fullword ascii
      $s24 = "  storehex  key  data  : store a record (replace), key/value in hex format" fullword ascii
      $s25 = "Storing key:" fullword ascii
      $s26 = "tdb_firstkey" fullword ascii
      $s27 = "data %d bytes" fullword ascii
      $s28 = "Database integrity is OK and has %d records." fullword ascii
      $s29 = "tdb_nextkey" fullword ascii
      $s30 = "key %d bytes" fullword ascii
      $s31 = "tdb_errorstr" fullword ascii
      $s32 = "tdb_transaction_commit" fullword ascii
      $s33 = "transaction_commit" fullword ascii
      $s34 = "storing key/data:" fullword ascii
      $s35 = "/usr/lib/debug/.dwz/x86_64-linux-gnu/tdb-tools.debug" fullword ascii
      $s36 = "  \\n                   : repeat 'next' command" fullword ascii
      $s37 = "mmap is disabled" fullword ascii
      $s38 = "need data" fullword ascii
      $s39 = "transaction test" fullword ascii
      $s40 = "store test" fullword ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 80 25 00 00 00 00 00 00 40 00 00 00 00 00 00 00 b0 63 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1d 00 1c 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d0 13 00 00 00 00 00 00 d0 13 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 55 1c 00 00 00 00 00 00 55 1c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 d0 0d 00 00 00 00 00 00 d0 0d 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 58 5c 00 00 00 00 00 00 58 5c 00 00 00 00 00 00 58 5c 00 00 00 00 00 00 b8 05 00 00 00 00 00 00 80 0e 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 68 5c 00 00 00 00 00 00 68 5c 00 00 00 00 00 00 68 5c 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 48 4a 00 00 00 00 00 00 48 4a 00 00 00 00 00 00 48 4a 00 00 00 00 00 00 8c 00 00 00 00 00 00 00 8c 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 58 5c 00 00 00 00 00 00 58 5c 00 00 00 00 00 00 58 5c 00 00 00 00 00 00 a8 03 00 00 00 00 00 00 a8 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 1f c3 8a c6 c4 64 f0 65 7b 1e 5b 30 fd 6d e7 c9 a8 fb 23 79 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 30 00 00 00 01 00 00 00 06 00 00 00 00 00 81 00 00 00 00 00 30 00 00 00 00 00 00 00 d1 65 ce 6d 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ad 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 a2 01 00 00 12 00 00 00}
condition:
      filesize < 80KB and
      8 of them and $magic
}

rule gtfobins_binaries_logsave {
   strings:
      $s1 = "Usage: %s [-asv] logfile program" fullword ascii
      $s2 = "Backgrounding to save %s later" fullword ascii
      $s3 = "Log of " fullword ascii
      $s4 = "ee7131a9a8a06c3e2261b7e21f8c5269707709.debug" fullword ascii
      $s5 = "died with signal %d" fullword ascii
      $s6 = " exited with status code %d" fullword ascii
      $s7 = "ee7131a9a8a06c3e2261b7e21f8c5269707709" ascii
      $magic = {7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 03 00 3e 00 01 00 00 00 a0 17 00 00 00 00 00 00 40 00 00 00 00 00 00 00 58 31 00 00 00 00 00 00 00 00 00 00 40 00 38 00 0d 00 40 00 1c 00 1b 00 06 00 00 00 04 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 40 00 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 08 00 00 00 00 00 00 00 03 00 00 00 04 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 18 03 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 1c 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 b0 0c 00 00 00 00 00 00 b0 0c 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 05 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 10 00 00 00 00 00 00 fd 0b 00 00 00 00 00 00 fd 0b 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 04 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 d8 02 00 00 00 00 00 00 00 10 00 00 00 00 00 00 01 00 00 00 06 00 00 00 e0 2c 00 00 00 00 00 00 e0 3c 00 00 00 00 00 00 e0 3c 00 00 00 00 00 00 38 03 00 00 00 00 00 00 60 03 00 00 00 00 00 00 00 10 00 00 00 00 00 00 02 00 00 00 06 00 00 00 f0 2c 00 00 00 00 00 00 f0 3c 00 00 00 00 00 00 f0 3c 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 f0 01 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 58 03 00 00 00 00 00 00 44 00 00 00 00 00 00 00 44 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 53 e5 74 64 04 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 38 03 00 00 00 00 00 00 20 00 00 00 00 00 00 00 20 00 00 00 00 00 00 00 08 00 00 00 00 00 00 00 50 e5 74 64 04 00 00 00 b8 20 00 00 00 00 00 00 b8 20 00 00 00 00 00 00 b8 20 00 00 00 00 00 00 54 00 00 00 00 00 00 00 54 00 00 00 00 00 00 00 04 00 00 00 00 00 00 00 51 e5 74 64 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00 00 00 00 00 00 00 52 e5 74 64 04 00 00 00 e0 2c 00 00 00 00 00 00 e0 3c 00 00 00 00 00 00 e0 3c 00 00 00 00 00 00 20 03 00 00 00 00 00 00 20 03 00 00 00 00 00 00 01 00 00 00 00 00 00 00 2f 6c 69 62 36 34 2f 6c 64 2d 6c 69 6e 75 78 2d 78 38 36 2d 36 34 2e 73 6f 2e 32 00 00 00 00 00 04 00 00 00 10 00 00 00 05 00 00 00 47 4e 55 00 02 80 00 c0 04 00 00 00 01 00 00 00 00 00 00 00 04 00 00 00 14 00 00 00 03 00 00 00 47 4e 55 00 43 ee 71 31 a9 a8 a0 6c 3e 22 61 b7 e2 1f 8c 52 69 70 77 09 04 00 00 00 10 00 00 00 01 00 00 00 47 4e 55 00 00 00 00 00 03 00 00 00 02 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 21 00 00 00 01 00 00 00 06 00 00 00 00 00 81 00 00 00 08 00 21 00 00 00 22 00 00 00 d1 65 ce 6d 33 c4 f7 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 55 00 00 00 12 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 35 00 00 00 12 00 00 00}
condition:
      filesize < 40KB and
      all of them
}

rule gtfobins_binaries_knife {
   strings:
      $s1 = "rescue LoadError" fullword ascii
      $s2 = "# load OpenSSL early so that the shared library gets loaded in its" fullword ascii
      $s3 = "Kernel.load(bin_file)" fullword ascii
      $s4 = "  gem \"mutex_m\", \"= 0.2.0\"" fullword ascii
      $s5 = "  gem \"syslog-logger\", \"= 1.6.8\"" fullword ascii
      $s6 = "  gem \"mixlib-shellout\", \"= 3.2.7\"" fullword ascii
      $s7 = "  gem \"winrm-elevated\", \"= 1.2.3\"" fullword ascii
      $s8 = "  gem \"passwordmasker\", \"= 1.2.0\"" fullword ascii
      $s9 = "  gem \"aws-sdk-costandusagereportservice\", \"= 1.54.0\"" fullword ascii
      $s10 = "  gem \"activesupport\", \"= 7.1.3.2\"" fullword ascii
      $s11 = "# it expects to be loaded in image base known at compile time. We" fullword ascii
      $s12 = "# preferred image base address" fullword ascii
      $s13 = "# avoid appbundling if we are definitely running within a Bundler bundle." fullword ascii
      $s14 = "#!/opt/chef-workstation/embedded/bin/ruby --disable-gems" fullword ascii
      $s15 = "  gem \"aws-sdk-codepipeline\", \"= 1.69.0\"" fullword ascii
      $s16 = "#--APP_BUNDLER_BINSTUB_FORMAT_VERSION=1--" fullword ascii
      $s17 = "  gem \"aws-sdk-configservice\", \"= 1.106.0\"" fullword ascii
      $s18 = "  gem \"http-cookie\", \"= 1.0.5\"" fullword ascii
      $s19 = "  gem \"net-sftp\", \"= 4.0.0\"" fullword ascii
      $s20 = "  gem \"logging\", \"= 2.3.1\"" fullword ascii
      $s21 = "  gem \"vsphere-automation-content\", \"= 0.4.7\"" fullword ascii
      $s22 = "  gem \"aws-sdk-budgets\", \"= 1.63.0\"" fullword ascii
      $s23 = "  gem \"mixlib-log\", \"= 3.0.9\"" fullword ascii
      $s24 = "  gem \"multipart-post\", \"= 2.4.0\"" fullword ascii
      $s25 = "  gem \"dry-logic\", \"= 1.5.0\"" fullword ascii
      $s26 = "  gem \"kitchen-vagrant\", \"= 2.0.0\"" fullword ascii
      $s27 = "  gem \"shellany\", \"= 0.0.1\"" fullword ascii
      $s28 = "  gem \"aws-sdk-codedeploy\", \"= 1.64.0\"" fullword ascii
      $s29 = "  gem \"parser\", \"= 3.3.0.5\"" fullword ascii
      $s30 = "  gem \"aws-sdk-cloudwatchlogs\", \"= 1.80.0\"" fullword ascii
      $s31 = "# really doing its thing or not." fullword ascii
      $s32 = "# most likely the check for defined?(Bundler) is enough since we don't require" fullword ascii
      $s33 = "# bundler above, but just for paranoia's sake also we test to see if Bundler is" fullword ascii
      $s34 = "# this works around OpenSSL FIPS fingerprint matching issue where" fullword ascii
      $s35 = "  gem \"aws-sdk-servicecatalog\", \"= 1.60.0\"" fullword ascii
      $s36 = "bin_file = spec.bin_file(\"knife\")" fullword ascii
      $s37 = "  gem \"rubyntlm\", \"= 0.6.3\"" fullword ascii
      $s38 = "  gem \"hashdiff\", \"= 1.0.1\"" fullword ascii
      $s39 = "  gem \"connection_pool\", \"= 2.4.1\"" fullword ascii
      $s40 = "  gem \"faraday-httpclient\", \"= 1.0.1\"" fullword ascii
      $magic = {23 21 2f 6f 70 74 2f 63 68 65 66 2d 77 6f 72 6b 73 74 61 74 69 6f 6e 2f 65 6d 62 65 64 64 65 64 2f 62 69 6e 2f 72 75 62 79 20 2d 2d 64 69 73 61 62 6c 65 2d 67 65 6d 73 0a 23 2d 2d 41 50 50 5f 42 55 4e 44 4c 45 52 5f 42 49 4e 53 54 55 42 5f 46 4f 52 4d 41 54 5f 56 45 52 53 49 4f 4e 3d 31 2d 2d 0a 72 65 71 75 69 72 65 20 22 72 75 62 79 67 65 6d 73 22 0a 0a 23 20 74 68 69 73 20 77 6f 72 6b 73 20 61 72 6f 75 6e 64 20 4f 70 65 6e 53 53 4c 20 46 49 50 53 20 66 69 6e 67 65 72 70 72 69 6e 74 20 6d 61 74 63 68 69 6e 67 20 69 73 73 75 65 20 77 68 65 72 65 0a 23 20 69 74 20 65 78 70 65 63 74 73 20 74 6f 20 62 65 20 6c 6f 61 64 65 64 20 69 6e 20 69 6d 61 67 65 20 62 61 73 65 20 6b 6e 6f 77 6e 20 61 74 20 63 6f 6d 70 69 6c 65 20 74 69 6d 65 2e 20 57 65 0a 23 20 6c 6f 61 64 20 4f 70 65 6e 53 53 4c 20 65 61 72 6c 79 20 73 6f 20 74 68 61 74 20 74 68 65 20 73 68 61 72 65 64 20 6c 69 62 72 61 72 79 20 67 65 74 73 20 6c 6f 61 64 65 64 20 69 6e 20 69 74 73 0a 23 20 70 72 65 66 65 72 72 65 64 20 69 6d 61 67 65 20 62 61 73 65 20 61 64 64 72 65 73 73 0a 72 65 71 75 69 72 65 20 22 6f 70 65 6e 73 73 6c 22 0a 0a 62 65 67 69 6e 0a 20 20 23 20 74 68 69 73 20 77 6f 72 6b 73 20 61 72 6f 75 6e 64 20 72 75 62 79 67 65 6d 73 2f 72 75 62 79 67 65 6d 73 23 32 31 39 36 20 61 6e 64 20 63 61 6e 20 62 65 20 72 65 6d 6f 76 65 64 20 69 6e 20 72 75 62 79 67 65 6d 73 20 3e 20 32 2e 37 2e 36 0a 20 20 72 65 71 75 69 72 65 20 22 72 75 62 79 67 65 6d 73 2f 62 75 6e 64 6c 65 72 5f 76 65 72 73 69 6f 6e 5f 66 69 6e 64 65 72 22 0a 72 65 73 63 75 65 20 4c 6f 61 64 45 72 72 6f 72 0a 20 20 23 20 70 72 6f 62 61 62 6c 79 20 6d 65 61 6e 73 20 72 75 62 79 67 65 6d 73 20 69 73 20 74 6f 6f 20 6f 6c 64 20 6f 72 20 74 6f 6f 20 6e 65 77 20 74 6f 20 68 61 76 65 20 74 68 69 73 20 63 6c 61 73 73 2c 20 61 6e 64 20 77 65 20 64 6f 6e 27 74 20 63 61 72 65 0a 65 6e 64 0a 0a 23 20 61 76 6f 69 64 20 61 70 70 62 75 6e 64 6c 69 6e 67 20 69 66 20 77 65 20 61 72 65 20 64 65 66 69 6e 69 74 65 6c 79 20 72 75 6e 6e 69 6e 67 20 77 69 74 68 69 6e 20 61 20 42 75 6e 64 6c 65 72 20 62 75 6e 64 6c 65 2e 0a 23 20 6d 6f 73 74 20 6c 69 6b 65 6c 79 20 74 68 65 20 63 68 65 63 6b 20 66 6f 72 20 64 65 66 69 6e 65 64 3f 28 42 75 6e 64 6c 65 72 29 20 69 73 20 65 6e 6f 75 67 68 20 73 69 6e 63 65 20 77 65 20 64 6f 6e 27 74 20 72 65 71 75 69 72 65 0a 23 20 62 75 6e 64 6c 65 72 20 61 62 6f 76 65 2c 20 62 75 74 20 6a 75 73 74 20 66 6f 72 20 70 61 72 61 6e 6f 69 61 27 73 20 73 61 6b 65 20 61 6c 73 6f 20 77 65 20 74 65 73 74 20 74 6f 20 73 65 65 20 69 66 20 42 75 6e 64 6c 65 72 20 69 73 0a 23 20 72 65 61 6c 6c 79 20 64 6f 69 6e 67 20 69 74 73 20 74 68 69 6e 67 20 6f 72 20 6e 6f 74 2e 0a 75 6e 6c 65 73 73 20 64 65 66 69 6e 65 64 3f 28 42 75 6e 64 6c 65 72 29 20 26 26 20 42 75 6e 64 6c 65 72 2e 69 6e 73 74 61 6e 63 65 5f 76 61 72 69 61 62 6c 65 5f 64 65 66 69 6e 65 64 3f 28 22 40 6c 6f 61 64 22 29 0a 20 20 45 4e 56 5b 22 47 45 4d 5f 48 4f 4d 45 22 5d 20 3d 20 45 4e 56 5b 22 47 45 4d 5f 50 41 54 48 22 5d 20 3d 20 6e 69 6c 20 75 6e 6c 65 73 73 20 45 4e 56 5b 22 41 50 50 42 55 4e 44 4c 45 52 5f 41 4c 4c 4f 57 5f 52 56 4d}
condition:
      filesize < 40KB and
      8 of them and $magic
}